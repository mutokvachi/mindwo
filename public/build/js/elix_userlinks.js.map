{"version":3,"sources":["search_top.js","userlinks.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC/VA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"elix_userlinks.js","sourcesContent":["/**\r\n * Lapas augšējās joslas meklēšanas lauka funkcionalitāte\r\n * \r\n * @type _L4.Anonym$0|Function\r\n */\r\nvar SearchTop = function()\r\n{\r\n    /**\r\n     * Aktuālais meklēšanas tips\r\n     * \r\n     * @type String\r\n     */\r\n    var current_type = \"\";\r\n\r\n    /**\r\n     * Paziņojuma teksts, ja nekas nav atrasts pēc norādītā kritērija\r\n     * \r\n     * @type String\r\n     */\r\n    var txt_nothing_found = \"Nav atrasts neviens atbilstošs ieraksts.\";\r\n    \r\n    /**\r\n     * Noklusētais paziņojuma teksts, kamēr vēl nav veikta darbinieku meklēšana\r\n     * \r\n     * @type String\r\n     */\r\n    var txt_default_info = \"Lūdzu, ievadiet vismaz trīs burtus, un tiks veikta dinamiskā darbinieku meklēšana.\";\r\n    \r\n    /**\r\n     * Employee label title\r\n     * \r\n     * @type String\r\n     */\r\n    var txt_employee = \"Darbinieki\";\r\n    \r\n    /**\r\n     * Searching in progress label\r\n     * \r\n     * @type String\r\n     */\r\n    var txt_searching = \"Meklē....\";\r\n    \r\n    /**\r\n     * Norāda, vai ir parādīts izslīdošais darbinieku meklēšanas rezultātu bloks\r\n     * \r\n     * @type Number\r\n     */\r\n    var is_sidebar_shown = 0;\r\n    \r\n    var is_search_on_top = 1;\r\n\r\n    var statusDisplay = $(\"#quick-search-status\");\r\n    \r\n    /**\r\n     * Veic AJAX pieprasījumu ar darbinieku meklēšanu\r\n     * \r\n     * @returns {undefined}\r\n     */\r\n    var doAjaxSearch = function() {\r\n        \r\n        var criteria = $(\"#search_criteria\").val().trim();\r\n        \r\n        if (criteria == \"\")\r\n        {\r\n            $(\".dx-employees-quick-results\").html('');\r\n            statusDisplay.html(txt_default_info);\r\n            return;\r\n        }\r\n        \r\n        if (criteria.length < 3) {\r\n            $(\".dx-employees-quick-results\").html('');\r\n            statusDisplay.html(txt_default_info);\r\n            return;\r\n        }\r\n        \r\n        /*\r\n        var formData = new FormData();\r\n        formData.append(\"criteria\", criteria);\r\n        */\r\n        var formData = \"criteria=\" + criteria;\r\n        var ajax_url = 'ajax/employees';\r\n        \r\n        $(\".dx-employees-quick-results\").html('');\r\n        statusDisplay.html(txt_searching);\r\n\r\n        var request = new FormAjaxRequestIE9 (ajax_url, \"\", \"\", formData);            \r\n        request.progress_info = \"\";\r\n\r\n        request.callback = function(data) {\r\n\r\n            if (data['html'].indexOf('employee-list') !== -1) {\r\n                $(\".dx-employees-quick-results\").html(data['html']);\r\n\r\n                EmployeesLinks.init($(\"#dx-top-search-div\").find(\".employee-list\"), clearCriteria);\r\n                statusDisplay.html('');\r\n            }\r\n            else {\r\n                // nothing found\r\n                statusDisplay.html(txt_nothing_found);\r\n            }\r\n        };\r\n\r\n        // izpildam AJAX pieprasījumu\r\n        request.doRequest();\r\n    };    \r\n    \r\n    /**\r\n     * Notīra darbinieku meklēšanas frāzes lauku\r\n     * \r\n     * @returns {undefined}\r\n     */\r\n    var clearCriteria = function() {\r\n        $(\"#search_criteria\").val('');\r\n    }\r\n    \r\n    /**\r\n     * Nodrošina meklēšanas tipa izvēles apstrādi - uzstāda meklēšanas tipa tekstu un ieliek kursora fokusu meklēšanas laukā\r\n     * \r\n     * @returns {undefined}\r\n     */\r\n    var handleTypeChoose = function() {\r\n        $(\"#top_search a\").each(function() {\r\n            $(this).click(function(e) {\r\n                $(\"#search_title\").html($(this).text());\r\n                $(\"#searchType\").val($(this).text());\r\n                current_type = $(this).text();\r\n                $(\"#search_criteria\").focus();                \r\n            });\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Nodrošina meklēšanas izpildi uz pogas nospiešanu\r\n     * \r\n     * @returns {undefined}\r\n     */\r\n    var handleBtnSearch = function() {\r\n        $(\"#search_btn\").click(function() {\r\n            show_page_splash();\r\n        });\r\n    };\r\n    \r\n    var hideSideBar = function() {\r\n        $('body').toggleClass('page-quick-sidebar-open');\r\n        is_sidebar_shown = 0;\r\n        $(\".dx-employees-quick-results\").html('');  \r\n        statusDisplay.html(txt_default_info);\r\n\r\n    };\r\n    \r\n    /**\r\n     * Parāda izslīdošo darbinieku meklēšanas rezultātu bloku, ja ir fokuss uz meklēšanas lauku.\r\n     * Bloku rāda tikai tad, ja meklēšanas tips ir Darbinieki\r\n     * \r\n     * @returns {undefined}\r\n     */\r\n    var handleQuickSidebarToggler = function() {\r\n        // quick sidebar toggler\r\n        $('#search_criteria').on('keyup', function(e) {\r\n            if (current_type == txt_employee)\r\n            {\r\n                if (is_sidebar_shown == 0 && is_search_on_top == 1)\r\n                {                    \r\n                    $('body').toggleClass('page-quick-sidebar-open');\r\n                    is_sidebar_shown = 1;\r\n                    \r\n                    if ($(\"#search_criteria\").val().trim() != \"\")\r\n                    {\r\n                        doAjaxSearch();\r\n                    }\r\n                }\r\n            }\r\n            else\r\n            {\r\n                if (is_sidebar_shown == 1)\r\n                {\r\n                    hideSideBar();\r\n                }\r\n            }\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Paslēp darbinieku meklēšanas rezultātu bloku, ja nospiests krustiņš\r\n     * \r\n     * @returns {undefined}\r\n     */\r\n    var handleSidebarHide = function() {\r\n        $(\"a.close-quick-sidebar\").click(function() {\r\n            if (is_sidebar_shown == 1)\r\n            {\r\n                $('body').toggleClass('page-quick-sidebar-open');\r\n                is_sidebar_shown = 0;\r\n            }\r\n        });\r\n    };\r\n    \r\n    /**\r\n     * Nodrošina darbinieku ātro meklēšanu - AJAX pieprasījuma izpilde, ja ievada kādu simbolu meklēšanas laukā\r\n     * \r\n     * @returns {undefined}\r\n     */\r\n    var handleQuickSearch = function() {\r\n        $(\"#search_criteria\").keyup(function() {\r\n            if (is_sidebar_shown)\r\n            {\r\n                doAjaxSearch();\r\n            }\r\n        });        \r\n    };\r\n    \r\n    /**\r\n     * Nodrošina darbinieku ātro meklēšanu - AJAX pieprasījuma izpilde, ja meklēšanas laukā iekopē kādu tekstu\r\n     * \r\n     * @returns {undefined}\r\n     */\r\n    var handleCopyPasteSearch = function() {\r\n        $('#search_criteria').bind('paste', function () {            \r\n            setTimeout(function () {\r\n                doAjaxSearch();\r\n            }, 100);\r\n        });\r\n    };\r\n    \r\n    /**\r\n     * Uzstāda izslīdošā darbinieku meklēšanas rezultāta bloka platumu atbilstoši loga platumam\r\n     * \r\n     * @returns {undefined}\r\n     */\r\n    var initSidebarStyle = function() {                \r\n        \r\n        var width = 760; //$( document ).width() - $(\"#top_search\").offset().left;\r\n        \r\n        if ($(\"#employee_quick_css\").length == 0)\r\n        {\r\n            $(\"head\").append('<style type=\"text/css\" id=\"employee_quick_css\"></style>');\r\n        }\r\n        var newStyleElement = $(\"#employee_quick_css\");\r\n        newStyleElement.html('.page-quick-sidebar-wrapper{width:' + width + 'px; right: -' + width + 'px;}');\r\n        \r\n        if ( $.isFunction($.fn.slimScroll) ) {\r\n            if ($(\".dx-employees-quick .slimScrollDiv\").length)\r\n            {\r\n                $(\".dx-employees-quick-results\").slimScroll({destroy: true});\r\n            }\r\n\r\n            $('.dx-employees-quick-results').slimScroll({\r\n                height: $(\".dx-employees-quick\").height() + 'px',\r\n                position: 'left',\r\n                color: '#f1f4f7'\r\n            });\r\n        }\r\n    };\r\n    \r\n    var placeSearchBox = function() {\r\n        if ($( document ).width() > 990) {\r\n            // show on top\r\n            if (is_search_on_top){\r\n                return;\r\n            }\r\n            \r\n            var htm = $(\"#dx-search-box-in-page\").html();\r\n            $(\"#dx-search-box-in-page\").html(\"\");\r\n            \r\n            $(\"#dx-search-box-top-li\").html(htm);\r\n            is_search_on_top = 1;\r\n            initHandlers();\r\n        }\r\n        else\r\n        {            \r\n            // show in page content\r\n            if (!is_search_on_top){\r\n                return;\r\n            }\r\n            \r\n            var htm = $(\"#dx-top-search-form\").parent().html();\r\n            $(\"#dx-top-search-form\").remove();\r\n            \r\n            $(\"#dx-search-box-in-page\").html(htm);\r\n            is_search_on_top = 0;\r\n            initHandlers();\r\n            \r\n            if (is_sidebar_shown == 1)\r\n            {\r\n                hideSideBar();\r\n            }\r\n        }\r\n        \r\n    };\r\n    \r\n    /**\r\n     * Initialize button handlers and styles\r\n     * \r\n     * @returns {undefined}\r\n     */\r\n    var initHandlers = function() {\r\n        handleTypeChoose();\r\n        handleBtnSearch();\r\n        \r\n        initSidebarStyle();\r\n        handleQuickSidebarToggler();\r\n        handleSidebarHide();\r\n        handleQuickSearch();\r\n        handleCopyPasteSearch();\r\n    };\r\n    \r\n    /**\r\n     * Initialize translations for messages and labels\r\n     * \r\n     * @returns {undefined}\r\n     */\r\n    var initTranslations = function() {\r\n        var search_obj = $(\"#dx-top-search-div\");\r\n        txt_nothing_found = search_obj.attr('trans_nothing_found');\r\n        txt_default_info = search_obj.attr('trans_default_info');\r\n        txt_employee = search_obj.attr('trans_employees');\r\n        txt_searching = search_obj.attr('trans_searching');\r\n    };\r\n    \r\n    /**\r\n     * Inicializē slīdrādes bloku\r\n     * \r\n     * @returns {undefined}\r\n     */\r\n    var initSearch = function()\r\n    {\r\n        initTranslations();\r\n        \r\n        initHandlers();\r\n        \r\n        // uzstāda, ka pēc noklusēšanas tiks meklēti darbinieki\r\n        $(\"#searchType\").val(txt_employee);\r\n        current_type = txt_employee;\r\n        \r\n        placeSearchBox();\r\n        \r\n        // Pievienojam izslīdošā darbinieku rezultātu bloka pārzīmēšanas izsaukumu uz lapas/loga izmēra izmaiņām\r\n        PageMain.addResizeCallback(initSidebarStyle);\r\n        PageMain.addResizeCallback(placeSearchBox);\r\n    };\r\n\r\n    return {\r\n        init: function() {\r\n            initSearch();\r\n        }\r\n    };\r\n}();\r\n\r\n$(document).ready(function() {\r\n    $('[autofocus]:not(:focus)').eq(0).focus();\r\n    SearchTop.init();\r\n});","/**\r\n * SVS lietotāja profila funkcionalitāte - paroles maiņa\r\n * \r\n * @type _L4.Anonym$0|Function\r\n */\r\nvar UserLinks = function()\r\n{\r\n    /**\r\n     * Paroles nomaiņas formas elements\r\n     * \r\n     * @type Object\r\n     */\r\n    var pass_form = null;\r\n    \r\n    /**\r\n     * Izpilda paroles maiņas AJAX pieprasījumu - saglabā jauno paroli\r\n     * \r\n     * @returns {undefined}\r\n     */\r\n    var changePassw = function() {\r\n        \r\n        var formData = new FormData();\r\n        formData.append(\"pass_old\", pass_form.find(\"input[name='pass_old']\").val());\r\n        formData.append(\"pass_new1\", pass_form.find(\"input[name='pass_new1']\").val());\r\n        formData.append(\"pass_new2\", pass_form.find(\"input[name='pass_new2']\").val());\r\n\r\n        var ajax_url = '/ajax/change_password';\r\n\r\n        var request = new FormAjaxRequest (ajax_url, \"\", \"\", formData);            \r\n        request.progress_info = DX_CORE.trans_data_processing;                       \r\n\r\n        request.callback = function(data) {\r\n\r\n            notify_info(DX_CORE.trans_data_saved);          \r\n\r\n        };\r\n\r\n        // izpildam AJAX pieprasījumu\r\n        request.doRequest();\r\n    };    \r\n    \r\n    /**\r\n     * Uzstāda formas laukiem validatoru\r\n     * \r\n     * @returns {undefined}\r\n     */\r\n    var setValidator = function() {\r\n        pass_form.validator({            \r\n            errors: {\r\n                auto: 'Nav norādīta vērtība!'\r\n            },\r\n            feedback: {\r\n                success: 'glyphicon-ok',\r\n                error: 'glyphicon-alert'\r\n            }\r\n        }); \r\n    };\r\n    \r\n    /**\r\n     * Nodrošina paroles maiņas formas atvēršanu\r\n     * \r\n     * @returns {undefined}\r\n     */\r\n    var handleLinkPassword = function() {\r\n        $(\"a.dx-user-change-passw-link\").click(function(){\r\n            get_popup_item_by_id(0, 'ajax/form_password', DX_CORE.trans_passw_form_title);\r\n        });\r\n    };\r\n    \r\n    /**\r\n     * Nodrošina paroles maiņas saglabāšanas izsaukumu - pogas \"Mainīt paroli\" nospiešana\r\n     * \r\n     * @returns {undefined}\r\n     */\r\n    var handleBtnChange = function() {\r\n        pass_form.find(\".dx-user-change-passw-btn\").click(function() {\r\n            changePassw();\r\n        });\r\n    };\r\n    \r\n    /**\r\n     * Uzstāda laukiem validatoru. Ja validatora komponente vēl netika iekļauta, tad dinamiski to iekļauj\r\n     * \r\n     * @returns {undefined}\r\n     */\r\n    var handleValidator = function() {        \r\n        if ( !$.isFunction($.fn.validator) ) {\r\n            $.getScript( getBaseUrl() + \"plugins/validator/validator.js\", setValidator);\r\n        }\r\n        else{\r\n            setValidator();\r\n        }\r\n    };\r\n    \r\n    /**\r\n     * Inicializē lietotāja profila iespējas\r\n     * \r\n     * @returns {undefined}\r\n     */\r\n    var initProfile = function()\r\n    {\r\n        handleLinkPassword();        \r\n    };\r\n    \r\n    /**\r\n     * Inicializē paroles nomaiņas formu - tā tiek ielādēta ar AJAX\r\n     * \r\n     * @returns {undefined}\r\n     */\r\n    var initPasswForm = function() {\r\n        \r\n        if ($(\".dx-user-change-passw-form[dx_block_init='0']\").length == 0) {\r\n            return; // jau ir inicializēts\r\n        }\r\n        \r\n        pass_form = $(\".dx-user-change-passw-form\");\r\n        \r\n        handleBtnChange();\r\n        handleValidator();\r\n        \r\n        pass_form.attr(\"dx_block_init\", 1);\r\n        \r\n        setTimeout(function() {\r\n            pass_form.find(\"input[name='pass_old']\").focus();\r\n        }, 500);\r\n        \r\n    };\r\n\r\n    return {\r\n        init: function() {\r\n            initProfile();\r\n        },\r\n        initPasswForm: function() {\r\n            initPasswForm();\r\n        }\r\n    };\r\n}();\r\n\r\n$(document).ready(function() {\r\n    UserLinks.init();\r\n});\r\n\r\n$(document).ajaxComplete(function(event, xhr, settings) {\r\n    UserLinks.initPasswForm();\r\n});"]}