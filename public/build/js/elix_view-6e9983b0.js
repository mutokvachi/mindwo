function load_binded_field(e,t,i,n){var r=new FormData;r.append("binded_field_id",i),r.append("binded_rel_field_id",n),r.append("binded_rel_field_value",$("#"+e).val()),$.ajax({type:"POST",url:DX_CORE.site_url+"load_binded_field",data:r,processData:!1,contentType:!1,dataType:"json",success:function(e){try{var i=e;1==i.success?($("#"+t).empty(),$("#"+t).append(i.data),$("#"+t).val(0)):notify_err(i.error)}catch(n){notify_err(escapeHtml(n))}},beforeSend:function(){show_dx_progres(DX_CORE.trans_data_processing)},complete:function(){hide_dx_progres()},error:function(e,t,i){if(422===e.status){var n=e.responseJSON,r="<ul>";$.each(n,function(e,t){r+="<li>"+t[0]+"</li>"}),r+="</ul>",toastr.error(r)}else notify_err(DX_CORE.trans_general_error)}})}function new_list_item(e,t,i,n,r){return 0==e?void notify_err(DX_CORE.trans_general_error+" The List ID not provided!"):t>0&&0==i&&(i=$("#"+n+" input[name='item_id']").val(),0==i)?void notify_err(DX_CORE.trans_first_save_msg):void view_list_item("form",0,e,t,i,r,n)}function view_list_item(e,t,i,n,r,s,a){if(!is_executing(s)){start_executing(s);var o=new FormData;o.append("item_id",t),o.append("list_id",i),o.append("parent_item_id",r),o.append("parent_field_id",n),o.append("grid_htm_id",s),$.ajax({type:"POST",url:DX_CORE.site_url+e,data:o,processData:!1,contentType:!1,dataType:"json",success:function(e){try{var t=e;1==t.success?$("body").append(t.html):(notify_err(t.error),stop_executing(s))}catch(i){notify_err(i),stop_executing(s)}hide_form_splash(),hide_page_splash()},beforeSend:function(){show_form_splash(),show_page_splash()},error:function(e,t,i){if(422===e.status){var n=e.responseJSON,r="<ul>";$.each(n,function(e,t){r+="<li>"+t[0]+"</li>"}),r+="</ul>",toastr.error(r)}else notify_err(DX_CORE.trans_general_error),console.log("Sistēmas kļūda - XHR: "+e.statusText),console.log("Sistēmas kļūda - statuss: "+t),console.log("Sistēmas kļūda - kļūda: "+i);hide_form_splash(),hide_page_splash(),stop_executing(s)}})}}function open_form(e,t,i,n,r,s,a,o){var l=new FormData;if(l.append("item_id",t),l.append("list_id",i),l.append("parent_item_id",r),l.append("parent_field_id",n),l.append("grid_htm_id",s),l.append("form_is_edit_mode",a),l.append("parent_form_htm_id",o),o.length>0){var c=$("#"+o),d=c.find("input[name=call_field_htm_id]");d.length>0&&(l.append("call_field_htm_id",d.val()),l.append("call_field_id",c.find("input[name=call_field_id]").val()),l.append("call_field_type",c.find("input[name=call_field_type]").val()))}$.ajax({type:"POST",url:DX_CORE.site_url+e,data:l,processData:!1,contentType:!1,dataType:"json",success:function(e){try{var t=e;1==t.success?$("body").append(t.html):notify_err(t.error)}catch(i){notify_err(i)}hide_form_splash(),hide_page_splash()},beforeSend:function(){show_form_splash(),show_page_splash()},error:function(e,t,i){if(422===e.status){var n=e.responseJSON,r="<ul>";$.each(n,function(e,t){r+="<li>"+t[0]+"</li>"}),r+="</ul>",toastr.error(r)}else notify_err(DX_CORE.trans_general_error);hide_form_splash(),hide_page_splash()}})}function rel_new_form(e,t,i,n,r,s){var a=new FormData;a.append("item_id",i),a.append("list_id",t),a.append("call_field_id",n),a.append("call_field_htm_id",r),a.append("call_field_type",s),i>0&&a.append("form_is_edit_mode",1),$.ajax({type:"POST",url:DX_CORE.site_url+e,data:a,processData:!1,contentType:!1,dataType:"json",success:function(e){try{var t=e;1==t.success?$("body").append(t.html):notify_err(t.error)}catch(i){notify_err(i)}hide_form_splash()},beforeSend:function(){show_form_splash()},error:function(e,t,i){if(422===e.status){var n=e.responseJSON,r="<ul>";$.each(n,function(e,t){r+="<li>"+t[0]+"</li>"}),r+="</ul>",toastr.error(r)}else notify_err(DX_CORE.trans_general_error);hide_form_splash()}})}function refresh_form_fields(edit_form_htm_id,form_htm_id,item_id,list_id,rel_field_id,rel_field_value){var formData=new FormData;formData.append("item_id",item_id),formData.append("list_id",list_id),formData.append("rel_field_id",rel_field_id),formData.append("rel_field_value",rel_field_value);var frm_uniq_id=$("#"+form_htm_id).find("div[dx_attr=form_fields]").attr("dx_form_id");formData.append("frm_uniq_id",frm_uniq_id),edit_form_htm_id==form_htm_id&&formData.append("form_is_edit_mode",1),$.ajax({type:"POST",url:DX_CORE.site_url+"refresh_form",data:formData,processData:!1,contentType:!1,dataType:"json",async:!0,success:function(data){debug_log("refresh_form_fields - AJAX received");try{var myData=data;if(1==myData.success){var div_fields=$("#"+form_htm_id).find("div[dx_attr=form_fields]");div_fields.html(myData.html),div_fields.attr("dx_is_init",0),jQuery.each(myData.tabs,function(e,t){$("#"+form_htm_id).find("div[dx_tab_id="+e+"]").html(t)});var script=$("body").find("div[dx_attr='"+form_htm_id+"']");if(script.html()){var tmp=script.html();tmp=tmp.replace('<script type="text/javascript">'),tmp=tmp.replace("</script>"),eval(tmp)}FormLogic.adjustDataTabs($("#item_edit_form_"+frm_uniq_id).find(".dx-cms-form-fields-section").first()),notify_info(DX_CORE.trans_data_saved),stop_executing(edit_form_htm_id),edit_form_htm_id!=form_htm_id&&$("#"+edit_form_htm_id).parent().parent().parent().parent().parent().modal("hide")}else notify_err(myData.error)}catch(err){notify_err(escapeHtml(err))}debug_log("refresh_form_fields - lets hide splash"),hide_form_splash(1),hide_page_splash(1)},beforeSend:function(){show_form_splash(),show_page_splash()},error:function(e,t,i){if(422===e.status){var n=e.responseJSON,r="<ul>";$.each(n,function(e,t){r+="<li>"+t[0]+"</li>"}),r+="</ul>",toastr.error(r)}else notify_err(DX_CORE.trans_sys_error);hide_form_splash(),hide_page_splash()}})}function reload_edited_form(e,t,i,n,r,s,a){var o=new FormData;o.append("item_id",t),o.append("list_id",i),o.append("parent_item_id",r),o.append("parent_field_id",n),o.append("grid_htm_id",s),o.append("is_form_reloaded",1);var l=new FormAjaxRequest(e,"",s,o);l.progress_info="Ielādē datus. Lūdzu, uzgaidiet...",l.callback=function(e){show_form_splash();var t=e.frm_uniq_id,i=new RegExp(t,"g"),n=e.html.replace(i,a),r=$("#list_item_view_form_"+a).find(".modal-body").height();if(unregister_form("list_item_view_form_"+a),$("#list_item_view_form_"+a).find(".modal-content").html(n),r>500){var s=$("#top_toolbar_list_item_view_form_"+a).height();$("#list_item_view_form_"+a).find(".modal-body").height(r-s-21)}var o=$(window).height()*DX_CORE.form_height_ratio,l=$("#list_item_view_form_"+a).find(".modal-body");l.css("overflow-y","auto"),l.css("max-height",o+"px"),FormLogic.adjustDataTabs($("#item_edit_form_"+a).find(".dx-cms-form-fields-section").first()),notify_info(DX_CORE.trans_data_saved),hide_form_splash(1)},l.doRequest()}function save_list_item(e,t,i,n,r,s){var a=process_data_fields(e);if(null!=a){show_form_splash(1);var o=new FormAjaxRequest("save_form",e,t,a);o.progress_info="Saglabā datus. Lūdzu, uzgaidiet...",o.callback=function(a){if(show_form_splash(),t&&reload_grid(t),a.call_field_htm_id)return"RelIdField"==a.call_field_type?RelIdField.update_callback(a.call_field_htm_id,a.id,a.call_field_value):"AutocompleateField"==a.call_field_type?AutocompleateField.update_callback(a.call_field_htm_id,a.id,a.call_field_value):notify_error("Unsuported field type '"+a.call_field_htm_id+"'"),hide_form_splash(1),hide_page_splash(1),$("#"+e).parent().parent().parent().parent().parent().modal("hide"),void notify_info(DX_CORE.trans_data_saved);if(s)refresh_form_fields(e,s,a.id,i,n,r);else{var o=$("#"+e).parent().parent().parent().parent().parent().attr("id").replace("list_item_view_form_","");reload_edited_form("form",a.id,i,n,r,t,o)}},o.doRequest()}}function process_data_fields(e){tinyMCE.triggerSave();var t=new FormData;return process_Input_simple(e,t)&&process_dropzone(e,t)?(process_TextArea_Select(e,t),process_Input_radio(e,t),t):null}function process_Input_radio(e,t){$("#"+e).find(":checkbox:checked, :radio:checked").each(function(e,i){t.append(i.name,i.value)})}function process_TextArea_Select(e,t){return $("#"+e+" select, #"+e+" textarea").each(function(e,i){t.append(i.name,i.value)}),t}function process_Input_simple(e,t){var i=0;return $("#"+e).find(":input:not(:checkbox, :radio)").each(function(e,n){if(1!=i)if("file"==n.type){if(n.files[0]){if(!validateFile(n.files[0]))return void(i=1);t.append(n.name,n.files[0])}}else n.name.length>0&&t.append(n.name,n.value)}),1!=i}function process_dropzone(e,t){var i=0;return $("#"+e).find(".dropzone").each(function(e,n){if(1!=i)for(var r=Dropzone.forElement(n),s=0;s<r.files.length;s++){if(!validateFile(r.files[s]))return void(i=1);t.append(r.options.paramName+"[]",r.files[s])}}),1!=i}function validateFile(e){if("undefined"==typeof e.name)return!1;var t=(e.size/1024/1024).toFixed(2),i=DX_CORE.trans_file_error,n=0;return parseFloat(t)>parseFloat(DX_CORE.max_upload_size)?n=parseFloat(DX_CORE.max_upload_size):parseFloat(t)>parseFloat(DX_CORE.post_max_size)&&(n=parseFloat(DX_CORE.post_max_size)),!(n>0)||(i=i.replace("%n",e.name).replace("%s",t).replace("%u",n),notify_err(i),!1)}function delete_list_item(e,t){if(confirm(DX_CORE.trans_confirm_delete)){var i=$("#"+e+" input[name='item_id']").val();if(0===i)return void $("#"+e).modal("hide");var n=$("#"+e+" input[name='edit_form_id']").val(),r=new FormData;r.append("item_id",i),r.append("edit_form_id",n);var s=new FormAjaxRequest("delete_item",e,t,r);s.callback=function(){t&&reload_grid(t),$("#"+e).modal("hide"),notify_info(DX_CORE.trans_data_deleted)},s.doRequest()}}function delete_multiple_items(e,t,i,n){var r=new FormData;r.append("list_id",e),r.append("items",i);var s=new FormAjaxRequest("delete_grid_items","",t,r);s.callback=function(){reload_grid(t);var e=DX_CORE.trans_data_deleted;n||(e=DX_CORE.trans_data_deleted_all),notify_info(e)},s.doRequest()}function get_word_filter_data(e){var t=new Array,i=new Array;return i.push("id"),i.push(e),t.push(i),JSON.stringify(t)}function generate_word(e,t,i,n){var r=new FormData;r.append("item_id",e),r.append("list_id",t),r.append("filter_data",get_word_filter_data(e));var s=new FormAjaxRequest("generate_word",n,i,r);s.progress_info=DX_CORE.trans_word_generating,s.callback=function(e){reload_grid(i),$("#"+n+" [dx_file_field_id="+e.field_id+"]").html(e.html),notify_info(DX_CORE.trans_word_generated)},s.doRequest()}function FileManager(e,t,i,n){var r=window,s=document,a=s.documentElement,o=s.getElementsByTagName("body")[0],l=r.innerWidth||a.clientWidth||o.clientWidth,c=r.innerHeight||a.clientHeight||o.clientHeight,d=DX_CORE.site_url+"filemanager/show?&field_name="+e+"&lang="+tinymce.settings.language;"image"==i&&(d+="&type=images"),tinyMCE.activeEditor.windowManager.open({file:d,title:"Datņu pārvaldība",width:.8*l,height:.8*c,resizable:"yes",close_previous:"no"})}function init_textarea(e){var t={mode:"exact",height:208,language:"lv",plugins:["advlist autolink lists link image charmap print preview anchor colorpicker hr","searchreplace visualblocks code fullscreen","insertdatetime media table contextmenu paste textcolor","custom_buttons"],toolbar:"insertfile undo redo | styleselect | bold italic | forecolor backcolor | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image | sizeselect fontsizeselect",file_browser_callback:FileManager,fullscreen_new_window:!0,theme_advanced_font_sizes:"10px,12px,13px,14px,15px,16px,18px,20px,22px,24px,26px,28px,30px,32px,34px,36px,38px,40px",font_size_style_values:"10px,12px,13px,14px,15px,16px,18px,20px,22px,24px,26px,28px,30px,32px,34px,36px,38px,40px"};tinyMCE.PluginManager.add("custom_buttons",function(e,t){}),DX_CORE.valid_elements.length>0&&(t.valid_elements=DX_CORE.valid_elements),DX_CORE.valid_styles.length>0&&(t.valid_styles={},t.valid_styles["*"]=DX_CORE.valid_styles),tinyMCE.init(t)}function init_soft_code(e){var t=CodeMirror.fromTextArea(document.getElementById(e),{lineNumbers:!0,matchBrackets:!0,styleActiveLine:!0,mode:"javascript",autofocus:!0});t.on("change",function(t){$("#"+e).val(t.getValue())}),setTimeout(function(){t.refresh()},1e3)}function printForm(e){var t=$("#"+e).html(),i=window.open("","my div","height=400,width=600");return i.document.write("<html><head><title>my div</title>"),i.document.write('<link rel="stylesheet" href="'+DX_CORE.site_url+'homer/vendor/bootstrap/dist/css/bootstrap.css" type="text/css" />'),i.document.write("</head><body >"),i.document.write(t),i.document.write("</body></html>"),i.document.close(),i.focus(),i.print(),i.close(),!0}function load_grid(e,t,i){var n=new FormData;n.append("list_id",t),n.append("view_id",i),n.append("grid_data_htm_id",e),n.append("page_nr",1),n.append("page_row_count",0),post_grid_ajax(n,e,"",0)}function reload_grid_by_id(e){var t=get_filter_data(e),i=$("#"+e).data("grid_data_htm_id"),n=new FormData;n.append("list_id",$("#"+e).data("list_id")),n.append("view_id",$("#"+e).data("view_id")),n.append("grid_data_htm_id",i),n.append("page_nr",$("#"+e).data("grid_page_nr")),n.append("page_row_count",$("#"+e).data("grid_rows_in_page")),n.append("grid_id",e),n.append("filter_data",t),n.append("sorting_field",$("#"+e).data("sorting_field")),n.append("sorting_direction",$("#"+e).data("sorting_direction")),post_grid_ajax(n,i,"",0)}function reload_grid(e){return $("#"+e).data("tab_id")?void reload_tab_grid(e):void reload_grid_by_id(e)}function load_tab_grid(e,t,i,n,r,s,a,o,l){var c=new FormData;c.append("list_id",t),c.append("tab_id",e),c.append("view_id",i),c.append("rel_field_id",n),c.append("rel_field_value",r),c.append("form_htm_id",s),c.append("page_nr",a),c.append("page_row_count",o),post_grid_ajax(c,e,s,l)}function post_grid_ajax(e,t,i,n){$.ajax({type:"POST",url:DX_CORE.site_url+"grid",data:e,processData:!1,contentType:!1,dataType:"json",success:function(e){try{var r=e;if(1==r.success){if($("#"+t).html(r.html),1==n){var s=$("#"+i).find(".modal-body");s.scrollTop(s.prop("scrollHeight"))}}else notify_err(r.error)}catch(a){notify_err(escapeHtml(a))}hide_page_splash(),hide_form_splash()},beforeSend:function(){show_form_splash(),show_page_splash()},complete:function(){debug_log("Grid AJAX compleate - hiding splashes"),hide_form_splash(),hide_page_splash()},error:function(e,t,i){if(422===e.status){var n=e.responseJSON,r="<ul>";$.each(n,function(e,t){r+="<li>"+t[0]+"</li>"}),r+="</ul>",toastr.error(r)}else 401===e.status?notify_err(DX_CORE.trans_session_end):notify_err(DX_CORE.trans_general_error);hide_form_splash(),hide_page_splash()}})}function reload_tab_grid(e){var t=get_filter_data(e),i=$("#"+e).data("rel_field_id"),n=$("#"+e).data("rel_field_value"),r=$("#"+e).data("form_htm_id"),s=e;if(i>0&&0==n){if(n=$("#"+r+" input[name='item_id']").val(),0==n)return void notify_err("Vispirms saglabājiet formu un tad veiciet saistīto datu ielādēšanu!");s=""}var a=new FormData;a.append("list_id",$("#"+e).data("list_id")),a.append("tab_id",$("#"+e).data("tab_id")),a.append("view_id",$("#"+e).data("view_id")),a.append("rel_field_id",i),a.append("rel_field_value",n),a.append("form_htm_id",r),a.append("page_nr",$("#"+e).data("grid_page_nr")),a.append("page_row_count",$("#"+e).data("grid_rows_in_page")),a.append("sorting_field",$("#"+e).data("sorting_field")),a.append("sorting_direction",$("#"+e).data("sorting_direction")),a.append("grid_id",s),a.append("filter_data",t),post_grid_ajax(a,$("#"+e).data("tab_id"),r,1)}function get_filter_data(e){var t=new Array;return $("#filter_"+e+" input").each(function(e,i){if(""!=i.value){var n=new Array;n.push(i.getAttribute("sql_name")),n.push(i.value),n.push(i.getAttribute("field_id")),t.push(n)}}),JSON.stringify(t)}if(!function(e,t){if("function"==typeof define&&define.amd)define(["moment","jquery","exports"],function(i,n,r){e.daterangepicker=t(e,r,i,n)});else if("undefined"!=typeof exports){var i=require("moment"),n="undefined"!=typeof window?window.jQuery:void 0;if(!n)try{n=require("jquery"),n.fn||(n.fn={})}catch(r){if(!n)throw new Error("jQuery dependency not found")}t(e,exports,i,n)}else e.daterangepicker=t(e,{},e.moment||moment,e.jQuery||e.Zepto||e.ender||e.$)}(this||{},function(e,t,i,n){var r=function(e,t,r){if(this.parentEl="body",this.element=n(e),this.startDate=i().startOf("day"),this.endDate=i().endOf("day"),this.minDate=!1,this.maxDate=!1,this.dateLimit=!1,this.autoApply=!1,this.singleDatePicker=!1,this.showDropdowns=!1,this.showWeekNumbers=!1,this.timePicker=!1,this.timePicker24Hour=!1,this.timePickerIncrement=1,this.timePickerSeconds=!1,this.linkedCalendars=!0,this.autoUpdateInput=!0,this.ranges={},this.opens="right",this.element.hasClass("pull-right")&&(this.opens="left"),this.drops="down",this.element.hasClass("dropup")&&(this.drops="up"),this.buttonClasses="btn btn-sm",this.applyClass="btn-success",this.cancelClass="btn-default",this.locale={format:"MM/DD/YYYY",separator:" - ",applyLabel:"Apply",cancelLabel:"Cancel",weekLabel:"W",customRangeLabel:"Custom Range",daysOfWeek:i.weekdaysMin(),monthNames:i.monthsShort(),firstDay:i.localeData().firstDayOfWeek()},this.callback=function(){},this.isShowing=!1,this.leftCalendar={},this.rightCalendar={},("object"!=typeof t||null===t)&&(t={}),t=n.extend(this.element.data(),t),"string"!=typeof t.template&&(t.template='<div class="daterangepicker dropdown-menu"><div class="calendar left"><div class="daterangepicker_input"><input class="input-mini" type="text" name="daterangepicker_start" value="" /><i class="fa fa-calendar"></i><div class="calendar-time"><div></div><i class="fa fa-clock-o"></i></div></div><div class="calendar-table"></div></div><div class="calendar right"><div class="daterangepicker_input"><input class="input-mini" type="text" name="daterangepicker_end" value="" /><i class="fa fa-calendar"></i><div class="calendar-time"><div></div><i class="fa fa-clock-o"></i></div></div><div class="calendar-table"></div></div><div class="ranges"><div class="range_inputs"><button class="applyBtn" disabled="disabled" type="button"></button> <button class="cancelBtn" type="button"></button></div></div></div>'),this.parentEl=n(t.parentEl&&n(t.parentEl).length?t.parentEl:this.parentEl),this.container=n(t.template).appendTo(this.parentEl),"object"==typeof t.locale&&("string"==typeof t.locale.format&&(this.locale.format=t.locale.format),"string"==typeof t.locale.separator&&(this.locale.separator=t.locale.separator),"object"==typeof t.locale.daysOfWeek&&(this.locale.daysOfWeek=t.locale.daysOfWeek.slice()),"object"==typeof t.locale.monthNames&&(this.locale.monthNames=t.locale.monthNames.slice()),"number"==typeof t.locale.firstDay&&(this.locale.firstDay=t.locale.firstDay),"string"==typeof t.locale.applyLabel&&(this.locale.applyLabel=t.locale.applyLabel),"string"==typeof t.locale.cancelLabel&&(this.locale.cancelLabel=t.locale.cancelLabel),"string"==typeof t.locale.weekLabel&&(this.locale.weekLabel=t.locale.weekLabel),"string"==typeof t.locale.customRangeLabel&&(this.locale.customRangeLabel=t.locale.customRangeLabel)),"string"==typeof t.startDate&&(this.startDate=i(t.startDate,this.locale.format)),"string"==typeof t.endDate&&(this.endDate=i(t.endDate,this.locale.format)),"string"==typeof t.minDate&&(this.minDate=i(t.minDate,this.locale.format)),"string"==typeof t.maxDate&&(this.maxDate=i(t.maxDate,this.locale.format)),"object"==typeof t.startDate&&(this.startDate=i(t.startDate)),"object"==typeof t.endDate&&(this.endDate=i(t.endDate)),"object"==typeof t.minDate&&(this.minDate=i(t.minDate)),"object"==typeof t.maxDate&&(this.maxDate=i(t.maxDate)),this.minDate&&this.startDate.isBefore(this.minDate)&&(this.startDate=this.minDate.clone()),this.maxDate&&this.endDate.isAfter(this.maxDate)&&(this.endDate=this.maxDate.clone()),"string"==typeof t.applyClass&&(this.applyClass=t.applyClass),"string"==typeof t.cancelClass&&(this.cancelClass=t.cancelClass),"object"==typeof t.dateLimit&&(this.dateLimit=t.dateLimit),"string"==typeof t.opens&&(this.opens=t.opens),"string"==typeof t.drops&&(this.drops=t.drops),"boolean"==typeof t.showWeekNumbers&&(this.showWeekNumbers=t.showWeekNumbers),"string"==typeof t.buttonClasses&&(this.buttonClasses=t.buttonClasses),"object"==typeof t.buttonClasses&&(this.buttonClasses=t.buttonClasses.join(" ")),"boolean"==typeof t.showDropdowns&&(this.showDropdowns=t.showDropdowns),"boolean"==typeof t.singleDatePicker&&(this.singleDatePicker=t.singleDatePicker,this.singleDatePicker&&(this.endDate=this.startDate.clone())),"boolean"==typeof t.timePicker&&(this.timePicker=t.timePicker),"boolean"==typeof t.timePickerSeconds&&(this.timePickerSeconds=t.timePickerSeconds),"number"==typeof t.timePickerIncrement&&(this.timePickerIncrement=t.timePickerIncrement),"boolean"==typeof t.timePicker24Hour&&(this.timePicker24Hour=t.timePicker24Hour),"boolean"==typeof t.autoApply&&(this.autoApply=t.autoApply),"boolean"==typeof t.autoUpdateInput&&(this.autoUpdateInput=t.autoUpdateInput),"boolean"==typeof t.linkedCalendars&&(this.linkedCalendars=t.linkedCalendars),"function"==typeof t.isInvalidDate&&(this.isInvalidDate=t.isInvalidDate),0!=this.locale.firstDay)for(var s=this.locale.firstDay;s>0;)this.locale.daysOfWeek.push(this.locale.daysOfWeek.shift()),s--;var a,o,l;if("undefined"==typeof t.startDate&&"undefined"==typeof t.endDate&&n(this.element).is("input[type=text]")){var c=n(this.element).val(),d=c.split(this.locale.separator);a=o=null,2==d.length?(a=i(d[0],this.locale.format),o=i(d[1],this.locale.format)):this.singleDatePicker&&""!==c&&(a=i(c,this.locale.format),o=i(c,this.locale.format)),null!==a&&null!==o&&(this.setStartDate(a),this.setEndDate(o))}if("object"==typeof t.ranges){for(l in t.ranges){a="string"==typeof t.ranges[l][0]?i(t.ranges[l][0],this.locale.format):i(t.ranges[l][0]),o="string"==typeof t.ranges[l][1]?i(t.ranges[l][1],this.locale.format):i(t.ranges[l][1]),this.minDate&&a.isBefore(this.minDate)&&(a=this.minDate.clone());var h=this.maxDate;if(this.dateLimit&&a.clone().add(this.dateLimit).isAfter(h)&&(h=a.clone().add(this.dateLimit)),h&&o.isAfter(h)&&(o=h.clone()),!(this.minDate&&o.isBefore(this.minDate)||h&&a.isAfter(h))){var u=document.createElement("textarea");u.innerHTML=l,rangeHtml=u.value,this.ranges[rangeHtml]=[a,o]}}var f="<ul>";for(l in this.ranges)f+="<li>"+l+"</li>";f+="<li>"+this.locale.customRangeLabel+"</li>",f+="</ul>",this.container.find(".ranges").prepend(f)}if("function"==typeof r&&(this.callback=r),this.timePicker||(this.startDate=this.startDate.startOf("day"),this.endDate=this.endDate.endOf("day"),this.container.find(".calendar-time").hide()),this.timePicker&&this.autoApply&&(this.autoApply=!1),this.autoApply&&"object"!=typeof t.ranges?this.container.find(".ranges").hide():this.autoApply&&this.container.find(".applyBtn, .cancelBtn").addClass("hide"),this.singleDatePicker&&(this.container.addClass("single"),this.container.find(".calendar.left").addClass("single"),this.container.find(".calendar.left").show(),this.container.find(".calendar.right").hide(),this.container.find(".daterangepicker_input input, .daterangepicker_input i").hide(),this.timePicker||this.container.find(".ranges").hide()),"undefined"!=typeof t.ranges||this.singleDatePicker||this.container.addClass("show-calendar"),this.container.addClass("opens"+this.opens),"undefined"!=typeof t.ranges&&"right"==this.opens){var p=this.container.find(".ranges"),m=p.clone();p.remove(),this.container.find(".calendar.left").parent().prepend(m)}this.container.find(".applyBtn, .cancelBtn").addClass(this.buttonClasses),this.applyClass.length&&this.container.find(".applyBtn").addClass(this.applyClass),this.cancelClass.length&&this.container.find(".cancelBtn").addClass(this.cancelClass),this.container.find(".applyBtn").html(this.locale.applyLabel),this.container.find(".cancelBtn").html(this.locale.cancelLabel),this.container.find(".calendar").on("click.daterangepicker",".prev",n.proxy(this.clickPrev,this)).on("click.daterangepicker",".next",n.proxy(this.clickNext,this)).on("click.daterangepicker","td.available",n.proxy(this.clickDate,this)).on("mouseenter.daterangepicker","td.available",n.proxy(this.hoverDate,this)).on("mouseleave.daterangepicker","td.available",n.proxy(this.updateFormInputs,this)).on("change.daterangepicker","select.yearselect",n.proxy(this.monthOrYearChanged,this)).on("change.daterangepicker","select.monthselect",n.proxy(this.monthOrYearChanged,this)).on("change.daterangepicker","select.hourselect,select.minuteselect,select.secondselect,select.ampmselect",n.proxy(this.timeChanged,this)).on("click.daterangepicker",".daterangepicker_input input",n.proxy(this.showCalendars,this)).on("change.daterangepicker",".daterangepicker_input input",n.proxy(this.formInputsChanged,this)),this.container.find(".ranges").on("click.daterangepicker","button.applyBtn",n.proxy(this.clickApply,this)).on("click.daterangepicker","button.cancelBtn",n.proxy(this.clickCancel,this)).on("click.daterangepicker","li",n.proxy(this.clickRange,this)).on("mouseenter.daterangepicker","li",n.proxy(this.hoverRange,this)).on("mouseleave.daterangepicker","li",n.proxy(this.updateFormInputs,this)),this.element.is("input")?this.element.on({"click.daterangepicker":n.proxy(this.show,this),"focus.daterangepicker":n.proxy(this.show,this),"keyup.daterangepicker":n.proxy(this.elementChanged,this),"keydown.daterangepicker":n.proxy(this.keydown,this)}):this.element.on("click.daterangepicker",n.proxy(this.toggle,this)),this.element.is("input")&&!this.singleDatePicker&&this.autoUpdateInput?(this.element.val(this.startDate.format(this.locale.format)+this.locale.separator+this.endDate.format(this.locale.format)),this.element.trigger("change")):this.element.is("input")&&this.autoUpdateInput&&(this.element.val(this.startDate.format(this.locale.format)),this.element.trigger("change"))};r.prototype={constructor:r,setStartDate:function(e){"string"==typeof e&&(this.startDate=i(e,this.locale.format)),"object"==typeof e&&(this.startDate=i(e)),this.timePicker||(this.startDate=this.startDate.startOf("day")),this.timePicker&&this.timePickerIncrement&&this.startDate.minute(Math.round(this.startDate.minute()/this.timePickerIncrement)*this.timePickerIncrement),this.minDate&&this.startDate.isBefore(this.minDate)&&(this.startDate=this.minDate),this.maxDate&&this.startDate.isAfter(this.maxDate)&&(this.startDate=this.maxDate),this.isShowing||this.updateElement(),this.updateMonthsInView()},setEndDate:function(e){"string"==typeof e&&(this.endDate=i(e,this.locale.format)),"object"==typeof e&&(this.endDate=i(e)),this.timePicker||(this.endDate=this.endDate.endOf("day")),this.timePicker&&this.timePickerIncrement&&this.endDate.minute(Math.round(this.endDate.minute()/this.timePickerIncrement)*this.timePickerIncrement),this.endDate.isBefore(this.startDate)&&(this.endDate=this.startDate.clone()),this.maxDate&&this.endDate.isAfter(this.maxDate)&&(this.endDate=this.maxDate),this.dateLimit&&this.startDate.clone().add(this.dateLimit).isBefore(this.endDate)&&(this.endDate=this.startDate.clone().add(this.dateLimit)),this.isShowing||this.updateElement(),this.updateMonthsInView()},isInvalidDate:function(){return!1},updateView:function(){this.timePicker&&(this.renderTimePicker("left"),this.renderTimePicker("right"),this.endDate?this.container.find(".right .calendar-time select").removeAttr("disabled").removeClass("disabled"):this.container.find(".right .calendar-time select").attr("disabled","disabled").addClass("disabled")),this.endDate?(this.container.find('input[name="daterangepicker_end"]').removeClass("active"),this.container.find('input[name="daterangepicker_start"]').addClass("active")):(this.container.find('input[name="daterangepicker_end"]').addClass("active"),this.container.find('input[name="daterangepicker_start"]').removeClass("active")),this.updateMonthsInView(),this.updateCalendars(),this.updateFormInputs()},updateMonthsInView:function(){if(this.endDate){if(!this.singleDatePicker&&this.leftCalendar.month&&this.rightCalendar.month&&(this.startDate.format("YYYY-MM")==this.leftCalendar.month.format("YYYY-MM")||this.startDate.format("YYYY-MM")==this.rightCalendar.month.format("YYYY-MM"))&&(this.endDate.format("YYYY-MM")==this.leftCalendar.month.format("YYYY-MM")||this.endDate.format("YYYY-MM")==this.rightCalendar.month.format("YYYY-MM")))return;this.leftCalendar.month=this.startDate.clone().date(2),this.linkedCalendars||this.endDate.month()==this.startDate.month()&&this.endDate.year()==this.startDate.year()?this.rightCalendar.month=this.startDate.clone().date(2).add(1,"month"):this.rightCalendar.month=this.endDate.clone().date(2)}else this.leftCalendar.month.format("YYYY-MM")!=this.startDate.format("YYYY-MM")&&this.rightCalendar.month.format("YYYY-MM")!=this.startDate.format("YYYY-MM")&&(this.leftCalendar.month=this.startDate.clone().date(2),this.rightCalendar.month=this.startDate.clone().date(2).add(1,"month"))},updateCalendars:function(){if(this.timePicker){var e,t,i;if(this.endDate){if(e=parseInt(this.container.find(".left .hourselect").val(),10),t=parseInt(this.container.find(".left .minuteselect").val(),10),i=this.timePickerSeconds?parseInt(this.container.find(".left .secondselect").val(),10):0,!this.timePicker24Hour){var n=this.container.find(".left .ampmselect").val();"PM"===n&&12>e&&(e+=12),"AM"===n&&12===e&&(e=0)}}else if(e=parseInt(this.container.find(".right .hourselect").val(),10),t=parseInt(this.container.find(".right .minuteselect").val(),10),i=this.timePickerSeconds?parseInt(this.container.find(".right .secondselect").val(),10):0,!this.timePicker24Hour){var n=this.container.find(".right .ampmselect").val();"PM"===n&&12>e&&(e+=12),"AM"===n&&12===e&&(e=0)}this.leftCalendar.month.hour(e).minute(t).second(i),this.rightCalendar.month.hour(e).minute(t).second(i)}if(this.renderCalendar("left"),this.renderCalendar("right"),this.container.find(".ranges li").removeClass("active"),null!=this.endDate){var r=!0,s=0;for(var a in this.ranges){if(this.timePicker){if(this.startDate.isSame(this.ranges[a][0])&&this.endDate.isSame(this.ranges[a][1])){r=!1,this.chosenLabel=this.container.find(".ranges li:eq("+s+")").addClass("active").html();break}}else if(this.startDate.format("YYYY-MM-DD")==this.ranges[a][0].format("YYYY-MM-DD")&&this.endDate.format("YYYY-MM-DD")==this.ranges[a][1].format("YYYY-MM-DD")){r=!1,this.chosenLabel=this.container.find(".ranges li:eq("+s+")").addClass("active").html();break}s++}r&&(this.chosenLabel=this.container.find(".ranges li:last").addClass("active").html(),this.showCalendars())}},renderCalendar:function(e){var t="left"==e?this.leftCalendar:this.rightCalendar,r=t.month.month(),s=t.month.year(),a=t.month.hour(),o=t.month.minute(),l=t.month.second(),c=i([s,r]).daysInMonth(),d=i([s,r,1]),h=i([s,r,c]),u=i(d).subtract(1,"month").month(),f=i(d).subtract(1,"month").year(),p=i([f,u]).daysInMonth(),m=d.day(),t=[];t.firstDay=d,t.lastDay=h;for(var g=0;6>g;g++)t[g]=[];var v=p-m+this.locale.firstDay+1;v>p&&(v-=7),m==this.locale.firstDay&&(v=p-6);for(var _,y,b=i([f,u,v,12,o,l]),g=0,_=0,y=0;42>g;g++,_++,b=i(b).add(24,"hour"))g>0&&_%7===0&&(_=0,y++),t[y][_]=b.clone().hour(a).minute(o).second(l),b.hour(12),this.minDate&&t[y][_].format("YYYY-MM-DD")==this.minDate.format("YYYY-MM-DD")&&t[y][_].isBefore(this.minDate)&&"left"==e&&(t[y][_]=this.minDate.clone()),this.maxDate&&t[y][_].format("YYYY-MM-DD")==this.maxDate.format("YYYY-MM-DD")&&t[y][_].isAfter(this.maxDate)&&"right"==e&&(t[y][_]=this.maxDate.clone());"left"==e?this.leftCalendar.calendar=t:this.rightCalendar.calendar=t;var x="left"==e?this.minDate:this.startDate,w=this.maxDate,k=("left"==e?this.startDate:this.endDate,'<table class="table-condensed">');k+="<thead>",k+="<tr>",this.showWeekNumbers&&(k+="<th></th>"),k+=x&&!x.isBefore(t.firstDay)||this.linkedCalendars&&"left"!=e?"<th></th>":'<th class="prev available"><i class="fa fa-angle-left"></i></th>';var C=this.locale.monthNames[t[1][1].month()]+t[1][1].format(" YYYY");if(this.showDropdowns){for(var D=t[1][1].month(),S=t[1][1].year(),j=w&&w.year()||S+5,T=x&&x.year()||S-50,M=S==T,L=S==j,E='<select class="monthselect">',O=0;12>O;O++)E+=(!M||O>=x.month())&&(!L||O<=w.month())?"<option value='"+O+"'"+(O===D?" selected='selected'":"")+">"+this.locale.monthNames[O]+"</option>":"<option value='"+O+"'"+(O===D?" selected='selected'":"")+" disabled='disabled'>"+this.locale.monthNames[O]+"</option>";
E+="</select>";for(var A='<select class="yearselect">',N=T;j>=N;N++)A+='<option value="'+N+'"'+(N===S?' selected="selected"':"")+">"+N+"</option>";A+="</select>",C=E+A}if(k+='<th colspan="5" class="month">'+C+"</th>",k+=w&&!w.isAfter(t.lastDay)||this.linkedCalendars&&"right"!=e&&!this.singleDatePicker?"<th></th>":'<th class="next available"><i class="fa fa-angle-right"></i></th>',k+="</tr>",k+="<tr>",this.showWeekNumbers&&(k+='<th class="week">'+this.locale.weekLabel+"</th>"),n.each(this.locale.daysOfWeek,function(e,t){k+="<th>"+t+"</th>"}),k+="</tr>",k+="</thead>",k+="<tbody>",null==this.endDate&&this.dateLimit){var F=this.startDate.clone().add(this.dateLimit).endOf("day");(!w||F.isBefore(w))&&(w=F)}for(var y=0;6>y;y++){k+="<tr>",this.showWeekNumbers&&(k+='<td class="week">'+t[y][0].week()+"</td>");for(var _=0;7>_;_++){var P=[];t[y][_].isSame(new Date,"day")&&P.push("today"),t[y][_].isoWeekday()>5&&P.push("weekend"),t[y][_].month()!=t[1][1].month()&&P.push("off"),this.minDate&&t[y][_].isBefore(this.minDate,"day")&&P.push("off","disabled"),w&&t[y][_].isAfter(w,"day")&&P.push("off","disabled"),this.isInvalidDate(t[y][_])&&P.push("off","disabled"),t[y][_].format("YYYY-MM-DD")==this.startDate.format("YYYY-MM-DD")&&P.push("active","start-date"),null!=this.endDate&&t[y][_].format("YYYY-MM-DD")==this.endDate.format("YYYY-MM-DD")&&P.push("active","end-date"),null!=this.endDate&&t[y][_]>this.startDate&&t[y][_]<this.endDate&&P.push("in-range");for(var I="",H=!1,g=0;g<P.length;g++)I+=P[g]+" ","disabled"==P[g]&&(H=!0);H||(I+="available"),k+='<td class="'+I.replace(/^\s+|\s+$/g,"")+'" data-title="r'+y+"c"+_+'">'+t[y][_].date()+"</td>"}k+="</tr>"}k+="</tbody>",k+="</table>",this.container.find(".calendar."+e+" .calendar-table").html(k)},renderTimePicker:function(e){var t,i,n,r=this.maxDate;!this.dateLimit||this.maxDate&&!this.startDate.clone().add(this.dateLimit).isAfter(this.maxDate)||(r=this.startDate.clone().add(this.dateLimit)),"left"==e?(i=this.startDate.clone(),n=this.minDate):"right"==e&&(i=this.endDate?this.endDate.clone():this.startDate.clone(),n=this.startDate),t='<select class="hourselect">';for(var s=this.timePicker24Hour?0:1,a=this.timePicker24Hour?23:12,o=s;a>=o;o++){var l=o;this.timePicker24Hour||(l=i.hour()>=12?12==o?12:o+12:12==o?0:o);var c=i.clone().hour(l),d=!1;n&&c.minute(59).isBefore(n)&&(d=!0),r&&c.minute(0).isAfter(r)&&(d=!0),t+=l!=i.hour()||d?d?'<option value="'+o+'" disabled="disabled" class="disabled">'+o+"</option>":'<option value="'+o+'">'+o+"</option>":'<option value="'+o+'" selected="selected">'+o+"</option>"}t+="</select> ",t+=': <select class="minuteselect">';for(var o=0;60>o;o+=this.timePickerIncrement){var h=10>o?"0"+o:o,c=i.clone().minute(o),d=!1;n&&c.second(59).isBefore(n)&&(d=!0),r&&c.second(0).isAfter(r)&&(d=!0),t+=i.minute()!=o||d?d?'<option value="'+o+'" disabled="disabled" class="disabled">'+h+"</option>":'<option value="'+o+'">'+h+"</option>":'<option value="'+o+'" selected="selected">'+h+"</option>"}if(t+="</select> ",this.timePickerSeconds){t+=': <select class="secondselect">';for(var o=0;60>o;o++){var h=10>o?"0"+o:o,c=i.clone().second(o),d=!1;n&&c.isBefore(n)&&(d=!0),r&&c.isAfter(r)&&(d=!0),t+=i.second()!=o||d?d?'<option value="'+o+'" disabled="disabled" class="disabled">'+h+"</option>":'<option value="'+o+'">'+h+"</option>":'<option value="'+o+'" selected="selected">'+h+"</option>"}t+="</select> "}if(!this.timePicker24Hour){t+='<select class="ampmselect">';var u="",f="";n&&i.clone().hour(12).minute(0).second(0).isBefore(n)&&(u=' disabled="disabled" class="disabled"'),r&&i.clone().hour(0).minute(0).second(0).isAfter(r)&&(f=' disabled="disabled" class="disabled"'),t+=i.hour()>=12?'<option value="AM"'+u+'>AM</option><option value="PM" selected="selected"'+f+">PM</option>":'<option value="AM" selected="selected"'+u+'>AM</option><option value="PM"'+f+">PM</option>",t+="</select>"}this.container.find(".calendar."+e+" .calendar-time div").html(t)},updateFormInputs:function(){this.container.find("input[name=daterangepicker_start]").is(":focus")||this.container.find("input[name=daterangepicker_end]").is(":focus")||(this.container.find("input[name=daterangepicker_start]").val(this.startDate.format(this.locale.format)),this.endDate&&this.container.find("input[name=daterangepicker_end]").val(this.endDate.format(this.locale.format)),this.singleDatePicker||this.endDate&&(this.startDate.isBefore(this.endDate)||this.startDate.isSame(this.endDate))?this.container.find("button.applyBtn").removeAttr("disabled"):this.container.find("button.applyBtn").attr("disabled","disabled"))},move:function(){var e,t={top:0,left:0},i=n(window).width();this.parentEl.is("body")||(t={top:this.parentEl.offset().top-this.parentEl.scrollTop(),left:this.parentEl.offset().left-this.parentEl.scrollLeft()},i=this.parentEl[0].clientWidth+this.parentEl.offset().left),e="up"==this.drops?this.element.offset().top-this.container.outerHeight()-t.top:this.element.offset().top+this.element.outerHeight()-t.top,this.container["up"==this.drops?"addClass":"removeClass"]("dropup"),"left"==this.opens?(this.container.css({top:e,right:i-this.element.offset().left-this.element.outerWidth(),left:"auto"}),this.container.offset().left<0&&this.container.css({right:"auto",left:9})):"center"==this.opens?(this.container.css({top:e,left:this.element.offset().left-t.left+this.element.outerWidth()/2-this.container.outerWidth()/2,right:"auto"}),this.container.offset().left<0&&this.container.css({right:"auto",left:9})):(this.container.css({top:e,left:this.element.offset().left-t.left,right:"auto"}),this.container.offset().left+this.container.outerWidth()>n(window).width()&&this.container.css({left:"auto",right:0}))},show:function(e){this.isShowing||(this._outsideClickProxy=n.proxy(function(e){this.outsideClick(e)},this),n(document).on("mousedown.daterangepicker",this._outsideClickProxy).on("touchend.daterangepicker",this._outsideClickProxy).on("click.daterangepicker","[data-toggle=dropdown]",this._outsideClickProxy).on("focusin.daterangepicker",this._outsideClickProxy),n(window).on("resize.daterangepicker",n.proxy(function(e){this.move(e)},this)),this.oldStartDate=this.startDate.clone(),this.oldEndDate=this.endDate.clone(),this.updateView(),this.container.show(),this.move(),this.element.trigger("show.daterangepicker",this),this.isShowing=!0)},hide:function(e){this.isShowing&&(this.endDate||(this.startDate=this.oldStartDate.clone(),this.endDate=this.oldEndDate.clone()),this.startDate.isSame(this.oldStartDate)&&this.endDate.isSame(this.oldEndDate)||this.callback(this.startDate,this.endDate,this.chosenLabel),this.updateElement(),n(document).off(".daterangepicker"),n(window).off(".daterangepicker"),this.container.hide(),this.element.trigger("hide.daterangepicker",this),this.isShowing=!1)},toggle:function(e){this.isShowing?this.hide():this.show()},outsideClick:function(e){var t=n(e.target);"focusin"==e.type||t.closest(this.element).length||t.closest(this.container).length||t.closest(".calendar-table").length||this.hide()},showCalendars:function(){this.container.addClass("show-calendar"),this.move(),this.element.trigger("showCalendar.daterangepicker",this)},hideCalendars:function(){this.container.removeClass("show-calendar"),this.element.trigger("hideCalendar.daterangepicker",this)},hoverRange:function(e){if(!this.container.find("input[name=daterangepicker_start]").is(":focus")&&!this.container.find("input[name=daterangepicker_end]").is(":focus")){var t=e.target.innerHTML;if(t==this.locale.customRangeLabel)this.updateView();else{var i=this.ranges[t];this.container.find("input[name=daterangepicker_start]").val(i[0].format(this.locale.format)),this.container.find("input[name=daterangepicker_end]").val(i[1].format(this.locale.format))}}},clickRange:function(e){var t=e.target.innerHTML;if(this.chosenLabel=t,t==this.locale.customRangeLabel)this.showCalendars();else{var i=this.ranges[t];this.startDate=i[0],this.endDate=i[1],this.timePicker||(this.startDate.startOf("day"),this.endDate.endOf("day")),this.hideCalendars(),this.clickApply()}},clickPrev:function(e){var t=n(e.target).parents(".calendar");t.hasClass("left")?(this.leftCalendar.month.subtract(1,"month"),this.linkedCalendars&&this.rightCalendar.month.subtract(1,"month")):this.rightCalendar.month.subtract(1,"month"),this.updateCalendars()},clickNext:function(e){var t=n(e.target).parents(".calendar");t.hasClass("left")?this.leftCalendar.month.add(1,"month"):(this.rightCalendar.month.add(1,"month"),this.linkedCalendars&&this.leftCalendar.month.add(1,"month")),this.updateCalendars()},hoverDate:function(e){if(!this.container.find("input[name=daterangepicker_start]").is(":focus")&&!this.container.find("input[name=daterangepicker_end]").is(":focus")&&n(e.target).hasClass("available")){var t=n(e.target).attr("data-title"),i=t.substr(1,1),r=t.substr(3,1),s=n(e.target).parents(".calendar"),a=s.hasClass("left")?this.leftCalendar.calendar[i][r]:this.rightCalendar.calendar[i][r];this.endDate?this.container.find("input[name=daterangepicker_start]").val(a.format(this.locale.format)):this.container.find("input[name=daterangepicker_end]").val(a.format(this.locale.format));var o=this.leftCalendar,l=this.rightCalendar,c=this.startDate;this.endDate||this.container.find(".calendar td").each(function(e,t){if(!n(t).hasClass("week")){var i=n(t).attr("data-title"),r=i.substr(1,1),s=i.substr(3,1),d=n(t).parents(".calendar"),h=d.hasClass("left")?o.calendar[r][s]:l.calendar[r][s];h.isAfter(c)&&h.isBefore(a)?n(t).addClass("in-range"):n(t).removeClass("in-range")}})}},clickDate:function(e){if(n(e.target).hasClass("available")){var t=n(e.target).attr("data-title"),i=t.substr(1,1),r=t.substr(3,1),s=n(e.target).parents(".calendar"),a=s.hasClass("left")?this.leftCalendar.calendar[i][r]:this.rightCalendar.calendar[i][r];if(this.endDate||a.isBefore(this.startDate)){if(this.timePicker){var o=parseInt(this.container.find(".left .hourselect").val(),10);if(!this.timePicker24Hour){var l=s.find(".ampmselect").val();"PM"===l&&12>o&&(o+=12),"AM"===l&&12===o&&(o=0)}var c=parseInt(this.container.find(".left .minuteselect").val(),10),d=this.timePickerSeconds?parseInt(this.container.find(".left .secondselect").val(),10):0;a=a.clone().hour(o).minute(c).second(d)}this.endDate=null,this.setStartDate(a.clone())}else{if(this.timePicker){var o=parseInt(this.container.find(".right .hourselect").val(),10);if(!this.timePicker24Hour){var l=this.container.find(".right .ampmselect").val();"PM"===l&&12>o&&(o+=12),"AM"===l&&12===o&&(o=0)}var c=parseInt(this.container.find(".right .minuteselect").val(),10),d=this.timePickerSeconds?parseInt(this.container.find(".right .secondselect").val(),10):0;a=a.clone().hour(o).minute(c).second(d)}this.setEndDate(a.clone()),this.autoApply&&this.clickApply()}this.singleDatePicker&&(this.setEndDate(this.startDate),this.timePicker||this.clickApply()),this.updateView()}},clickApply:function(e){this.hide(),this.element.trigger("apply.daterangepicker",this)},clickCancel:function(e){this.startDate=this.oldStartDate,this.endDate=this.oldEndDate,this.hide(),this.element.trigger("cancel.daterangepicker",this)},monthOrYearChanged:function(e){var t=n(e.target).closest(".calendar").hasClass("left"),i=t?"left":"right",r=this.container.find(".calendar."+i),s=parseInt(r.find(".monthselect").val(),10),a=r.find(".yearselect").val();t||(a<this.startDate.year()||a==this.startDate.year()&&s<this.startDate.month())&&(s=this.startDate.month(),a=this.startDate.year()),this.minDate&&(a<this.minDate.year()||a==this.minDate.year()&&s<this.minDate.month())&&(s=this.minDate.month(),a=this.minDate.year()),this.maxDate&&(a>this.maxDate.year()||a==this.maxDate.year()&&s>this.maxDate.month())&&(s=this.maxDate.month(),a=this.maxDate.year()),t?(this.leftCalendar.month.month(s).year(a),this.linkedCalendars&&(this.rightCalendar.month=this.leftCalendar.month.clone().add(1,"month"))):(this.rightCalendar.month.month(s).year(a),this.linkedCalendars&&(this.leftCalendar.month=this.rightCalendar.month.clone().subtract(1,"month"))),this.updateCalendars()},timeChanged:function(e){var t=n(e.target).closest(".calendar"),i=t.hasClass("left"),r=parseInt(t.find(".hourselect").val(),10),s=parseInt(t.find(".minuteselect").val(),10),a=this.timePickerSeconds?parseInt(t.find(".secondselect").val(),10):0;if(!this.timePicker24Hour){var o=t.find(".ampmselect").val();"PM"===o&&12>r&&(r+=12),"AM"===o&&12===r&&(r=0)}if(i){var l=this.startDate.clone();l.hour(r),l.minute(s),l.second(a),this.setStartDate(l),this.singleDatePicker?this.endDate=this.startDate.clone():this.endDate&&this.endDate.format("YYYY-MM-DD")==l.format("YYYY-MM-DD")&&this.endDate.isBefore(l)&&this.setEndDate(l.clone())}else if(this.endDate){var c=this.endDate.clone();c.hour(r),c.minute(s),c.second(a),this.setEndDate(c)}this.updateCalendars(),this.updateFormInputs(),this.renderTimePicker("left"),this.renderTimePicker("right")},formInputsChanged:function(e){var t=n(e.target).closest(".calendar").hasClass("right"),r=i(this.container.find('input[name="daterangepicker_start"]').val(),this.locale.format),s=i(this.container.find('input[name="daterangepicker_end"]').val(),this.locale.format);r.isValid()&&s.isValid()&&(t&&s.isBefore(r)&&(r=s.clone()),this.setStartDate(r),this.setEndDate(s),t?this.container.find('input[name="daterangepicker_start"]').val(this.startDate.format(this.locale.format)):this.container.find('input[name="daterangepicker_end"]').val(this.endDate.format(this.locale.format))),this.updateCalendars(),this.timePicker&&(this.renderTimePicker("left"),this.renderTimePicker("right"))},elementChanged:function(){if(this.element.is("input")&&this.element.val().length&&!(this.element.val().length<this.locale.format.length)){var e=this.element.val().split(this.locale.separator),t=null,n=null;2===e.length&&(t=i(e[0],this.locale.format),n=i(e[1],this.locale.format)),(this.singleDatePicker||null===t||null===n)&&(t=i(this.element.val(),this.locale.format),n=t),t.isValid()&&n.isValid()&&(this.setStartDate(t),this.setEndDate(n),this.updateView())}},keydown:function(e){(9===e.keyCode||13===e.keyCode)&&this.hide()},updateElement:function(){this.element.is("input")&&!this.singleDatePicker&&this.autoUpdateInput?(this.element.val(this.startDate.format(this.locale.format)+this.locale.separator+this.endDate.format(this.locale.format)),this.element.trigger("change")):this.element.is("input")&&this.autoUpdateInput&&(this.element.val(this.startDate.format(this.locale.format)),this.element.trigger("change"))},remove:function(){this.container.remove(),this.element.off(".daterangepicker"),this.element.removeData()}},n.fn.daterangepicker=function(e,t){return this.each(function(){var i=n(this);i.data("daterangepicker")&&i.data("daterangepicker").remove(),i.data("daterangepicker",new r(i,e,t))}),this}}),!function(e){var t=function(e){this.value={h:1,s:1,b:1,a:1},this.setColor(e)};t.prototype={constructor:t,setColor:function(t){t=t.toLowerCase();var i=this;e.each(n.stringParsers,function(e,r){var s=r.re.exec(t),a=s&&r.parse(s),o=r.space||"rgba";if(a)return"hsla"===o?i.value=n.RGBtoHSB.apply(null,n.HSLtoRGB.apply(null,a)):i.value=n.RGBtoHSB.apply(null,a),!1})},setHue:function(e){this.value.h=1-e},setSaturation:function(e){this.value.s=e},setLightness:function(e){this.value.b=1-e},setAlpha:function(e){this.value.a=parseInt(100*(1-e),10)/100},toRGB:function(e,t,i,n){e||(e=this.value.h,t=this.value.s,i=this.value.b),e*=360;var r,s,a,o,l;return e=e%360/60,l=i*t,o=l*(1-Math.abs(e%2-1)),r=s=a=i-l,e=~~e,r+=[l,o,0,0,o,l][e],s+=[o,l,l,o,0,0][e],a+=[0,0,o,l,l,o][e],{r:Math.round(255*r),g:Math.round(255*s),b:Math.round(255*a),a:n||this.value.a}},toHex:function(e,t,i,n){var r=this.toRGB(e,t,i,n);return"#"+(1<<24|parseInt(r.r)<<16|parseInt(r.g)<<8|parseInt(r.b)).toString(16).substr(1)},toHSL:function(e,t,i,n){e||(e=this.value.h,t=this.value.s,i=this.value.b);var r=e,s=(2-t)*i,a=t*i;return a/=s>0&&s<=1?s:2-s,s/=2,a>1&&(a=1),{h:r,s:a,l:s,a:n||this.value.a}}};var i=function(t,i){this.element=e(t);var r=i.format||this.element.data("color-format")||"hex";this.format=n.translateFormats[r],this.isInput=this.element.is("input"),this.component=!!this.element.is(".color")&&this.element.find(".input-group-btn"),this.picker=e(n.template).appendTo("body").on("mousedown",e.proxy(this.mousedown,this)),this.isInput?this.element.on({focus:e.proxy(this.show,this),keyup:e.proxy(this.update,this)}):this.component?this.component.on({click:e.proxy(this.show,this)}):this.element.on({click:e.proxy(this.show,this)}),"rgba"!==r&&"hsla"!==r||(this.picker.addClass("alpha"),this.alpha=this.picker.find(".colorpicker-alpha")[0].style),this.component?(this.picker.find(".colorpicker-color").hide(),this.preview=this.element.find("i")[0].style):this.preview=this.picker.find("div:last")[0].style,this.base=this.picker.find("div:first")[0].style,this.update()};i.prototype={constructor:i,show:function(t){this.picker.show(),this.height=this.component?this.component.outerHeight():this.element.outerHeight(),this.place(),e(window).on("resize",e.proxy(this.place,this)),this.isInput||t&&(t.stopPropagation(),t.preventDefault()),e(document).on({mousedown:e.proxy(this.hide,this)}),this.element.trigger({type:"show",color:this.color})},update:function(){this.color=new t(this.isInput?this.element.prop("value"):this.element.data("color")),this.picker.find("i").eq(0).css({left:100*this.color.value.s,top:100-100*this.color.value.b}).end().eq(1).css("top",100*(1-this.color.value.h)).end().eq(2).css("top",100*(1-this.color.value.a)),this.previewColor()},setValue:function(e){this.color=new t(e),this.picker.find("i").eq(0).css({left:100*this.color.value.s,top:100-100*this.color.value.b}).end().eq(1).css("top",100*(1-this.color.value.h)).end().eq(2).css("top",100*(1-this.color.value.a)),this.previewColor(),this.element.trigger({type:"changeColor",color:this.color})},hide:function(){this.picker.hide(),e(window).off("resize",this.place),this.isInput?this.element.prop("value",this.format.call(this)):(e(document).off({mousedown:this.hide}),this.component&&this.element.find("input").prop("value",this.format.call(this)),this.element.data("color",this.format.call(this))),this.element.trigger({type:"hide",color:this.color})},place:function(){var e=this.component?this.component.offset():this.element.offset();this.picker.css({top:e.top+this.height,left:e.left})},previewColor:function(){try{this.preview.backgroundColor=this.format.call(this)}catch(e){this.preview.backgroundColor=this.color.toHex()}this.base.backgroundColor=this.color.toHex(this.color.value.h,1,1,1),this.alpha&&(this.alpha.backgroundColor=this.color.toHex())},pointer:null,slider:null,mousedown:function(t){t.stopPropagation(),t.preventDefault();var i=e(t.target),r=i.closest("div");if(!r.is(".colorpicker")){if(r.is(".colorpicker-saturation"))this.slider=e.extend({},n.sliders.saturation);else if(r.is(".colorpicker-hue"))this.slider=e.extend({},n.sliders.hue);else{if(!r.is(".colorpicker-alpha"))return!1;this.slider=e.extend({},n.sliders.alpha)}var s=r.offset();this.slider.knob=r.find("i")[0].style,this.slider.left=t.pageX-s.left,this.slider.top=t.pageY-s.top,this.pointer={left:t.pageX,top:t.pageY},e(document).on({mousemove:e.proxy(this.mousemove,this),mouseup:e.proxy(this.mouseup,this)}).trigger("mousemove")}return!1},mousemove:function(e){e.stopPropagation(),e.preventDefault();var t=Math.max(0,Math.min(this.slider.maxLeft,this.slider.left+((e.pageX||this.pointer.left)-this.pointer.left))),i=Math.max(0,Math.min(this.slider.maxTop,this.slider.top+((e.pageY||this.pointer.top)-this.pointer.top)));return this.slider.knob.left=t+"px",this.slider.knob.top=i+"px",this.slider.callLeft&&this.color[this.slider.callLeft].call(this.color,t/100),this.slider.callTop&&this.color[this.slider.callTop].call(this.color,i/100),this.previewColor(),this.element.trigger({type:"changeColor",color:this.color}),!1},mouseup:function(t){return t.stopPropagation(),t.preventDefault(),e(document).off({mousemove:this.mousemove,mouseup:this.mouseup}),!1}},e.fn.colorpicker=function(t,n){return this.each(function(){var r=e(this),s=r.data("colorpicker"),a="object"==typeof t&&t;s||r.data("colorpicker",s=new i(this,e.extend({},e.fn.colorpicker.defaults,a))),"string"==typeof t&&s[t](n)})},e.fn.colorpicker.defaults={},e.fn.colorpicker.Constructor=i;var n={translateFormats:{rgb:function(){var e=this.color.toRGB();return"rgb("+e.r+","+e.g+","+e.b+")"},rgba:function(){var e=this.color.toRGB();return"rgba("+e.r+","+e.g+","+e.b+","+e.a+")"},hsl:function(){var e=this.color.toHSL();return"hsl("+Math.round(360*e.h)+","+Math.round(100*e.s)+"%,"+Math.round(100*e.l)+"%)"},hsla:function(){var e=this.color.toHSL();return"hsla("+Math.round(360*e.h)+","+Math.round(100*e.s)+"%,"+Math.round(100*e.l)+"%,"+e.a+")"},hex:function(){return this.color.toHex()}},sliders:{saturation:{maxLeft:100,maxTop:100,callLeft:"setSaturation",callTop:"setLightness"},hue:{maxLeft:0,maxTop:100,callLeft:!1,callTop:"setHue"},alpha:{maxLeft:0,maxTop:100,callLeft:!1,callTop:"setAlpha"}},RGBtoHSB:function(e,t,i,n){e/=255,t/=255,i/=255;var r,s,a,o;return a=Math.max(e,t,i),o=a-Math.min(e,t,i),r=0===o?null:a==e?(t-i)/o:a==t?(i-e)/o+2:(e-t)/o+4,r=(r+360)%6*60/360,s=0===o?0:o/a,{h:r||1,s:s,b:a,a:n||1}},HueToRGB:function(e,t,i){return i<0?i+=1:i>1&&(i-=1),6*i<1?e+(t-e)*i*6:2*i<1?t:3*i<2?e+(t-e)*(2/3-i)*6:e},HSLtoRGB:function(e,t,i,r){t<0&&(t=0);var s;s=i<=.5?i*(1+t):i+t-i*t;var a=2*i-s,o=e+1/3,l=e,c=e-1/3,d=Math.round(255*n.HueToRGB(a,s,o)),h=Math.round(255*n.HueToRGB(a,s,l)),u=Math.round(255*n.HueToRGB(a,s,c));return[d,h,u,r||1]},stringParsers:[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1],e[2],e[3],e[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(e){return[2.55*e[1],2.55*e[2],2.55*e[3],e[4]]}},{re:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/,parse:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/,parse:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(e){return[e[1]/360,e[2]/100,e[3]/100,e[4]]}}],template:'<div class="colorpicker dropdown-menu"><div class="colorpicker-saturation"><i><b></b></i></div><div class="colorpicker-hue"><i></i></div><div class="colorpicker-alpha"><i></i></div><div class="colorpicker-color"><div /></div></div>'}}(window.jQuery),function(){var e,t,i,n,r,s,a,o,l=[].slice,c={}.hasOwnProperty,d=function(e,t){function i(){this.constructor=e}for(var n in t)c.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};a=function(){},t=function(){function e(){}return e.prototype.addEventListener=e.prototype.on,e.prototype.on=function(e,t){return this._callbacks=this._callbacks||{},this._callbacks[e]||(this._callbacks[e]=[]),this._callbacks[e].push(t),this},e.prototype.emit=function(){var e,t,i,n,r,s;if(n=arguments[0],e=2<=arguments.length?l.call(arguments,1):[],this._callbacks=this._callbacks||{},i=this._callbacks[n])for(r=0,s=i.length;s>r;r++)t=i[r],t.apply(this,e);return this},e.prototype.removeListener=e.prototype.off,e.prototype.removeAllListeners=e.prototype.off,e.prototype.removeEventListener=e.prototype.off,e.prototype.off=function(e,t){var i,n,r,s,a;if(!this._callbacks||0===arguments.length)return this._callbacks={},this;if(n=this._callbacks[e],!n)return this;if(1===arguments.length)return delete this._callbacks[e],this;for(r=s=0,a=n.length;a>s;r=++s)if(i=n[r],i===t){n.splice(r,1);break}return this},e}(),e=function(e){function i(e,t){var r,s,a;if(this.element=e,this.version=i.version,this.defaultOptions.previewTemplate=this.defaultOptions.previewTemplate.replace(/\n*/g,""),this.clickableElements=[],this.listeners=[],this.files=[],"string"==typeof this.element&&(this.element=document.querySelector(this.element)),!this.element||null==this.element.nodeType)throw new Error("Invalid dropzone element.");if(this.element.dropzone)throw new Error("Dropzone already attached.");if(i.instances.push(this),this.element.dropzone=this,r=null!=(a=i.optionsForElement(this.element))?a:{},this.options=n({},this.defaultOptions,r,null!=t?t:{}),this.options.forceFallback||!i.isBrowserSupported())return this.options.fallback.call(this);if(null==this.options.url&&(this.options.url=this.element.getAttribute("action")),!this.options.url)throw new Error("No URL provided.");if(this.options.acceptedFiles&&this.options.acceptedMimeTypes)throw new Error("You can't provide both 'acceptedFiles' and 'acceptedMimeTypes'. 'acceptedMimeTypes' is deprecated.");this.options.acceptedMimeTypes&&(this.options.acceptedFiles=this.options.acceptedMimeTypes,delete this.options.acceptedMimeTypes),this.options.method=this.options.method.toUpperCase(),(s=this.getExistingFallback())&&s.parentNode&&s.parentNode.removeChild(s),this.options.previewsContainer!==!1&&(this.previewsContainer=this.options.previewsContainer?i.getElement(this.options.previewsContainer,"previewsContainer"):this.element),this.options.clickable&&(this.clickableElements=this.options.clickable===!0?[this.element]:i.getElements(this.options.clickable,"clickable")),this.init()}var n,r;return d(i,e),i.prototype.Emitter=t,i.prototype.events=["drop","dragstart","dragend","dragenter","dragover","dragleave","addedfile","removedfile","thumbnail","error","errormultiple","processing","processingmultiple","uploadprogress","totaluploadprogress","sending","sendingmultiple","success","successmultiple","canceled","canceledmultiple","complete","completemultiple","reset","maxfilesexceeded","maxfilesreached","queuecomplete"],i.prototype.defaultOptions={url:null,method:"post",withCredentials:!1,parallelUploads:2,uploadMultiple:!1,maxFilesize:256,paramName:"file",createImageThumbnails:!0,maxThumbnailFilesize:10,thumbnailWidth:120,thumbnailHeight:120,filesizeBase:1e3,maxFiles:null,filesizeBase:1e3,params:{},clickable:!0,ignoreHiddenFiles:!0,acceptedFiles:null,acceptedMimeTypes:null,autoProcessQueue:!0,autoQueue:!0,addRemoveLinks:!1,previewsContainer:null,capture:null,dictDefaultMessage:"Drop files here to upload",dictFallbackMessage:"Your browser does not support drag'n'drop file uploads.",dictFallbackText:"Please use the fallback form below to upload your files like in the olden days.",dictFileTooBig:"File is too big ({{filesize}}MiB). Max filesize: {{maxFilesize}}MiB.",dictInvalidFileType:"You can't upload files of this type.",dictResponseError:"Server responded with {{statusCode}} code.",dictCancelUpload:"Cancel upload",dictCancelUploadConfirmation:"Are you sure you want to cancel this upload?",dictRemoveFile:"Remove file",dictRemoveFileConfirmation:null,dictMaxFilesExceeded:"You can not upload any more files.",accept:function(e,t){return t()},init:function(){return a},forceFallback:!1,fallback:function(){var e,t,n,r,s,a;for(this.element.className=""+this.element.className+" dz-browser-not-supported",a=this.element.getElementsByTagName("div"),r=0,s=a.length;s>r;r++)e=a[r],/(^| )dz-message($| )/.test(e.className)&&(t=e,e.className="dz-message");return t||(t=i.createElement('<div class="dz-message"><span></span></div>'),this.element.appendChild(t)),n=t.getElementsByTagName("span")[0],n&&(n.textContent=this.options.dictFallbackMessage),this.element.appendChild(this.getFallbackForm())},resize:function(e){var t,i,n;return t={srcX:0,srcY:0,srcWidth:e.width,srcHeight:e.height},i=e.width/e.height,t.optWidth=this.options.thumbnailWidth,t.optHeight=this.options.thumbnailHeight,null==t.optWidth&&null==t.optHeight?(t.optWidth=t.srcWidth,t.optHeight=t.srcHeight):null==t.optWidth?t.optWidth=i*t.optHeight:null==t.optHeight&&(t.optHeight=1/i*t.optWidth),n=t.optWidth/t.optHeight,e.height<t.optHeight||e.width<t.optWidth?(t.trgHeight=t.srcHeight,t.trgWidth=t.srcWidth):i>n?(t.srcHeight=e.height,t.srcWidth=t.srcHeight*n):(t.srcWidth=e.width,t.srcHeight=t.srcWidth/n),t.srcX=(e.width-t.srcWidth)/2,t.srcY=(e.height-t.srcHeight)/2,t},drop:function(){return this.element.classList.remove("dz-drag-hover")},dragstart:a,dragend:function(){return this.element.classList.remove("dz-drag-hover")},dragenter:function(){return this.element.classList.add("dz-drag-hover")},dragover:function(){return this.element.classList.add("dz-drag-hover")},dragleave:function(){return this.element.classList.remove("dz-drag-hover")},paste:a,reset:function(){return this.element.classList.remove("dz-started")},addedfile:function(e){var t,n,r,s,a,o,l,c,d,h,u,f,p;if(this.element===this.previewsContainer&&this.element.classList.add("dz-started"),this.previewsContainer){for(e.previewElement=i.createElement(this.options.previewTemplate.trim()),e.previewTemplate=e.previewElement,this.previewsContainer.appendChild(e.previewElement),h=e.previewElement.querySelectorAll("[data-dz-name]"),s=0,l=h.length;l>s;s++)t=h[s],t.textContent=e.name;for(u=e.previewElement.querySelectorAll("[data-dz-size]"),a=0,c=u.length;c>a;a++)t=u[a],t.innerHTML=this.filesize(e.size);for(this.options.addRemoveLinks&&(e._removeLink=i.createElement('<a class="dz-remove" href="javascript:undefined;" data-dz-remove>'+this.options.dictRemoveFile+"</a>"),e.previewElement.appendChild(e._removeLink)),n=function(t){return function(n){return n.preventDefault(),n.stopPropagation(),e.status===i.UPLOADING?i.confirm(t.options.dictCancelUploadConfirmation,function(){return t.removeFile(e)}):t.options.dictRemoveFileConfirmation?i.confirm(t.options.dictRemoveFileConfirmation,function(){return t.removeFile(e)}):t.removeFile(e)}}(this),f=e.previewElement.querySelectorAll("[data-dz-remove]"),p=[],o=0,d=f.length;d>o;o++)r=f[o],p.push(r.addEventListener("click",n));return p}},removedfile:function(e){var t;return e.previewElement&&null!=(t=e.previewElement)&&t.parentNode.removeChild(e.previewElement),this._updateMaxFilesReachedClass()},thumbnail:function(e,t){var i,n,r,s;if(e.previewElement){for(e.previewElement.classList.remove("dz-file-preview"),s=e.previewElement.querySelectorAll("[data-dz-thumbnail]"),n=0,r=s.length;r>n;n++)i=s[n],i.alt=e.name,i.src=t;return setTimeout(function(){return function(){return e.previewElement.classList.add("dz-image-preview")}}(this),1)}},error:function(e,t){var i,n,r,s,a;if(e.previewElement){for(e.previewElement.classList.add("dz-error"),"String"!=typeof t&&t.error&&(t=t.error),s=e.previewElement.querySelectorAll("[data-dz-errormessage]"),a=[],n=0,r=s.length;r>n;n++)i=s[n],a.push(i.textContent=t);return a}},errormultiple:a,processing:function(e){return e.previewElement&&(e.previewElement.classList.add("dz-processing"),e._removeLink)?e._removeLink.textContent=this.options.dictCancelUpload:void 0},processingmultiple:a,uploadprogress:function(e,t){var i,n,r,s,a;if(e.previewElement){for(s=e.previewElement.querySelectorAll("[data-dz-uploadprogress]"),a=[],n=0,r=s.length;r>n;n++)i=s[n],a.push("PROGRESS"===i.nodeName?i.value=t:i.style.width=""+t+"%");return a}},totaluploadprogress:a,sending:a,sendingmultiple:a,success:function(e){return e.previewElement?e.previewElement.classList.add("dz-success"):void 0},successmultiple:a,canceled:function(e){return this.emit("error",e,"Upload canceled.")},canceledmultiple:a,complete:function(e){return e._removeLink&&(e._removeLink.textContent=this.options.dictRemoveFile),e.previewElement?e.previewElement.classList.add("dz-complete"):void 0},completemultiple:a,maxfilesexceeded:a,maxfilesreached:a,queuecomplete:a,previewTemplate:'<div class="dz-preview dz-file-preview">\n  <div class="dz-image"><img data-dz-thumbnail /></div>\n  <div class="dz-details">\n    <div class="dz-size"><span data-dz-size></span></div>\n    <div class="dz-filename"><span data-dz-name></span></div>\n  </div>\n  <div class="dz-progress"><span class="dz-upload" data-dz-uploadprogress></span></div>\n  <div class="dz-error-message"><span data-dz-errormessage></span></div>\n  <div class="dz-success-mark">\n    <svg width="54px" height="54px" viewBox="0 0 54 54" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">\n      <title>Check</title>\n      <defs></defs>\n      <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage">\n        <path d="M23.5,31.8431458 L17.5852419,25.9283877 C16.0248253,24.3679711 13.4910294,24.366835 11.9289322,25.9289322 C10.3700136,27.4878508 10.3665912,30.0234455 11.9283877,31.5852419 L20.4147581,40.0716123 C20.5133999,40.1702541 20.6159315,40.2626649 20.7218615,40.3488435 C22.2835669,41.8725651 24.794234,41.8626202 26.3461564,40.3106978 L43.3106978,23.3461564 C44.8771021,21.7797521 44.8758057,19.2483887 43.3137085,17.6862915 C41.7547899,16.1273729 39.2176035,16.1255422 37.6538436,17.6893022 L23.5,31.8431458 Z M27,53 C41.3594035,53 53,41.3594035 53,27 C53,12.6405965 41.3594035,1 27,1 C12.6405965,1 1,12.6405965 1,27 C1,41.3594035 12.6405965,53 27,53 Z" id="Oval-2" stroke-opacity="0.198794158" stroke="#747474" fill-opacity="0.816519475" fill="#FFFFFF" sketch:type="MSShapeGroup"></path>\n      </g>\n    </svg>\n  </div>\n  <div class="dz-error-mark">\n    <svg width="54px" height="54px" viewBox="0 0 54 54" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">\n      <title>Error</title>\n      <defs></defs>\n      <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage">\n        <g id="Check-+-Oval-2" sketch:type="MSLayerGroup" stroke="#747474" stroke-opacity="0.198794158" fill="#FFFFFF" fill-opacity="0.816519475">\n          <path d="M32.6568542,29 L38.3106978,23.3461564 C39.8771021,21.7797521 39.8758057,19.2483887 38.3137085,17.6862915 C36.7547899,16.1273729 34.2176035,16.1255422 32.6538436,17.6893022 L27,23.3431458 L21.3461564,17.6893022 C19.7823965,16.1255422 17.2452101,16.1273729 15.6862915,17.6862915 C14.1241943,19.2483887 14.1228979,21.7797521 15.6893022,23.3461564 L21.3431458,29 L15.6893022,34.6538436 C14.1228979,36.2202479 14.1241943,38.7516113 15.6862915,40.3137085 C17.2452101,41.8726271 19.7823965,41.8744578 21.3461564,40.3106978 L27,34.6568542 L32.6538436,40.3106978 C34.2176035,41.8744578 36.7547899,41.8726271 38.3137085,40.3137085 C39.8758057,38.7516113 39.8771021,36.2202479 38.3106978,34.6538436 L32.6568542,29 Z M27,53 C41.3594035,53 53,41.3594035 53,27 C53,12.6405965 41.3594035,1 27,1 C12.6405965,1 1,12.6405965 1,27 C1,41.3594035 12.6405965,53 27,53 Z" id="Oval-2" sketch:type="MSShapeGroup"></path>\n        </g>\n      </g>\n    </svg>\n  </div>\n</div>'
},n=function(){var e,t,i,n,r,s,a;for(n=arguments[0],i=2<=arguments.length?l.call(arguments,1):[],s=0,a=i.length;a>s;s++){t=i[s];for(e in t)r=t[e],n[e]=r}return n},i.prototype.getAcceptedFiles=function(){var e,t,i,n,r;for(n=this.files,r=[],t=0,i=n.length;i>t;t++)e=n[t],e.accepted&&r.push(e);return r},i.prototype.getRejectedFiles=function(){var e,t,i,n,r;for(n=this.files,r=[],t=0,i=n.length;i>t;t++)e=n[t],e.accepted||r.push(e);return r},i.prototype.getFilesWithStatus=function(e){var t,i,n,r,s;for(r=this.files,s=[],i=0,n=r.length;n>i;i++)t=r[i],t.status===e&&s.push(t);return s},i.prototype.getQueuedFiles=function(){return this.getFilesWithStatus(i.QUEUED)},i.prototype.getUploadingFiles=function(){return this.getFilesWithStatus(i.UPLOADING)},i.prototype.getActiveFiles=function(){var e,t,n,r,s;for(r=this.files,s=[],t=0,n=r.length;n>t;t++)e=r[t],(e.status===i.UPLOADING||e.status===i.QUEUED)&&s.push(e);return s},i.prototype.init=function(){var e,t,n,r,s,a,o;for("form"===this.element.tagName&&this.element.setAttribute("enctype","multipart/form-data"),this.element.classList.contains("dropzone")&&!this.element.querySelector(".dz-message")&&this.element.appendChild(i.createElement('<div class="dz-default dz-message"><span>'+this.options.dictDefaultMessage+"</span></div>")),this.clickableElements.length&&(n=function(e){return function(){return e.hiddenFileInput&&document.body.removeChild(e.hiddenFileInput),e.hiddenFileInput=document.createElement("input"),e.hiddenFileInput.setAttribute("type","file"),(null==e.options.maxFiles||e.options.maxFiles>1)&&e.hiddenFileInput.setAttribute("multiple","multiple"),e.hiddenFileInput.className="dz-hidden-input",null!=e.options.acceptedFiles&&e.hiddenFileInput.setAttribute("accept",e.options.acceptedFiles),null!=e.options.capture&&e.hiddenFileInput.setAttribute("capture",e.options.capture),e.hiddenFileInput.style.visibility="hidden",e.hiddenFileInput.style.position="absolute",e.hiddenFileInput.style.top="0",e.hiddenFileInput.style.left="0",e.hiddenFileInput.style.height="0",e.hiddenFileInput.style.width="0",document.body.appendChild(e.hiddenFileInput),e.hiddenFileInput.addEventListener("change",function(){var t,i,r,s;if(i=e.hiddenFileInput.files,i.length)for(r=0,s=i.length;s>r;r++)t=i[r],e.addFile(t);return n()})}}(this))(),this.URL=null!=(a=window.URL)?a:window.webkitURL,o=this.events,r=0,s=o.length;s>r;r++)e=o[r],this.on(e,this.options[e]);return this.on("uploadprogress",function(e){return function(){return e.updateTotalUploadProgress()}}(this)),this.on("removedfile",function(e){return function(){return e.updateTotalUploadProgress()}}(this)),this.on("canceled",function(e){return function(t){return e.emit("complete",t)}}(this)),this.on("complete",function(e){return function(){return 0===e.getUploadingFiles().length&&0===e.getQueuedFiles().length?setTimeout(function(){return e.emit("queuecomplete")},0):void 0}}(this)),t=function(e){return e.stopPropagation(),e.preventDefault?e.preventDefault():e.returnValue=!1},this.listeners=[{element:this.element,events:{dragstart:function(e){return function(t){return e.emit("dragstart",t)}}(this),dragenter:function(e){return function(i){return t(i),e.emit("dragenter",i)}}(this),dragover:function(e){return function(i){var n;try{n=i.dataTransfer.effectAllowed}catch(r){}return i.dataTransfer.dropEffect="move"===n||"linkMove"===n?"move":"copy",t(i),e.emit("dragover",i)}}(this),dragleave:function(e){return function(t){return e.emit("dragleave",t)}}(this),drop:function(e){return function(i){return t(i),e.drop(i)}}(this),dragend:function(e){return function(t){return e.emit("dragend",t)}}(this)}}],this.clickableElements.forEach(function(e){return function(t){return e.listeners.push({element:t,events:{click:function(n){return t!==e.element||n.target===e.element||i.elementInside(n.target,e.element.querySelector(".dz-message"))?e.hiddenFileInput.click():void 0}}})}}(this)),this.enable(),this.options.init.call(this)},i.prototype.destroy=function(){var e;return this.disable(),this.removeAllFiles(!0),(null!=(e=this.hiddenFileInput)?e.parentNode:void 0)&&(this.hiddenFileInput.parentNode.removeChild(this.hiddenFileInput),this.hiddenFileInput=null),delete this.element.dropzone,i.instances.splice(i.instances.indexOf(this),1)},i.prototype.updateTotalUploadProgress=function(){var e,t,i,n,r,s,a,o;if(n=0,i=0,e=this.getActiveFiles(),e.length){for(o=this.getActiveFiles(),s=0,a=o.length;a>s;s++)t=o[s],n+=t.upload.bytesSent,i+=t.upload.total;r=100*n/i}else r=100;return this.emit("totaluploadprogress",r,i,n)},i.prototype._getParamName=function(e){return"function"==typeof this.options.paramName?this.options.paramName(e):""+this.options.paramName+(this.options.uploadMultiple?"["+e+"]":"")},i.prototype.getFallbackForm=function(){var e,t,n,r;return(e=this.getExistingFallback())?e:(n='<div class="dz-fallback">',this.options.dictFallbackText&&(n+="<p>"+this.options.dictFallbackText+"</p>"),n+='<input type="file" name="'+this._getParamName(0)+'" '+(this.options.uploadMultiple?'multiple="multiple"':void 0)+' /><input type="submit" value="Upload!"></div>',t=i.createElement(n),"FORM"!==this.element.tagName?(r=i.createElement('<form action="'+this.options.url+'" enctype="multipart/form-data" method="'+this.options.method+'"></form>'),r.appendChild(t)):(this.element.setAttribute("enctype","multipart/form-data"),this.element.setAttribute("method",this.options.method)),null!=r?r:t)},i.prototype.getExistingFallback=function(){var e,t,i,n,r,s;for(t=function(e){var t,i,n;for(i=0,n=e.length;n>i;i++)if(t=e[i],/(^| )fallback($| )/.test(t.className))return t},s=["div","form"],n=0,r=s.length;r>n;n++)if(i=s[n],e=t(this.element.getElementsByTagName(i)))return e},i.prototype.setupEventListeners=function(){var e,t,i,n,r,s,a;for(s=this.listeners,a=[],n=0,r=s.length;r>n;n++)e=s[n],a.push(function(){var n,r;n=e.events,r=[];for(t in n)i=n[t],r.push(e.element.addEventListener(t,i,!1));return r}());return a},i.prototype.removeEventListeners=function(){var e,t,i,n,r,s,a;for(s=this.listeners,a=[],n=0,r=s.length;r>n;n++)e=s[n],a.push(function(){var n,r;n=e.events,r=[];for(t in n)i=n[t],r.push(e.element.removeEventListener(t,i,!1));return r}());return a},i.prototype.disable=function(){var e,t,i,n,r;for(this.clickableElements.forEach(function(e){return e.classList.remove("dz-clickable")}),this.removeEventListeners(),n=this.files,r=[],t=0,i=n.length;i>t;t++)e=n[t],r.push(this.cancelUpload(e));return r},i.prototype.enable=function(){return this.clickableElements.forEach(function(e){return e.classList.add("dz-clickable")}),this.setupEventListeners()},i.prototype.filesize=function(e){var t,i,n,r,s,a,o,l;for(a=["TB","GB","MB","KB","b"],n=r=null,i=o=0,l=a.length;l>o;i=++o)if(s=a[i],t=Math.pow(this.options.filesizeBase,4-i)/10,e>=t){n=e/Math.pow(this.options.filesizeBase,4-i),r=s;break}return n=Math.round(10*n)/10,"<strong>"+n+"</strong> "+r},i.prototype._updateMaxFilesReachedClass=function(){return null!=this.options.maxFiles&&this.getAcceptedFiles().length>=this.options.maxFiles?(this.getAcceptedFiles().length===this.options.maxFiles&&this.emit("maxfilesreached",this.files),this.element.classList.add("dz-max-files-reached")):this.element.classList.remove("dz-max-files-reached")},i.prototype.drop=function(e){var t,i;e.dataTransfer&&(this.emit("drop",e),t=e.dataTransfer.files,t.length&&(i=e.dataTransfer.items,i&&i.length&&null!=i[0].webkitGetAsEntry?this._addFilesFromItems(i):this.handleFiles(t)))},i.prototype.paste=function(e){var t,i;if(null!=(null!=e&&null!=(i=e.clipboardData)?i.items:void 0))return this.emit("paste",e),t=e.clipboardData.items,t.length?this._addFilesFromItems(t):void 0},i.prototype.handleFiles=function(e){var t,i,n,r;for(r=[],i=0,n=e.length;n>i;i++)t=e[i],r.push(this.addFile(t));return r},i.prototype._addFilesFromItems=function(e){var t,i,n,r,s;for(s=[],n=0,r=e.length;r>n;n++)i=e[n],s.push(null!=i.webkitGetAsEntry&&(t=i.webkitGetAsEntry())?t.isFile?this.addFile(i.getAsFile()):t.isDirectory?this._addFilesFromDirectory(t,t.name):void 0:null!=i.getAsFile&&(null==i.kind||"file"===i.kind)?this.addFile(i.getAsFile()):void 0);return s},i.prototype._addFilesFromDirectory=function(e,t){var i,n;return i=e.createReader(),n=function(e){return function(i){var n,r,s;for(r=0,s=i.length;s>r;r++)n=i[r],n.isFile?n.file(function(i){return e.options.ignoreHiddenFiles&&"."===i.name.substring(0,1)?void 0:(i.fullPath=""+t+"/"+i.name,e.addFile(i))}):n.isDirectory&&e._addFilesFromDirectory(n,""+t+"/"+n.name)}}(this),i.readEntries(n,function(e){return"undefined"!=typeof console&&null!==console&&"function"==typeof console.log?console.log(e):void 0})},i.prototype.accept=function(e,t){return e.size>1024*this.options.maxFilesize*1024?t(this.options.dictFileTooBig.replace("{{filesize}}",Math.round(e.size/1024/10.24)/100).replace("{{maxFilesize}}",this.options.maxFilesize)):i.isValidFile(e,this.options.acceptedFiles)?null!=this.options.maxFiles&&this.getAcceptedFiles().length>=this.options.maxFiles?(t(this.options.dictMaxFilesExceeded.replace("{{maxFiles}}",this.options.maxFiles)),this.emit("maxfilesexceeded",e)):this.options.accept.call(this,e,t):t(this.options.dictInvalidFileType)},i.prototype.addFile=function(e){return e.upload={progress:0,total:e.size,bytesSent:0},this.files.push(e),e.status=i.ADDED,this.emit("addedfile",e),this._enqueueThumbnail(e),this.accept(e,function(t){return function(i){return i?(e.accepted=!1,t._errorProcessing([e],i)):(e.accepted=!0,t.options.autoQueue&&t.enqueueFile(e)),t._updateMaxFilesReachedClass()}}(this))},i.prototype.enqueueFiles=function(e){var t,i,n;for(i=0,n=e.length;n>i;i++)t=e[i],this.enqueueFile(t);return null},i.prototype.enqueueFile=function(e){if(e.status!==i.ADDED||e.accepted!==!0)throw new Error("This file can't be queued because it has already been processed or was rejected.");return e.status=i.QUEUED,this.options.autoProcessQueue?setTimeout(function(e){return function(){return e.processQueue()}}(this),0):void 0},i.prototype._thumbnailQueue=[],i.prototype._processingThumbnail=!1,i.prototype._enqueueThumbnail=function(e){return this.options.createImageThumbnails&&e.type.match(/image.*/)&&e.size<=1024*this.options.maxThumbnailFilesize*1024?(this._thumbnailQueue.push(e),setTimeout(function(e){return function(){return e._processThumbnailQueue()}}(this),0)):void 0},i.prototype._processThumbnailQueue=function(){return this._processingThumbnail||0===this._thumbnailQueue.length?void 0:(this._processingThumbnail=!0,this.createThumbnail(this._thumbnailQueue.shift(),function(e){return function(){return e._processingThumbnail=!1,e._processThumbnailQueue()}}(this)))},i.prototype.removeFile=function(e){return e.status===i.UPLOADING&&this.cancelUpload(e),this.files=o(this.files,e),this.emit("removedfile",e),0===this.files.length?this.emit("reset"):void 0},i.prototype.removeAllFiles=function(e){var t,n,r,s;for(null==e&&(e=!1),s=this.files.slice(),n=0,r=s.length;r>n;n++)t=s[n],(t.status!==i.UPLOADING||e)&&this.removeFile(t);return null},i.prototype.createThumbnail=function(e,t){var i;return i=new FileReader,i.onload=function(n){return function(){var r;return"image/svg+xml"===e.type?(n.emit("thumbnail",e,i.result),void(null!=t&&t())):(r=document.createElement("img"),r.onload=function(){var i,a,o,l,c,d,h,u;return e.width=r.width,e.height=r.height,o=n.options.resize.call(n,e),null==o.trgWidth&&(o.trgWidth=o.optWidth),null==o.trgHeight&&(o.trgHeight=o.optHeight),i=document.createElement("canvas"),a=i.getContext("2d"),i.width=o.trgWidth,i.height=o.trgHeight,s(a,r,null!=(c=o.srcX)?c:0,null!=(d=o.srcY)?d:0,o.srcWidth,o.srcHeight,null!=(h=o.trgX)?h:0,null!=(u=o.trgY)?u:0,o.trgWidth,o.trgHeight),l=i.toDataURL("image/png"),n.emit("thumbnail",e,l),null!=t?t():void 0},r.onerror=t,r.src=i.result)}}(this),i.readAsDataURL(e)},i.prototype.processQueue=function(){var e,t,i,n;if(t=this.options.parallelUploads,i=this.getUploadingFiles().length,e=i,!(i>=t)&&(n=this.getQueuedFiles(),n.length>0)){if(this.options.uploadMultiple)return this.processFiles(n.slice(0,t-i));for(;t>e;){if(!n.length)return;this.processFile(n.shift()),e++}}},i.prototype.processFile=function(e){return this.processFiles([e])},i.prototype.processFiles=function(e){var t,n,r;for(n=0,r=e.length;r>n;n++)t=e[n],t.processing=!0,t.status=i.UPLOADING,this.emit("processing",t);return this.options.uploadMultiple&&this.emit("processingmultiple",e),this.uploadFiles(e)},i.prototype._getFilesWithXhr=function(e){var t,i;return i=function(){var i,n,r,s;for(r=this.files,s=[],i=0,n=r.length;n>i;i++)t=r[i],t.xhr===e&&s.push(t);return s}.call(this)},i.prototype.cancelUpload=function(e){var t,n,r,s,a,o,l;if(e.status===i.UPLOADING){for(n=this._getFilesWithXhr(e.xhr),r=0,a=n.length;a>r;r++)t=n[r],t.status=i.CANCELED;for(e.xhr.abort(),s=0,o=n.length;o>s;s++)t=n[s],this.emit("canceled",t);this.options.uploadMultiple&&this.emit("canceledmultiple",n)}else((l=e.status)===i.ADDED||l===i.QUEUED)&&(e.status=i.CANCELED,this.emit("canceled",e),this.options.uploadMultiple&&this.emit("canceledmultiple",[e]));return this.options.autoProcessQueue?this.processQueue():void 0},r=function(){var e,t;return t=arguments[0],e=2<=arguments.length?l.call(arguments,1):[],"function"==typeof t?t.apply(this,e):t},i.prototype.uploadFile=function(e){return this.uploadFiles([e])},i.prototype.uploadFiles=function(e){var t,s,a,o,l,c,d,h,u,f,p,m,g,v,_,y,b,x,w,k,C,D,S,j,T,M,L,E,O,A,N,F,P,I;for(w=new XMLHttpRequest,k=0,j=e.length;j>k;k++)t=e[k],t.xhr=w;m=r(this.options.method,e),b=r(this.options.url,e),w.open(m,b,!0),w.withCredentials=!!this.options.withCredentials,_=null,a=function(i){return function(){var n,r,s;for(s=[],n=0,r=e.length;r>n;n++)t=e[n],s.push(i._errorProcessing(e,_||i.options.dictResponseError.replace("{{statusCode}}",w.status),w));return s}}(this),y=function(i){return function(n){var r,s,a,o,l,c,d,h,u;if(null!=n)for(s=100*n.loaded/n.total,a=0,c=e.length;c>a;a++)t=e[a],t.upload={progress:s,total:n.total,bytesSent:n.loaded};else{for(r=!0,s=100,o=0,d=e.length;d>o;o++)t=e[o],(100!==t.upload.progress||t.upload.bytesSent!==t.upload.total)&&(r=!1),t.upload.progress=s,t.upload.bytesSent=t.upload.total;if(r)return}for(u=[],l=0,h=e.length;h>l;l++)t=e[l],u.push(i.emit("uploadprogress",t,s,t.upload.bytesSent));return u}}(this),w.onload=function(t){return function(n){var r;if(e[0].status!==i.CANCELED&&4===w.readyState){if(_=w.responseText,w.getResponseHeader("content-type")&&~w.getResponseHeader("content-type").indexOf("application/json"))try{_=JSON.parse(_)}catch(s){n=s,_="Invalid JSON response from server."}return y(),200<=(r=w.status)&&300>r?t._finished(e,_,n):a()}}}(this),w.onerror=function(){return function(){return e[0].status!==i.CANCELED?a():void 0}}(this),v=null!=(O=w.upload)?O:w,v.onprogress=y,c={Accept:"application/json","Cache-Control":"no-cache","X-Requested-With":"XMLHttpRequest"},this.options.headers&&n(c,this.options.headers);for(o in c)l=c[o],w.setRequestHeader(o,l);if(s=new FormData,this.options.params){A=this.options.params;for(p in A)x=A[p],s.append(p,x)}for(C=0,T=e.length;T>C;C++)t=e[C],this.emit("sending",t,w,s);if(this.options.uploadMultiple&&this.emit("sendingmultiple",e,w,s),"FORM"===this.element.tagName)for(N=this.element.querySelectorAll("input, textarea, select, button"),D=0,M=N.length;M>D;D++)if(h=N[D],u=h.getAttribute("name"),f=h.getAttribute("type"),"SELECT"===h.tagName&&h.hasAttribute("multiple"))for(F=h.options,S=0,L=F.length;L>S;S++)g=F[S],g.selected&&s.append(u,g.value);else(!f||"checkbox"!==(P=f.toLowerCase())&&"radio"!==P||h.checked)&&s.append(u,h.value);for(d=E=0,I=e.length-1;I>=0?I>=E:E>=I;d=I>=0?++E:--E)s.append(this._getParamName(d),e[d],e[d].name);return w.send(s)},i.prototype._finished=function(e,t,n){var r,s,a;for(s=0,a=e.length;a>s;s++)r=e[s],r.status=i.SUCCESS,this.emit("success",r,t,n),this.emit("complete",r);return this.options.uploadMultiple&&(this.emit("successmultiple",e,t,n),this.emit("completemultiple",e)),this.options.autoProcessQueue?this.processQueue():void 0},i.prototype._errorProcessing=function(e,t,n){var r,s,a;for(s=0,a=e.length;a>s;s++)r=e[s],r.status=i.ERROR,this.emit("error",r,t,n),this.emit("complete",r);return this.options.uploadMultiple&&(this.emit("errormultiple",e,t,n),this.emit("completemultiple",e)),this.options.autoProcessQueue?this.processQueue():void 0},i}(t),e.version="4.0.1",e.options={},e.optionsForElement=function(t){return t.getAttribute("id")?e.options[i(t.getAttribute("id"))]:void 0},e.instances=[],e.forElement=function(e){if("string"==typeof e&&(e=document.querySelector(e)),null==(null!=e?e.dropzone:void 0))throw new Error("No Dropzone found for given element. This is probably because you're trying to access it before Dropzone had the time to initialize. Use the `init` option to setup any additional observers on your Dropzone.");return e.dropzone},e.autoDiscover=!0,e.discover=function(){var t,i,n,r,s,a;for(document.querySelectorAll?n=document.querySelectorAll(".dropzone"):(n=[],t=function(e){var t,i,r,s;for(s=[],i=0,r=e.length;r>i;i++)t=e[i],s.push(/(^| )dropzone($| )/.test(t.className)?n.push(t):void 0);return s},t(document.getElementsByTagName("div")),t(document.getElementsByTagName("form"))),a=[],r=0,s=n.length;s>r;r++)i=n[r],a.push(e.optionsForElement(i)!==!1?new e(i):void 0);return a},e.blacklistedBrowsers=[/opera.*Macintosh.*version\/12/i],e.isBrowserSupported=function(){var t,i,n,r,s;if(t=!0,window.File&&window.FileReader&&window.FileList&&window.Blob&&window.FormData&&document.querySelector)if("classList"in document.createElement("a"))for(s=e.blacklistedBrowsers,n=0,r=s.length;r>n;n++)i=s[n],i.test(navigator.userAgent)&&(t=!1);else t=!1;else t=!1;return t},o=function(e,t){var i,n,r,s;for(s=[],n=0,r=e.length;r>n;n++)i=e[n],i!==t&&s.push(i);return s},i=function(e){return e.replace(/[\-_](\w)/g,function(e){return e.charAt(1).toUpperCase()})},e.createElement=function(e){var t;return t=document.createElement("div"),t.innerHTML=e,t.childNodes[0]},e.elementInside=function(e,t){if(e===t)return!0;for(;e=e.parentNode;)if(e===t)return!0;return!1},e.getElement=function(e,t){var i;if("string"==typeof e?i=document.querySelector(e):null!=e.nodeType&&(i=e),null==i)throw new Error("Invalid `"+t+"` option provided. Please provide a CSS selector or a plain HTML element.");return i},e.getElements=function(e,t){var i,n,r,s,a,o,l,c;if(e instanceof Array){r=[];try{for(s=0,o=e.length;o>s;s++)n=e[s],r.push(this.getElement(n,t))}catch(d){i=d,r=null}}else if("string"==typeof e)for(r=[],c=document.querySelectorAll(e),a=0,l=c.length;l>a;a++)n=c[a],r.push(n);else null!=e.nodeType&&(r=[e]);if(null==r||!r.length)throw new Error("Invalid `"+t+"` option provided. Please provide a CSS selector, a plain HTML element or a list of those.");return r},e.confirm=function(e,t,i){return window.confirm(e)?t():null!=i?i():void 0},e.isValidFile=function(e,t){var i,n,r,s,a;if(!t)return!0;for(t=t.split(","),n=e.type,i=n.replace(/\/.*$/,""),s=0,a=t.length;a>s;s++)if(r=t[s],r=r.trim(),"."===r.charAt(0)){if(-1!==e.name.toLowerCase().indexOf(r.toLowerCase(),e.name.length-r.length))return!0}else if(/\/\*$/.test(r)){if(i===r.replace(/\/.*$/,""))return!0}else if(n===r)return!0;return!1},"undefined"!=typeof jQuery&&null!==jQuery&&(jQuery.fn.dropzone=function(t){return this.each(function(){return new e(this,t)})}),"undefined"!=typeof module&&null!==module?module.exports=e:window.Dropzone=e,e.ADDED="added",e.QUEUED="queued",e.ACCEPTED=e.QUEUED,e.UPLOADING="uploading",e.PROCESSING=e.UPLOADING,e.CANCELED="canceled",e.ERROR="error",e.SUCCESS="success",r=function(e){var t,i,n,r,s,a,o,l,c,d;for(o=e.naturalWidth,a=e.naturalHeight,i=document.createElement("canvas"),i.width=1,i.height=a,n=i.getContext("2d"),n.drawImage(e,0,0),r=n.getImageData(0,0,1,a).data,d=0,s=a,l=a;l>d;)t=r[4*(l-1)+3],0===t?s=l:d=l,l=s+d>>1;return c=l/a,0===c?1:c},s=function(e,t,i,n,s,a,o,l,c,d){var h;return h=r(t),e.drawImage(t,i,n,s,a,o,l,c,d/h)},n=function(e,t){var i,n,r,s,a,o,l,c,d;if(r=!1,d=!0,n=e.document,c=n.documentElement,i=n.addEventListener?"addEventListener":"attachEvent",l=n.addEventListener?"removeEventListener":"detachEvent",o=n.addEventListener?"":"on",s=function(i){return"readystatechange"!==i.type||"complete"===n.readyState?(("load"===i.type?e:n)[l](o+i.type,s,!1),!r&&(r=!0)?t.call(e,i.type||i):void 0):void 0},a=function(){var e;try{c.doScroll("left")}catch(t){return e=t,void setTimeout(a,50)}return s("poll")},"complete"!==n.readyState){if(n.createEventObject&&c.doScroll){try{d=!e.frameElement}catch(h){}d&&a()}return n[i](o+"DOMContentLoaded",s,!1),n[i](o+"readystatechange",s,!1),e[i](o+"load",s,!1)}},e._autoDiscoverFunction=function(){return e.autoDiscover?e.discover():void 0},n(window,e._autoDiscoverFunction)}.call(this),"undefined"==typeof jQuery)throw new Error("Jasny Bootstrap's JavaScript requires jQuery");+function(e){"use strict";function t(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var i in t)if(void 0!==e.style[i])return{end:t[i]};return!1}void 0===e.support.transition&&(e.fn.emulateTransitionEnd=function(t){var i=!1,n=this;e(this).one(e.support.transition.end,function(){i=!0});var r=function(){i||e(n).trigger(e.support.transition.end)};return setTimeout(r,t),this},e(function(){e.support.transition=t()}))}(window.jQuery),+function(e){"use strict";var t=function(i,n){this.$element=e(i),this.options=e.extend({},t.DEFAULTS,n),this.state=null,this.placement=null,this.options.recalc&&(this.calcClone(),e(window).on("resize",e.proxy(this.recalc,this))),this.options.autohide&&e(document).on("click",e.proxy(this.autohide,this)),this.options.toggle&&this.toggle(),this.options.disablescrolling&&(this.options.disableScrolling=this.options.disablescrolling,delete this.options.disablescrolling)};t.DEFAULTS={toggle:!0,placement:"auto",autohide:!0,recalc:!0,disableScrolling:!0},t.prototype.offset=function(){switch(this.placement){case"left":case"right":return this.$element.outerWidth();case"top":case"bottom":return this.$element.outerHeight()}},t.prototype.calcPlacement=function(){function t(e,t){if("auto"===r.css(t))return e;if("auto"===r.css(e))return t;var i=parseInt(r.css(e),10),n=parseInt(r.css(t),10);return i>n?t:e}if("auto"!==this.options.placement)return void(this.placement=this.options.placement);this.$element.hasClass("in")||this.$element.css("visiblity","hidden !important").addClass("in");var i=e(window).width()/this.$element.width(),n=e(window).height()/this.$element.height(),r=this.$element;this.placement=i>=n?t("left","right"):t("top","bottom"),"hidden !important"===this.$element.css("visibility")&&this.$element.removeClass("in").css("visiblity","")},t.prototype.opposite=function(e){switch(e){case"top":return"bottom";case"left":return"right";case"bottom":return"top";case"right":return"left"}},t.prototype.getCanvasElements=function(){var t=this.options.canvas?e(this.options.canvas):this.$element,i=t.find("*").filter(function(){return"fixed"===e(this).css("position")}).not(this.options.exclude);return t.add(i)},t.prototype.slide=function(t,i,n){if(!e.support.transition){var r={};return r[this.placement]="+="+i,t.animate(r,350,n)}var s=this.placement,a=this.opposite(s);t.each(function(){"auto"!==e(this).css(s)&&e(this).css(s,(parseInt(e(this).css(s),10)||0)+i),"auto"!==e(this).css(a)&&e(this).css(a,(parseInt(e(this).css(a),10)||0)-i)}),this.$element.one(e.support.transition.end,n).emulateTransitionEnd(350)},t.prototype.disableScrolling=function(){var t=e("body").width(),i="padding-"+this.opposite(this.placement);if(void 0===e("body").data("offcanvas-style")&&e("body").data("offcanvas-style",e("body").attr("style")||""),e("body").css("overflow","hidden"),e("body").width()>t){var n=parseInt(e("body").css(i),10)+e("body").width()-t;setTimeout(function(){e("body").css(i,n)},1)}},t.prototype.show=function(){if(!this.state){var t=e.Event("show.bs.offcanvas");if(this.$element.trigger(t),!t.isDefaultPrevented()){this.state="slide-in",this.calcPlacement();var i=this.getCanvasElements(),n=this.placement,r=this.opposite(n),s=this.offset();i.index(this.$element)!==-1&&(e(this.$element).data("offcanvas-style",e(this.$element).attr("style")||""),this.$element.css(n,-1*s),this.$element.css(n)),i.addClass("canvas-sliding").each(function(){void 0===e(this).data("offcanvas-style")&&e(this).data("offcanvas-style",e(this).attr("style")||""),"static"===e(this).css("position")&&e(this).css("position","relative"),"auto"!==e(this).css(n)&&"0px"!==e(this).css(n)||"auto"!==e(this).css(r)&&"0px"!==e(this).css(r)||e(this).css(n,0)}),this.options.disableScrolling&&this.disableScrolling();var a=function(){"slide-in"==this.state&&(this.state="slid",i.removeClass("canvas-sliding").addClass("canvas-slid"),this.$element.trigger("shown.bs.offcanvas"))};setTimeout(e.proxy(function(){this.$element.addClass("in"),this.slide(i,s,e.proxy(a,this))},this),1)}}},t.prototype.hide=function(t){if("slid"===this.state){var i=e.Event("hide.bs.offcanvas");if(this.$element.trigger(i),!i.isDefaultPrevented()){this.state="slide-out";var n=e(".canvas-slid"),r=(this.placement,-1*this.offset()),s=function(){"slide-out"==this.state&&(this.state=null,this.placement=null,this.$element.removeClass("in"),n.removeClass("canvas-sliding"),n.add(this.$element).add("body").each(function(){e(this).attr("style",e(this).data("offcanvas-style")).removeData("offcanvas-style")}),this.$element.trigger("hidden.bs.offcanvas"))};n.removeClass("canvas-slid").addClass("canvas-sliding"),setTimeout(e.proxy(function(){this.slide(n,r,e.proxy(s,this))},this),1)}}},t.prototype.toggle=function(){"slide-in"!==this.state&&"slide-out"!==this.state&&this["slid"===this.state?"hide":"show"]()},t.prototype.calcClone=function(){this.$calcClone=this.$element.clone().html("").addClass("offcanvas-clone").removeClass("in").appendTo(e("body"))},t.prototype.recalc=function(){if("none"!==this.$calcClone.css("display")&&("slid"===this.state||"slide-in"===this.state)){this.state=null,this.placement=null;var t=this.getCanvasElements();this.$element.removeClass("in"),t.removeClass("canvas-slid"),t.add(this.$element).add("body").each(function(){e(this).attr("style",e(this).data("offcanvas-style")).removeData("offcanvas-style")})}},t.prototype.autohide=function(t){0===e(t.target).closest(this.$element).length&&this.hide()};var i=e.fn.offcanvas;e.fn.offcanvas=function(i){return this.each(function(){var n=e(this),r=n.data("bs.offcanvas"),s=e.extend({},t.DEFAULTS,n.data(),"object"==typeof i&&i);r||n.data("bs.offcanvas",r=new t(this,s)),"string"==typeof i&&r[i]()})},e.fn.offcanvas.Constructor=t,e.fn.offcanvas.noConflict=function(){return e.fn.offcanvas=i,this},e(document).on("click.bs.offcanvas.data-api","[data-toggle=offcanvas]",function(t){var i,n=e(this),r=n.attr("data-target")||t.preventDefault()||(i=n.attr("href"))&&i.replace(/.*(?=#[^\s]+$)/,""),s=e(r),a=s.data("bs.offcanvas"),o=a?"toggle":n.data();t.stopPropagation(),a?a.toggle():s.offcanvas(o)})}(window.jQuery),+function(e){"use strict";var t=function(i,n){this.$element=e(i),this.options=e.extend({},t.DEFAULTS,n),this.$element.on("click.bs.rowlink","td:not(.rowlink-skip)",e.proxy(this.click,this))};t.DEFAULTS={target:"a"},t.prototype.click=function(t){var i=e(t.currentTarget).closest("tr").find(this.options.target)[0];if(e(t.target)[0]!==i)if(t.preventDefault(),i.click)i.click();else if(document.createEvent){var n=document.createEvent("MouseEvents");n.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),i.dispatchEvent(n)}};var i=e.fn.rowlink;e.fn.rowlink=function(i){return this.each(function(){var n=e(this),r=n.data("bs.rowlink");r||n.data("bs.rowlink",r=new t(this,i))})},e.fn.rowlink.Constructor=t,e.fn.rowlink.noConflict=function(){return e.fn.rowlink=i,this},e(document).on("click.bs.rowlink.data-api",'[data-link="row"]',function(t){if(0===e(t.target).closest(".rowlink-skip").length){var i=e(this);i.data("bs.rowlink")||(i.rowlink(i.data()),e(t.target).trigger("click.bs.rowlink"))}})}(window.jQuery),+function(e){"use strict";var t=void 0!==window.orientation,i=navigator.userAgent.toLowerCase().indexOf("android")>-1,n="Microsoft Internet Explorer"==window.navigator.appName,r=function(t,n){i||(this.$element=e(t),this.options=e.extend({},r.DEFAULTS,n),this.mask=String(this.options.mask),this.init(),this.listen(),this.checkVal())};r.DEFAULTS={mask:"",placeholder:"_",definitions:{9:"[0-9]",a:"[A-Za-z]",w:"[A-Za-z0-9]","*":"."}},r.prototype.init=function(){var t=this.options.definitions,i=this.mask.length;this.tests=[],this.partialPosition=this.mask.length,this.firstNonMaskPos=null,e.each(this.mask.split(""),e.proxy(function(e,n){"?"==n?(i--,this.partialPosition=e):t[n]?(this.tests.push(new RegExp(t[n])),null===this.firstNonMaskPos&&(this.firstNonMaskPos=this.tests.length-1)):this.tests.push(null)},this)),this.buffer=e.map(this.mask.split(""),e.proxy(function(e,i){if("?"!=e)return t[e]?this.options.placeholder:e},this)),this.focusText=this.$element.val(),this.$element.data("rawMaskFn",e.proxy(function(){return e.map(this.buffer,function(e,t){return this.tests[t]&&e!=this.options.placeholder?e:null}).join("")},this))},r.prototype.listen=function(){if(!this.$element.attr("readonly")){var t=(n?"paste":"input")+".mask";this.$element.on("unmask.bs.inputmask",e.proxy(this.unmask,this)).on("focus.bs.inputmask",e.proxy(this.focusEvent,this)).on("blur.bs.inputmask",e.proxy(this.blurEvent,this)).on("keydown.bs.inputmask",e.proxy(this.keydownEvent,this)).on("keypress.bs.inputmask",e.proxy(this.keypressEvent,this)).on(t,e.proxy(this.pasteEvent,this))}},r.prototype.caret=function(e,t){if(0!==this.$element.length){if("number"==typeof e)return t="number"==typeof t?t:e,this.$element.each(function(){if(this.setSelectionRange)this.setSelectionRange(e,t);else if(this.createTextRange){var i=this.createTextRange();i.collapse(!0),i.moveEnd("character",t),i.moveStart("character",e),i.select()}});if(this.$element[0].setSelectionRange)e=this.$element[0].selectionStart,t=this.$element[0].selectionEnd;else if(document.selection&&document.selection.createRange){var i=document.selection.createRange();e=0-i.duplicate().moveStart("character",-1e5),t=e+i.text.length}return{begin:e,end:t}}},r.prototype.seekNext=function(e){for(var t=this.mask.length;++e<=t&&!this.tests[e];);return e},r.prototype.seekPrev=function(e){for(;--e>=0&&!this.tests[e];);return e},r.prototype.shiftL=function(e,t){var i=this.mask.length;if(!(e<0)){for(var n=e,r=this.seekNext(t);n<i;n++)if(this.tests[n]){if(!(r<i&&this.tests[n].test(this.buffer[r])))break;this.buffer[n]=this.buffer[r],this.buffer[r]=this.options.placeholder,r=this.seekNext(r)}this.writeBuffer(),this.caret(Math.max(this.firstNonMaskPos,e))}},r.prototype.shiftR=function(e){for(var t=this.mask.length,i=e,n=this.options.placeholder;i<t;i++)if(this.tests[i]){var r=this.seekNext(i),s=this.buffer[i];if(this.buffer[i]=n,!(r<t&&this.tests[r].test(s)))break;n=s}},r.prototype.unmask=function(){this.$element.unbind(".mask").removeData("inputmask")},r.prototype.focusEvent=function(){this.focusText=this.$element.val();var e=this.mask.length,t=this.checkVal();this.writeBuffer();var i=this,n=function(){t==e?i.caret(0,t):i.caret(t)};n(),setTimeout(n,50)},r.prototype.blurEvent=function(){this.checkVal(),this.$element.val()!==this.focusText&&this.$element.trigger("change")},r.prototype.keydownEvent=function(e){var i=e.which;if(8==i||46==i||t&&127==i){var n=this.caret(),r=n.begin,s=n.end;return s-r===0&&(r=46!=i?this.seekPrev(r):s=this.seekNext(r-1),s=46==i?this.seekNext(s):s),this.clearBuffer(r,s),this.shiftL(r,s-1),!1}if(27==i)return this.$element.val(this.focusText),this.caret(0,this.checkVal()),!1},r.prototype.keypressEvent=function(e){var t=this.mask.length,i=e.which,n=this.caret();if(e.ctrlKey||e.altKey||e.metaKey||i<32)return!0;if(i){n.end-n.begin!==0&&(this.clearBuffer(n.begin,n.end),this.shiftL(n.begin,n.end-1));var r=this.seekNext(n.begin-1);if(r<t){var s=String.fromCharCode(i);if(this.tests[r].test(s)){this.shiftR(r),this.buffer[r]=s,this.writeBuffer();var a=this.seekNext(r);
this.caret(a)}}return!1}},r.prototype.pasteEvent=function(){var e=this;setTimeout(function(){e.caret(e.checkVal(!0))},0)},r.prototype.clearBuffer=function(e,t){for(var i=this.mask.length,n=e;n<t&&n<i;n++)this.tests[n]&&(this.buffer[n]=this.options.placeholder)},r.prototype.writeBuffer=function(){return this.$element.val(this.buffer.join("")).val()},r.prototype.checkVal=function(e){for(var t=this.mask.length,i=this.$element.val(),n=-1,r=0,s=0;r<t;r++)if(this.tests[r]){for(this.buffer[r]=this.options.placeholder;s++<i.length;){var a=i.charAt(s-1);if(this.tests[r].test(a)){this.buffer[r]=a,n=r;break}}if(s>i.length)break}else this.buffer[r]==i.charAt(s)&&r!=this.partialPosition&&(s++,n=r);return!e&&n+1<this.partialPosition?(this.$element.val(""),this.clearBuffer(0,t)):(e||n+1>=this.partialPosition)&&(this.writeBuffer(),e||this.$element.val(this.$element.val().substring(0,n+1))),this.partialPosition?r:this.firstNonMaskPos};var s=e.fn.inputmask;e.fn.inputmask=function(t){return this.each(function(){var i=e(this),n=i.data("bs.inputmask");n||i.data("bs.inputmask",n=new r(this,t))})},e.fn.inputmask.Constructor=r,e.fn.inputmask.noConflict=function(){return e.fn.inputmask=s,this},e(document).on("focus.bs.inputmask.data-api","[data-mask]",function(t){var i=e(this);i.data("bs.inputmask")||i.inputmask(i.data())})}(window.jQuery),+function(e){"use strict";var t="Microsoft Internet Explorer"==window.navigator.appName,i=function(t,i){if(this.$element=e(t),this.$input=this.$element.find(":file"),0!==this.$input.length){this.name=this.$input.attr("name")||i.name,this.$hidden=this.$element.find('input[type=hidden][name="'+this.name+'"]'),0===this.$hidden.length&&(this.$hidden=e('<input type="hidden">').insertBefore(this.$input)),this.$preview=this.$element.find(".fileinput-preview");var n=this.$preview.css("height");"inline"!==this.$preview.css("display")&&"0px"!==n&&"none"!==n&&this.$preview.css("line-height",n),this.original={exists:this.$element.hasClass("fileinput-exists"),preview:this.$preview.html(),hiddenVal:this.$hidden.val()},this.listen()}};i.prototype.listen=function(){this.$input.on("change.bs.fileinput",e.proxy(this.change,this)),e(this.$input[0].form).on("reset.bs.fileinput",e.proxy(this.reset,this)),this.$element.find('[data-trigger="fileinput"]').on("click.bs.fileinput",e.proxy(this.trigger,this)),this.$element.find('[data-dismiss="fileinput"]').on("click.bs.fileinput",e.proxy(this.clear,this))},i.prototype.change=function(t){var i=void 0===t.target.files?t.target&&t.target.value?[{name:t.target.value.replace(/^.+\\/,"")}]:[]:t.target.files;if(t.stopPropagation(),0===i.length)return void this.clear();this.$hidden.val(""),this.$hidden.attr("name",""),this.$input.attr("name",this.name);var n=i[0];if(this.$preview.length>0&&("undefined"!=typeof n.type?n.type.match(/^image\/(gif|png|jpeg)$/):n.name.match(/\.(gif|png|jpe?g)$/i))&&"undefined"!=typeof FileReader){var r=new FileReader,s=this.$preview,a=this.$element;r.onload=function(t){var r=e("<img>");r[0].src=t.target.result,i[0].result=t.target.result,a.find(".fileinput-filename").text(n.name),"none"!=s.css("max-height")&&r.css("max-height",parseInt(s.css("max-height"),10)-parseInt(s.css("padding-top"),10)-parseInt(s.css("padding-bottom"),10)-parseInt(s.css("border-top"),10)-parseInt(s.css("border-bottom"),10)),s.html(r),a.addClass("fileinput-exists").removeClass("fileinput-new"),a.trigger("change.bs.fileinput",i)},r.readAsDataURL(n)}else this.$element.find(".fileinput-filename").text(n.name),this.$preview.text(n.name),this.$element.addClass("fileinput-exists").removeClass("fileinput-new"),this.$element.trigger("change.bs.fileinput")},i.prototype.clear=function(e){if(e&&e.preventDefault(),this.$hidden.val(""),this.$hidden.attr("name",this.name),this.$input.attr("name",""),this.$element.find(".fileinput-remove-mark").val("1"),t){var i=this.$input.clone(!0);this.$input.after(i),this.$input.remove(),this.$input=i}else this.$input.val("");this.$preview.html(""),this.$element.find(".fileinput-filename").text(""),this.$element.addClass("fileinput-new").removeClass("fileinput-exists"),void 0!==e&&(this.$input.trigger("change"),this.$element.trigger("clear.bs.fileinput"))},i.prototype.reset=function(){this.clear(),this.$hidden.val(this.original.hiddenVal),this.$preview.html(this.original.preview),this.$element.find(".fileinput-filename").text(""),this.original.exists?this.$element.addClass("fileinput-exists").removeClass("fileinput-new"):this.$element.addClass("fileinput-new").removeClass("fileinput-exists"),this.$element.trigger("reset.bs.fileinput")},i.prototype.trigger=function(e){this.$input.trigger("click"),e.preventDefault()};var n=e.fn.fileinput;e.fn.fileinput=function(t){return this.each(function(){var n=e(this),r=n.data("bs.fileinput");r||n.data("bs.fileinput",r=new i(this,t)),"string"==typeof t&&r[t]()})},e.fn.fileinput.Constructor=i,e.fn.fileinput.noConflict=function(){return e.fn.fileinput=n,this},e(document).on("click.fileinput.data-api",'[data-provides="fileinput"]',function(t){var i=e(this);if(!i.data("bs.fileinput")){i.fileinput(i.data());var n=e(t.target).closest('[data-dismiss="fileinput"],[data-trigger="fileinput"]');n.length>0&&(t.preventDefault(),n.trigger("click.bs.fileinput"))}})}(window.jQuery),!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):"undefined"!=typeof module&&module.exports?module.exports=e(require("jquery")):e(jQuery)}(function(e,t){"use strict";if(!e.jstree){var i,n,r=0,s=!1,a=!1,o=!1,l=[],c=e("script:last").attr("src"),d=window.document,h=d.createElement("LI");h.setAttribute("role","treeitem"),i=d.createElement("I"),i.className="jstree-icon jstree-ocl",i.setAttribute("role","presentation"),h.appendChild(i),i=d.createElement("A"),i.className="jstree-anchor",i.setAttribute("href","#"),i.setAttribute("tabindex","-1"),n=d.createElement("I"),n.className="jstree-icon jstree-themeicon",n.setAttribute("role","presentation"),i.appendChild(n),h.appendChild(i),i=n=null,e.jstree={version:"3.2.1",defaults:{plugins:[]},plugins:{},path:c&&-1!==c.indexOf("/")?c.replace(/\/[^\/]+$/,""):"",idregex:/[\\:&!^|()\[\]<>@*'+~#";.,=\- \/${}%?`]/g,root:"#"},e.jstree.create=function(t,i){var n=new e.jstree.core((++r)),s=i;return i=e.extend(!0,{},e.jstree.defaults,i),s&&s.plugins&&(i.plugins=s.plugins),e.each(i.plugins,function(e,t){"core"!==e&&(n=n.plugin(t,i[t]))}),e(t).data("jstree",n),n.init(t,i),n},e.jstree.destroy=function(){e(".jstree:jstree").jstree("destroy"),e(d).off(".jstree")},e.jstree.core=function(e){this._id=e,this._cnt=0,this._wrk=null,this._data={core:{themes:{name:!1,dots:!1,icons:!1},selected:[],last_error:{},working:!1,worker_queue:[],focused:null}}},e.jstree.reference=function(t){var i=null,n=null;if(!t||!t.id||t.tagName&&t.nodeType||(t=t.id),!n||!n.length)try{n=e(t)}catch(r){}if(!n||!n.length)try{n=e("#"+t.replace(e.jstree.idregex,"\\$&"))}catch(r){}return n&&n.length&&(n=n.closest(".jstree")).length&&(n=n.data("jstree"))?i=n:e(".jstree").each(function(){var n=e(this).data("jstree");return n&&n._model.data[t]?(i=n,!1):void 0}),i},e.fn.jstree=function(i){var n="string"==typeof i,r=Array.prototype.slice.call(arguments,1),s=null;return!(i===!0&&!this.length)&&(this.each(function(){var a=e.jstree.reference(this),o=n&&a?a[i]:null;return s=n&&o?o.apply(a,r):null,a||n||i!==t&&!e.isPlainObject(i)||e.jstree.create(this,i),(a&&!n||i===!0)&&(s=a||!1),(null===s||s===t)&&void 0}),null!==s&&s!==t?s:this)},e.expr[":"].jstree=e.expr.createPseudo(function(i){return function(i){return e(i).hasClass("jstree")&&e(i).data("jstree")!==t}}),e.jstree.defaults.core={data:!1,strings:!1,check_callback:!1,error:e.noop,animation:200,multiple:!0,themes:{name:!1,url:!1,dir:!1,dots:!0,icons:!0,stripes:!1,variant:!1,responsive:!1},expand_selected_onload:!0,worker:!0,force_text:!1,dblclick_toggle:!0},e.jstree.core.prototype={plugin:function(t,i){var n=e.jstree.plugins[t];return n?(this._data[t]={},n.prototype=this,new n(i,this)):this},init:function(t,i){this._model={data:{},changed:[],force_full_redraw:!1,redraw_timeout:!1,default_state:{loaded:!0,opened:!1,selected:!1,disabled:!1}},this._model.data[e.jstree.root]={id:e.jstree.root,parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}},this.element=e(t).addClass("jstree jstree-"+this._id),this.settings=i,this._data.core.ready=!1,this._data.core.loaded=!1,this._data.core.rtl="rtl"===this.element.css("direction"),this.element[this._data.core.rtl?"addClass":"removeClass"]("jstree-rtl"),this.element.attr("role","tree"),this.settings.core.multiple&&this.element.attr("aria-multiselectable",!0),this.element.attr("tabindex")||this.element.attr("tabindex","0"),this.bind(),this.trigger("init"),this._data.core.original_container_html=this.element.find(" > ul > li").clone(!0),this._data.core.original_container_html.find("li").addBack().contents().filter(function(){return 3===this.nodeType&&(!this.nodeValue||/^\s+$/.test(this.nodeValue))}).remove(),this.element.html("<ul class='jstree-container-ul jstree-children' role='group'><li id='j"+this._id+"_loading' class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='tree-item'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>"),this.element.attr("aria-activedescendant","j"+this._id+"_loading"),this._data.core.li_height=this.get_container_ul().children("li").first().height()||24,this.trigger("loading"),this.load_node(e.jstree.root)},destroy:function(e){if(this._wrk)try{window.URL.revokeObjectURL(this._wrk),this._wrk=null}catch(t){}e||this.element.empty(),this.teardown()},teardown:function(){this.unbind(),this.element.removeClass("jstree").removeData("jstree").find("[class^='jstree']").addBack().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/gi,"")}),this.element=null},bind:function(){var t="",i=null,n=0;this.element.on("dblclick.jstree",function(e){if(e.target.tagName&&"input"===e.target.tagName.toLowerCase())return!0;if(d.selection&&d.selection.empty)d.selection.empty();else if(window.getSelection){var t=window.getSelection();try{t.removeAllRanges(),t.collapse()}catch(i){}}}).on("mousedown.jstree",e.proxy(function(e){e.target===this.element[0]&&(e.preventDefault(),n=+new Date)},this)).on("mousedown.jstree",".jstree-ocl",function(e){e.preventDefault()}).on("click.jstree",".jstree-ocl",e.proxy(function(e){this.toggle_node(e.target)},this)).on("dblclick.jstree",".jstree-anchor",e.proxy(function(e){return!(!e.target.tagName||"input"!==e.target.tagName.toLowerCase())||void(this.settings.core.dblclick_toggle&&this.toggle_node(e.target))},this)).on("click.jstree",".jstree-anchor",e.proxy(function(t){t.preventDefault(),t.currentTarget!==d.activeElement&&e(t.currentTarget).focus(),this.activate_node(t.currentTarget,t)},this)).on("keydown.jstree",".jstree-anchor",e.proxy(function(t){if(t.target.tagName&&"input"===t.target.tagName.toLowerCase())return!0;if(32!==t.which&&13!==t.which&&(t.shiftKey||t.ctrlKey||t.altKey||t.metaKey))return!0;var i=null;switch(this._data.core.rtl&&(37===t.which?t.which=39:39===t.which&&(t.which=37)),t.which){case 32:t.ctrlKey&&(t.type="click",e(t.currentTarget).trigger(t));break;case 13:t.type="click",e(t.currentTarget).trigger(t);break;case 37:t.preventDefault(),this.is_open(t.currentTarget)?this.close_node(t.currentTarget):(i=this.get_parent(t.currentTarget),i&&i.id!==e.jstree.root&&this.get_node(i,!0).children(".jstree-anchor").focus());break;case 38:t.preventDefault(),i=this.get_prev_dom(t.currentTarget),i&&i.length&&i.children(".jstree-anchor").focus();break;case 39:t.preventDefault(),this.is_closed(t.currentTarget)?this.open_node(t.currentTarget,function(e){this.get_node(e,!0).children(".jstree-anchor").focus()}):this.is_open(t.currentTarget)&&(i=this.get_node(t.currentTarget,!0).children(".jstree-children")[0],i&&e(this._firstChild(i)).children(".jstree-anchor").focus());break;case 40:t.preventDefault(),i=this.get_next_dom(t.currentTarget),i&&i.length&&i.children(".jstree-anchor").focus();break;case 106:this.open_all();break;case 36:t.preventDefault(),i=this._firstChild(this.get_container_ul()[0]),i&&e(i).children(".jstree-anchor").filter(":visible").focus();break;case 35:t.preventDefault(),this.element.find(".jstree-anchor").filter(":visible").last().focus()}},this)).on("load_node.jstree",e.proxy(function(t,i){i.status&&(i.node.id!==e.jstree.root||this._data.core.loaded||(this._data.core.loaded=!0,this._firstChild(this.get_container_ul()[0])&&this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id),this.trigger("loaded")),this._data.core.ready||setTimeout(e.proxy(function(){if(this.element&&!this.get_container_ul().find(".jstree-loading").length){if(this._data.core.ready=!0,this._data.core.selected.length){if(this.settings.core.expand_selected_onload){var t,i,n=[];for(t=0,i=this._data.core.selected.length;i>t;t++)n=n.concat(this._model.data[this._data.core.selected[t]].parents);for(n=e.vakata.array_unique(n),t=0,i=n.length;i>t;t++)this.open_node(n[t],!1,0)}this.trigger("changed",{action:"ready",selected:this._data.core.selected})}this.trigger("ready")}},this),0))},this)).on("keypress.jstree",e.proxy(function(n){if(n.target.tagName&&"input"===n.target.tagName.toLowerCase())return!0;i&&clearTimeout(i),i=setTimeout(function(){t=""},500);var r=String.fromCharCode(n.which).toLowerCase(),s=this.element.find(".jstree-anchor").filter(":visible"),a=s.index(d.activeElement)||0,o=!1;if(t+=r,t.length>1){if(s.slice(a).each(e.proxy(function(i,n){return 0===e(n).text().toLowerCase().indexOf(t)?(e(n).focus(),o=!0,!1):void 0},this)),o)return;if(s.slice(0,a).each(e.proxy(function(i,n){return 0===e(n).text().toLowerCase().indexOf(t)?(e(n).focus(),o=!0,!1):void 0},this)),o)return}if(new RegExp("^"+r.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")+"+$").test(t)){if(s.slice(a+1).each(e.proxy(function(t,i){return e(i).text().toLowerCase().charAt(0)===r?(e(i).focus(),o=!0,!1):void 0},this)),o)return;if(s.slice(0,a+1).each(e.proxy(function(t,i){return e(i).text().toLowerCase().charAt(0)===r?(e(i).focus(),o=!0,!1):void 0},this)),o)return}},this)).on("init.jstree",e.proxy(function(){var e=this.settings.core.themes;this._data.core.themes.dots=e.dots,this._data.core.themes.stripes=e.stripes,this._data.core.themes.icons=e.icons,this.set_theme(e.name||"default",e.url),this.set_theme_variant(e.variant)},this)).on("loading.jstree",e.proxy(function(){this[this._data.core.themes.dots?"show_dots":"hide_dots"](),this[this._data.core.themes.icons?"show_icons":"hide_icons"](),this[this._data.core.themes.stripes?"show_stripes":"hide_stripes"]()},this)).on("blur.jstree",".jstree-anchor",e.proxy(function(t){this._data.core.focused=null,e(t.currentTarget).filter(".jstree-hovered").mouseleave(),this.element.attr("tabindex","0")},this)).on("focus.jstree",".jstree-anchor",e.proxy(function(t){var i=this.get_node(t.currentTarget);i&&i.id&&(this._data.core.focused=i.id),this.element.find(".jstree-hovered").not(t.currentTarget).mouseleave(),e(t.currentTarget).mouseenter(),this.element.attr("tabindex","-1")},this)).on("focus.jstree",e.proxy(function(){if(+new Date-n>500&&!this._data.core.focused){n=0;var e=this.get_node(this.element.attr("aria-activedescendant"),!0);e&&e.find("> .jstree-anchor").focus()}},this)).on("mouseenter.jstree",".jstree-anchor",e.proxy(function(e){this.hover_node(e.currentTarget)},this)).on("mouseleave.jstree",".jstree-anchor",e.proxy(function(e){this.dehover_node(e.currentTarget)},this))},unbind:function(){this.element.off(".jstree"),e(d).off(".jstree-"+this._id)},trigger:function(e,t){t||(t={}),t.instance=this,this.element.triggerHandler(e.replace(".jstree","")+".jstree",t)},get_container:function(){return this.element},get_container_ul:function(){return this.element.children(".jstree-children").first()},get_string:function(t){var i=this.settings.core.strings;return e.isFunction(i)?i.call(this,t):i&&i[t]?i[t]:t},_firstChild:function(e){for(e=e?e.firstChild:null;null!==e&&1!==e.nodeType;)e=e.nextSibling;return e},_nextSibling:function(e){for(e=e?e.nextSibling:null;null!==e&&1!==e.nodeType;)e=e.nextSibling;return e},_previousSibling:function(e){for(e=e?e.previousSibling:null;null!==e&&1!==e.nodeType;)e=e.previousSibling;return e},get_node:function(t,i){t&&t.id&&(t=t.id);var n;try{if(this._model.data[t])t=this._model.data[t];else if("string"==typeof t&&this._model.data[t.replace(/^#/,"")])t=this._model.data[t.replace(/^#/,"")];else if("string"==typeof t&&(n=e("#"+t.replace(e.jstree.idregex,"\\$&"),this.element)).length&&this._model.data[n.closest(".jstree-node").attr("id")])t=this._model.data[n.closest(".jstree-node").attr("id")];else if((n=e(t,this.element)).length&&this._model.data[n.closest(".jstree-node").attr("id")])t=this._model.data[n.closest(".jstree-node").attr("id")];else{if(!(n=e(t,this.element)).length||!n.hasClass("jstree"))return!1;t=this._model.data[e.jstree.root]}return i&&(t=t.id===e.jstree.root?this.element:e("#"+t.id.replace(e.jstree.idregex,"\\$&"),this.element)),t}catch(r){return!1}},get_path:function(t,i,n){if(t=t.parents?t:this.get_node(t),!t||t.id===e.jstree.root||!t.parents)return!1;var r,s,a=[];for(a.push(n?t.id:t.text),r=0,s=t.parents.length;s>r;r++)a.push(n?t.parents[r]:this.get_text(t.parents[r]));return a=a.reverse().slice(1),i?a.join(i):a},get_next_dom:function(t,i){var n;if(t=this.get_node(t,!0),t[0]===this.element[0]){for(n=this._firstChild(this.get_container_ul()[0]);n&&0===n.offsetHeight;)n=this._nextSibling(n);return!!n&&e(n)}if(!t||!t.length)return!1;if(i){n=t[0];do n=this._nextSibling(n);while(n&&0===n.offsetHeight);return!!n&&e(n)}if(t.hasClass("jstree-open")){for(n=this._firstChild(t.children(".jstree-children")[0]);n&&0===n.offsetHeight;)n=this._nextSibling(n);if(null!==n)return e(n)}n=t[0];do n=this._nextSibling(n);while(n&&0===n.offsetHeight);return null!==n?e(n):t.parentsUntil(".jstree",".jstree-node").nextAll(".jstree-node:visible").first()},get_prev_dom:function(t,i){var n;if(t=this.get_node(t,!0),t[0]===this.element[0]){for(n=this.get_container_ul()[0].lastChild;n&&0===n.offsetHeight;)n=this._previousSibling(n);return!!n&&e(n)}if(!t||!t.length)return!1;if(i){n=t[0];do n=this._previousSibling(n);while(n&&0===n.offsetHeight);return!!n&&e(n)}n=t[0];do n=this._previousSibling(n);while(n&&0===n.offsetHeight);if(null!==n){for(t=e(n);t.hasClass("jstree-open");)t=t.children(".jstree-children").first().children(".jstree-node:visible:last");return t}return n=t[0].parentNode.parentNode,!(!n||!n.className||-1===n.className.indexOf("jstree-node"))&&e(n)},get_parent:function(t){return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&t.parent},get_children_dom:function(e){return e=this.get_node(e,!0),e[0]===this.element[0]?this.get_container_ul().children(".jstree-node"):!(!e||!e.length)&&e.children(".jstree-children").children(".jstree-node")},is_parent:function(e){return e=this.get_node(e),e&&(e.state.loaded===!1||e.children.length>0)},is_loaded:function(e){return e=this.get_node(e),e&&e.state.loaded},is_loading:function(e){return e=this.get_node(e),e&&e.state&&e.state.loading},is_open:function(e){return e=this.get_node(e),e&&e.state.opened},is_closed:function(e){return e=this.get_node(e),e&&this.is_parent(e)&&!e.state.opened},is_leaf:function(e){return!this.is_parent(e)},load_node:function(t,i){var n,r,s,a,o;if(e.isArray(t))return this._load_nodes(t.slice(),i),!0;if(t=this.get_node(t),!t)return i&&i.call(this,t,!1),!1;if(t.state.loaded){for(t.state.loaded=!1,n=0,r=t.children_d.length;r>n;n++){for(s=0,a=t.parents.length;a>s;s++)this._model.data[t.parents[s]].children_d=e.vakata.array_remove_item(this._model.data[t.parents[s]].children_d,t.children_d[n]);this._model.data[t.children_d[n]].state.selected&&(o=!0,this._data.core.selected=e.vakata.array_remove_item(this._data.core.selected,t.children_d[n])),delete this._model.data[t.children_d[n]]}t.children=[],t.children_d=[],o&&this.trigger("changed",{action:"load_node",node:t,selected:this._data.core.selected})}return t.state.failed=!1,t.state.loading=!0,this.get_node(t,!0).addClass("jstree-loading").attr("aria-busy",!0),this._load_node(t,e.proxy(function(e){t=this._model.data[t.id],t.state.loading=!1,t.state.loaded=e,t.state.failed=!t.state.loaded;var n=this.get_node(t,!0),r=0,s=0,a=this._model.data,o=!1;for(r=0,s=t.children.length;s>r;r++)if(a[t.children[r]]&&!a[t.children[r]].state.hidden){o=!0;break}t.state.loaded&&!o&&n&&n.length&&!n.hasClass("jstree-leaf")&&n.removeClass("jstree-closed jstree-open").addClass("jstree-leaf"),n.removeClass("jstree-loading").attr("aria-busy",!1),this.trigger("load_node",{node:t,status:e}),i&&i.call(this,t,e)},this)),!0},_load_nodes:function(e,t,i){var n,r,s=!0,a=function(){this._load_nodes(e,t,!0)},o=this._model.data,l=[];for(n=0,r=e.length;r>n;n++)!o[e[n]]||(o[e[n]].state.loaded||o[e[n]].state.failed)&&i||(this.is_loading(e[n])||this.load_node(e[n],a),s=!1);if(s){for(n=0,r=e.length;r>n;n++)o[e[n]]&&o[e[n]].state.loaded&&l.push(e[n]);t&&!t.done&&(t.call(this,l),t.done=!0)}},load_all:function(t,i){if(t||(t=e.jstree.root),t=this.get_node(t),!t)return!1;var n,r,s=[],a=this._model.data,o=a[t.id].children_d;for(t.state&&!t.state.loaded&&s.push(t.id),n=0,r=o.length;r>n;n++)a[o[n]]&&a[o[n]].state&&!a[o[n]].state.loaded&&s.push(o[n]);s.length?this._load_nodes(s,function(){this.load_all(t,i)}):(i&&i.call(this,t),this.trigger("load_all",{node:t}))},_load_node:function(t,i){var n,r=this.settings.core.data;return r?e.isFunction(r)?r.call(this,t,e.proxy(function(n){n===!1&&i.call(this,!1),this["string"==typeof n?"_append_html_data":"_append_json_data"](t,"string"==typeof n?e(e.parseHTML(n)).filter(function(){return 3!==this.nodeType}):n,function(e){i.call(this,e)})},this)):"object"==typeof r?r.url?(r=e.extend(!0,{},r),e.isFunction(r.url)&&(r.url=r.url.call(this,t)),e.isFunction(r.data)&&(r.data=r.data.call(this,t)),e.ajax(r).done(e.proxy(function(n,r,s){var a=s.getResponseHeader("Content-Type");return a&&-1!==a.indexOf("json")||"object"==typeof n?this._append_json_data(t,n,function(e){i.call(this,e)}):a&&-1!==a.indexOf("html")||"string"==typeof n?this._append_html_data(t,e(e.parseHTML(n)).filter(function(){return 3!==this.nodeType}),function(e){i.call(this,e)}):(this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:t.id,xhr:s})},this.settings.core.error.call(this,this._data.core.last_error),i.call(this,!1))},this)).fail(e.proxy(function(e){i.call(this,!1),this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:t.id,xhr:e})},this.settings.core.error.call(this,this._data.core.last_error)},this))):(n=e.isArray(r)||e.isPlainObject(r)?JSON.parse(JSON.stringify(r)):r,t.id===e.jstree.root?this._append_json_data(t,n,function(e){i.call(this,e)}):(this._data.core.last_error={error:"nodata",plugin:"core",id:"core_05",reason:"Could not load node",data:JSON.stringify({id:t.id})},this.settings.core.error.call(this,this._data.core.last_error),i.call(this,!1))):"string"==typeof r?t.id===e.jstree.root?this._append_html_data(t,e(e.parseHTML(r)).filter(function(){return 3!==this.nodeType}),function(e){i.call(this,e)}):(this._data.core.last_error={error:"nodata",plugin:"core",id:"core_06",reason:"Could not load node",data:JSON.stringify({id:t.id})},this.settings.core.error.call(this,this._data.core.last_error),i.call(this,!1)):i.call(this,!1):t.id===e.jstree.root?this._append_html_data(t,this._data.core.original_container_html.clone(!0),function(e){i.call(this,e)}):i.call(this,!1)},_node_changed:function(e){e=this.get_node(e),e&&this._model.changed.push(e.id)},_append_html_data:function(t,i,n){t=this.get_node(t),t.children=[],t.children_d=[];var r,s,a,o=i.is("ul")?i.children():i,l=t.id,c=[],d=[],h=this._model.data,u=h[l],f=this._data.core.selected.length;for(o.each(e.proxy(function(t,i){r=this._parse_model_from_html(e(i),l,u.parents.concat()),r&&(c.push(r),d.push(r),h[r].children_d.length&&(d=d.concat(h[r].children_d)))},this)),u.children=c,u.children_d=d,s=0,a=u.parents.length;a>s;s++)h[u.parents[s]].children_d=h[u.parents[s]].children_d.concat(d);this.trigger("model",{nodes:d,parent:l}),l!==e.jstree.root?(this._node_changed(l),this.redraw()):(this.get_container_ul().children(".jstree-initial-node").remove(),this.redraw(!0)),this._data.core.selected.length!==f&&this.trigger("changed",{action:"model",selected:this._data.core.selected}),n.call(this,!0)},_append_json_data:function(t,i,n,r){if(null!==this.element){t=this.get_node(t),t.children=[],t.children_d=[],i.d&&(i=i.d,"string"==typeof i&&(i=JSON.parse(i))),e.isArray(i)||(i=[i]);var s=null,a={df:this._model.default_state,dat:i,par:t.id,m:this._model.data,t_id:this._id,t_cnt:this._cnt,sel:this._data.core.selected},o=function(e,t){e.data&&(e=e.data);var i,n,r,s,a=e.dat,o=e.par,l=[],c=[],d=[],h=e.df,u=e.t_id,f=e.t_cnt,p=e.m,m=p[o],g=e.sel,v=function(e,i,n){n=n?n.concat():[],i&&n.unshift(i);var r,s,a,o,l=e.id.toString(),c={id:l,text:e.text||"",icon:e.icon===t||e.icon,parent:i,parents:n,children:e.children||[],children_d:e.children_d||[],data:e.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(r in h)h.hasOwnProperty(r)&&(c.state[r]=h[r]);if(e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(c.icon=e.data.jstree.icon),(c.icon===t||null===c.icon||""===c.icon)&&(c.icon=!0),e&&e.data&&(c.data=e.data,e.data.jstree))for(r in e.data.jstree)e.data.jstree.hasOwnProperty(r)&&(c.state[r]=e.data.jstree[r]);if(e&&"object"==typeof e.state)for(r in e.state)e.state.hasOwnProperty(r)&&(c.state[r]=e.state[r]);if(e&&"object"==typeof e.li_attr)for(r in e.li_attr)e.li_attr.hasOwnProperty(r)&&(c.li_attr[r]=e.li_attr[r]);if(c.li_attr.id||(c.li_attr.id=l),e&&"object"==typeof e.a_attr)for(r in e.a_attr)e.a_attr.hasOwnProperty(r)&&(c.a_attr[r]=e.a_attr[r]);for(e&&e.children&&e.children===!0&&(c.state.loaded=!1,c.children=[],c.children_d=[]),p[c.id]=c,r=0,s=c.children.length;s>r;r++)a=v(p[c.children[r]],c.id,n),o=p[a],c.children_d.push(a),o.children_d.length&&(c.children_d=c.children_d.concat(o.children_d));return delete e.data,delete e.children,p[c.id].original=e,c.state.selected&&d.push(c.id),c.id},_=function(e,i,n){n=n?n.concat():[],i&&n.unshift(i);var r,s,a,o,l,c=!1;do c="j"+u+"_"+ ++f;while(p[c]);l={id:!1,text:"string"==typeof e?e:"",icon:"object"!=typeof e||e.icon===t||e.icon,parent:i,parents:n,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(r in h)h.hasOwnProperty(r)&&(l.state[r]=h[r]);if(e&&e.id&&(l.id=e.id.toString()),e&&e.text&&(l.text=e.text),e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(l.icon=e.data.jstree.icon),(l.icon===t||null===l.icon||""===l.icon)&&(l.icon=!0),e&&e.data&&(l.data=e.data,e.data.jstree))for(r in e.data.jstree)e.data.jstree.hasOwnProperty(r)&&(l.state[r]=e.data.jstree[r]);if(e&&"object"==typeof e.state)for(r in e.state)e.state.hasOwnProperty(r)&&(l.state[r]=e.state[r]);if(e&&"object"==typeof e.li_attr)for(r in e.li_attr)e.li_attr.hasOwnProperty(r)&&(l.li_attr[r]=e.li_attr[r]);if(l.li_attr.id&&!l.id&&(l.id=l.li_attr.id.toString()),l.id||(l.id=c),l.li_attr.id||(l.li_attr.id=l.id),e&&"object"==typeof e.a_attr)for(r in e.a_attr)e.a_attr.hasOwnProperty(r)&&(l.a_attr[r]=e.a_attr[r]);if(e&&e.children&&e.children.length){for(r=0,s=e.children.length;s>r;r++)a=_(e.children[r],l.id,n),o=p[a],l.children.push(a),o.children_d.length&&(l.children_d=l.children_d.concat(o.children_d));l.children_d=l.children_d.concat(l.children)}return e&&e.children&&e.children===!0&&(l.state.loaded=!1,l.children=[],l.children_d=[]),delete e.data,delete e.children,l.original=e,p[l.id]=l,l.state.selected&&d.push(l.id),l.id};if(a.length&&a[0].id!==t&&a[0].parent!==t){for(n=0,r=a.length;r>n;n++)a[n].children||(a[n].children=[]),p[a[n].id.toString()]=a[n];for(n=0,r=a.length;r>n;n++)p[a[n].parent.toString()].children.push(a[n].id.toString()),m.children_d.push(a[n].id.toString());for(n=0,r=m.children.length;r>n;n++)i=v(p[m.children[n]],o,m.parents.concat()),c.push(i),p[i].children_d.length&&(c=c.concat(p[i].children_d));for(n=0,r=m.parents.length;r>n;n++)p[m.parents[n]].children_d=p[m.parents[n]].children_d.concat(c);s={cnt:f,mod:p,sel:g,par:o,dpc:c,add:d}}else{for(n=0,r=a.length;r>n;n++)i=_(a[n],o,m.parents.concat()),i&&(l.push(i),c.push(i),p[i].children_d.length&&(c=c.concat(p[i].children_d)));for(m.children=l,m.children_d=c,n=0,r=m.parents.length;r>n;n++)p[m.parents[n]].children_d=p[m.parents[n]].children_d.concat(c);s={cnt:f,mod:p,sel:g,par:o,dpc:c,add:d}}return"undefined"!=typeof window&&"undefined"!=typeof window.document?s:void postMessage(s)},l=function(t,i){if(null!==this.element){if(this._cnt=t.cnt,this._model.data=t.mod,i){var r,s,a=t.add,o=t.sel,l=this._data.core.selected.slice(),c=this._model.data;if(o.length!==l.length||e.vakata.array_unique(o.concat(l)).length!==o.length){for(r=0,s=o.length;s>r;r++)-1===e.inArray(o[r],a)&&-1===e.inArray(o[r],l)&&(c[o[r]].state.selected=!1);for(r=0,s=l.length;s>r;r++)-1===e.inArray(l[r],o)&&(c[l[r]].state.selected=!0)}}t.add.length&&(this._data.core.selected=this._data.core.selected.concat(t.add)),this.trigger("model",{nodes:t.dpc,parent:t.par}),t.par!==e.jstree.root?(this._node_changed(t.par),this.redraw()):this.redraw(!0),t.add.length&&this.trigger("changed",{action:"model",selected:this._data.core.selected}),n.call(this,!0)}};if(this.settings.core.worker&&window.Blob&&window.URL&&window.Worker)try{null===this._wrk&&(this._wrk=window.URL.createObjectURL(new window.Blob(["self.onmessage = "+o.toString()],{type:"text/javascript"}))),!this._data.core.working||r?(this._data.core.working=!0,s=new window.Worker(this._wrk),s.onmessage=e.proxy(function(e){l.call(this,e.data,!0);try{s.terminate(),s=null}catch(t){}this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1},this),a.par?s.postMessage(a):this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1):this._data.core.worker_queue.push([t,i,n,!0])}catch(c){l.call(this,o(a),!1),this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1}else l.call(this,o(a),!1)}},_parse_model_from_html:function(i,n,r){r=r?[].concat(r):[],n&&r.unshift(n);var s,a,o,l,c,d=this._model.data,h={id:!1,text:!1,icon:!0,parent:n,parents:r,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(o in this._model.default_state)this._model.default_state.hasOwnProperty(o)&&(h.state[o]=this._model.default_state[o]);if(l=e.vakata.attributes(i,!0),e.each(l,function(t,i){return i=e.trim(i),!i.length||(h.li_attr[t]=i,void("id"===t&&(h.id=i.toString())))}),l=i.children("a").first(),l.length&&(l=e.vakata.attributes(l,!0),e.each(l,function(t,i){i=e.trim(i),i.length&&(h.a_attr[t]=i)})),l=i.children("a").first().length?i.children("a").first().clone():i.clone(),l.children("ins, i, ul").remove(),l=l.html(),l=e("<div />").html(l),h.text=this.settings.core.force_text?l.text():l.html(),l=i.data(),h.data=l?e.extend(!0,{},l):null,h.state.opened=i.hasClass("jstree-open"),h.state.selected=i.children("a").hasClass("jstree-clicked"),h.state.disabled=i.children("a").hasClass("jstree-disabled"),h.data&&h.data.jstree)for(o in h.data.jstree)h.data.jstree.hasOwnProperty(o)&&(h.state[o]=h.data.jstree[o]);l=i.children("a").children(".jstree-themeicon"),l.length&&(h.icon=!l.hasClass("jstree-themeicon-hidden")&&l.attr("rel")),h.state.icon!==t&&(h.icon=h.state.icon),(h.icon===t||null===h.icon||""===h.icon)&&(h.icon=!0),l=i.children("ul").children("li");do c="j"+this._id+"_"+ ++this._cnt;while(d[c]);return h.id=h.li_attr.id?h.li_attr.id.toString():c,l.length?(l.each(e.proxy(function(t,i){s=this._parse_model_from_html(e(i),h.id,r),a=this._model.data[s],h.children.push(s),a.children_d.length&&(h.children_d=h.children_d.concat(a.children_d))},this)),h.children_d=h.children_d.concat(h.children)):i.hasClass("jstree-closed")&&(h.state.loaded=!1),
h.li_attr["class"]&&(h.li_attr["class"]=h.li_attr["class"].replace("jstree-closed","").replace("jstree-open","")),h.a_attr["class"]&&(h.a_attr["class"]=h.a_attr["class"].replace("jstree-clicked","").replace("jstree-disabled","")),d[h.id]=h,h.state.selected&&this._data.core.selected.push(h.id),h.id},_parse_model_from_flat_json:function(e,i,n){n=n?n.concat():[],i&&n.unshift(i);var r,s,a,o,l=e.id.toString(),c=this._model.data,d=this._model.default_state,h={id:l,text:e.text||"",icon:e.icon===t||e.icon,parent:i,parents:n,children:e.children||[],children_d:e.children_d||[],data:e.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(r in d)d.hasOwnProperty(r)&&(h.state[r]=d[r]);if(e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(h.icon=e.data.jstree.icon),(h.icon===t||null===h.icon||""===h.icon)&&(h.icon=!0),e&&e.data&&(h.data=e.data,e.data.jstree))for(r in e.data.jstree)e.data.jstree.hasOwnProperty(r)&&(h.state[r]=e.data.jstree[r]);if(e&&"object"==typeof e.state)for(r in e.state)e.state.hasOwnProperty(r)&&(h.state[r]=e.state[r]);if(e&&"object"==typeof e.li_attr)for(r in e.li_attr)e.li_attr.hasOwnProperty(r)&&(h.li_attr[r]=e.li_attr[r]);if(h.li_attr.id||(h.li_attr.id=l),e&&"object"==typeof e.a_attr)for(r in e.a_attr)e.a_attr.hasOwnProperty(r)&&(h.a_attr[r]=e.a_attr[r]);for(e&&e.children&&e.children===!0&&(h.state.loaded=!1,h.children=[],h.children_d=[]),c[h.id]=h,r=0,s=h.children.length;s>r;r++)a=this._parse_model_from_flat_json(c[h.children[r]],h.id,n),o=c[a],h.children_d.push(a),o.children_d.length&&(h.children_d=h.children_d.concat(o.children_d));return delete e.data,delete e.children,c[h.id].original=e,h.state.selected&&this._data.core.selected.push(h.id),h.id},_parse_model_from_json:function(e,i,n){n=n?n.concat():[],i&&n.unshift(i);var r,s,a,o,l,c=!1,d=this._model.data,h=this._model.default_state;do c="j"+this._id+"_"+ ++this._cnt;while(d[c]);l={id:!1,text:"string"==typeof e?e:"",icon:"object"!=typeof e||e.icon===t||e.icon,parent:i,parents:n,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(r in h)h.hasOwnProperty(r)&&(l.state[r]=h[r]);if(e&&e.id&&(l.id=e.id.toString()),e&&e.text&&(l.text=e.text),e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(l.icon=e.data.jstree.icon),(l.icon===t||null===l.icon||""===l.icon)&&(l.icon=!0),e&&e.data&&(l.data=e.data,e.data.jstree))for(r in e.data.jstree)e.data.jstree.hasOwnProperty(r)&&(l.state[r]=e.data.jstree[r]);if(e&&"object"==typeof e.state)for(r in e.state)e.state.hasOwnProperty(r)&&(l.state[r]=e.state[r]);if(e&&"object"==typeof e.li_attr)for(r in e.li_attr)e.li_attr.hasOwnProperty(r)&&(l.li_attr[r]=e.li_attr[r]);if(l.li_attr.id&&!l.id&&(l.id=l.li_attr.id.toString()),l.id||(l.id=c),l.li_attr.id||(l.li_attr.id=l.id),e&&"object"==typeof e.a_attr)for(r in e.a_attr)e.a_attr.hasOwnProperty(r)&&(l.a_attr[r]=e.a_attr[r]);if(e&&e.children&&e.children.length){for(r=0,s=e.children.length;s>r;r++)a=this._parse_model_from_json(e.children[r],l.id,n),o=d[a],l.children.push(a),o.children_d.length&&(l.children_d=l.children_d.concat(o.children_d));l.children_d=l.children_d.concat(l.children)}return e&&e.children&&e.children===!0&&(l.state.loaded=!1,l.children=[],l.children_d=[]),delete e.data,delete e.children,l.original=e,d[l.id]=l,l.state.selected&&this._data.core.selected.push(l.id),l.id},_redraw:function(){var t,i,n,r=this._model.force_full_redraw?this._model.data[e.jstree.root].children.concat([]):this._model.changed.concat([]),s=d.createElement("UL"),a=this._data.core.focused;for(i=0,n=r.length;n>i;i++)t=this.redraw_node(r[i],!0,this._model.force_full_redraw),t&&this._model.force_full_redraw&&s.appendChild(t);this._model.force_full_redraw&&(s.className=this.get_container_ul()[0].className,s.setAttribute("role","group"),this.element.empty().append(s)),null!==a&&(t=this.get_node(a,!0),t&&t.length&&t.children(".jstree-anchor")[0]!==d.activeElement?t.children(".jstree-anchor").focus():this._data.core.focused=null),this._model.force_full_redraw=!1,this._model.changed=[],this.trigger("redraw",{nodes:r})},redraw:function(e){e&&(this._model.force_full_redraw=!0),this._redraw()},draw_children:function(t){var i=this.get_node(t),n=!1,r=!1,s=!1,a=d;if(!i)return!1;if(i.id===e.jstree.root)return this.redraw(!0);if(t=this.get_node(t,!0),!t||!t.length)return!1;if(t.children(".jstree-children").remove(),t=t[0],i.children.length&&i.state.loaded){for(s=a.createElement("UL"),s.setAttribute("role","group"),s.className="jstree-children",n=0,r=i.children.length;r>n;n++)s.appendChild(this.redraw_node(i.children[n],!0,!0));t.appendChild(s)}},redraw_node:function(t,i,n,r){var s=this.get_node(t),a=!1,o=!1,l=!1,c=!1,u=!1,f=!1,p="",m=d,g=this._model.data,v=!1,_=null,y=0,b=0,x=!1,w=!1;if(!s)return!1;if(s.id===e.jstree.root)return this.redraw(!0);if(i=i||0===s.children.length,t=d.querySelector?this.element[0].querySelector("#"+(-1!=="0123456789".indexOf(s.id[0])?"\\3"+s.id[0]+" "+s.id.substr(1).replace(e.jstree.idregex,"\\$&"):s.id.replace(e.jstree.idregex,"\\$&"))):d.getElementById(s.id))t=e(t),n||(a=t.parent().parent()[0],a===this.element[0]&&(a=null),o=t.index()),i||!s.children.length||t.children(".jstree-children").length||(i=!0),i||(l=t.children(".jstree-children")[0]),v=t.children(".jstree-anchor")[0]===d.activeElement,t.remove();else if(i=!0,!n){if(a=s.parent!==e.jstree.root?e("#"+s.parent.replace(e.jstree.idregex,"\\$&"),this.element)[0]:null,!(null===a||a&&g[s.parent].state.opened))return!1;o=e.inArray(s.id,null===a?g[e.jstree.root].children:g[s.parent].children)}t=h.cloneNode(!0),p="jstree-node ";for(c in s.li_attr)if(s.li_attr.hasOwnProperty(c)){if("id"===c)continue;"class"!==c?t.setAttribute(c,s.li_attr[c]):p+=s.li_attr[c]}for(s.a_attr.id||(s.a_attr.id=s.id+"_anchor"),t.setAttribute("aria-selected",!!s.state.selected),t.setAttribute("aria-level",s.parents.length),t.setAttribute("aria-labelledby",s.a_attr.id),s.state.disabled&&t.setAttribute("aria-disabled",!0),c=0,u=s.children.length;u>c;c++)if(!g[s.children[c]].state.hidden){x=!0;break}if(null!==s.parent&&g[s.parent]&&!s.state.hidden&&(c=e.inArray(s.id,g[s.parent].children),w=s.id,-1!==c))for(c++,u=g[s.parent].children.length;u>c&&(g[g[s.parent].children[c]].state.hidden||(w=g[s.parent].children[c]),w===s.id);c++);s.state.hidden&&(p+=" jstree-hidden"),s.state.loaded&&!x?p+=" jstree-leaf":(p+=s.state.opened&&s.state.loaded?" jstree-open":" jstree-closed",t.setAttribute("aria-expanded",s.state.opened&&s.state.loaded)),w===s.id&&(p+=" jstree-last"),t.id=s.id,t.className=p,p=(s.state.selected?" jstree-clicked":"")+(s.state.disabled?" jstree-disabled":"");for(u in s.a_attr)if(s.a_attr.hasOwnProperty(u)){if("href"===u&&"#"===s.a_attr[u])continue;"class"!==u?t.childNodes[1].setAttribute(u,s.a_attr[u]):p+=" "+s.a_attr[u]}if(p.length&&(t.childNodes[1].className="jstree-anchor "+p),(s.icon&&s.icon!==!0||s.icon===!1)&&(s.icon===!1?t.childNodes[1].childNodes[0].className+=" jstree-themeicon-hidden":-1===s.icon.indexOf("/")&&-1===s.icon.indexOf(".")?t.childNodes[1].childNodes[0].className+=" "+s.icon+" jstree-themeicon-custom":(t.childNodes[1].childNodes[0].style.backgroundImage="url("+s.icon+")",t.childNodes[1].childNodes[0].style.backgroundPosition="center center",t.childNodes[1].childNodes[0].style.backgroundSize="auto",t.childNodes[1].childNodes[0].className+=" jstree-themeicon-custom")),this.settings.core.force_text?t.childNodes[1].appendChild(m.createTextNode(s.text)):t.childNodes[1].innerHTML+=s.text,i&&s.children.length&&(s.state.opened||r)&&s.state.loaded){for(f=m.createElement("UL"),f.setAttribute("role","group"),f.className="jstree-children",c=0,u=s.children.length;u>c;c++)f.appendChild(this.redraw_node(s.children[c],i,!0));t.appendChild(f)}if(l&&t.appendChild(l),!n){for(a||(a=this.element[0]),c=0,u=a.childNodes.length;u>c;c++)if(a.childNodes[c]&&a.childNodes[c].className&&-1!==a.childNodes[c].className.indexOf("jstree-children")){_=a.childNodes[c];break}_||(_=m.createElement("UL"),_.setAttribute("role","group"),_.className="jstree-children",a.appendChild(_)),a=_,o<a.childNodes.length?a.insertBefore(t,a.childNodes[o]):a.appendChild(t),v&&(y=this.element[0].scrollTop,b=this.element[0].scrollLeft,t.childNodes[1].focus(),this.element[0].scrollTop=y,this.element[0].scrollLeft=b)}return s.state.opened&&!s.state.loaded&&(s.state.opened=!1,setTimeout(e.proxy(function(){this.open_node(s.id,!1,0)},this),0)),t},open_node:function(i,n,r){var s,a,o,l;if(e.isArray(i)){for(i=i.slice(),s=0,a=i.length;a>s;s++)this.open_node(i[s],n,r);return!0}return i=this.get_node(i),!(!i||i.id===e.jstree.root)&&(r=r===t?this.settings.core.animation:r,this.is_closed(i)?this.is_loaded(i)?(o=this.get_node(i,!0),l=this,o.length&&(r&&o.children(".jstree-children").length&&o.children(".jstree-children").stop(!0,!0),i.children.length&&!this._firstChild(o.children(".jstree-children")[0])&&this.draw_children(i),r?(this.trigger("before_open",{node:i}),o.children(".jstree-children").css("display","none").end().removeClass("jstree-closed").addClass("jstree-open").attr("aria-expanded",!0).children(".jstree-children").stop(!0,!0).slideDown(r,function(){this.style.display="",l.trigger("after_open",{node:i})})):(this.trigger("before_open",{node:i}),o[0].className=o[0].className.replace("jstree-closed","jstree-open"),o[0].setAttribute("aria-expanded",!0))),i.state.opened=!0,n&&n.call(this,i,!0),o.length||this.trigger("before_open",{node:i}),this.trigger("open_node",{node:i}),r&&o.length||this.trigger("after_open",{node:i}),!0):this.is_loading(i)?setTimeout(e.proxy(function(){this.open_node(i,n,r)},this),500):void this.load_node(i,function(e,t){return t?this.open_node(e,n,r):!!n&&n.call(this,e,!1)}):(n&&n.call(this,i,!1),!1))},_open_to:function(t){if(t=this.get_node(t),!t||t.id===e.jstree.root)return!1;var i,n,r=t.parents;for(i=0,n=r.length;n>i;i+=1)i!==e.jstree.root&&this.open_node(r[i],!1,0);return e("#"+t.id.replace(e.jstree.idregex,"\\$&"),this.element)},close_node:function(i,n){var r,s,a,o;if(e.isArray(i)){for(i=i.slice(),r=0,s=i.length;s>r;r++)this.close_node(i[r],n);return!0}return i=this.get_node(i),!(!i||i.id===e.jstree.root)&&(!this.is_closed(i)&&(n=n===t?this.settings.core.animation:n,a=this,o=this.get_node(i,!0),o.length&&(n?o.children(".jstree-children").attr("style","display:block !important").end().removeClass("jstree-open").addClass("jstree-closed").attr("aria-expanded",!1).children(".jstree-children").stop(!0,!0).slideUp(n,function(){this.style.display="",o.children(".jstree-children").remove(),a.trigger("after_close",{node:i})}):(o[0].className=o[0].className.replace("jstree-open","jstree-closed"),o.attr("aria-expanded",!1).children(".jstree-children").remove())),i.state.opened=!1,this.trigger("close_node",{node:i}),void(n&&o.length||this.trigger("after_close",{node:i}))))},toggle_node:function(t){var i,n;if(e.isArray(t)){for(t=t.slice(),i=0,n=t.length;n>i;i++)this.toggle_node(t[i]);return!0}return this.is_closed(t)?this.open_node(t):this.is_open(t)?this.close_node(t):void 0},open_all:function(t,i,n){if(t||(t=e.jstree.root),t=this.get_node(t),!t)return!1;var r,s,a,o=t.id===e.jstree.root?this.get_container_ul():this.get_node(t,!0);if(!o.length){for(r=0,s=t.children_d.length;s>r;r++)this.is_closed(this._model.data[t.children_d[r]])&&(this._model.data[t.children_d[r]].state.opened=!0);return this.trigger("open_all",{node:t})}n=n||o,a=this,o=this.is_closed(t)?o.find(".jstree-closed").addBack():o.find(".jstree-closed"),o.each(function(){a.open_node(this,function(e,t){t&&this.is_parent(e)&&this.open_all(e,i,n)},i||0)}),0===n.find(".jstree-closed").length&&this.trigger("open_all",{node:this.get_node(n)})},close_all:function(t,i){if(t||(t=e.jstree.root),t=this.get_node(t),!t)return!1;var n,r,s=t.id===e.jstree.root?this.get_container_ul():this.get_node(t,!0),a=this;for(s.length&&(s=this.is_open(t)?s.find(".jstree-open").addBack():s.find(".jstree-open"),e(s.get().reverse()).each(function(){a.close_node(this,i||0)})),n=0,r=t.children_d.length;r>n;n++)this._model.data[t.children_d[n]].state.opened=!1;this.trigger("close_all",{node:t})},is_disabled:function(e){return e=this.get_node(e),e&&e.state&&e.state.disabled},enable_node:function(t){var i,n;if(e.isArray(t)){for(t=t.slice(),i=0,n=t.length;n>i;i++)this.enable_node(t[i]);return!0}return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&(t.state.disabled=!1,this.get_node(t,!0).children(".jstree-anchor").removeClass("jstree-disabled").attr("aria-disabled",!1),void this.trigger("enable_node",{node:t}))},disable_node:function(t){var i,n;if(e.isArray(t)){for(t=t.slice(),i=0,n=t.length;n>i;i++)this.disable_node(t[i]);return!0}return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&(t.state.disabled=!0,this.get_node(t,!0).children(".jstree-anchor").addClass("jstree-disabled").attr("aria-disabled",!0),void this.trigger("disable_node",{node:t}))},hide_node:function(t,i){var n,r;if(e.isArray(t)){for(t=t.slice(),n=0,r=t.length;r>n;n++)this.hide_node(t[n],!0);return this.redraw(),!0}return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&void(t.state.hidden||(t.state.hidden=!0,this._node_changed(t.parent),i||this.redraw(),this.trigger("hide_node",{node:t})))},show_node:function(t,i){var n,r;if(e.isArray(t)){for(t=t.slice(),n=0,r=t.length;r>n;n++)this.show_node(t[n],!0);return this.redraw(),!0}return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&void(t.state.hidden&&(t.state.hidden=!1,this._node_changed(t.parent),i||this.redraw(),this.trigger("show_node",{node:t})))},hide_all:function(t){var i,n=this._model.data,r=[];for(i in n)n.hasOwnProperty(i)&&i!==e.jstree.root&&!n[i].state.hidden&&(n[i].state.hidden=!0,r.push(i));return this._model.force_full_redraw=!0,t||this.redraw(),this.trigger("hide_all",{nodes:r}),r},show_all:function(t){var i,n=this._model.data,r=[];for(i in n)n.hasOwnProperty(i)&&i!==e.jstree.root&&n[i].state.hidden&&(n[i].state.hidden=!1,r.push(i));return this._model.force_full_redraw=!0,t||this.redraw(),this.trigger("show_all",{nodes:r}),r},activate_node:function(e,i){if(this.is_disabled(e))return!1;if(i&&"object"==typeof i||(i={}),this._data.core.last_clicked=this._data.core.last_clicked&&this._data.core.last_clicked.id!==t?this.get_node(this._data.core.last_clicked.id):null,this._data.core.last_clicked&&!this._data.core.last_clicked.state.selected&&(this._data.core.last_clicked=null),!this._data.core.last_clicked&&this._data.core.selected.length&&(this._data.core.last_clicked=this.get_node(this._data.core.selected[this._data.core.selected.length-1])),this.settings.core.multiple&&(i.metaKey||i.ctrlKey||i.shiftKey)&&(!i.shiftKey||this._data.core.last_clicked&&this.get_parent(e)&&this.get_parent(e)===this._data.core.last_clicked.parent))if(i.shiftKey){var n,r,s=this.get_node(e).id,a=this._data.core.last_clicked.id,o=this.get_node(this._data.core.last_clicked.parent).children,l=!1;for(n=0,r=o.length;r>n;n+=1)o[n]===s&&(l=!l),o[n]===a&&(l=!l),this.is_disabled(o[n])||!l&&o[n]!==s&&o[n]!==a?this.deselect_node(o[n],!0,i):this.select_node(o[n],!0,!1,i);this.trigger("changed",{action:"select_node",node:this.get_node(e),selected:this._data.core.selected,event:i})}else this.is_selected(e)?this.deselect_node(e,!1,i):this.select_node(e,!1,!1,i);else!this.settings.core.multiple&&(i.metaKey||i.ctrlKey||i.shiftKey)&&this.is_selected(e)?this.deselect_node(e,!1,i):(this.deselect_all(!0),this.select_node(e,!1,!1,i),this._data.core.last_clicked=this.get_node(e));this.trigger("activate_node",{node:this.get_node(e),event:i})},hover_node:function(e){if(e=this.get_node(e,!0),!e||!e.length||e.children(".jstree-hovered").length)return!1;var t=this.element.find(".jstree-hovered"),i=this.element;t&&t.length&&this.dehover_node(t),e.children(".jstree-anchor").addClass("jstree-hovered"),this.trigger("hover_node",{node:this.get_node(e)}),setTimeout(function(){i.attr("aria-activedescendant",e[0].id)},0)},dehover_node:function(e){return e=this.get_node(e,!0),!!(e&&e.length&&e.children(".jstree-hovered").length)&&(e.children(".jstree-anchor").removeClass("jstree-hovered"),void this.trigger("dehover_node",{node:this.get_node(e)}))},select_node:function(t,i,n,r){var s,a,o;if(e.isArray(t)){for(t=t.slice(),a=0,o=t.length;o>a;a++)this.select_node(t[a],i,n,r);return!0}return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&(s=this.get_node(t,!0),void(t.state.selected||(t.state.selected=!0,this._data.core.selected.push(t.id),n||(s=this._open_to(t)),s&&s.length&&s.attr("aria-selected",!0).children(".jstree-anchor").addClass("jstree-clicked"),this.trigger("select_node",{node:t,selected:this._data.core.selected,event:r}),i||this.trigger("changed",{action:"select_node",node:t,selected:this._data.core.selected,event:r}))))},deselect_node:function(t,i,n){var r,s,a;if(e.isArray(t)){for(t=t.slice(),r=0,s=t.length;s>r;r++)this.deselect_node(t[r],i,n);return!0}return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&(a=this.get_node(t,!0),void(t.state.selected&&(t.state.selected=!1,this._data.core.selected=e.vakata.array_remove_item(this._data.core.selected,t.id),a.length&&a.attr("aria-selected",!1).children(".jstree-anchor").removeClass("jstree-clicked"),this.trigger("deselect_node",{node:t,selected:this._data.core.selected,event:n}),i||this.trigger("changed",{action:"deselect_node",node:t,selected:this._data.core.selected,event:n}))))},select_all:function(t){var i,n,r=this._data.core.selected.concat([]);for(this._data.core.selected=this._model.data[e.jstree.root].children_d.concat(),i=0,n=this._data.core.selected.length;n>i;i++)this._model.data[this._data.core.selected[i]]&&(this._model.data[this._data.core.selected[i]].state.selected=!0);this.redraw(!0),this.trigger("select_all",{selected:this._data.core.selected}),t||this.trigger("changed",{action:"select_all",selected:this._data.core.selected,old_selection:r})},deselect_all:function(e){var t,i,n=this._data.core.selected.concat([]);for(t=0,i=this._data.core.selected.length;i>t;t++)this._model.data[this._data.core.selected[t]]&&(this._model.data[this._data.core.selected[t]].state.selected=!1);this._data.core.selected=[],this.element.find(".jstree-clicked").removeClass("jstree-clicked").parent().attr("aria-selected",!1),this.trigger("deselect_all",{selected:this._data.core.selected,node:n}),e||this.trigger("changed",{action:"deselect_all",selected:this._data.core.selected,old_selection:n})},is_selected:function(t){return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&t.state.selected},get_selected:function(t){return t?e.map(this._data.core.selected,e.proxy(function(e){return this.get_node(e)},this)):this._data.core.selected.slice()},get_top_selected:function(t){var i,n,r,s,a=this.get_selected(!0),o={};for(i=0,n=a.length;n>i;i++)o[a[i].id]=a[i];for(i=0,n=a.length;n>i;i++)for(r=0,s=a[i].children_d.length;s>r;r++)o[a[i].children_d[r]]&&delete o[a[i].children_d[r]];a=[];for(i in o)o.hasOwnProperty(i)&&a.push(i);return t?e.map(a,e.proxy(function(e){return this.get_node(e)},this)):a},get_bottom_selected:function(t){var i,n,r=this.get_selected(!0),s=[];for(i=0,n=r.length;n>i;i++)r[i].children.length||s.push(r[i].id);return t?e.map(s,e.proxy(function(e){return this.get_node(e)},this)):s},get_state:function(){var t,i={core:{open:[],scroll:{left:this.element.scrollLeft(),top:this.element.scrollTop()},selected:[]}};for(t in this._model.data)this._model.data.hasOwnProperty(t)&&t!==e.jstree.root&&(this._model.data[t].state.opened&&i.core.open.push(t),this._model.data[t].state.selected&&i.core.selected.push(t));return i},set_state:function(i,n){if(i){if(i.core){var r,s;if(i.core.open)return e.isArray(i.core.open)&&i.core.open.length?this._load_nodes(i.core.open,function(e){this.open_node(e,!1,0),delete i.core.open,this.set_state(i,n)},!0):(delete i.core.open,this.set_state(i,n)),!1;if(i.core.scroll)return i.core.scroll&&i.core.scroll.left!==t&&this.element.scrollLeft(i.core.scroll.left),i.core.scroll&&i.core.scroll.top!==t&&this.element.scrollTop(i.core.scroll.top),delete i.core.scroll,this.set_state(i,n),!1;if(i.core.selected)return r=this,this.deselect_all(),e.each(i.core.selected,function(e,t){r.select_node(t,!1,!0)}),delete i.core.selected,this.set_state(i,n),!1;for(s in i)i.hasOwnProperty(s)&&"core"!==s&&-1===e.inArray(s,this.settings.plugins)&&delete i[s];if(e.isEmptyObject(i.core))return delete i.core,this.set_state(i,n),!1}return!e.isEmptyObject(i)||(i=null,n&&n.call(this),this.trigger("set_state"),!1)}return!1},refresh:function(t,i){this._data.core.state=i===!0?{}:this.get_state(),i&&e.isFunction(i)&&(this._data.core.state=i.call(this,this._data.core.state)),this._cnt=0,this._model.data={},this._model.data[e.jstree.root]={id:e.jstree.root,parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}},this._data.core.selected=[],this._data.core.last_clicked=null,this._data.core.focused=null;var n=this.get_container_ul()[0].className;t||(this.element.html("<ul class='"+n+"' role='group'><li class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='treeitem' id='j"+this._id+"_loading'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>"),this.element.attr("aria-activedescendant","j"+this._id+"_loading")),this.load_node(e.jstree.root,function(t,i){i&&(this.get_container_ul()[0].className=n,this._firstChild(this.get_container_ul()[0])&&this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id),this.set_state(e.extend(!0,{},this._data.core.state),function(){this.trigger("refresh")})),this._data.core.state=null})},refresh_node:function(t){if(t=this.get_node(t),!t||t.id===e.jstree.root)return!1;var i=[],n=[];this._data.core.selected.concat([]);n.push(t.id),t.state.opened===!0&&i.push(t.id),this.get_node(t,!0).find(".jstree-open").each(function(){i.push(this.id)}),this._load_nodes(n,e.proxy(function(e){this.open_node(i,!1,0),this.select_node(this._data.core.selected),this.trigger("refresh_node",{node:t,nodes:e})},this))},set_id:function(t,i){if(t=this.get_node(t),!t||t.id===e.jstree.root)return!1;var n,r,s=this._model.data;for(i=i.toString(),s[t.parent].children[e.inArray(t.id,s[t.parent].children)]=i,n=0,r=t.parents.length;r>n;n++)s[t.parents[n]].children_d[e.inArray(t.id,s[t.parents[n]].children_d)]=i;for(n=0,r=t.children.length;r>n;n++)s[t.children[n]].parent=i;for(n=0,r=t.children_d.length;r>n;n++)s[t.children_d[n]].parents[e.inArray(t.id,s[t.children_d[n]].parents)]=i;return n=e.inArray(t.id,this._data.core.selected),-1!==n&&(this._data.core.selected[n]=i),n=this.get_node(t.id,!0),n&&(n.attr("id",i).children(".jstree-anchor").attr("id",i+"_anchor").end().attr("aria-labelledby",i+"_anchor"),this.element.attr("aria-activedescendant")===t.id&&this.element.attr("aria-activedescendant",i)),delete s[t.id],t.id=i,t.li_attr.id=i,s[i]=t,!0},get_text:function(t){return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&t.text},set_text:function(t,i){var n,r;if(e.isArray(t)){for(t=t.slice(),n=0,r=t.length;r>n;n++)this.set_text(t[n],i);return!0}return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&(t.text=i,this.get_node(t,!0).length&&this.redraw_node(t.id),this.trigger("set_text",{obj:t,text:i}),!0)},get_json:function(t,i,n){if(t=this.get_node(t||e.jstree.root),!t)return!1;i&&i.flat&&!n&&(n=[]);var r,s,a={id:t.id,text:t.text,icon:this.get_icon(t),li_attr:e.extend(!0,{},t.li_attr),a_attr:e.extend(!0,{},t.a_attr),state:{},data:(!i||!i.no_data)&&e.extend(!0,{},t.data)};if(i&&i.flat?a.parent=t.parent:a.children=[],!i||!i.no_state)for(r in t.state)t.state.hasOwnProperty(r)&&(a.state[r]=t.state[r]);if(i&&i.no_id&&(delete a.id,a.li_attr&&a.li_attr.id&&delete a.li_attr.id,a.a_attr&&a.a_attr.id&&delete a.a_attr.id),i&&i.flat&&t.id!==e.jstree.root&&n.push(a),!i||!i.no_children)for(r=0,s=t.children.length;s>r;r++)i&&i.flat?this.get_json(t.children[r],i,n):a.children.push(this.get_json(t.children[r],i));return i&&i.flat?n:t.id===e.jstree.root?a.children:a},create_node:function(i,n,r,s,a){if(null===i&&(i=e.jstree.root),i=this.get_node(i),!i)return!1;if(r=r===t?"last":r,!r.toString().match(/^(before|after)$/)&&!a&&!this.is_loaded(i))return this.load_node(i,function(){this.create_node(i,n,r,s,!0)});n||(n={text:this.get_string("New node")}),"string"==typeof n&&(n={text:n}),n.text===t&&(n.text=this.get_string("New node"));var o,l,c,d;switch(i.id===e.jstree.root&&("before"===r&&(r="first"),"after"===r&&(r="last")),r){case"before":o=this.get_node(i.parent),r=e.inArray(i.id,o.children),i=o;break;case"after":o=this.get_node(i.parent),r=e.inArray(i.id,o.children)+1,i=o;break;case"inside":case"first":r=0;break;case"last":r=i.children.length;break;default:r||(r=0)}if(r>i.children.length&&(r=i.children.length),n.id||(n.id=!0),!this.check("create_node",n,i,r))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(n.id===!0&&delete n.id,n=this._parse_model_from_json(n,i.id,i.parents.concat()),!n)return!1;for(o=this.get_node(n),l=[],l.push(n),l=l.concat(o.children_d),this.trigger("model",{nodes:l,parent:i.id}),i.children_d=i.children_d.concat(l),c=0,d=i.parents.length;d>c;c++)this._model.data[i.parents[c]].children_d=this._model.data[i.parents[c]].children_d.concat(l);for(n=o,o=[],c=0,d=i.children.length;d>c;c++)o[c>=r?c+1:c]=i.children[c];return o[r]=n.id,i.children=o,this.redraw_node(i,!0),s&&s.call(this,this.get_node(n)),this.trigger("create_node",{node:this.get_node(n),parent:i.id,position:r}),n.id},rename_node:function(t,i){var n,r,s;if(e.isArray(t)){for(t=t.slice(),n=0,r=t.length;r>n;n++)this.rename_node(t[n],i);return!0}return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&(s=t.text,this.check("rename_node",t,this.get_parent(t),i)?(this.set_text(t,i),this.trigger("rename_node",{node:t,text:i,old:s}),!0):(this.settings.core.error.call(this,this._data.core.last_error),!1))},delete_node:function(t){var i,n,r,s,a,o,l,c,d,h,u,f;if(e.isArray(t)){for(t=t.slice(),i=0,n=t.length;n>i;i++)this.delete_node(t[i]);return!0}if(t=this.get_node(t),!t||t.id===e.jstree.root)return!1;if(r=this.get_node(t.parent),s=e.inArray(t.id,r.children),h=!1,!this.check("delete_node",t,r,s))return this.settings.core.error.call(this,this._data.core.last_error),!1;for(-1!==s&&(r.children=e.vakata.array_remove(r.children,s)),a=t.children_d.concat([]),a.push(t.id),c=0,d=a.length;d>c;c++){for(o=0,l=t.parents.length;l>o;o++)s=e.inArray(a[c],this._model.data[t.parents[o]].children_d),-1!==s&&(this._model.data[t.parents[o]].children_d=e.vakata.array_remove(this._model.data[t.parents[o]].children_d,s));this._model.data[a[c]].state.selected&&(h=!0,s=e.inArray(a[c],this._data.core.selected),-1!==s&&(this._data.core.selected=e.vakata.array_remove(this._data.core.selected,s)))}for(this.trigger("delete_node",{node:t,parent:r.id}),h&&this.trigger("changed",{action:"delete_node",node:t,selected:this._data.core.selected,parent:r.id}),c=0,d=a.length;d>c;c++)delete this._model.data[a[c]];return-1!==e.inArray(this._data.core.focused,a)&&(this._data.core.focused=null,u=this.element[0].scrollTop,f=this.element[0].scrollLeft,r.id===e.jstree.root?this.get_node(this._model.data[e.jstree.root].children[0],!0).children(".jstree-anchor").focus():this.get_node(r,!0).children(".jstree-anchor").focus(),this.element[0].scrollTop=u,this.element[0].scrollLeft=f),this.redraw_node(r,!0),!0},check:function(t,i,n,r,s){i=i&&i.id?i:this.get_node(i),n=n&&n.id?n:this.get_node(n);var a=t.match(/^move_node|copy_node|create_node$/i)?n:i,o=this.settings.core.check_callback;return"move_node"!==t&&"copy_node"!==t||s&&s.is_multi||i.id!==n.id&&e.inArray(i.id,n.children)!==r&&-1===e.inArray(n.id,i.children_d)?(a&&a.data&&(a=a.data),a&&a.functions&&(a.functions[t]===!1||a.functions[t]===!0)?(a.functions[t]===!1&&(this._data.core.last_error={error:"check",plugin:"core",id:"core_02",reason:"Node data prevents function: "+t,data:JSON.stringify({chk:t,pos:r,obj:!(!i||!i.id)&&i.id,par:!(!n||!n.id)&&n.id})}),a.functions[t]):!(o===!1||e.isFunction(o)&&o.call(this,t,i,n,r,s)===!1||o&&o[t]===!1)||(this._data.core.last_error={error:"check",plugin:"core",id:"core_03",reason:"User config for core.check_callback prevents function: "+t,data:JSON.stringify({chk:t,pos:r,obj:!(!i||!i.id)&&i.id,par:!(!n||!n.id)&&n.id})},!1)):(this._data.core.last_error={error:"check",plugin:"core",id:"core_01",reason:"Moving parent inside child",data:JSON.stringify({chk:t,pos:r,obj:!(!i||!i.id)&&i.id,par:!(!n||!n.id)&&n.id})},!1)},last_error:function(){return this._data.core.last_error},move_node:function(i,n,r,s,a,o,l){var c,d,h,u,f,p,m,g,v,_,y,b,x,w;if(n=this.get_node(n),r=r===t?0:r,!n)return!1;if(!r.toString().match(/^(before|after)$/)&&!a&&!this.is_loaded(n))return this.load_node(n,function(){this.move_node(i,n,r,s,!0,!1,l)});if(e.isArray(i)){if(1!==i.length){for(c=0,d=i.length;d>c;c++)(v=this.move_node(i[c],n,r,s,a,!1,l))&&(n=v,r="after");return this.redraw(),!0}i=i[0]}if(i=i&&i.id?i:this.get_node(i),!i||i.id===e.jstree.root)return!1;if(h=(i.parent||e.jstree.root).toString(),f=r.toString().match(/^(before|after)$/)&&n.id!==e.jstree.root?this.get_node(n.parent):n,p=l?l:this._model.data[i.id]?this:e.jstree.reference(i.id),m=!p||!p._id||this._id!==p._id,u=p&&p._id&&h&&p._model.data[h]&&p._model.data[h].children?e.inArray(i.id,p._model.data[h].children):-1,p&&p._id&&(i=p._model.data[i.id]),m)return!!(v=this.copy_node(i,n,r,s,a,!1,l))&&(p&&p.delete_node(i),v);switch(n.id===e.jstree.root&&("before"===r&&(r="first"),"after"===r&&(r="last")),r){case"before":r=e.inArray(n.id,f.children);break;case"after":r=e.inArray(n.id,f.children)+1;break;case"inside":case"first":r=0;break;case"last":r=f.children.length;break;default:r||(r=0)}if(r>f.children.length&&(r=f.children.length),!this.check("move_node",i,f,r,{core:!0,origin:l,is_multi:p&&p._id&&p._id!==this._id,is_foreign:!p||!p._id}))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(i.parent===f.id){for(g=f.children.concat(),v=e.inArray(i.id,g),-1!==v&&(g=e.vakata.array_remove(g,v),r>v&&r--),v=[],_=0,y=g.length;y>_;_++)v[_>=r?_+1:_]=g[_];v[r]=i.id,f.children=v,this._node_changed(f.id),this.redraw(f.id===e.jstree.root)}else{for(v=i.children_d.concat(),v.push(i.id),_=0,y=i.parents.length;y>_;_++){for(g=[],w=p._model.data[i.parents[_]].children_d,b=0,x=w.length;x>b;b++)-1===e.inArray(w[b],v)&&g.push(w[b]);p._model.data[i.parents[_]].children_d=g}for(p._model.data[h].children=e.vakata.array_remove_item(p._model.data[h].children,i.id),_=0,y=f.parents.length;y>_;_++)this._model.data[f.parents[_]].children_d=this._model.data[f.parents[_]].children_d.concat(v);for(g=[],_=0,y=f.children.length;y>_;_++)g[_>=r?_+1:_]=f.children[_];for(g[r]=i.id,f.children=g,f.children_d.push(i.id),f.children_d=f.children_d.concat(i.children_d),i.parent=f.id,v=f.parents.concat(),v.unshift(f.id),w=i.parents.length,i.parents=v,v=v.concat(),_=0,y=i.children_d.length;y>_;_++)this._model.data[i.children_d[_]].parents=this._model.data[i.children_d[_]].parents.slice(0,-1*w),Array.prototype.push.apply(this._model.data[i.children_d[_]].parents,v);(h===e.jstree.root||f.id===e.jstree.root)&&(this._model.force_full_redraw=!0),this._model.force_full_redraw||(this._node_changed(h),this._node_changed(f.id)),o||this.redraw()}return s&&s.call(this,i,f,r),this.trigger("move_node",{node:i,parent:f.id,position:r,old_parent:h,old_position:u,is_multi:p&&p._id&&p._id!==this._id,is_foreign:!p||!p._id,old_instance:p,new_instance:this}),i.id},copy_node:function(i,n,r,s,a,o,l){var c,d,h,u,f,p,m,g,v,_,y;if(n=this.get_node(n),r=r===t?0:r,!n)return!1;if(!r.toString().match(/^(before|after)$/)&&!a&&!this.is_loaded(n))return this.load_node(n,function(){this.copy_node(i,n,r,s,!0,!1,l)});if(e.isArray(i)){if(1!==i.length){for(c=0,d=i.length;d>c;c++)(u=this.copy_node(i[c],n,r,s,a,!0,l))&&(n=u,r="after");return this.redraw(),!0}i=i[0]}if(i=i&&i.id?i:this.get_node(i),!i||i.id===e.jstree.root)return!1;switch(g=(i.parent||e.jstree.root).toString(),v=r.toString().match(/^(before|after)$/)&&n.id!==e.jstree.root?this.get_node(n.parent):n,_=l?l:this._model.data[i.id]?this:e.jstree.reference(i.id),y=!_||!_._id||this._id!==_._id,_&&_._id&&(i=_._model.data[i.id]),
n.id===e.jstree.root&&("before"===r&&(r="first"),"after"===r&&(r="last")),r){case"before":r=e.inArray(n.id,v.children);break;case"after":r=e.inArray(n.id,v.children)+1;break;case"inside":case"first":r=0;break;case"last":r=v.children.length;break;default:r||(r=0)}if(r>v.children.length&&(r=v.children.length),!this.check("copy_node",i,v,r,{core:!0,origin:l,is_multi:_&&_._id&&_._id!==this._id,is_foreign:!_||!_._id}))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(m=_?_.get_json(i,{no_id:!0,no_data:!0,no_state:!0}):i,!m)return!1;if(m.id===!0&&delete m.id,m=this._parse_model_from_json(m,v.id,v.parents.concat()),!m)return!1;for(u=this.get_node(m),i&&i.state&&i.state.loaded===!1&&(u.state.loaded=!1),h=[],h.push(m),h=h.concat(u.children_d),this.trigger("model",{nodes:h,parent:v.id}),f=0,p=v.parents.length;p>f;f++)this._model.data[v.parents[f]].children_d=this._model.data[v.parents[f]].children_d.concat(h);for(h=[],f=0,p=v.children.length;p>f;f++)h[f>=r?f+1:f]=v.children[f];return h[r]=u.id,v.children=h,v.children_d.push(u.id),v.children_d=v.children_d.concat(u.children_d),v.id===e.jstree.root&&(this._model.force_full_redraw=!0),this._model.force_full_redraw||this._node_changed(v.id),o||this.redraw(v.id===e.jstree.root),s&&s.call(this,u,v,r),this.trigger("copy_node",{node:u,original:i,parent:v.id,position:r,old_parent:g,old_position:_&&_._id&&g&&_._model.data[g]&&_._model.data[g].children?e.inArray(i.id,_._model.data[g].children):-1,is_multi:_&&_._id&&_._id!==this._id,is_foreign:!_||!_._id,old_instance:_,new_instance:this}),u.id},cut:function(t){if(t||(t=this._data.core.selected.concat()),e.isArray(t)||(t=[t]),!t.length)return!1;var i,n,r,l=[];for(n=0,r=t.length;r>n;n++)i=this.get_node(t[n]),i&&i.id&&i.id!==e.jstree.root&&l.push(i);return!!l.length&&(s=l,o=this,a="move_node",void this.trigger("cut",{node:t}))},copy:function(t){if(t||(t=this._data.core.selected.concat()),e.isArray(t)||(t=[t]),!t.length)return!1;var i,n,r,l=[];for(n=0,r=t.length;r>n;n++)i=this.get_node(t[n]),i&&i.id&&i.id!==e.jstree.root&&l.push(i);return!!l.length&&(s=l,o=this,a="copy_node",void this.trigger("copy",{node:t}))},get_buffer:function(){return{mode:a,node:s,inst:o}},can_paste:function(){return a!==!1&&s!==!1},paste:function(e,t){return e=this.get_node(e),!!(e&&a&&a.match(/^(copy_node|move_node)$/)&&s)&&(this[a](s,e,t,!1,!1,!1,o)&&this.trigger("paste",{parent:e.id,node:s,mode:a}),s=!1,a=!1,void(o=!1))},clear_buffer:function(){s=!1,a=!1,o=!1,this.trigger("clear_buffer")},edit:function(t,i,n){var r,s,a,o,l,c,d,h,u,f=!1;return!!(t=this.get_node(t))&&(this.settings.core.check_callback===!1?(this._data.core.last_error={error:"check",plugin:"core",id:"core_07",reason:"Could not edit node because of check_callback"},this.settings.core.error.call(this,this._data.core.last_error),!1):(u=t,i="string"==typeof i?i:t.text,this.set_text(t,""),t=this._open_to(t),u.text=i,r=this._data.core.rtl,s=this.element.width(),this._data.core.focused=u.id,a=t.children(".jstree-anchor").focus(),o=e("<span>"),l=i,c=e("<div />",{css:{position:"absolute",top:"-200px",left:r?"0px":"-1000px",visibility:"hidden"}}).appendTo("body"),d=e("<input />",{value:l,"class":"jstree-rename-input",css:{padding:"0",border:"1px solid silver","box-sizing":"border-box",display:"inline-block",height:this._data.core.li_height+"px",lineHeight:this._data.core.li_height+"px",width:"150px"},blur:e.proxy(function(i){i.stopImmediatePropagation(),i.preventDefault();var r,s=o.children(".jstree-rename-input"),d=s.val(),h=this.settings.core.force_text;""===d&&(d=l),c.remove(),o.replaceWith(a),o.remove(),l=h?l:e("<div></div>").append(e.parseHTML(l)).html(),this.set_text(t,l),r=!!this.rename_node(t,h?e("<div></div>").text(d).text():e("<div></div>").append(e.parseHTML(d)).html()),r||this.set_text(t,l),this._data.core.focused=u.id,setTimeout(e.proxy(function(){var e=this.get_node(u.id,!0);e.length&&(this._data.core.focused=u.id,e.children(".jstree-anchor").focus())},this),0),n&&n.call(this,u,r,f)},this),keydown:function(e){var t=e.which;27===t&&(f=!0,this.value=l),(27===t||13===t||37===t||38===t||39===t||40===t||32===t)&&e.stopImmediatePropagation(),(27===t||13===t)&&(e.preventDefault(),this.blur())},click:function(e){e.stopImmediatePropagation()},mousedown:function(e){e.stopImmediatePropagation()},keyup:function(e){d.width(Math.min(c.text("pW"+this.value).width(),s))},keypress:function(e){return 13!==e.which&&void 0}}),h={fontFamily:a.css("fontFamily")||"",fontSize:a.css("fontSize")||"",fontWeight:a.css("fontWeight")||"",fontStyle:a.css("fontStyle")||"",fontStretch:a.css("fontStretch")||"",fontVariant:a.css("fontVariant")||"",letterSpacing:a.css("letterSpacing")||"",wordSpacing:a.css("wordSpacing")||""},o.attr("class",a.attr("class")).append(a.contents().clone()).append(d),a.replaceWith(o),c.css(h),void d.css(h).width(Math.min(c.text("pW"+d[0].value).width(),s))[0].select()))},set_theme:function(t,i){if(!t)return!1;if(i===!0){var n=this.settings.core.themes.dir;n||(n=e.jstree.path+"/themes"),i=n+"/"+t+"/style.css"}i&&-1===e.inArray(i,l)&&(e("head").append('<link rel="stylesheet" href="'+i+'" type="text/css" />'),l.push(i)),this._data.core.themes.name&&this.element.removeClass("jstree-"+this._data.core.themes.name),this._data.core.themes.name=t,this.element.addClass("jstree-"+t),this.element[this.settings.core.themes.responsive?"addClass":"removeClass"]("jstree-"+t+"-responsive"),this.trigger("set_theme",{theme:t})},get_theme:function(){return this._data.core.themes.name},set_theme_variant:function(e){this._data.core.themes.variant&&this.element.removeClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant),this._data.core.themes.variant=e,e&&this.element.addClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant)},get_theme_variant:function(){return this._data.core.themes.variant},show_stripes:function(){this._data.core.themes.stripes=!0,this.get_container_ul().addClass("jstree-striped")},hide_stripes:function(){this._data.core.themes.stripes=!1,this.get_container_ul().removeClass("jstree-striped")},toggle_stripes:function(){this._data.core.themes.stripes?this.hide_stripes():this.show_stripes()},show_dots:function(){this._data.core.themes.dots=!0,this.get_container_ul().removeClass("jstree-no-dots")},hide_dots:function(){this._data.core.themes.dots=!1,this.get_container_ul().addClass("jstree-no-dots")},toggle_dots:function(){this._data.core.themes.dots?this.hide_dots():this.show_dots()},show_icons:function(){this._data.core.themes.icons=!0,this.get_container_ul().removeClass("jstree-no-icons")},hide_icons:function(){this._data.core.themes.icons=!1,this.get_container_ul().addClass("jstree-no-icons")},toggle_icons:function(){this._data.core.themes.icons?this.hide_icons():this.show_icons()},set_icon:function(i,n){var r,s,a,o;if(e.isArray(i)){for(i=i.slice(),r=0,s=i.length;s>r;r++)this.set_icon(i[r],n);return!0}return i=this.get_node(i),!(!i||i.id===e.jstree.root)&&(o=i.icon,i.icon=n===!0||null===n||n===t||""===n||n,a=this.get_node(i,!0).children(".jstree-anchor").children(".jstree-themeicon"),n===!1?this.hide_icon(i):n===!0||null===n||n===t||""===n?(a.removeClass("jstree-themeicon-custom "+o).css("background","").removeAttr("rel"),o===!1&&this.show_icon(i)):-1===n.indexOf("/")&&-1===n.indexOf(".")?(a.removeClass(o).css("background",""),a.addClass(n+" jstree-themeicon-custom").attr("rel",n),o===!1&&this.show_icon(i)):(a.removeClass(o).css("background",""),a.addClass("jstree-themeicon-custom").css("background","url('"+n+"') center center no-repeat").attr("rel",n),o===!1&&this.show_icon(i)),!0)},get_icon:function(t){return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&t.icon},hide_icon:function(t){var i,n;if(e.isArray(t)){for(t=t.slice(),i=0,n=t.length;n>i;i++)this.hide_icon(t[i]);return!0}return t=this.get_node(t),!(!t||t===e.jstree.root)&&(t.icon=!1,this.get_node(t,!0).children(".jstree-anchor").children(".jstree-themeicon").addClass("jstree-themeicon-hidden"),!0)},show_icon:function(t){var i,n,r;if(e.isArray(t)){for(t=t.slice(),i=0,n=t.length;n>i;i++)this.show_icon(t[i]);return!0}return t=this.get_node(t),!(!t||t===e.jstree.root)&&(r=this.get_node(t,!0),t.icon=!r.length||r.children(".jstree-anchor").children(".jstree-themeicon").attr("rel"),t.icon||(t.icon=!0),r.children(".jstree-anchor").children(".jstree-themeicon").removeClass("jstree-themeicon-hidden"),!0)}},e.vakata={},e.vakata.attributes=function(t,i){t=e(t)[0];var n=i?{}:[];return t&&t.attributes&&e.each(t.attributes,function(t,r){-1===e.inArray(r.name.toLowerCase(),["style","contenteditable","hasfocus","tabindex"])&&null!==r.value&&""!==e.trim(r.value)&&(i?n[r.name]=r.value:n.push(r.name))}),n},e.vakata.array_unique=function(e){var i,n,r=[],s={};for(i=0,n=e.length;n>i;i++)s[e[i]]===t&&(r.push(e[i]),s[e[i]]=!0);return r},e.vakata.array_remove=function(e,t,i){var n=e.slice((i||t)+1||e.length);return e.length=0>t?e.length+t:t,e.push.apply(e,n),e},e.vakata.array_remove_item=function(t,i){var n=e.inArray(i,t);return-1!==n?e.vakata.array_remove(t,n):t},e.jstree.plugins.changed=function(e,t){var i=[];this.trigger=function(e,n){var r,s;if(n||(n={}),"changed"===e.replace(".jstree","")){n.changed={selected:[],deselected:[]};var a={};for(r=0,s=i.length;s>r;r++)a[i[r]]=1;for(r=0,s=n.selected.length;s>r;r++)a[n.selected[r]]?a[n.selected[r]]=2:n.changed.selected.push(n.selected[r]);for(r=0,s=i.length;s>r;r++)1===a[i[r]]&&n.changed.deselected.push(i[r]);i=n.selected.slice()}t.trigger.call(this,e,n)},this.refresh=function(e,n){return i=[],t.refresh.apply(this,arguments)}};var u=d.createElement("I");u.className="jstree-icon jstree-checkbox",u.setAttribute("role","presentation"),e.jstree.defaults.checkbox={visible:!0,three_state:!0,whole_node:!0,keep_selected_style:!0,cascade:"",tie_selection:!0},e.jstree.plugins.checkbox=function(i,n){this.bind=function(){n.bind.call(this),this._data.checkbox.uto=!1,this._data.checkbox.selected=[],this.settings.checkbox.three_state&&(this.settings.checkbox.cascade="up+down+undetermined"),this.element.on("init.jstree",e.proxy(function(){this._data.checkbox.visible=this.settings.checkbox.visible,this.settings.checkbox.keep_selected_style||this.element.addClass("jstree-checkbox-no-clicked"),this.settings.checkbox.tie_selection&&this.element.addClass("jstree-checkbox-selection")},this)).on("loading.jstree",e.proxy(function(){this[this._data.checkbox.visible?"show_checkboxes":"hide_checkboxes"]()},this)),-1!==this.settings.checkbox.cascade.indexOf("undetermined")&&this.element.on("changed.jstree uncheck_node.jstree check_node.jstree uncheck_all.jstree check_all.jstree move_node.jstree copy_node.jstree redraw.jstree open_node.jstree",e.proxy(function(){this._data.checkbox.uto&&clearTimeout(this._data.checkbox.uto),this._data.checkbox.uto=setTimeout(e.proxy(this._undetermined,this),50)},this)),this.settings.checkbox.tie_selection||this.element.on("model.jstree",e.proxy(function(e,t){var i,n,r=this._model.data,s=(r[t.parent],t.nodes);for(i=0,n=s.length;n>i;i++)r[s[i]].state.checked=r[s[i]].state.checked||r[s[i]].original&&r[s[i]].original.state&&r[s[i]].original.state.checked,r[s[i]].state.checked&&this._data.checkbox.selected.push(s[i])},this)),(-1!==this.settings.checkbox.cascade.indexOf("up")||-1!==this.settings.checkbox.cascade.indexOf("down"))&&this.element.on("model.jstree",e.proxy(function(t,i){var n,r,s,a,o,l,c=this._model.data,d=c[i.parent],h=i.nodes,u=[],f=this.settings.checkbox.cascade,p=this.settings.checkbox.tie_selection;if(-1!==f.indexOf("down"))if(d.state[p?"selected":"checked"]){for(r=0,s=h.length;s>r;r++)c[h[r]].state[p?"selected":"checked"]=!0;this._data[p?"core":"checkbox"].selected=this._data[p?"core":"checkbox"].selected.concat(h)}else for(r=0,s=h.length;s>r;r++)if(c[h[r]].state[p?"selected":"checked"]){for(a=0,o=c[h[r]].children_d.length;o>a;a++)c[c[h[r]].children_d[a]].state[p?"selected":"checked"]=!0;this._data[p?"core":"checkbox"].selected=this._data[p?"core":"checkbox"].selected.concat(c[h[r]].children_d)}if(-1!==f.indexOf("up")){for(r=0,s=d.children_d.length;s>r;r++)c[d.children_d[r]].children.length||u.push(c[d.children_d[r]].parent);for(u=e.vakata.array_unique(u),a=0,o=u.length;o>a;a++)for(d=c[u[a]];d&&d.id!==e.jstree.root;){for(n=0,r=0,s=d.children.length;s>r;r++)n+=c[d.children[r]].state[p?"selected":"checked"];if(n!==s)break;d.state[p?"selected":"checked"]=!0,this._data[p?"core":"checkbox"].selected.push(d.id),l=this.get_node(d,!0),l&&l.length&&l.attr("aria-selected",!0).children(".jstree-anchor").addClass(p?"jstree-clicked":"jstree-checked"),d=this.get_node(d.parent)}}this._data[p?"core":"checkbox"].selected=e.vakata.array_unique(this._data[p?"core":"checkbox"].selected)},this)).on(this.settings.checkbox.tie_selection?"select_node.jstree":"check_node.jstree",e.proxy(function(t,i){var n,r,s,a,o=i.node,l=this._model.data,c=this.get_node(o.parent),d=this.get_node(o,!0),h=this.settings.checkbox.cascade,u=this.settings.checkbox.tie_selection;if(-1!==h.indexOf("down"))for(this._data[u?"core":"checkbox"].selected=e.vakata.array_unique(this._data[u?"core":"checkbox"].selected.concat(o.children_d)),n=0,r=o.children_d.length;r>n;n++)a=l[o.children_d[n]],a.state[u?"selected":"checked"]=!0,a&&a.original&&a.original.state&&a.original.state.undetermined&&(a.original.state.undetermined=!1);if(-1!==h.indexOf("up"))for(;c&&c.id!==e.jstree.root;){for(s=0,n=0,r=c.children.length;r>n;n++)s+=l[c.children[n]].state[u?"selected":"checked"];if(s!==r)break;c.state[u?"selected":"checked"]=!0,this._data[u?"core":"checkbox"].selected.push(c.id),a=this.get_node(c,!0),a&&a.length&&a.attr("aria-selected",!0).children(".jstree-anchor").addClass(u?"jstree-clicked":"jstree-checked"),c=this.get_node(c.parent)}-1!==h.indexOf("down")&&d.length&&d.find(".jstree-anchor").addClass(u?"jstree-clicked":"jstree-checked").parent().attr("aria-selected",!0)},this)).on(this.settings.checkbox.tie_selection?"deselect_all.jstree":"uncheck_all.jstree",e.proxy(function(t,i){var n,r,s,a=this.get_node(e.jstree.root),o=this._model.data;for(n=0,r=a.children_d.length;r>n;n++)s=o[a.children_d[n]],s&&s.original&&s.original.state&&s.original.state.undetermined&&(s.original.state.undetermined=!1)},this)).on(this.settings.checkbox.tie_selection?"deselect_node.jstree":"uncheck_node.jstree",e.proxy(function(t,i){var n,r,s,a=i.node,o=this.get_node(a,!0),l=this.settings.checkbox.cascade,c=this.settings.checkbox.tie_selection;if(a&&a.original&&a.original.state&&a.original.state.undetermined&&(a.original.state.undetermined=!1),-1!==l.indexOf("down"))for(n=0,r=a.children_d.length;r>n;n++)s=this._model.data[a.children_d[n]],s.state[c?"selected":"checked"]=!1,s&&s.original&&s.original.state&&s.original.state.undetermined&&(s.original.state.undetermined=!1);if(-1!==l.indexOf("up"))for(n=0,r=a.parents.length;r>n;n++)s=this._model.data[a.parents[n]],s.state[c?"selected":"checked"]=!1,s&&s.original&&s.original.state&&s.original.state.undetermined&&(s.original.state.undetermined=!1),s=this.get_node(a.parents[n],!0),s&&s.length&&s.attr("aria-selected",!1).children(".jstree-anchor").removeClass(c?"jstree-clicked":"jstree-checked");for(s=[],n=0,r=this._data[c?"core":"checkbox"].selected.length;r>n;n++)-1!==l.indexOf("down")&&-1!==e.inArray(this._data[c?"core":"checkbox"].selected[n],a.children_d)||-1!==l.indexOf("up")&&-1!==e.inArray(this._data[c?"core":"checkbox"].selected[n],a.parents)||s.push(this._data[c?"core":"checkbox"].selected[n]);this._data[c?"core":"checkbox"].selected=e.vakata.array_unique(s),-1!==l.indexOf("down")&&o.length&&o.find(".jstree-anchor").removeClass(c?"jstree-clicked":"jstree-checked").parent().attr("aria-selected",!1)},this)),-1!==this.settings.checkbox.cascade.indexOf("up")&&this.element.on("delete_node.jstree",e.proxy(function(t,i){for(var n,r,s,a,o=this.get_node(i.parent),l=this._model.data,c=this.settings.checkbox.tie_selection;o&&o.id!==e.jstree.root&&!o.state[c?"selected":"checked"];){for(s=0,n=0,r=o.children.length;r>n;n++)s+=l[o.children[n]].state[c?"selected":"checked"];if(!(r>0&&s===r))break;o.state[c?"selected":"checked"]=!0,this._data[c?"core":"checkbox"].selected.push(o.id),a=this.get_node(o,!0),a&&a.length&&a.attr("aria-selected",!0).children(".jstree-anchor").addClass(c?"jstree-clicked":"jstree-checked"),o=this.get_node(o.parent)}},this)).on("move_node.jstree",e.proxy(function(t,i){var n,r,s,a,o,l=i.is_multi,c=i.old_parent,d=this.get_node(i.parent),h=this._model.data,u=this.settings.checkbox.tie_selection;if(!l)for(n=this.get_node(c);n&&n.id!==e.jstree.root&&!n.state[u?"selected":"checked"];){for(r=0,s=0,a=n.children.length;a>s;s++)r+=h[n.children[s]].state[u?"selected":"checked"];if(!(a>0&&r===a))break;n.state[u?"selected":"checked"]=!0,this._data[u?"core":"checkbox"].selected.push(n.id),o=this.get_node(n,!0),o&&o.length&&o.attr("aria-selected",!0).children(".jstree-anchor").addClass(u?"jstree-clicked":"jstree-checked"),n=this.get_node(n.parent)}for(n=d;n&&n.id!==e.jstree.root;){for(r=0,s=0,a=n.children.length;a>s;s++)r+=h[n.children[s]].state[u?"selected":"checked"];if(r===a)n.state[u?"selected":"checked"]||(n.state[u?"selected":"checked"]=!0,this._data[u?"core":"checkbox"].selected.push(n.id),o=this.get_node(n,!0),o&&o.length&&o.attr("aria-selected",!0).children(".jstree-anchor").addClass(u?"jstree-clicked":"jstree-checked"));else{if(!n.state[u?"selected":"checked"])break;n.state[u?"selected":"checked"]=!1,this._data[u?"core":"checkbox"].selected=e.vakata.array_remove_item(this._data[u?"core":"checkbox"].selected,n.id),o=this.get_node(n,!0),o&&o.length&&o.attr("aria-selected",!1).children(".jstree-anchor").removeClass(u?"jstree-clicked":"jstree-checked")}n=this.get_node(n.parent)}},this))},this._undetermined=function(){if(null!==this.element){var i,n,r,s,a={},o=this._model.data,l=this.settings.checkbox.tie_selection,c=this._data[l?"core":"checkbox"].selected,d=[],h=this;for(i=0,n=c.length;n>i;i++)if(o[c[i]]&&o[c[i]].parents)for(r=0,s=o[c[i]].parents.length;s>r;r++)a[o[c[i]].parents[r]]===t&&o[c[i]].parents[r]!==e.jstree.root&&(a[o[c[i]].parents[r]]=!0,d.push(o[c[i]].parents[r]));for(this.element.find(".jstree-closed").not(":has(.jstree-children)").each(function(){var l,c=h.get_node(this);if(c.state.loaded){for(i=0,n=c.children_d.length;n>i;i++)if(l=o[c.children_d[i]],!l.state.loaded&&l.original&&l.original.state&&l.original.state.undetermined&&l.original.state.undetermined===!0)for(a[l.id]===t&&l.id!==e.jstree.root&&(a[l.id]=!0,d.push(l.id)),r=0,s=l.parents.length;s>r;r++)a[l.parents[r]]===t&&l.parents[r]!==e.jstree.root&&(a[l.parents[r]]=!0,d.push(l.parents[r]))}else if(c.original&&c.original.state&&c.original.state.undetermined&&c.original.state.undetermined===!0)for(a[c.id]===t&&c.id!==e.jstree.root&&(a[c.id]=!0,d.push(c.id)),r=0,s=c.parents.length;s>r;r++)a[c.parents[r]]===t&&c.parents[r]!==e.jstree.root&&(a[c.parents[r]]=!0,d.push(c.parents[r]))}),this.element.find(".jstree-undetermined").removeClass("jstree-undetermined"),i=0,n=d.length;n>i;i++)o[d[i]].state[l?"selected":"checked"]||(c=this.get_node(d[i],!0),c&&c.length&&c.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-undetermined"))}},this.redraw_node=function(t,i,r,s){if(t=n.redraw_node.apply(this,arguments)){var a,o,l=null,c=null;for(a=0,o=t.childNodes.length;o>a;a++)if(t.childNodes[a]&&t.childNodes[a].className&&-1!==t.childNodes[a].className.indexOf("jstree-anchor")){l=t.childNodes[a];break}l&&(!this.settings.checkbox.tie_selection&&this._model.data[t.id].state.checked&&(l.className+=" jstree-checked"),c=u.cloneNode(!1),this._model.data[t.id].state.checkbox_disabled&&(c.className+=" jstree-checkbox-disabled"),l.insertBefore(c,l.childNodes[0]))}return r||-1===this.settings.checkbox.cascade.indexOf("undetermined")||(this._data.checkbox.uto&&clearTimeout(this._data.checkbox.uto),this._data.checkbox.uto=setTimeout(e.proxy(this._undetermined,this),50)),t},this.show_checkboxes=function(){this._data.core.themes.checkboxes=!0,this.get_container_ul().removeClass("jstree-no-checkboxes")},this.hide_checkboxes=function(){this._data.core.themes.checkboxes=!1,this.get_container_ul().addClass("jstree-no-checkboxes")},this.toggle_checkboxes=function(){this._data.core.themes.checkboxes?this.hide_checkboxes():this.show_checkboxes()},this.is_undetermined=function(t){t=this.get_node(t);var i,n,r=this.settings.checkbox.cascade,s=this.settings.checkbox.tie_selection,a=this._data[s?"core":"checkbox"].selected,o=this._model.data;if(!t||t.state[s?"selected":"checked"]===!0||-1===r.indexOf("undetermined")||-1===r.indexOf("down")&&-1===r.indexOf("up"))return!1;if(!t.state.loaded&&t.original.state.undetermined===!0)return!0;for(i=0,n=t.children_d.length;n>i;i++)if(-1!==e.inArray(t.children_d[i],a)||!o[t.children_d[i]].state.loaded&&o[t.children_d[i]].original.state.undetermined)return!0;return!1},this.disable_checkbox=function(t){var i,n,r;if(e.isArray(t)){for(t=t.slice(),i=0,n=t.length;n>i;i++)this.disable_checkbox(t[i]);return!0}return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&(r=this.get_node(t,!0),void(t.state.checkbox_disabled||(t.state.checkbox_disabled=!0,r&&r.length&&r.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-checkbox-disabled"),this.trigger("disable_checkbox",{node:t}))))},this.enable_checkbox=function(t){var i,n,r;if(e.isArray(t)){for(t=t.slice(),i=0,n=t.length;n>i;i++)this.enable_checkbox(t[i]);return!0}return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&(r=this.get_node(t,!0),void(t.state.checkbox_disabled&&(t.state.checkbox_disabled=!1,r&&r.length&&r.children(".jstree-anchor").children(".jstree-checkbox").removeClass("jstree-checkbox-disabled"),this.trigger("enable_checkbox",{node:t}))))},this.activate_node=function(t,i){return!e(i.target).hasClass("jstree-checkbox-disabled")&&(this.settings.checkbox.tie_selection&&(this.settings.checkbox.whole_node||e(i.target).hasClass("jstree-checkbox"))&&(i.ctrlKey=!0),this.settings.checkbox.tie_selection||!this.settings.checkbox.whole_node&&!e(i.target).hasClass("jstree-checkbox")?n.activate_node.call(this,t,i):!this.is_disabled(t)&&(this.is_checked(t)?this.uncheck_node(t,i):this.check_node(t,i),void this.trigger("activate_node",{node:this.get_node(t)})))},this.check_node=function(t,i){if(this.settings.checkbox.tie_selection)return this.select_node(t,!1,!0,i);var n,r,s;if(e.isArray(t)){for(t=t.slice(),r=0,s=t.length;s>r;r++)this.check_node(t[r],i);return!0}return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&(n=this.get_node(t,!0),void(t.state.checked||(t.state.checked=!0,this._data.checkbox.selected.push(t.id),n&&n.length&&n.children(".jstree-anchor").addClass("jstree-checked"),this.trigger("check_node",{node:t,selected:this._data.checkbox.selected,event:i}))))},this.uncheck_node=function(t,i){if(this.settings.checkbox.tie_selection)return this.deselect_node(t,!1,i);var n,r,s;if(e.isArray(t)){for(t=t.slice(),n=0,r=t.length;r>n;n++)this.uncheck_node(t[n],i);return!0}return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&(s=this.get_node(t,!0),void(t.state.checked&&(t.state.checked=!1,this._data.checkbox.selected=e.vakata.array_remove_item(this._data.checkbox.selected,t.id),s.length&&s.children(".jstree-anchor").removeClass("jstree-checked"),this.trigger("uncheck_node",{node:t,selected:this._data.checkbox.selected,event:i}))))},this.check_all=function(){if(this.settings.checkbox.tie_selection)return this.select_all();var t,i;this._data.checkbox.selected.concat([]);for(this._data.checkbox.selected=this._model.data[e.jstree.root].children_d.concat(),t=0,i=this._data.checkbox.selected.length;i>t;t++)this._model.data[this._data.checkbox.selected[t]]&&(this._model.data[this._data.checkbox.selected[t]].state.checked=!0);this.redraw(!0),this.trigger("check_all",{selected:this._data.checkbox.selected})},this.uncheck_all=function(){if(this.settings.checkbox.tie_selection)return this.deselect_all();var e,t,i=this._data.checkbox.selected.concat([]);for(e=0,t=this._data.checkbox.selected.length;t>e;e++)this._model.data[this._data.checkbox.selected[e]]&&(this._model.data[this._data.checkbox.selected[e]].state.checked=!1);this._data.checkbox.selected=[],this.element.find(".jstree-checked").removeClass("jstree-checked"),this.trigger("uncheck_all",{selected:this._data.checkbox.selected,node:i})},this.is_checked=function(t){return this.settings.checkbox.tie_selection?this.is_selected(t):(t=this.get_node(t),!(!t||t.id===e.jstree.root)&&t.state.checked)},this.get_checked=function(t){return this.settings.checkbox.tie_selection?this.get_selected(t):t?e.map(this._data.checkbox.selected,e.proxy(function(e){return this.get_node(e)},this)):this._data.checkbox.selected},this.get_top_checked=function(t){if(this.settings.checkbox.tie_selection)return this.get_top_selected(t);var i,n,r,s,a=this.get_checked(!0),o={};for(i=0,n=a.length;n>i;i++)o[a[i].id]=a[i];for(i=0,n=a.length;n>i;i++)for(r=0,s=a[i].children_d.length;s>r;r++)o[a[i].children_d[r]]&&delete o[a[i].children_d[r]];a=[];for(i in o)o.hasOwnProperty(i)&&a.push(i);return t?e.map(a,e.proxy(function(e){return this.get_node(e)},this)):a},this.get_bottom_checked=function(t){if(this.settings.checkbox.tie_selection)return this.get_bottom_selected(t);var i,n,r=this.get_checked(!0),s=[];for(i=0,n=r.length;n>i;i++)r[i].children.length||s.push(r[i].id);return t?e.map(s,e.proxy(function(e){return this.get_node(e)},this)):s},this.load_node=function(t,i){var r,s,a,o;if(!e.isArray(t)&&!this.settings.checkbox.tie_selection&&(o=this.get_node(t),o&&o.state.loaded))for(r=0,s=o.children_d.length;s>r;r++)this._model.data[o.children_d[r]].state.checked&&(a=!0,this._data.checkbox.selected=e.vakata.array_remove_item(this._data.checkbox.selected,o.children_d[r]));return n.load_node.apply(this,arguments)},this.get_state=function(){var e=n.get_state.apply(this,arguments);return this.settings.checkbox.tie_selection?e:(e.checkbox=this._data.checkbox.selected.slice(),e)},this.set_state=function(t,i){var r=n.set_state.apply(this,arguments);if(r&&t.checkbox){if(!this.settings.checkbox.tie_selection){this.uncheck_all();var s=this;e.each(t.checkbox,function(e,t){s.check_node(t)})}return delete t.checkbox,this.set_state(t,i),!1}return r},this.refresh=function(e,t){return this.settings.checkbox.tie_selection||(this._data.checkbox.selected=[]),n.refresh.apply(this,arguments)}},e.jstree.defaults.conditionalselect=function(){return!0},e.jstree.plugins.conditionalselect=function(e,t){this.activate_node=function(e,i){this.settings.conditionalselect.call(this,this.get_node(e),i)&&t.activate_node.call(this,e,i)}},e.jstree.defaults.contextmenu={select_node:!0,show_at_node:!0,items:function(t,i){return{create:{separator_before:!1,separator_after:!0,_disabled:!1,label:"Create",action:function(t){var i=e.jstree.reference(t.reference),n=i.get_node(t.reference);i.create_node(n,{},"last",function(e){setTimeout(function(){i.edit(e)},0)})}},rename:{separator_before:!1,separator_after:!1,_disabled:!1,label:"Rename",action:function(t){var i=e.jstree.reference(t.reference),n=i.get_node(t.reference);i.edit(n)}},remove:{separator_before:!1,icon:!1,separator_after:!1,_disabled:!1,label:"Delete",action:function(t){var i=e.jstree.reference(t.reference),n=i.get_node(t.reference);i.is_selected(n)?i.delete_node(i.get_selected()):i.delete_node(n)}},ccp:{separator_before:!0,icon:!1,separator_after:!1,label:"Edit",action:!1,submenu:{cut:{separator_before:!1,separator_after:!1,label:"Cut",action:function(t){var i=e.jstree.reference(t.reference),n=i.get_node(t.reference);i.is_selected(n)?i.cut(i.get_top_selected()):i.cut(n)}},copy:{separator_before:!1,icon:!1,separator_after:!1,label:"Copy",action:function(t){var i=e.jstree.reference(t.reference),n=i.get_node(t.reference);i.is_selected(n)?i.copy(i.get_top_selected()):i.copy(n)}},paste:{separator_before:!1,icon:!1,_disabled:function(t){return!e.jstree.reference(t.reference).can_paste()},separator_after:!1,label:"Paste",action:function(t){var i=e.jstree.reference(t.reference),n=i.get_node(t.reference);i.paste(n)}}}}}}},e.jstree.plugins.contextmenu=function(i,n){this.bind=function(){n.bind.call(this);var t,i,r=0,s=null;this.element.on("contextmenu.jstree",".jstree-anchor",e.proxy(function(e,t){e.preventDefault(),r=e.ctrlKey?+new Date:0,(t||s)&&(r=+new Date+1e4),s&&clearTimeout(s),this.is_loading(e.currentTarget)||this.show_contextmenu(e.currentTarget,e.pageX,e.pageY,e)},this)).on("click.jstree",".jstree-anchor",e.proxy(function(t){this._data.contextmenu.visible&&(!r||+new Date-r>250)&&e.vakata.context.hide(),r=0},this)).on("touchstart.jstree",".jstree-anchor",function(n){n.originalEvent&&n.originalEvent.changedTouches&&n.originalEvent.changedTouches[0]&&(t=n.pageX,i=n.pageY,s=setTimeout(function(){e(n.currentTarget).trigger("contextmenu",!0)},750))}).on("touchmove.vakata.jstree",function(e){s&&e.originalEvent&&e.originalEvent.changedTouches&&e.originalEvent.changedTouches[0]&&(Math.abs(t-e.pageX)>50||Math.abs(i-e.pageY)>50)&&clearTimeout(s)}).on("touchend.vakata.jstree",function(e){s&&clearTimeout(s)}),e(d).on("context_hide.vakata.jstree",e.proxy(function(){this._data.contextmenu.visible=!1},this))},this.teardown=function(){this._data.contextmenu.visible&&e.vakata.context.hide(),n.teardown.call(this)},this.show_contextmenu=function(i,n,r,s){if(i=this.get_node(i),!i||i.id===e.jstree.root)return!1;var a=this.settings.contextmenu,o=this.get_node(i,!0),l=o.children(".jstree-anchor"),c=!1,d=!1;(a.show_at_node||n===t||r===t)&&(c=l.offset(),n=c.left,r=c.top+this._data.core.li_height),this.settings.contextmenu.select_node&&!this.is_selected(i)&&this.activate_node(i,s),d=a.items,e.isFunction(d)&&(d=d.call(this,i,e.proxy(function(e){this._show_contextmenu(i,n,r,e)},this))),e.isPlainObject(d)&&this._show_contextmenu(i,n,r,d)},this._show_contextmenu=function(t,i,n,r){var s=this.get_node(t,!0),a=s.children(".jstree-anchor");e(d).one("context_show.vakata.jstree",e.proxy(function(t,i){var n="jstree-contextmenu jstree-"+this.get_theme()+"-contextmenu";e(i.element).addClass(n)},this)),this._data.contextmenu.visible=!0,e.vakata.context.show(a,{x:i,y:n},r),this.trigger("show_contextmenu",{node:t,x:i,y:n})}},function(e){var t=!1,i={element:!1,reference:!1,position_x:0,position_y:0,items:[],html:"",is_visible:!1};e.vakata.context={settings:{hide_onmouseleave:0,icons:!0},_trigger:function(t){e(d).triggerHandler("context_"+t+".vakata",{reference:i.reference,element:i.element,position:{x:i.position_x,y:i.position_y}})},_execute:function(t){return t=i.items[t],!(!t||t._disabled&&(!e.isFunction(t._disabled)||t._disabled({item:t,reference:i.reference,element:i.element}))||!t.action)&&t.action.call(null,{item:t,reference:i.reference,element:i.element,position:{x:i.position_x,y:i.position_y}})},_parse:function(t,n){if(!t)return!1;n||(i.html="",i.items=[]);var r,s="",a=!1;return n&&(s+="<ul>"),e.each(t,function(t,n){return!n||(i.items.push(n),!a&&n.separator_before&&(s+="<li class='vakata-context-separator'><a href='#' "+(e.vakata.context.settings.icons?"":'style="margin-left:0px;"')+">&#160;</a></li>"),a=!1,s+="<li class='"+(n._class||"")+(n._disabled===!0||e.isFunction(n._disabled)&&n._disabled({item:n,reference:i.reference,element:i.element})?" vakata-contextmenu-disabled ":"")+"' "+(n.shortcut?" data-shortcut='"+n.shortcut+"' ":"")+">",s+="<a href='#' rel='"+(i.items.length-1)+"'>",e.vakata.context.settings.icons&&(s+="<i ",n.icon&&(s+=-1!==n.icon.indexOf("/")||-1!==n.icon.indexOf(".")?" style='background:url(\""+n.icon+"\") center center no-repeat' ":" class='"+n.icon+"' "),s+="></i><span class='vakata-contextmenu-sep'>&#160;</span>"),s+=(e.isFunction(n.label)?n.label({item:t,reference:i.reference,element:i.element}):n.label)+(n.shortcut?' <span class="vakata-contextmenu-shortcut vakata-contextmenu-shortcut-'+n.shortcut+'">'+(n.shortcut_label||"")+"</span>":"")+"</a>",n.submenu&&(r=e.vakata.context._parse(n.submenu,!0),r&&(s+=r)),s+="</li>",void(n.separator_after&&(s+="<li class='vakata-context-separator'><a href='#' "+(e.vakata.context.settings.icons?"":'style="margin-left:0px;"')+">&#160;</a></li>",
a=!0)))}),s=s.replace(/<li class\='vakata-context-separator'\><\/li\>$/,""),n&&(s+="</ul>"),n||(i.html=s,e.vakata.context._trigger("parse")),s.length>10&&s},_show_submenu:function(i){if(i=e(i),i.length&&i.children("ul").length){var n=i.children("ul"),r=i.offset().left+i.outerWidth(),s=i.offset().top,a=n.width(),o=n.height(),l=e(window).width()+e(window).scrollLeft(),c=e(window).height()+e(window).scrollTop();t?i[r-(a+10+i.outerWidth())<0?"addClass":"removeClass"]("vakata-context-left"):i[r+a+10>l?"addClass":"removeClass"]("vakata-context-right"),s+o+10>c&&n.css("bottom","-1px"),n.show()}},show:function(n,r,s){var a,o,l,c,d,h,u,f,p=!0;switch(i.element&&i.element.length&&i.element.width(""),p){case!r&&!n:return!1;case!!r&&!!n:i.reference=n,i.position_x=r.x,i.position_y=r.y;break;case!r&&!!n:i.reference=n,a=n.offset(),i.position_x=a.left+n.outerHeight(),i.position_y=a.top;break;case!!r&&!n:i.position_x=r.x,i.position_y=r.y}n&&!s&&e(n).data("vakata_contextmenu")&&(s=e(n).data("vakata_contextmenu")),e.vakata.context._parse(s)&&i.element.html(i.html),i.items.length&&(i.element.appendTo("body"),o=i.element,l=i.position_x,c=i.position_y,d=o.width(),h=o.height(),u=e(window).width()+e(window).scrollLeft(),f=e(window).height()+e(window).scrollTop(),t&&(l-=o.outerWidth()-e(n).outerWidth(),l<e(window).scrollLeft()+20&&(l=e(window).scrollLeft()+20)),l+d+20>u&&(l=u-(d+20)),c+h+20>f&&(c=f-(h+20)),i.element.css({left:l,top:c}).show().find("a").first().focus().parent().addClass("vakata-context-hover"),i.is_visible=!0,e.vakata.context._trigger("show"))},hide:function(){i.is_visible&&(i.element.hide().find("ul").hide().end().find(":focus").blur().end().detach(),i.is_visible=!1,e.vakata.context._trigger("hide"))}},e(function(){t="rtl"===e("body").css("direction");var n=!1;i.element=e("<ul class='vakata-context'></ul>"),i.element.on("mouseenter","li",function(t){t.stopImmediatePropagation(),e.contains(this,t.relatedTarget)||(n&&clearTimeout(n),i.element.find(".vakata-context-hover").removeClass("vakata-context-hover").end(),e(this).siblings().find("ul").hide().end().end().parentsUntil(".vakata-context","li").addBack().addClass("vakata-context-hover"),e.vakata.context._show_submenu(this))}).on("mouseleave","li",function(t){e.contains(this,t.relatedTarget)||e(this).find(".vakata-context-hover").addBack().removeClass("vakata-context-hover")}).on("mouseleave",function(t){e(this).find(".vakata-context-hover").removeClass("vakata-context-hover"),e.vakata.context.settings.hide_onmouseleave&&(n=setTimeout(function(t){return function(){e.vakata.context.hide()}}(this),e.vakata.context.settings.hide_onmouseleave))}).on("click","a",function(t){t.preventDefault(),e(this).blur().parent().hasClass("vakata-context-disabled")||e.vakata.context._execute(e(this).attr("rel"))===!1||e.vakata.context.hide()}).on("keydown","a",function(t){var n=null;switch(t.which){case 13:case 32:t.type="mouseup",t.preventDefault(),e(t.currentTarget).trigger(t);break;case 37:i.is_visible&&(i.element.find(".vakata-context-hover").last().closest("li").first().find("ul").hide().find(".vakata-context-hover").removeClass("vakata-context-hover").end().end().children("a").focus(),t.stopImmediatePropagation(),t.preventDefault());break;case 38:i.is_visible&&(n=i.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").prevAll("li:not(.vakata-context-separator)").first(),n.length||(n=i.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").last()),n.addClass("vakata-context-hover").children("a").focus(),t.stopImmediatePropagation(),t.preventDefault());break;case 39:i.is_visible&&(i.element.find(".vakata-context-hover").last().children("ul").show().children("li:not(.vakata-context-separator)").removeClass("vakata-context-hover").first().addClass("vakata-context-hover").children("a").focus(),t.stopImmediatePropagation(),t.preventDefault());break;case 40:i.is_visible&&(n=i.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").nextAll("li:not(.vakata-context-separator)").first(),n.length||(n=i.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").first()),n.addClass("vakata-context-hover").children("a").focus(),t.stopImmediatePropagation(),t.preventDefault());break;case 27:e.vakata.context.hide(),t.preventDefault()}}).on("keydown",function(e){e.preventDefault();var t=i.element.find(".vakata-contextmenu-shortcut-"+e.which).parent();t.parent().not(".vakata-context-disabled")&&t.click()}),e(d).on("mousedown.vakata.jstree",function(t){i.is_visible&&!e.contains(i.element[0],t.target)&&e.vakata.context.hide()}).on("context_show.vakata.jstree",function(e,n){i.element.find("li:has(ul)").children("a").addClass("vakata-context-parent"),t&&i.element.addClass("vakata-context-rtl").css("direction","rtl"),i.element.find("ul").hide().end()})})}(e),e.jstree.defaults.dnd={copy:!0,open_timeout:500,is_draggable:!0,check_while_dragging:!0,always_copy:!1,inside_pos:0,drag_selection:!0,touch:!0,large_drop_target:!1,large_drag_target:!1},e.jstree.plugins.dnd=function(t,i){this.bind=function(){i.bind.call(this),this.element.on("mousedown.jstree touchstart.jstree",this.settings.dnd.large_drag_target?".jstree-node":".jstree-anchor",e.proxy(function(t){if(this.settings.dnd.large_drag_target&&e(t.target).closest(".jstree-node")[0]!==t.currentTarget)return!0;if("touchstart"===t.type&&(!this.settings.dnd.touch||"selected"===this.settings.dnd.touch&&!e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").hasClass("jstree-clicked")))return!0;var i=this.get_node(t.target),n=this.is_selected(i)&&this.settings.dnd.drag_selection?this.get_top_selected().length:1,r=n>1?n+" "+this.get_string("nodes"):this.get_text(t.currentTarget);return this.settings.core.force_text&&(r=e.vakata.html.escape(r)),i&&i.id&&i.id!==e.jstree.root&&(1===t.which||"touchstart"===t.type)&&(this.settings.dnd.is_draggable===!0||e.isFunction(this.settings.dnd.is_draggable)&&this.settings.dnd.is_draggable.call(this,n>1?this.get_top_selected(!0):[i],t))?(this.element.trigger("mousedown.jstree"),e.vakata.dnd.start(t,{jstree:!0,origin:this,obj:this.get_node(i,!0),nodes:n>1?this.get_top_selected():[i.id]},'<div id="jstree-dnd" class="jstree-'+this.get_theme()+" jstree-"+this.get_theme()+"-"+this.get_theme_variant()+" "+(this.settings.core.themes.responsive?" jstree-dnd-responsive":"")+'"><i class="jstree-icon jstree-er"></i>'+r+'<ins class="jstree-copy" style="display:none;">+</ins></div>')):void 0},this))}},e(function(){var t=!1,i=!1,n=!1,r=!1,s=e('<div id="jstree-marker">&#160;</div>').hide();e(d).on("dnd_start.vakata.jstree",function(e,i){t=!1,n=!1,i&&i.data&&i.data.jstree&&s.appendTo("body")}).on("dnd_move.vakata.jstree",function(a,o){if(r&&clearTimeout(r),o&&o.data&&o.data.jstree&&(!o.event.target.id||"jstree-marker"!==o.event.target.id)){n=o.event;var l,c,d,h,u,f,p,m,g,v,_,y,b,x,w=e.jstree.reference(o.event.target),k=!1,C=!1,D=!1;if(w&&w._data&&w._data.dnd)if(s.attr("class","jstree-"+w.get_theme()+(w.settings.core.themes.responsive?" jstree-dnd-responsive":"")),o.helper.children().attr("class","jstree-"+w.get_theme()+" jstree-"+w.get_theme()+"-"+w.get_theme_variant()+" "+(w.settings.core.themes.responsive?" jstree-dnd-responsive":"")).find(".jstree-copy").first()[o.data.origin&&(o.data.origin.settings.dnd.always_copy||o.data.origin.settings.dnd.copy&&(o.event.metaKey||o.event.ctrlKey))?"show":"hide"](),o.event.target!==w.element[0]&&o.event.target!==w.get_container_ul()[0]||0!==w.get_container_ul().children().length){if(k=w.settings.dnd.large_drop_target?e(o.event.target).closest(".jstree-node").children(".jstree-anchor"):e(o.event.target).closest(".jstree-anchor"),k&&k.length&&k.parent().is(".jstree-closed, .jstree-open, .jstree-leaf")&&(C=k.offset(),D=o.event.pageY-C.top,d=k.outerHeight(),f=d/3>D?["b","i","a"]:D>d-d/3?["a","i","b"]:D>d/2?["i","a","b"]:["i","b","a"],e.each(f,function(n,a){switch(a){case"b":l=C.left-6,c=C.top,h=w.get_parent(k),u=k.parent().index();break;case"i":b=w.settings.dnd.inside_pos,x=w.get_node(k.parent()),l=C.left-2,c=C.top+d/2+1,h=x.id,u="first"===b?0:"last"===b?x.children.length:Math.min(b,x.children.length);break;case"a":l=C.left-6,c=C.top+d,h=w.get_parent(k),u=k.parent().index()+1}for(p=!0,m=0,g=o.data.nodes.length;g>m;m++)if(v=o.data.origin&&(o.data.origin.settings.dnd.always_copy||o.data.origin.settings.dnd.copy&&(o.event.metaKey||o.event.ctrlKey))?"copy_node":"move_node",_=u,"move_node"===v&&"a"===a&&o.data.origin&&o.data.origin===w&&h===w.get_parent(o.data.nodes[m])&&(y=w.get_node(h),_>e.inArray(o.data.nodes[m],y.children)&&(_-=1)),p=p&&(w&&w.settings&&w.settings.dnd&&w.settings.dnd.check_while_dragging===!1||w.check(v,o.data.origin&&o.data.origin!==w?o.data.origin.get_node(o.data.nodes[m]):o.data.nodes[m],h,_,{dnd:!0,ref:w.get_node(k.parent()),pos:a,origin:o.data.origin,is_multi:o.data.origin&&o.data.origin!==w,is_foreign:!o.data.origin})),!p){w&&w.last_error&&(i=w.last_error());break}return"i"===a&&k.parent().is(".jstree-closed")&&w.settings.dnd.open_timeout&&(r=setTimeout(function(e,t){return function(){e.open_node(t)}}(w,k),w.settings.dnd.open_timeout)),p?(t={ins:w,par:h,pos:"i"!==a||"last"!==b||0!==u||w.is_loaded(x)?u:"last"},s.css({left:l+"px",top:c+"px"}).show(),o.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok"),i={},f=!0,!1):void 0}),f===!0))return}else{for(p=!0,m=0,g=o.data.nodes.length;g>m&&(p=p&&w.check(o.data.origin&&(o.data.origin.settings.dnd.always_copy||o.data.origin.settings.dnd.copy&&(o.event.metaKey||o.event.ctrlKey))?"copy_node":"move_node",o.data.origin&&o.data.origin!==w?o.data.origin.get_node(o.data.nodes[m]):o.data.nodes[m],e.jstree.root,"last",{dnd:!0,ref:w.get_node(e.jstree.root),pos:"i",origin:o.data.origin,is_multi:o.data.origin&&o.data.origin!==w,is_foreign:!o.data.origin}),p);m++);if(p)return t={ins:w,par:e.jstree.root,pos:"last"},s.hide(),void o.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok")}t=!1,o.helper.find(".jstree-icon").removeClass("jstree-ok").addClass("jstree-er"),s.hide()}}).on("dnd_scroll.vakata.jstree",function(e,i){i&&i.data&&i.data.jstree&&(s.hide(),t=!1,n=!1,i.helper.find(".jstree-icon").first().removeClass("jstree-ok").addClass("jstree-er"))}).on("dnd_stop.vakata.jstree",function(a,o){if(r&&clearTimeout(r),o&&o.data&&o.data.jstree){s.hide().detach();var l,c,d=[];if(t){for(l=0,c=o.data.nodes.length;c>l;l++)d[l]=o.data.origin?o.data.origin.get_node(o.data.nodes[l]):o.data.nodes[l];t.ins[o.data.origin&&(o.data.origin.settings.dnd.always_copy||o.data.origin.settings.dnd.copy&&(o.event.metaKey||o.event.ctrlKey))?"copy_node":"move_node"](d,t.par,t.pos,!1,!1,!1,o.data.origin)}else l=e(o.event.target).closest(".jstree"),l.length&&i&&i.error&&"check"===i.error&&(l=l.jstree(!0),l&&l.settings.core.error.call(this,i));n=!1,t=!1}}).on("keyup.jstree keydown.jstree",function(t,i){i=e.vakata.dnd._get(),i&&i.data&&i.data.jstree&&(i.helper.find(".jstree-copy").first()[i.data.origin&&(i.data.origin.settings.dnd.always_copy||i.data.origin.settings.dnd.copy&&(t.metaKey||t.ctrlKey))?"show":"hide"](),n&&(n.metaKey=t.metaKey,n.ctrlKey=t.ctrlKey,e.vakata.dnd._trigger("move",n)))})}),function(e){e.vakata.html={div:e("<div />"),escape:function(t){return e.vakata.html.div.text(t).html()},strip:function(t){return e.vakata.html.div.empty().append(e.parseHTML(t)).text()}};var t={element:!1,target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1};e.vakata.dnd={settings:{scroll_speed:10,scroll_proximity:20,helper_left:5,helper_top:10,threshold:5,threshold_touch:50},_trigger:function(t,i){var n=e.vakata.dnd._get();n.event=i,e(d).triggerHandler("dnd_"+t+".vakata",n)},_get:function(){return{data:t.data,element:t.element,helper:t.helper}},_clean:function(){t.helper&&t.helper.remove(),t.scroll_i&&(clearInterval(t.scroll_i),t.scroll_i=!1),t={element:!1,target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1},e(d).off("mousemove.vakata.jstree touchmove.vakata.jstree",e.vakata.dnd.drag),e(d).off("mouseup.vakata.jstree touchend.vakata.jstree",e.vakata.dnd.stop)},_scroll:function(i){if(!t.scroll_e||!t.scroll_l&&!t.scroll_t)return t.scroll_i&&(clearInterval(t.scroll_i),t.scroll_i=!1),!1;if(!t.scroll_i)return t.scroll_i=setInterval(e.vakata.dnd._scroll,100),!1;if(i===!0)return!1;var n=t.scroll_e.scrollTop(),r=t.scroll_e.scrollLeft();t.scroll_e.scrollTop(n+t.scroll_t*e.vakata.dnd.settings.scroll_speed),t.scroll_e.scrollLeft(r+t.scroll_l*e.vakata.dnd.settings.scroll_speed),(n!==t.scroll_e.scrollTop()||r!==t.scroll_e.scrollLeft())&&e.vakata.dnd._trigger("scroll",t.scroll_e)},start:function(i,n,r){"touchstart"===i.type&&i.originalEvent&&i.originalEvent.changedTouches&&i.originalEvent.changedTouches[0]&&(i.pageX=i.originalEvent.changedTouches[0].pageX,i.pageY=i.originalEvent.changedTouches[0].pageY,i.target=d.elementFromPoint(i.originalEvent.changedTouches[0].pageX-window.pageXOffset,i.originalEvent.changedTouches[0].pageY-window.pageYOffset)),t.is_drag&&e.vakata.dnd.stop({});try{i.currentTarget.unselectable="on",i.currentTarget.onselectstart=function(){return!1},i.currentTarget.style&&(i.currentTarget.style.MozUserSelect="none")}catch(s){}return t.init_x=i.pageX,t.init_y=i.pageY,t.data=n,t.is_down=!0,t.element=i.currentTarget,t.target=i.target,t.is_touch="touchstart"===i.type,r!==!1&&(t.helper=e("<div id='vakata-dnd'></div>").html(r).css({display:"block",margin:"0",padding:"0",position:"absolute",top:"-2000px",lineHeight:"16px",zIndex:"10000"})),e(d).on("mousemove.vakata.jstree touchmove.vakata.jstree",e.vakata.dnd.drag),e(d).on("mouseup.vakata.jstree touchend.vakata.jstree",e.vakata.dnd.stop),!1},drag:function(i){if("touchmove"===i.type&&i.originalEvent&&i.originalEvent.changedTouches&&i.originalEvent.changedTouches[0]&&(i.pageX=i.originalEvent.changedTouches[0].pageX,i.pageY=i.originalEvent.changedTouches[0].pageY,i.target=d.elementFromPoint(i.originalEvent.changedTouches[0].pageX-window.pageXOffset,i.originalEvent.changedTouches[0].pageY-window.pageYOffset)),t.is_down){if(!t.is_drag){if(!(Math.abs(i.pageX-t.init_x)>(t.is_touch?e.vakata.dnd.settings.threshold_touch:e.vakata.dnd.settings.threshold)||Math.abs(i.pageY-t.init_y)>(t.is_touch?e.vakata.dnd.settings.threshold_touch:e.vakata.dnd.settings.threshold)))return;t.helper&&(t.helper.appendTo("body"),t.helper_w=t.helper.outerWidth()),t.is_drag=!0,e.vakata.dnd._trigger("start",i)}var n=!1,r=!1,s=!1,a=!1,o=!1,l=!1,c=!1,h=!1,u=!1,f=!1;return t.scroll_t=0,t.scroll_l=0,t.scroll_e=!1,e(e(i.target).parentsUntil("body").addBack().get().reverse()).filter(function(){return/^auto|scroll$/.test(e(this).css("overflow"))&&(this.scrollHeight>this.offsetHeight||this.scrollWidth>this.offsetWidth)}).each(function(){var n=e(this),r=n.offset();return this.scrollHeight>this.offsetHeight&&(r.top+n.height()-i.pageY<e.vakata.dnd.settings.scroll_proximity&&(t.scroll_t=1),i.pageY-r.top<e.vakata.dnd.settings.scroll_proximity&&(t.scroll_t=-1)),this.scrollWidth>this.offsetWidth&&(r.left+n.width()-i.pageX<e.vakata.dnd.settings.scroll_proximity&&(t.scroll_l=1),i.pageX-r.left<e.vakata.dnd.settings.scroll_proximity&&(t.scroll_l=-1)),t.scroll_t||t.scroll_l?(t.scroll_e=e(this),!1):void 0}),t.scroll_e||(n=e(d),r=e(window),s=n.height(),a=r.height(),o=n.width(),l=r.width(),c=n.scrollTop(),h=n.scrollLeft(),s>a&&i.pageY-c<e.vakata.dnd.settings.scroll_proximity&&(t.scroll_t=-1),s>a&&a-(i.pageY-c)<e.vakata.dnd.settings.scroll_proximity&&(t.scroll_t=1),o>l&&i.pageX-h<e.vakata.dnd.settings.scroll_proximity&&(t.scroll_l=-1),o>l&&l-(i.pageX-h)<e.vakata.dnd.settings.scroll_proximity&&(t.scroll_l=1),(t.scroll_t||t.scroll_l)&&(t.scroll_e=n)),t.scroll_e&&e.vakata.dnd._scroll(!0),t.helper&&(u=parseInt(i.pageY+e.vakata.dnd.settings.helper_top,10),f=parseInt(i.pageX+e.vakata.dnd.settings.helper_left,10),s&&u+25>s&&(u=s-50),o&&f+t.helper_w>o&&(f=o-(t.helper_w+2)),t.helper.css({left:f+"px",top:u+"px"})),e.vakata.dnd._trigger("move",i),!1}},stop:function(i){if("touchend"===i.type&&i.originalEvent&&i.originalEvent.changedTouches&&i.originalEvent.changedTouches[0]&&(i.pageX=i.originalEvent.changedTouches[0].pageX,i.pageY=i.originalEvent.changedTouches[0].pageY,i.target=d.elementFromPoint(i.originalEvent.changedTouches[0].pageX-window.pageXOffset,i.originalEvent.changedTouches[0].pageY-window.pageYOffset)),t.is_drag)e.vakata.dnd._trigger("stop",i);else if("touchend"===i.type&&i.target===t.target){var n=setTimeout(function(){e(i.target).click()},100);e(i.target).one("click",function(){n&&clearTimeout(n)})}return e.vakata.dnd._clean(),!1}}}(e),e.jstree.defaults.massload=null,e.jstree.plugins.massload=function(t,i){this.init=function(e,t){i.init.call(this,e,t),this._data.massload={}},this._load_nodes=function(t,n,r){var s=this.settings.massload;return r&&!e.isEmptyObject(this._data.massload)?i._load_nodes.call(this,t,n,r):e.isFunction(s)?s.call(this,t,e.proxy(function(e){if(e)for(var s in e)e.hasOwnProperty(s)&&(this._data.massload[s]=e[s]);i._load_nodes.call(this,t,n,r)},this)):"object"==typeof s&&s&&s.url?(s=e.extend(!0,{},s),e.isFunction(s.url)&&(s.url=s.url.call(this,t)),e.isFunction(s.data)&&(s.data=s.data.call(this,t)),e.ajax(s).done(e.proxy(function(e,s,a){if(e)for(var o in e)e.hasOwnProperty(o)&&(this._data.massload[o]=e[o]);i._load_nodes.call(this,t,n,r)},this)).fail(e.proxy(function(e){i._load_nodes.call(this,t,n,r)},this))):i._load_nodes.call(this,t,n,r)},this._load_node=function(t,n){var r=this._data.massload[t.id];return r?this["string"==typeof r?"_append_html_data":"_append_json_data"](t,"string"==typeof r?e(e.parseHTML(r)).filter(function(){return 3!==this.nodeType}):r,function(e){n.call(this,e),delete this._data.massload[t.id]}):i._load_node.call(this,t,n)}},e.jstree.defaults.search={ajax:!1,fuzzy:!1,case_sensitive:!1,show_only_matches:!1,show_only_matches_children:!1,close_opened_onclear:!0,search_leaves_only:!1,search_callback:!1},e.jstree.plugins.search=function(i,n){this.bind=function(){n.bind.call(this),this._data.search.str="",this._data.search.dom=e(),this._data.search.res=[],this._data.search.opn=[],this._data.search.som=!1,this._data.search.smc=!1,this._data.search.hdn=[],this.element.on("search.jstree",e.proxy(function(t,i){if(this._data.search.som&&i.res.length){var n,r,s=this._model.data,a=[];for(n=0,r=i.res.length;r>n;n++)s[i.res[n]]&&!s[i.res[n]].state.hidden&&(a.push(i.res[n]),a=a.concat(s[i.res[n]].parents),this._data.search.smc&&(a=a.concat(s[i.res[n]].children_d)));a=e.vakata.array_remove_item(e.vakata.array_unique(a),e.jstree.root),this._data.search.hdn=this.hide_all(!0),this.show_node(a)}},this)).on("clear_search.jstree",e.proxy(function(e,t){this._data.search.som&&t.res.length&&this.show_node(this._data.search.hdn)},this))},this.search=function(i,n,r,s,a,o){if(i===!1||""===e.trim(i.toString()))return this.clear_search();s=this.get_node(s),s=s&&s.id?s.id:null,i=i.toString();var l,c,d=this.settings.search,h=!!d.ajax&&d.ajax,u=this._model.data,f=null,p=[],m=[];if(this._data.search.res.length&&!a&&this.clear_search(),r===t&&(r=d.show_only_matches),o===t&&(o=d.show_only_matches_children),!n&&h!==!1)return e.isFunction(h)?h.call(this,i,e.proxy(function(t){t&&t.d&&(t=t.d),this._load_nodes(e.isArray(t)?e.vakata.array_unique(t):[],function(){this.search(i,!0,r,s,a)},!0)},this),s):(h=e.extend({},h),h.data||(h.data={}),h.data.str=i,s&&(h.data.inside=s),e.ajax(h).fail(e.proxy(function(){this._data.core.last_error={error:"ajax",plugin:"search",id:"search_01",reason:"Could not load search parents",data:JSON.stringify(h)},this.settings.core.error.call(this,this._data.core.last_error)},this)).done(e.proxy(function(t){t&&t.d&&(t=t.d),this._load_nodes(e.isArray(t)?e.vakata.array_unique(t):[],function(){this.search(i,!0,r,s,a)},!0)},this)));if(a||(this._data.search.str=i,this._data.search.dom=e(),this._data.search.res=[],this._data.search.opn=[],this._data.search.som=r,this._data.search.smc=o),f=new e.vakata.search(i,(!0),{caseSensitive:d.case_sensitive,fuzzy:d.fuzzy}),e.each(u[s?s:e.jstree.root].children_d,function(e,t){var n=u[t];n.text&&(!d.search_leaves_only||n.state.loaded&&0===n.children.length)&&(d.search_callback&&d.search_callback.call(this,i,n)||!d.search_callback&&f.search(n.text).isMatch)&&(p.push(t),m=m.concat(n.parents))}),p.length){for(m=e.vakata.array_unique(m),l=0,c=m.length;c>l;l++)m[l]!==e.jstree.root&&u[m[l]]&&this.open_node(m[l],null,0)===!0&&this._data.search.opn.push(m[l]);a?(this._data.search.dom=this._data.search.dom.add(e(this.element[0].querySelectorAll("#"+e.map(p,function(t){return-1!=="0123456789".indexOf(t[0])?"\\3"+t[0]+" "+t.substr(1).replace(e.jstree.idregex,"\\$&"):t.replace(e.jstree.idregex,"\\$&")}).join(", #")))),this._data.search.res=e.vakata.array_unique(this._data.search.res.concat(p))):(this._data.search.dom=e(this.element[0].querySelectorAll("#"+e.map(p,function(t){return-1!=="0123456789".indexOf(t[0])?"\\3"+t[0]+" "+t.substr(1).replace(e.jstree.idregex,"\\$&"):t.replace(e.jstree.idregex,"\\$&")}).join(", #"))),this._data.search.res=p),this._data.search.dom.children(".jstree-anchor").addClass("jstree-search")}this.trigger("search",{nodes:this._data.search.dom,str:i,res:this._data.search.res,show_only_matches:r})},this.clear_search=function(){this.settings.search.close_opened_onclear&&this.close_node(this._data.search.opn,0),this.trigger("clear_search",{nodes:this._data.search.dom,str:this._data.search.str,res:this._data.search.res}),this._data.search.res.length&&(this._data.search.dom=e(this.element[0].querySelectorAll("#"+e.map(this._data.search.res,function(t){return-1!=="0123456789".indexOf(t[0])?"\\3"+t[0]+" "+t.substr(1).replace(e.jstree.idregex,"\\$&"):t.replace(e.jstree.idregex,"\\$&")}).join(", #"))),this._data.search.dom.children(".jstree-anchor").removeClass("jstree-search")),this._data.search.str="",this._data.search.res=[],this._data.search.opn=[],this._data.search.dom=e()},this.redraw_node=function(t,i,r,s){if(t=n.redraw_node.apply(this,arguments),t&&-1!==e.inArray(t.id,this._data.search.res)){var a,o,l=null;for(a=0,o=t.childNodes.length;o>a;a++)if(t.childNodes[a]&&t.childNodes[a].className&&-1!==t.childNodes[a].className.indexOf("jstree-anchor")){l=t.childNodes[a];break}l&&(l.className+=" jstree-search")}return t}},function(e){e.vakata.search=function(t,i,n){n=n||{},n=e.extend({},e.vakata.search.defaults,n),n.fuzzy!==!1&&(n.fuzzy=!0),t=n.caseSensitive?t:t.toLowerCase();var r,s,a,o,l=n.location,c=n.distance,d=n.threshold,h=t.length;return h>32&&(n.fuzzy=!1),n.fuzzy&&(r=1<<h-1,s=function(){var e={},i=0;for(i=0;h>i;i++)e[t.charAt(i)]=0;for(i=0;h>i;i++)e[t.charAt(i)]|=1<<h-i-1;return e}(),a=function(e,t){var i=e/h,n=Math.abs(l-t);return c?i+n/c:n?1:i}),o=function(e){if(e=n.caseSensitive?e:e.toLowerCase(),t===e||-1!==e.indexOf(t))return{isMatch:!0,score:0};if(!n.fuzzy)return{isMatch:!1,score:1};var i,o,c,u,f,p,m,g,v,_=e.length,y=d,b=e.indexOf(t,l),x=h+_,w=1,k=[];for(-1!==b&&(y=Math.min(a(0,b),y),b=e.lastIndexOf(t,l+h),-1!==b&&(y=Math.min(a(0,b),y))),b=-1,i=0;h>i;i++){for(c=0,u=x;u>c;)a(i,l+u)<=y?c=u:x=u,u=Math.floor((x-c)/2+c);for(x=u,p=Math.max(1,l-u+1),m=Math.min(l+u,_)+h,g=new Array(m+2),g[m+1]=(1<<i)-1,o=m;o>=p;o--)if(v=s[e.charAt(o-1)],0===i?g[o]=(g[o+1]<<1|1)&v:g[o]=(g[o+1]<<1|1)&v|((f[o+1]|f[o])<<1|1)|f[o+1],g[o]&r&&(w=a(i,o-1),y>=w)){if(y=w,b=o-1,k.push(b),!(b>l))break;p=Math.max(1,2*l-b)}if(a(i+1,l)>y)break;f=g}return{isMatch:b>=0,score:w}},i===!0?{search:o}:o(i)},e.vakata.search.defaults={location:0,distance:100,threshold:.6,fuzzy:!1,caseSensitive:!1}}(e),e.jstree.defaults.sort=function(e,t){return this.get_text(e)>this.get_text(t)?1:-1},e.jstree.plugins.sort=function(t,i){this.bind=function(){i.bind.call(this),this.element.on("model.jstree",e.proxy(function(e,t){this.sort(t.parent,!0)},this)).on("rename_node.jstree create_node.jstree",e.proxy(function(e,t){this.sort(t.parent||t.node.parent,!1),this.redraw_node(t.parent||t.node.parent,!0)},this)).on("move_node.jstree copy_node.jstree",e.proxy(function(e,t){this.sort(t.parent,!1),this.redraw_node(t.parent,!0)},this))},this.sort=function(t,i){var n,r;if(t=this.get_node(t),t&&t.children&&t.children.length&&(t.children.sort(e.proxy(this.settings.sort,this)),i))for(n=0,r=t.children_d.length;r>n;n++)this.sort(t.children_d[n],!1)}};var f=!1;e.jstree.defaults.state={key:"jstree",events:"changed.jstree open_node.jstree close_node.jstree check_node.jstree uncheck_node.jstree",ttl:!1,filter:!1},e.jstree.plugins.state=function(t,i){this.bind=function(){i.bind.call(this);var t=e.proxy(function(){this.element.on(this.settings.state.events,e.proxy(function(){f&&clearTimeout(f),f=setTimeout(e.proxy(function(){this.save_state()},this),100)},this)),this.trigger("state_ready")},this);this.element.on("ready.jstree",e.proxy(function(e,i){this.element.one("restore_state.jstree",t),this.restore_state()||t()},this))},this.save_state=function(){var t={state:this.get_state(),ttl:this.settings.state.ttl,sec:+new Date};e.vakata.storage.set(this.settings.state.key,JSON.stringify(t))},this.restore_state=function(){var t=e.vakata.storage.get(this.settings.state.key);if(t)try{t=JSON.parse(t)}catch(i){return!1}return!(t&&t.ttl&&t.sec&&+new Date-t.sec>t.ttl)&&(t&&t.state&&(t=t.state),t&&e.isFunction(this.settings.state.filter)&&(t=this.settings.state.filter.call(this,t)),!!t&&(this.element.one("set_state.jstree",function(i,n){n.instance.trigger("restore_state",{state:e.extend(!0,{},t)})}),this.set_state(t),!0))},this.clear_state=function(){return e.vakata.storage.del(this.settings.state.key)}},function(e,t){e.vakata.storage={set:function(e,t){return window.localStorage.setItem(e,t)},get:function(e){return window.localStorage.getItem(e)},del:function(e){return window.localStorage.removeItem(e)}}}(e),e.jstree.defaults.types={"default":{}},e.jstree.defaults.types[e.jstree.root]={},e.jstree.plugins.types=function(i,n){this.init=function(i,r){var s,a;if(r&&r.types&&r.types["default"])for(s in r.types)if("default"!==s&&s!==e.jstree.root&&r.types.hasOwnProperty(s))for(a in r.types["default"])r.types["default"].hasOwnProperty(a)&&r.types[s][a]===t&&(r.types[s][a]=r.types["default"][a]);n.init.call(this,i,r),this._model.data[e.jstree.root].type=e.jstree.root},this.refresh=function(t,i){n.refresh.call(this,t,i),this._model.data[e.jstree.root].type=e.jstree.root},this.bind=function(){this.element.on("model.jstree",e.proxy(function(i,n){var r,s,a=this._model.data,o=n.nodes,l=this.settings.types,c="default";for(r=0,s=o.length;s>r;r++)c="default",a[o[r]].original&&a[o[r]].original.type&&l[a[o[r]].original.type]&&(c=a[o[r]].original.type),a[o[r]].data&&a[o[r]].data.jstree&&a[o[r]].data.jstree.type&&l[a[o[r]].data.jstree.type]&&(c=a[o[r]].data.jstree.type),a[o[r]].type=c,a[o[r]].icon===!0&&l[c].icon!==t&&(a[o[r]].icon=l[c].icon);a[e.jstree.root].type=e.jstree.root},this)),n.bind.call(this)},this.get_json=function(t,i,r){var s,a,o=this._model.data,l=i?e.extend(!0,{},i,{no_id:!1}):{},c=n.get_json.call(this,t,l,r);if(c===!1)return!1;if(e.isArray(c))for(s=0,a=c.length;a>s;s++)c[s].type=c[s].id&&o[c[s].id]&&o[c[s].id].type?o[c[s].id].type:"default",i&&i.no_id&&(delete c[s].id,c[s].li_attr&&c[s].li_attr.id&&delete c[s].li_attr.id,c[s].a_attr&&c[s].a_attr.id&&delete c[s].a_attr.id);else c.type=c.id&&o[c.id]&&o[c.id].type?o[c.id].type:"default",i&&i.no_id&&(c=this._delete_ids(c));return c},this._delete_ids=function(t){if(e.isArray(t)){for(var i=0,n=t.length;n>i;i++)t[i]=this._delete_ids(t[i]);return t}return delete t.id,t.li_attr&&t.li_attr.id&&delete t.li_attr.id,t.a_attr&&t.a_attr.id&&delete t.a_attr.id,t.children&&e.isArray(t.children)&&(t.children=this._delete_ids(t.children)),t},this.check=function(i,r,s,a,o){if(n.check.call(this,i,r,s,a,o)===!1)return!1;r=r&&r.id?r:this.get_node(r),s=s&&s.id?s:this.get_node(s);var l,c,d,h,u=r&&r.id?o&&o.origin?o.origin:e.jstree.reference(r.id):null;switch(u=u&&u._model&&u._model.data?u._model.data:null,i){case"create_node":case"move_node":case"copy_node":if("move_node"!==i||-1===e.inArray(r.id,s.children)){if(l=this.get_rules(s),l.max_children!==t&&-1!==l.max_children&&l.max_children===s.children.length)return this._data.core.last_error={error:"check",plugin:"types",id:"types_01",reason:"max_children prevents function: "+i,data:JSON.stringify({chk:i,pos:a,obj:!(!r||!r.id)&&r.id,par:!(!s||!s.id)&&s.id})},!1;if(l.valid_children!==t&&-1!==l.valid_children&&-1===e.inArray(r.type||"default",l.valid_children))return this._data.core.last_error={error:"check",plugin:"types",id:"types_02",reason:"valid_children prevents function: "+i,data:JSON.stringify({chk:i,pos:a,obj:!(!r||!r.id)&&r.id,par:!(!s||!s.id)&&s.id})},!1;if(u&&r.children_d&&r.parents){for(c=0,d=0,h=r.children_d.length;h>d;d++)c=Math.max(c,u[r.children_d[d]].parents.length);c=c-r.parents.length+1}(0>=c||c===t)&&(c=1);do{if(l.max_depth!==t&&-1!==l.max_depth&&l.max_depth<c)return this._data.core.last_error={error:"check",plugin:"types",id:"types_03",reason:"max_depth prevents function: "+i,data:JSON.stringify({chk:i,pos:a,obj:!(!r||!r.id)&&r.id,par:!(!s||!s.id)&&s.id})},!1;s=this.get_node(s.parent),l=this.get_rules(s),c++}while(s)}}return!0},this.get_rules=function(e){if(e=this.get_node(e),!e)return!1;var i=this.get_type(e,!0);return i.max_depth===t&&(i.max_depth=-1),i.max_children===t&&(i.max_children=-1),i.valid_children===t&&(i.valid_children=-1),i},this.get_type=function(t,i){return t=this.get_node(t),!!t&&(i?e.extend({type:t.type},this.settings.types[t.type]):t.type)},this.set_type=function(i,n){var r,s,a,o,l;if(e.isArray(i)){for(i=i.slice(),s=0,a=i.length;a>s;s++)this.set_type(i[s],n);return!0}return r=this.settings.types,i=this.get_node(i),!(!r[n]||!i)&&(o=i.type,l=this.get_icon(i),i.type=n,(l===!0||r[o]&&r[o].icon!==t&&l===r[o].icon)&&this.set_icon(i,r[n].icon===t||r[n].icon),!0)}},e.jstree.defaults.unique={case_sensitive:!1,duplicate:function(e,t){return e+" ("+t+")"}},e.jstree.plugins.unique=function(i,n){this.check=function(t,i,r,s,a){if(n.check.call(this,t,i,r,s,a)===!1)return!1;if(i=i&&i.id?i:this.get_node(i),r=r&&r.id?r:this.get_node(r),!r||!r.children)return!0;var o,l,c="rename_node"===t?s:i.text,d=[],h=this.settings.unique.case_sensitive,u=this._model.data;for(o=0,l=r.children.length;l>o;o++)d.push(h?u[r.children[o]].text:u[r.children[o]].text.toLowerCase());switch(h||(c=c.toLowerCase()),t){case"delete_node":return!0;case"rename_node":return o=-1===e.inArray(c,d)||i.text&&i.text[h?"toString":"toLowerCase"]()===c,o||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_01",reason:"Child with name "+c+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:s,obj:!(!i||!i.id)&&i.id,par:!(!r||!r.id)&&r.id})}),o;case"create_node":return o=-1===e.inArray(c,d),o||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_04",reason:"Child with name "+c+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:s,obj:!(!i||!i.id)&&i.id,par:!(!r||!r.id)&&r.id})}),o;case"copy_node":return o=-1===e.inArray(c,d),o||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_02",reason:"Child with name "+c+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:s,obj:!(!i||!i.id)&&i.id,par:!(!r||!r.id)&&r.id})}),o;case"move_node":return o=i.parent===r.id&&(!a||!a.is_multi)||-1===e.inArray(c,d),o||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_03",reason:"Child with name "+c+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:s,obj:!(!i||!i.id)&&i.id,par:!(!r||!r.id)&&r.id})}),o}return!0},this.create_node=function(i,r,s,a,o){if(!r||r.text===t){if(null===i&&(i=e.jstree.root),i=this.get_node(i),!i)return n.create_node.call(this,i,r,s,a,o);if(s=s===t?"last":s,!s.toString().match(/^(before|after)$/)&&!o&&!this.is_loaded(i))return n.create_node.call(this,i,r,s,a,o);r||(r={});var l,c,d,h,u,f=this._model.data,p=this.settings.unique.case_sensitive,m=this.settings.unique.duplicate;
for(c=l=this.get_string("New node"),d=[],h=0,u=i.children.length;u>h;h++)d.push(p?f[i.children[h]].text:f[i.children[h]].text.toLowerCase());for(h=1;-1!==e.inArray(p?c:c.toLowerCase(),d);)c=m.call(this,l,++h).toString();r.text=c}return n.create_node.call(this,i,r,s,a,o)}};var p=d.createElement("DIV");if(p.setAttribute("unselectable","on"),p.setAttribute("role","presentation"),p.className="jstree-wholerow",p.innerHTML="&#160;",e.jstree.plugins.wholerow=function(t,i){this.bind=function(){i.bind.call(this),this.element.on("ready.jstree set_state.jstree",e.proxy(function(){this.hide_dots()},this)).on("init.jstree loading.jstree ready.jstree",e.proxy(function(){this.get_container_ul().addClass("jstree-wholerow-ul")},this)).on("deselect_all.jstree",e.proxy(function(e,t){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked")},this)).on("changed.jstree",e.proxy(function(e,t){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked");var i,n,r=!1;for(i=0,n=t.selected.length;n>i;i++)r=this.get_node(t.selected[i],!0),r&&r.length&&r.children(".jstree-wholerow").addClass("jstree-wholerow-clicked")},this)).on("open_node.jstree",e.proxy(function(e,t){this.get_node(t.node,!0).find(".jstree-clicked").parent().children(".jstree-wholerow").addClass("jstree-wholerow-clicked")},this)).on("hover_node.jstree dehover_node.jstree",e.proxy(function(e,t){"hover_node"===e.type&&this.is_disabled(t.node)||this.get_node(t.node,!0).children(".jstree-wholerow")["hover_node"===e.type?"addClass":"removeClass"]("jstree-wholerow-hovered")},this)).on("contextmenu.jstree",".jstree-wholerow",e.proxy(function(t){t.preventDefault();var i=e.Event("contextmenu",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey,pageX:t.pageX,pageY:t.pageY});e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(i)},this)).on("click.jstree",".jstree-wholerow",function(t){t.stopImmediatePropagation();var i=e.Event("click",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey});e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(i).focus()}).on("click.jstree",".jstree-leaf > .jstree-ocl",e.proxy(function(t){t.stopImmediatePropagation();var i=e.Event("click",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey});e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(i).focus()},this)).on("mouseover.jstree",".jstree-wholerow, .jstree-icon",e.proxy(function(e){return e.stopImmediatePropagation(),this.is_disabled(e.currentTarget)||this.hover_node(e.currentTarget),!1},this)).on("mouseleave.jstree",".jstree-node",e.proxy(function(e){this.dehover_node(e.currentTarget)},this))},this.teardown=function(){this.settings.wholerow&&this.element.find(".jstree-wholerow").remove(),i.teardown.call(this)},this.redraw_node=function(t,n,r,s){if(t=i.redraw_node.apply(this,arguments)){var a=p.cloneNode(!0);-1!==e.inArray(t.id,this._data.core.selected)&&(a.className+=" jstree-wholerow-clicked"),this._data.core.focused&&this._data.core.focused===t.id&&(a.className+=" jstree-wholerow-hovered"),t.insertBefore(a,t.childNodes[0])}return t}},d.registerElement&&Object&&Object.create){var m=Object.create(HTMLElement.prototype);m.createdCallback=function(){var t,i={core:{},plugins:[]};for(t in e.jstree.plugins)e.jstree.plugins.hasOwnProperty(t)&&this.attributes[t]&&(i.plugins.push(t),this.getAttribute(t)&&JSON.parse(this.getAttribute(t))&&(i[t]=JSON.parse(this.getAttribute(t))));for(t in e.jstree.defaults.core)e.jstree.defaults.core.hasOwnProperty(t)&&this.attributes[t]&&(i.core[t]=JSON.parse(this.getAttribute(t))||this.getAttribute(t));e(this).jstree(i)};try{d.registerElement("vakata-jstree",{prototype:m})}catch(g){}}}}),function(e,t){var i=/[<>&\r\n"']/gm,n={"<":"lt;",">":"gt;","&":"amp;","\r":"#13;","\n":"#10;",'"':"quot;","'":"#39;"};e.extend({fileDownload:function(r,s){function a(){var t=f.cookieValue;"string"==typeof t&&(t=t.toLowerCase());var i=f.cookieName.toLowerCase()+"="+t;if(document.cookie.toLowerCase().indexOf(i)>-1){_.onSuccess(r);var n=f.cookieName+"=; path="+f.cookiePath+"; expires="+new Date(0).toUTCString()+";";return f.cookieDomain&&(n+=" domain="+f.cookieDomain+";"),document.cookie=n,void l(!1)}if(b||y)try{var s=b?b.document:o(y);if(s&&null!==s.body&&s.body.innerHTML.length){var c=!0;if(w&&w.length){var d=e(s.body).contents().first();try{d.length&&d[0]===w[0]&&(c=!1)}catch(h){if(!h||h.number!=-2146828218)throw h;c=!0}}if(c)return void setTimeout(function(){_.onFail(s.body.innerHTML,r),l(!0)},100)}}catch(u){return _.onFail("",r,u),void l(!0)}setTimeout(a,f.checkInterval)}function o(e){var t=e[0].contentWindow||e[0].contentDocument;return t.document&&(t=t.document),t}function l(e){setTimeout(function(){b&&(h&&b.close(),d&&b.focus&&(b.focus(),e&&b.close()))},0)}function c(e){return e.replace(i,function(e){return"&"+n[e]})}var d,h,u,f=e.extend({preparingMessageHtml:null,failMessageHtml:null,androidPostUnsupportedMessageHtml:"Unfortunately your Android browser doesn't support this type of file download. Please try again with a different browser.",dialogOptions:{modal:!0},prepareCallback:function(e){},successCallback:function(e){},failCallback:function(e,t,i){},httpMethod:"GET",data:null,checkInterval:100,cookieName:"fileDownload",cookieValue:"true",cookiePath:"/",cookieDomain:null,popupWindowTitle:"Initiating file download...",encodeHTMLEntities:!0},s),p=new e.Deferred,m=(navigator.userAgent||navigator.vendor||t.opera).toLowerCase();/ip(ad|hone|od)/.test(m)?d=!0:m.indexOf("android")!==-1?h=!0:u=/avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|playbook|silk|iemobile|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(m)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|e\-|e\/|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(di|rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|xda(\-|2|g)|yas\-|your|zeto|zte\-/i.test(m.substr(0,4));var g=f.httpMethod.toUpperCase();if(h&&"GET"!==g&&f.androidPostUnsupportedMessageHtml)return e().dialog?e("<div>").html(f.androidPostUnsupportedMessageHtml).dialog(f.dialogOptions):alert(f.androidPostUnsupportedMessageHtml),p.reject();var v=null,_={onPrepare:function(t){f.preparingMessageHtml?v=e("<div>").html(f.preparingMessageHtml).dialog(f.dialogOptions):f.prepareCallback&&f.prepareCallback(t)},onSuccess:function(e){v&&v.dialog("close"),f.successCallback(e),p.resolve(e)},onFail:function(t,i,n){v&&v.dialog("close"),f.failMessageHtml&&e("<div>").html(f.failMessageHtml).dialog(f.dialogOptions),f.failCallback(t,i,n),p.reject(t,i)}};_.onPrepare(r),null!==f.data&&"string"!=typeof f.data&&(f.data=e.param(f.data));var y,b,x,w;if("GET"===g){if(null!==f.data){var k=r.indexOf("?");k!==-1?"&"!==r.substring(r.length-1)&&(r+="&"):r+="?",r+=f.data}d||h?(b=t.open(r),b.document.title=f.popupWindowTitle,t.focus()):u?t.location(r):y=e("<iframe>").hide().prop("src",r).appendTo("body")}else{var C="";null!==f.data&&e.each(f.data.replace(/\+/g," ").split("&"),function(){var e=this.split("="),t=e[0];e.shift();var i=e.join("=");e=[t,i];var n=f.encodeHTMLEntities?c(decodeURIComponent(e[0])):decodeURIComponent(e[0]);if(n){var r=f.encodeHTMLEntities?c(decodeURIComponent(e[1])):decodeURIComponent(e[1]);C+='<input type="hidden" name="'+n+'" value="'+r+'" />'}}),u?(w=e("<form>").appendTo("body"),w.hide().prop("method",f.httpMethod).prop("action",r).html(C)):(d?(b=t.open("about:blank"),b.document.title=f.popupWindowTitle,x=b.document,t.focus()):(y=e("<iframe style='display: none' src='about:blank'></iframe>").appendTo("body"),x=o(y)),x.write("<html><head></head><body><form method='"+f.httpMethod+"' action='"+r+"'>"+C+"</form>"+f.popupWindowTitle+"</body></html>"),w=e(x).find("form")),w.submit()}setTimeout(a,f.checkInterval);var D=p.promise();return D.abort=function(){l(),y.remove()},D}})}(jQuery,this),function(e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else{if("function"==typeof define&&define.amd)return define([],e);this.CodeMirror=e()}}(function(){"use strict";function e(i,n){if(!(this instanceof e))return new e(i,n);this.options=n=n?mr(n):{},mr(Os,n,!1),p(n);var r=n.value;"string"==typeof r&&(r=new ia(r,n.mode)),this.doc=r;var s=this.display=new t(i,r);s.wrapper.CodeMirror=this,d(this),l(this),n.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),n.autofocus&&!cs&&Dt(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,focused:!1,suppressEdits:!1,pasteIncoming:!1,cutIncoming:!1,draggingText:!1,highlight:new lr},Qr&&Zr<11&&setTimeout(gr(Ct,this,!0),20),Tt(this),Lr(),Ze(this),this.curOp.forceUpdate=!0,Mn(this,r),n.autofocus&&!cs||Cr()==s.input?setTimeout(gr(Jt,this),20):Qt(this);for(var a in As)As.hasOwnProperty(a)&&As[a](this,n[a],Ns);b(this);for(var o=0;o<Hs.length;++o)Hs[o](this);tt(this)}function t(e,t){var i=this,n=i.input=br("textarea",null,null,"position: absolute; padding: 0; width: 1px; height: 1em; outline: none");es?n.style.width="1000px":n.setAttribute("wrap","off"),ls&&(n.style.border="1px solid black"),n.setAttribute("autocorrect","off"),n.setAttribute("autocapitalize","off"),n.setAttribute("spellcheck","false"),i.inputDiv=br("div",[n],null,"overflow: hidden; position: relative; width: 3px; height: 0px;"),i.scrollbarH=br("div",[br("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar"),i.scrollbarV=br("div",[br("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),i.scrollbarFiller=br("div",null,"CodeMirror-scrollbar-filler"),i.gutterFiller=br("div",null,"CodeMirror-gutter-filler"),i.lineDiv=br("div",null,"CodeMirror-code"),i.selectionDiv=br("div",null,null,"position: relative; z-index: 1"),i.cursorDiv=br("div",null,"CodeMirror-cursors"),i.measure=br("div",null,"CodeMirror-measure"),i.lineMeasure=br("div",null,"CodeMirror-measure"),i.lineSpace=br("div",[i.measure,i.lineMeasure,i.selectionDiv,i.cursorDiv,i.lineDiv],null,"position: relative; outline: none"),i.mover=br("div",[br("div",[i.lineSpace],"CodeMirror-lines")],null,"position: relative"),i.sizer=br("div",[i.mover],"CodeMirror-sizer"),i.heightForcer=br("div",null,null,"position: absolute; height: "+ua+"px; width: 1px;"),i.gutters=br("div",null,"CodeMirror-gutters"),i.lineGutter=null,i.scroller=br("div",[i.sizer,i.heightForcer,i.gutters],"CodeMirror-scroll"),i.scroller.setAttribute("tabIndex","-1"),i.wrapper=br("div",[i.inputDiv,i.scrollbarH,i.scrollbarV,i.scrollbarFiller,i.gutterFiller,i.scroller],"CodeMirror"),Qr&&Zr<8&&(i.gutters.style.zIndex=-1,i.scroller.style.paddingRight=0),ls&&(n.style.width="0px"),es||(i.scroller.draggable=!0),ss&&(i.inputDiv.style.height="1px",i.inputDiv.style.position="absolute"),Qr&&Zr<8&&(i.scrollbarH.style.minHeight=i.scrollbarV.style.minWidth="18px"),e.appendChild?e.appendChild(i.wrapper):e(i.wrapper),i.viewFrom=i.viewTo=t.first,i.view=[],i.externalMeasured=null,i.viewOffset=0,i.lastSizeC=0,i.updateLineNumbers=null,i.lineNumWidth=i.lineNumInnerWidth=i.lineNumChars=null,i.prevInput="",i.alignWidgets=!1,i.pollingFast=!1,i.poll=new lr,i.cachedCharWidth=i.cachedTextHeight=i.cachedPaddingH=null,i.inaccurateSelection=!1,i.maxLine=null,i.maxLineLength=0,i.maxLineChanged=!1,i.wheelDX=i.wheelDY=i.wheelStartX=i.wheelStartY=null,i.shift=!1,i.selForContextMenu=null}function i(t){t.doc.mode=e.getMode(t.options,t.doc.modeOption),n(t)}function n(e){e.doc.iter(function(e){e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null)}),e.doc.frontier=e.doc.first,we(e,100),e.state.modeGen++,e.curOp&&pt(e)}function r(e){e.options.lineWrapping?(jr(e.display.wrapper,"CodeMirror-wrap"),e.display.sizer.style.minWidth=""):(Sr(e.display.wrapper,"CodeMirror-wrap"),f(e)),a(e),pt(e),Re(e),setTimeout(function(){v(e)},100)}function s(e){var t=Je(e.display),i=e.options.lineWrapping,n=i&&Math.max(5,e.display.scroller.clientWidth/Qe(e.display)-3);return function(r){if(tn(e.doc,r))return 0;var s=0;if(r.widgets)for(var a=0;a<r.widgets.length;a++)r.widgets[a].height&&(s+=r.widgets[a].height);return i?s+(Math.ceil(r.text.length/n)||1)*t:s+t}}function a(e){var t=e.doc,i=s(e);t.iter(function(e){var t=i(e);t!=e.height&&An(e,t)})}function o(e){var t=Ys[e.options.keyMap],i=t.style;e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-keymap-\S+/g,"")+(i?" cm-keymap-"+i:"")}function l(e){e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+e.options.theme.replace(/(^|\s)\s*/g," cm-s-"),Re(e)}function c(e){d(e),pt(e),setTimeout(function(){y(e)},20)}function d(e){var t=e.display.gutters,i=e.options.gutters;xr(t);for(var n=0;n<i.length;++n){var r=i[n],s=t.appendChild(br("div",null,"CodeMirror-gutter "+r));"CodeMirror-linenumbers"==r&&(e.display.lineGutter=s,s.style.width=(e.display.lineNumWidth||1)+"px")}t.style.display=n?"":"none",h(e)}function h(e){var t=e.display.gutters.offsetWidth;e.display.sizer.style.marginLeft=t+"px",e.display.scrollbarH.style.left=e.options.fixedGutter?t+"px":0}function u(e){if(0==e.height)return 0;for(var t,i=e.text.length,n=e;t=Vi(n);){var r=t.find(0,!0);n=r.from.line,i+=r.from.ch-r.to.ch}for(n=e;t=Gi(n);){var r=t.find(0,!0);i-=n.text.length-r.from.ch,n=r.to.line,i+=n.text.length-r.to.ch}return i}function f(e){var t=e.display,i=e.doc;t.maxLine=Ln(i,i.first),t.maxLineLength=u(t.maxLine),t.maxLineChanged=!0,i.iter(function(e){var i=u(e);i>t.maxLineLength&&(t.maxLineLength=i,t.maxLine=e)})}function p(e){var t=ur(e.gutters,"CodeMirror-linenumbers");t==-1&&e.lineNumbers?e.gutters=e.gutters.concat(["CodeMirror-linenumbers"]):t>-1&&!e.lineNumbers&&(e.gutters=e.gutters.slice(0),e.gutters.splice(t,1))}function m(e){return e.display.scroller.clientHeight-e.display.wrapper.clientHeight<ua-3}function g(e){var t=e.display.scroller;return{clientHeight:t.clientHeight,barHeight:e.display.scrollbarV.clientHeight,scrollWidth:t.scrollWidth,clientWidth:t.clientWidth,hScrollbarTakesSpace:m(e),barWidth:e.display.scrollbarH.clientWidth,docHeight:Math.round(e.doc.height+je(e.display))}}function v(e,t){t||(t=g(e));var i=e.display,n=Or(i.measure),r=t.docHeight+ua,s=t.scrollWidth>t.clientWidth;s&&t.scrollWidth<=t.clientWidth+1&&n>0&&!t.hScrollbarTakesSpace&&(s=!1);var a=r>t.clientHeight;if(a?(i.scrollbarV.style.display="block",i.scrollbarV.style.bottom=s?n+"px":"0",i.scrollbarV.firstChild.style.height=Math.max(0,r-t.clientHeight+(t.barHeight||i.scrollbarV.clientHeight))+"px"):(i.scrollbarV.style.display="",i.scrollbarV.firstChild.style.height="0"),s?(i.scrollbarH.style.display="block",i.scrollbarH.style.right=a?n+"px":"0",i.scrollbarH.firstChild.style.width=t.scrollWidth-t.clientWidth+(t.barWidth||i.scrollbarH.clientWidth)+"px"):(i.scrollbarH.style.display="",i.scrollbarH.firstChild.style.width="0"),s&&a?(i.scrollbarFiller.style.display="block",i.scrollbarFiller.style.height=i.scrollbarFiller.style.width=n+"px"):i.scrollbarFiller.style.display="",s&&e.options.coverGutterNextToScrollbar&&e.options.fixedGutter?(i.gutterFiller.style.display="block",i.gutterFiller.style.height=n+"px",i.gutterFiller.style.width=i.gutters.offsetWidth+"px"):i.gutterFiller.style.display="",!e.state.checkedOverlayScrollbar&&t.clientHeight>0){if(0===n){var o=ds&&!as?"12px":"18px";i.scrollbarV.style.minWidth=i.scrollbarH.style.minHeight=o;var l=function(t){er(t)!=i.scrollbarV&&er(t)!=i.scrollbarH&&ct(e,Ot)(t)};la(i.scrollbarV,"mousedown",l),la(i.scrollbarH,"mousedown",l)}e.state.checkedOverlayScrollbar=!0}}function _(e,t,i){var n=i&&null!=i.top?Math.max(0,i.top):e.scroller.scrollTop;n=Math.floor(n-Se(e));var r=i&&null!=i.bottom?i.bottom:n+e.wrapper.clientHeight,s=Fn(t,n),a=Fn(t,r);if(i&&i.ensure){var o=i.ensure.from.line,l=i.ensure.to.line;if(o<s)return{from:o,to:Fn(t,Pn(Ln(t,o))+e.wrapper.clientHeight)};if(Math.min(l,t.lastLine())>=a)return{from:Fn(t,Pn(Ln(t,l))-e.wrapper.clientHeight),to:l}}return{from:s,to:Math.max(a,s+1)}}function y(e){var t=e.display,i=t.view;if(t.alignWidgets||t.gutters.firstChild&&e.options.fixedGutter){for(var n=w(t)-t.scroller.scrollLeft+e.doc.scrollLeft,r=t.gutters.offsetWidth,s=n+"px",a=0;a<i.length;a++)if(!i[a].hidden){e.options.fixedGutter&&i[a].gutter&&(i[a].gutter.style.left=s);var o=i[a].alignable;if(o)for(var l=0;l<o.length;l++)o[l].style.left=s}e.options.fixedGutter&&(t.gutters.style.left=n+r+"px")}}function b(e){if(!e.options.lineNumbers)return!1;var t=e.doc,i=x(e.options,t.first+t.size-1),n=e.display;if(i.length!=n.lineNumChars){var r=n.measure.appendChild(br("div",[br("div",i)],"CodeMirror-linenumber CodeMirror-gutter-elt")),s=r.firstChild.offsetWidth,a=r.offsetWidth-s;return n.lineGutter.style.width="",n.lineNumInnerWidth=Math.max(s,n.lineGutter.offsetWidth-a),n.lineNumWidth=n.lineNumInnerWidth+a,n.lineNumChars=n.lineNumInnerWidth?i.length:-1,n.lineGutter.style.width=n.lineNumWidth+"px",h(e),!0}return!1}function x(e,t){return String(e.lineNumberFormatter(t+e.firstLineNumber))}function w(e){return e.scroller.getBoundingClientRect().left-e.sizer.getBoundingClientRect().left}function k(e,t,i){var n=e.display;this.viewport=t,this.visible=_(n,e.doc,t),this.editorIsHidden=!n.wrapper.offsetWidth,this.wrapperHeight=n.wrapper.clientHeight,this.oldViewFrom=n.viewFrom,this.oldViewTo=n.viewTo,this.oldScrollerWidth=n.scroller.clientWidth,this.force=i,this.dims=E(e)}function C(e,t){var i=e.display,n=e.doc;if(t.editorIsHidden)return gt(e),!1;if(!t.force&&t.visible.from>=i.viewFrom&&t.visible.to<=i.viewTo&&(null==i.updateLineNumbers||i.updateLineNumbers>=i.viewTo)&&0==bt(e))return!1;b(e)&&(gt(e),t.dims=E(e));var r=n.first+n.size,s=Math.max(t.visible.from-e.options.viewportMargin,n.first),a=Math.min(r,t.visible.to+e.options.viewportMargin);i.viewFrom<s&&s-i.viewFrom<20&&(s=Math.max(n.first,i.viewFrom)),i.viewTo>a&&i.viewTo-a<20&&(a=Math.min(r,i.viewTo)),gs&&(s=Zi(e.doc,s),a=en(e.doc,a));var o=s!=i.viewFrom||a!=i.viewTo||i.lastSizeC!=t.wrapperHeight;yt(e,s,a),i.viewOffset=Pn(Ln(e.doc,i.viewFrom)),e.display.mover.style.top=i.viewOffset+"px";var l=bt(e);if(!o&&0==l&&!t.force&&(null==i.updateLineNumbers||i.updateLineNumbers>=i.viewTo))return!1;var c=Cr();return l>4&&(i.lineDiv.style.display="none"),O(e,i.updateLineNumbers,t.dims),l>4&&(i.lineDiv.style.display=""),c&&Cr()!=c&&c.offsetHeight&&c.focus(),xr(i.cursorDiv),xr(i.selectionDiv),o&&(i.lastSizeC=t.wrapperHeight,we(e,400)),i.updateLineNumbers=null,!0}function D(e,t){for(var i=t.force,n=t.viewport,r=!0;;r=!1){if(r&&e.options.lineWrapping&&t.oldScrollerWidth!=e.display.scroller.clientWidth)i=!0;else if(i=!1,n&&null!=n.top&&(n={top:Math.min(e.doc.height+je(e.display)-ua-e.display.scroller.clientHeight,n.top)}),t.visible=_(e.display,e.doc,n),t.visible.from>=e.display.viewFrom&&t.visible.to<=e.display.viewTo)break;if(!C(e,t))break;M(e);var s=g(e);_e(e),j(e,s),v(e,s)}ir(e,"update",e),e.display.viewFrom==t.oldViewFrom&&e.display.viewTo==t.oldViewTo||ir(e,"viewportChange",e,e.display.viewFrom,e.display.viewTo)}function S(e,t){var i=new k(e,t);if(C(e,i)){M(e),D(e,i);var n=g(e);_e(e),j(e,n),v(e,n)}}function j(e,t){e.display.sizer.style.minHeight=e.display.heightForcer.style.top=t.docHeight+"px",e.display.gutters.style.height=Math.max(t.docHeight,t.clientHeight-ua)+"px"}function T(e,t){e.display.sizer.offsetWidth+e.display.gutters.offsetWidth<e.display.scroller.clientWidth-1&&(e.display.sizer.style.minHeight=e.display.heightForcer.style.top="0px",e.display.gutters.style.height=t.docHeight+"px")}function M(e){for(var t=e.display,i=t.lineDiv.offsetTop,n=0;n<t.view.length;n++){var r,s=t.view[n];if(!s.hidden){if(Qr&&Zr<8){var a=s.node.offsetTop+s.node.offsetHeight;r=a-i,i=a}else{var o=s.node.getBoundingClientRect();r=o.bottom-o.top}var l=s.line.height-r;if(r<2&&(r=Je(t)),(l>.001||l<-.001)&&(An(s.line,r),L(s.line),s.rest))for(var c=0;c<s.rest.length;c++)L(s.rest[c])}}}function L(e){if(e.widgets)for(var t=0;t<e.widgets.length;++t)e.widgets[t].height=e.widgets[t].node.offsetHeight}function E(e){for(var t=e.display,i={},n={},r=t.gutters.clientLeft,s=t.gutters.firstChild,a=0;s;s=s.nextSibling,++a)i[e.options.gutters[a]]=s.offsetLeft+s.clientLeft+r,n[e.options.gutters[a]]=s.clientWidth;return{fixedPos:w(t),gutterTotalWidth:t.gutters.offsetWidth,gutterLeft:i,gutterWidth:n,wrapperWidth:t.wrapper.clientWidth}}function O(e,t,i){function n(t){var i=t.nextSibling;return es&&ds&&e.display.currentWheelTarget==t?t.style.display="none":t.parentNode.removeChild(t),i}for(var r=e.display,s=e.options.lineNumbers,a=r.lineDiv,o=a.firstChild,l=r.view,c=r.viewFrom,d=0;d<l.length;d++){var h=l[d];if(h.hidden);else if(h.node){for(;o!=h.node;)o=n(o);var u=s&&null!=t&&t<=c&&h.lineNumber;h.changes&&(ur(h.changes,"gutter")>-1&&(u=!1),A(e,h,c,i)),u&&(xr(h.lineNumber),h.lineNumber.appendChild(document.createTextNode(x(e.options,c)))),o=h.node.nextSibling}else{var f=z(e,h,c,i);a.insertBefore(f,o)}c+=h.size}for(;o;)o=n(o)}function A(e,t,i,n){for(var r=0;r<t.changes.length;r++){var s=t.changes[r];"text"==s?I(e,t):"gutter"==s?$(e,t,i,n):"class"==s?H(t):"widget"==s&&R(t,n)}t.changes=null}function N(e){return e.node==e.text&&(e.node=br("div",null,null,"position: relative"),e.text.parentNode&&e.text.parentNode.replaceChild(e.node,e.text),e.node.appendChild(e.text),Qr&&Zr<8&&(e.node.style.zIndex=2)),e.node}function F(e){var t=e.bgClass?e.bgClass+" "+(e.line.bgClass||""):e.line.bgClass;if(t&&(t+=" CodeMirror-linebackground"),e.background)t?e.background.className=t:(e.background.parentNode.removeChild(e.background),e.background=null);else if(t){var i=N(e);e.background=i.insertBefore(br("div",null,t),i.firstChild)}}function P(e,t){var i=e.display.externalMeasured;return i&&i.line==t.line?(e.display.externalMeasured=null,t.measure=i.measure,i.built):vn(e,t)}function I(e,t){var i=t.text.className,n=P(e,t);t.text==t.node&&(t.node=n.pre),t.text.parentNode.replaceChild(n.pre,t.text),t.text=n.pre,n.bgClass!=t.bgClass||n.textClass!=t.textClass?(t.bgClass=n.bgClass,t.textClass=n.textClass,H(t)):i&&(t.text.className=i)}function H(e){F(e),e.line.wrapClass?N(e).className=e.line.wrapClass:e.node!=e.text&&(e.node.className="");var t=e.textClass?e.textClass+" "+(e.line.textClass||""):e.line.textClass;e.text.className=t||""}function $(e,t,i,n){t.gutter&&(t.node.removeChild(t.gutter),t.gutter=null);var r=t.line.gutterMarkers;if(e.options.lineNumbers||r){var s=N(t),a=t.gutter=s.insertBefore(br("div",null,"CodeMirror-gutter-wrapper","position: absolute; left: "+(e.options.fixedGutter?n.fixedPos:-n.gutterTotalWidth)+"px"),t.text);if(!e.options.lineNumbers||r&&r["CodeMirror-linenumbers"]||(t.lineNumber=a.appendChild(br("div",x(e.options,i),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+n.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+e.display.lineNumInnerWidth+"px"))),r)for(var o=0;o<e.options.gutters.length;++o){var l=e.options.gutters[o],c=r.hasOwnProperty(l)&&r[l];c&&a.appendChild(br("div",[c],"CodeMirror-gutter-elt","left: "+n.gutterLeft[l]+"px; width: "+n.gutterWidth[l]+"px"))}}}function R(e,t){e.alignable&&(e.alignable=null);for(var i,n=e.node.firstChild;n;n=i){var i=n.nextSibling;"CodeMirror-linewidget"==n.className&&e.node.removeChild(n)}W(e,t)}function z(e,t,i,n){var r=P(e,t);return t.text=t.node=r.pre,r.bgClass&&(t.bgClass=r.bgClass),r.textClass&&(t.textClass=r.textClass),H(t),$(e,t,i,n),W(t,n),t.node}function W(e,t){if(Y(e.line,e,t,!0),e.rest)for(var i=0;i<e.rest.length;i++)Y(e.rest[i],e,t,!1)}function Y(e,t,i,n){if(e.widgets)for(var r=N(t),s=0,a=e.widgets;s<a.length;++s){var o=a[s],l=br("div",[o.node],"CodeMirror-linewidget");o.handleMouseEvents||(l.ignoreEvents=!0),B(o,l,t,i),n&&o.above?r.insertBefore(l,t.gutter||t.text):r.appendChild(l),ir(o,"redraw")}}function B(e,t,i,n){if(e.noHScroll){(i.alignable||(i.alignable=[])).push(t);var r=n.wrapperWidth;t.style.left=n.fixedPos+"px",e.coverGutter||(r-=n.gutterTotalWidth,t.style.paddingLeft=n.gutterTotalWidth+"px"),t.style.width=r+"px"}e.coverGutter&&(t.style.zIndex=5,t.style.position="relative",e.noHScroll||(t.style.marginLeft=-n.gutterTotalWidth+"px"))}function U(e){return vs(e.line,e.ch)}function q(e,t){return _s(e,t)<0?t:e}function X(e,t){return _s(e,t)<0?e:t}function V(e,t){this.ranges=e,this.primIndex=t}function G(e,t){this.anchor=e,this.head=t}function K(e,t){var i=e[t];e.sort(function(e,t){return _s(e.from(),t.from())}),t=ur(e,i);for(var n=1;n<e.length;n++){var r=e[n],s=e[n-1];if(_s(s.to(),r.from())>=0){var a=X(s.from(),r.from()),o=q(s.to(),r.to()),l=s.empty()?r.from()==r.head:s.from()==s.head;n<=t&&--t,e.splice(--n,2,new G(l?o:a,l?a:o))}}return new V(e,t)}function J(e,t){return new V([new G(e,t||e)],0)}function Q(e,t){return Math.max(e.first,Math.min(t,e.first+e.size-1))}function Z(e,t){if(t.line<e.first)return vs(e.first,0);var i=e.first+e.size-1;return t.line>i?vs(i,Ln(e,i).text.length):ee(t,Ln(e,t.line).text.length)}function ee(e,t){var i=e.ch;return null==i||i>t?vs(e.line,t):i<0?vs(e.line,0):e}function te(e,t){return t>=e.first&&t<e.first+e.size}function ie(e,t){for(var i=[],n=0;n<t.length;n++)i[n]=Z(e,t[n]);return i}function ne(e,t,i,n){if(e.cm&&e.cm.display.shift||e.extend){var r=t.anchor;if(n){var s=_s(i,r)<0;s!=_s(n,r)<0?(r=i,i=n):s!=_s(i,n)<0&&(i=n)}return new G(r,i)}return new G(n||i,i)}function re(e,t,i,n){de(e,new V([ne(e,e.sel.primary(),t,i)],0),n)}function se(e,t,i){for(var n=[],r=0;r<e.sel.ranges.length;r++)n[r]=ne(e,e.sel.ranges[r],t[r],null);var s=K(n,e.sel.primIndex);de(e,s,i)}function ae(e,t,i,n){var r=e.sel.ranges.slice(0);r[t]=i,de(e,K(r,e.sel.primIndex),n)}function oe(e,t,i,n){de(e,J(t,i),n)}function le(e,t){var i={ranges:t.ranges,update:function(t){this.ranges=[];for(var i=0;i<t.length;i++)this.ranges[i]=new G(Z(e,t[i].anchor),Z(e,t[i].head))}};return da(e,"beforeSelectionChange",e,i),e.cm&&da(e.cm,"beforeSelectionChange",e.cm,i),i.ranges!=t.ranges?K(i.ranges,i.ranges.length-1):t}function ce(e,t,i){var n=e.history.done,r=hr(n);r&&r.ranges?(n[n.length-1]=t,he(e,t,i)):de(e,t,i)}function de(e,t,i){he(e,t,i),Bn(e,e.sel,e.cm?e.cm.curOp.id:NaN,i)}function he(e,t,i){(ar(e,"beforeSelectionChange")||e.cm&&ar(e.cm,"beforeSelectionChange"))&&(t=le(e,t));var n=i&&i.bias||(_s(t.primary().head,e.sel.primary().head)<0?-1:1);ue(e,pe(e,t,n,!0)),i&&i.scroll===!1||!e.cm||_i(e.cm)}function ue(e,t){t.equals(e.sel)||(e.sel=t,e.cm&&(e.cm.curOp.updateInput=e.cm.curOp.selectionChanged=!0,sr(e.cm)),ir(e,"cursorActivity",e))}function fe(e){ue(e,pe(e,e.sel,null,!1),pa)}function pe(e,t,i,n){for(var r,s=0;s<t.ranges.length;s++){var a=t.ranges[s],o=me(e,a.anchor,i,n),l=me(e,a.head,i,n);(r||o!=a.anchor||l!=a.head)&&(r||(r=t.ranges.slice(0,s)),r[s]=new G(o,l))}return r?K(r,t.primIndex):t}function me(e,t,i,n){var r=!1,s=t,a=i||1;e.cantEdit=!1;e:for(;;){var o=Ln(e,s.line);if(o.markedSpans)for(var l=0;l<o.markedSpans.length;++l){var c=o.markedSpans[l],d=c.marker;if((null==c.from||(d.inclusiveLeft?c.from<=s.ch:c.from<s.ch))&&(null==c.to||(d.inclusiveRight?c.to>=s.ch:c.to>s.ch))){if(n&&(da(d,"beforeCursorEnter"),d.explicitlyCleared)){if(o.markedSpans){--l;continue}break}if(!d.atomic)continue;var h=d.find(a<0?-1:1);if(0==_s(h,s)&&(h.ch+=a,h.ch<0?h=h.line>e.first?Z(e,vs(h.line-1)):null:h.ch>o.text.length&&(h=h.line<e.first+e.size-1?vs(h.line+1,0):null),!h)){if(r)return n?(e.cantEdit=!0,vs(e.first,0)):me(e,t,i,!0);r=!0,h=t,a=-a}s=h;continue e}}return s}}function ge(e){for(var t=e.display,i=e.doc,n={},r=n.cursors=document.createDocumentFragment(),s=n.selection=document.createDocumentFragment(),a=0;a<i.sel.ranges.length;a++){var o=i.sel.ranges[a],l=o.empty();(l||e.options.showCursorWhenSelecting)&&ye(e,o,r),l||be(e,o,s)}if(e.options.moveInputWithCursor){var c=qe(e,i.sel.primary().head,"div"),d=t.wrapper.getBoundingClientRect(),h=t.lineDiv.getBoundingClientRect();n.teTop=Math.max(0,Math.min(t.wrapper.clientHeight-10,c.top+h.top-d.top)),n.teLeft=Math.max(0,Math.min(t.wrapper.clientWidth-10,c.left+h.left-d.left))}return n}function ve(e,t){wr(e.display.cursorDiv,t.cursors),wr(e.display.selectionDiv,t.selection),null!=t.teTop&&(e.display.inputDiv.style.top=t.teTop+"px",e.display.inputDiv.style.left=t.teLeft+"px")}function _e(e){ve(e,ge(e))}function ye(e,t,i){var n=qe(e,t.head,"div",null,null,!e.options.singleCursorHeightPerLine),r=i.appendChild(br("div"," ","CodeMirror-cursor"));if(r.style.left=n.left+"px",r.style.top=n.top+"px",r.style.height=Math.max(0,n.bottom-n.top)*e.options.cursorHeight+"px",n.other){var s=i.appendChild(br("div"," ","CodeMirror-cursor CodeMirror-secondarycursor"));s.style.display="",s.style.left=n.other.left+"px",s.style.top=n.other.top+"px",s.style.height=.85*(n.other.bottom-n.other.top)+"px"}}function be(e,t,i){function n(e,t,i,n){t<0&&(t=0),t=Math.round(t),n=Math.round(n),o.appendChild(br("div",null,"CodeMirror-selected","position: absolute; left: "+e+"px; top: "+t+"px; width: "+(null==i?d-e:i)+"px; height: "+(n-t)+"px"))}function r(t,i,r){function s(i,n){return Ue(e,vs(t,i),"div",h,n)}var o,l,h=Ln(a,t),u=h.text.length;return Pr(In(h),i||0,null==r?u:r,function(e,t,a){var h,f,p,m=s(e,"left");if(e==t)h=m,f=p=m.left;else{if(h=s(t-1,"right"),"rtl"==a){var g=m;m=h,h=g}f=m.left,p=h.right}null==i&&0==e&&(f=c),h.top-m.top>3&&(n(f,m.top,null,m.bottom),f=c,m.bottom<h.top&&n(f,m.bottom,null,h.top)),null==r&&t==u&&(p=d),(!o||m.top<o.top||m.top==o.top&&m.left<o.left)&&(o=m),(!l||h.bottom>l.bottom||h.bottom==l.bottom&&h.right>l.right)&&(l=h),f<c+1&&(f=c),n(f,h.top,p-f,h.bottom)}),{start:o,end:l}}var s=e.display,a=e.doc,o=document.createDocumentFragment(),l=Te(e.display),c=l.left,d=s.lineSpace.offsetWidth-l.right,h=t.from(),u=t.to();if(h.line==u.line)r(h.line,h.ch,u.ch);else{var f=Ln(a,h.line),p=Ln(a,u.line),m=Ji(f)==Ji(p),g=r(h.line,h.ch,m?f.text.length+1:null).end,v=r(u.line,m?0:null,u.ch).start;m&&(g.top<v.top-2?(n(g.right,g.top,null,g.bottom),n(c,v.top,v.left,v.bottom)):n(g.right,g.top,v.left-g.right,g.bottom)),g.bottom<v.top&&n(c,g.bottom,null,v.top)}i.appendChild(o)}function xe(e){if(e.state.focused){var t=e.display;clearInterval(t.blinker);var i=!0;t.cursorDiv.style.visibility="",e.options.cursorBlinkRate>0?t.blinker=setInterval(function(){t.cursorDiv.style.visibility=(i=!i)?"":"hidden"},e.options.cursorBlinkRate):e.options.cursorBlinkRate<0&&(t.cursorDiv.style.visibility="hidden")}}function we(e,t){e.doc.mode.startState&&e.doc.frontier<e.display.viewTo&&e.state.highlight.set(t,gr(ke,e))}function ke(e){var t=e.doc;if(t.frontier<t.first&&(t.frontier=t.first),!(t.frontier>=e.display.viewTo)){var i=+new Date+e.options.workTime,n=Rs(t.mode,De(e,t.frontier)),r=[];t.iter(t.frontier,Math.min(t.first+t.size,e.display.viewTo+500),function(s){if(t.frontier>=e.display.viewFrom){var a=s.styles,o=fn(e,s,n,!0);
s.styles=o.styles;var l=s.styleClasses,c=o.classes;c?s.styleClasses=c:l&&(s.styleClasses=null);for(var d=!a||a.length!=s.styles.length||l!=c&&(!l||!c||l.bgClass!=c.bgClass||l.textClass!=c.textClass),h=0;!d&&h<a.length;++h)d=a[h]!=s.styles[h];d&&r.push(t.frontier),s.stateAfter=Rs(t.mode,n)}else mn(e,s.text,n),s.stateAfter=t.frontier%5==0?Rs(t.mode,n):null;if(++t.frontier,+new Date>i)return we(e,e.options.workDelay),!0}),r.length&&lt(e,function(){for(var t=0;t<r.length;t++)mt(e,r[t],"text")})}}function Ce(e,t,i){for(var n,r,s=e.doc,a=i?-1:t-(e.doc.mode.innerMode?1e3:100),o=t;o>a;--o){if(o<=s.first)return s.first;var l=Ln(s,o-1);if(l.stateAfter&&(!i||o<=s.frontier))return o;var c=va(l.text,null,e.options.tabSize);(null==r||n>c)&&(r=o-1,n=c)}return r}function De(e,t,i){var n=e.doc,r=e.display;if(!n.mode.startState)return!0;var s=Ce(e,t,i),a=s>n.first&&Ln(n,s-1).stateAfter;return a=a?Rs(n.mode,a):zs(n.mode),n.iter(s,t,function(i){mn(e,i.text,a);var o=s==t-1||s%5==0||s>=r.viewFrom&&s<r.viewTo;i.stateAfter=o?Rs(n.mode,a):null,++s}),i&&(n.frontier=s),a}function Se(e){return e.lineSpace.offsetTop}function je(e){return e.mover.offsetHeight-e.lineSpace.offsetHeight}function Te(e){if(e.cachedPaddingH)return e.cachedPaddingH;var t=wr(e.measure,br("pre","x")),i=window.getComputedStyle?window.getComputedStyle(t):t.currentStyle,n={left:parseInt(i.paddingLeft),right:parseInt(i.paddingRight)};return isNaN(n.left)||isNaN(n.right)||(e.cachedPaddingH=n),n}function Me(e,t,i){var n=e.options.lineWrapping,r=n&&e.display.scroller.clientWidth;if(!t.measure.heights||n&&t.measure.width!=r){var s=t.measure.heights=[];if(n){t.measure.width=r;for(var a=t.text.firstChild.getClientRects(),o=0;o<a.length-1;o++){var l=a[o],c=a[o+1];Math.abs(l.bottom-c.bottom)>2&&s.push((l.bottom+c.top)/2-i.top)}}s.push(i.bottom-i.top)}}function Le(e,t,i){if(e.line==t)return{map:e.measure.map,cache:e.measure.cache};for(var n=0;n<e.rest.length;n++)if(e.rest[n]==t)return{map:e.measure.maps[n],cache:e.measure.caches[n]};for(var n=0;n<e.rest.length;n++)if(Nn(e.rest[n])>i)return{map:e.measure.maps[n],cache:e.measure.caches[n],before:!0}}function Ee(e,t){t=Ji(t);var i=Nn(t),n=e.display.externalMeasured=new ut(e.doc,t,i);n.lineN=i;var r=n.built=vn(e,n);return n.text=r.pre,wr(e.display.lineMeasure,r.pre),n}function Oe(e,t,i,n){return Fe(e,Ne(e,t),i,n)}function Ae(e,t){if(t>=e.display.viewFrom&&t<e.display.viewTo)return e.display.view[vt(e,t)];var i=e.display.externalMeasured;return i&&t>=i.lineN&&t<i.lineN+i.size?i:void 0}function Ne(e,t){var i=Nn(t),n=Ae(e,i);n&&!n.text?n=null:n&&n.changes&&A(e,n,i,E(e)),n||(n=Ee(e,t));var r=Le(n,t,i);return{line:t,view:n,rect:null,map:r.map,cache:r.cache,before:r.before,hasHeights:!1}}function Fe(e,t,i,n,r){t.before&&(i=-1);var s,a=i+(n||"");return t.cache.hasOwnProperty(a)?s=t.cache[a]:(t.rect||(t.rect=t.view.text.getBoundingClientRect()),t.hasHeights||(Me(e,t.view,t.rect),t.hasHeights=!0),s=Pe(e,t,i,n),s.bogus||(t.cache[a]=s)),{left:s.left,right:s.right,top:r?s.rtop:s.top,bottom:r?s.rbottom:s.bottom}}function Pe(e,t,i,n){for(var r,s,a,o,l=t.map,c=0;c<l.length;c+=3){var d=l[c],h=l[c+1];if(i<d?(s=0,a=1,o="left"):i<h?(s=i-d,a=s+1):(c==l.length-3||i==h&&l[c+3]>i)&&(a=h-d,s=a-1,i>=h&&(o="right")),null!=s){if(r=l[c+2],d==h&&n==(r.insertLeft?"left":"right")&&(o=n),"left"==n&&0==s)for(;c&&l[c-2]==l[c-3]&&l[c-1].insertLeft;)r=l[(c-=3)+2],o="left";if("right"==n&&s==h-d)for(;c<l.length-3&&l[c+3]==l[c+4]&&!l[c+5].insertLeft;)r=l[(c+=3)+2],o="right";break}}var u;if(3==r.nodeType){for(var c=0;c<4;c++){for(;s&&yr(t.line.text.charAt(d+s));)--s;for(;d+a<h&&yr(t.line.text.charAt(d+a));)++a;if(Qr&&Zr<9&&0==s&&a==h-d)u=r.parentNode.getBoundingClientRect();else if(Qr&&e.options.lineWrapping){var f=ba(r,s,a).getClientRects();u=f.length?f["right"==n?f.length-1:0]:ws}else u=ba(r,s,a).getBoundingClientRect()||ws;if(u.left||u.right||0==s)break;a=s,s-=1,o="right"}Qr&&Zr<11&&(u=Ie(e.display.measure,u))}else{s>0&&(o=n="right");var f;u=e.options.lineWrapping&&(f=r.getClientRects()).length>1?f["right"==n?f.length-1:0]:r.getBoundingClientRect()}if(Qr&&Zr<9&&!s&&(!u||!u.left&&!u.right)){var p=r.parentNode.getClientRects()[0];u=p?{left:p.left,right:p.left+Qe(e.display),top:p.top,bottom:p.bottom}:ws}for(var m=u.top-t.rect.top,g=u.bottom-t.rect.top,v=(m+g)/2,_=t.view.measure.heights,c=0;c<_.length-1&&!(v<_[c]);c++);var y=c?_[c-1]:0,b=_[c],x={left:("right"==o?u.right:u.left)-t.rect.left,right:("left"==o?u.left:u.right)-t.rect.left,top:y,bottom:b};return u.left||u.right||(x.bogus=!0),e.options.singleCursorHeightPerLine||(x.rtop=m,x.rbottom=g),x}function Ie(e,t){if(!window.screen||null==screen.logicalXDPI||screen.logicalXDPI==screen.deviceXDPI||!Fr(e))return t;var i=screen.logicalXDPI/screen.deviceXDPI,n=screen.logicalYDPI/screen.deviceYDPI;return{left:t.left*i,right:t.right*i,top:t.top*n,bottom:t.bottom*n}}function He(e){if(e.measure&&(e.measure.cache={},e.measure.heights=null,e.rest))for(var t=0;t<e.rest.length;t++)e.measure.caches[t]={}}function $e(e){e.display.externalMeasure=null,xr(e.display.lineMeasure);for(var t=0;t<e.display.view.length;t++)He(e.display.view[t])}function Re(e){$e(e),e.display.cachedCharWidth=e.display.cachedTextHeight=e.display.cachedPaddingH=null,e.options.lineWrapping||(e.display.maxLineChanged=!0),e.display.lineNumChars=null}function ze(){return window.pageXOffset||(document.documentElement||document.body).scrollLeft}function We(){return window.pageYOffset||(document.documentElement||document.body).scrollTop}function Ye(e,t,i,n){if(t.widgets)for(var r=0;r<t.widgets.length;++r)if(t.widgets[r].above){var s=sn(t.widgets[r]);i.top+=s,i.bottom+=s}if("line"==n)return i;n||(n="local");var a=Pn(t);if("local"==n?a+=Se(e.display):a-=e.display.viewOffset,"page"==n||"window"==n){var o=e.display.lineSpace.getBoundingClientRect();a+=o.top+("window"==n?0:We());var l=o.left+("window"==n?0:ze());i.left+=l,i.right+=l}return i.top+=a,i.bottom+=a,i}function Be(e,t,i){if("div"==i)return t;var n=t.left,r=t.top;if("page"==i)n-=ze(),r-=We();else if("local"==i||!i){var s=e.display.sizer.getBoundingClientRect();n+=s.left,r+=s.top}var a=e.display.lineSpace.getBoundingClientRect();return{left:n-a.left,top:r-a.top}}function Ue(e,t,i,n,r){return n||(n=Ln(e.doc,t.line)),Ye(e,n,Oe(e,n,t.ch,r),i)}function qe(e,t,i,n,r,s){function a(t,a){var o=Fe(e,r,t,a?"right":"left",s);return a?o.left=o.right:o.right=o.left,Ye(e,n,o,i)}function o(e,t){var i=l[t],n=i.level%2;return e==Ir(i)&&t&&i.level<l[t-1].level?(i=l[--t],e=Hr(i)-(i.level%2?0:1),n=!0):e==Hr(i)&&t<l.length-1&&i.level<l[t+1].level&&(i=l[++t],e=Ir(i)-i.level%2,n=!1),n&&e==i.to&&e>i.from?a(e-1):a(e,n)}n=n||Ln(e.doc,t.line),r||(r=Ne(e,n));var l=In(n),c=t.ch;if(!l)return a(c);var d=Ur(l,c),h=o(c,d);return null!=Na&&(h.other=o(c,Na)),h}function Xe(e,t){var i=0,t=Z(e.doc,t);e.options.lineWrapping||(i=Qe(e.display)*t.ch);var n=Ln(e.doc,t.line),r=Pn(n)+Se(e.display);return{left:i,right:i,top:r,bottom:r+n.height}}function Ve(e,t,i,n){var r=vs(e,t);return r.xRel=n,i&&(r.outside=!0),r}function Ge(e,t,i){var n=e.doc;if(i+=e.display.viewOffset,i<0)return Ve(n.first,0,!0,-1);var r=Fn(n,i),s=n.first+n.size-1;if(r>s)return Ve(n.first+n.size-1,Ln(n,s).text.length,!0,1);t<0&&(t=0);for(var a=Ln(n,r);;){var o=Ke(e,a,r,t,i),l=Gi(a),c=l&&l.find(0,!0);if(!l||!(o.ch>c.from.ch||o.ch==c.from.ch&&o.xRel>0))return o;r=Nn(a=c.to.line)}}function Ke(e,t,i,n,r){function s(n){var r=qe(e,vs(i,n),"line",t,c);return o=!0,a>r.bottom?r.left-l:a<r.top?r.left+l:(o=!1,r.left)}var a=r-Pn(t),o=!1,l=2*e.display.wrapper.clientWidth,c=Ne(e,t),d=In(t),h=t.text.length,u=$r(t),f=Rr(t),p=s(u),m=o,g=s(f),v=o;if(n>g)return Ve(i,f,v,1);for(;;){if(d?f==u||f==Xr(t,u,1):f-u<=1){for(var _=n<p||n-p<=g-n?u:f,y=n-(_==u?p:g);yr(t.text.charAt(_));)++_;var b=Ve(i,_,_==u?m:v,y<-1?-1:y>1?1:0);return b}var x=Math.ceil(h/2),w=u+x;if(d){w=u;for(var k=0;k<x;++k)w=Xr(t,w,1)}var C=s(w);C>n?(f=w,g=C,(v=o)&&(g+=1e3),h=x):(u=w,p=C,m=o,h-=x)}}function Je(e){if(null!=e.cachedTextHeight)return e.cachedTextHeight;if(null==ys){ys=br("pre");for(var t=0;t<49;++t)ys.appendChild(document.createTextNode("x")),ys.appendChild(br("br"));ys.appendChild(document.createTextNode("x"))}wr(e.measure,ys);var i=ys.offsetHeight/50;return i>3&&(e.cachedTextHeight=i),xr(e.measure),i||1}function Qe(e){if(null!=e.cachedCharWidth)return e.cachedCharWidth;var t=br("span","xxxxxxxxxx"),i=br("pre",[t]);wr(e.measure,i);var n=t.getBoundingClientRect(),r=(n.right-n.left)/10;return r>2&&(e.cachedCharWidth=r),r||10}function Ze(e){e.curOp={cm:e,viewChanged:!1,startHeight:e.doc.height,forceUpdate:!1,updateInput:null,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,id:++Cs},ks?ks.ops.push(e.curOp):e.curOp.ownsGroup=ks={ops:[e.curOp],delayedCallbacks:[]}}function et(e){var t=e.delayedCallbacks,i=0;do{for(;i<t.length;i++)t[i]();for(var n=0;n<e.ops.length;n++){var r=e.ops[n];if(r.cursorActivityHandlers)for(;r.cursorActivityCalled<r.cursorActivityHandlers.length;)r.cursorActivityHandlers[r.cursorActivityCalled++](r.cm)}}while(i<t.length)}function tt(e){var t=e.curOp,i=t.ownsGroup;if(i)try{et(i)}finally{ks=null;for(var n=0;n<i.ops.length;n++)i.ops[n].cm.curOp=null;it(i)}}function it(e){for(var t=e.ops,i=0;i<t.length;i++)nt(t[i]);for(var i=0;i<t.length;i++)rt(t[i]);for(var i=0;i<t.length;i++)st(t[i]);for(var i=0;i<t.length;i++)at(t[i]);for(var i=0;i<t.length;i++)ot(t[i])}function nt(e){var t=e.cm,i=t.display;e.updateMaxLine&&f(t),e.mustUpdate=e.viewChanged||e.forceUpdate||null!=e.scrollTop||e.scrollToPos&&(e.scrollToPos.from.line<i.viewFrom||e.scrollToPos.to.line>=i.viewTo)||i.maxLineChanged&&t.options.lineWrapping,e.update=e.mustUpdate&&new k(t,e.mustUpdate&&{top:e.scrollTop,ensure:e.scrollToPos},e.forceUpdate)}function rt(e){e.updatedDisplay=e.mustUpdate&&C(e.cm,e.update)}function st(e){var t=e.cm,i=t.display;e.updatedDisplay&&M(t),e.barMeasure=g(t),i.maxLineChanged&&!t.options.lineWrapping&&(e.adjustWidthTo=Oe(t,i.maxLine,i.maxLine.text.length).left+3,e.maxScrollLeft=Math.max(0,i.sizer.offsetLeft+e.adjustWidthTo+ua-i.scroller.clientWidth)),(e.updatedDisplay||e.selectionChanged)&&(e.newSelectionNodes=ge(t))}function at(e){var t=e.cm;null!=e.adjustWidthTo&&(t.display.sizer.style.minWidth=e.adjustWidthTo+"px",e.maxScrollLeft<t.doc.scrollLeft&&zt(t,Math.min(t.display.scroller.scrollLeft,e.maxScrollLeft),!0),t.display.maxLineChanged=!1),e.newSelectionNodes&&ve(t,e.newSelectionNodes),e.updatedDisplay&&j(t,e.barMeasure),(e.updatedDisplay||e.startHeight!=t.doc.height)&&v(t,e.barMeasure),e.selectionChanged&&xe(t),t.state.focused&&e.updateInput&&Ct(t,e.typing)}function ot(e){var t=e.cm,i=t.display,n=t.doc;if(null!=e.adjustWidthTo&&Math.abs(e.barMeasure.scrollWidth-t.display.scroller.scrollWidth)>1&&v(t),e.updatedDisplay&&D(t,e.update),null==i.wheelStartX||null==e.scrollTop&&null==e.scrollLeft&&!e.scrollToPos||(i.wheelStartX=i.wheelStartY=null),null!=e.scrollTop&&(i.scroller.scrollTop!=e.scrollTop||e.forceScroll)){var r=Math.max(0,Math.min(i.scroller.scrollHeight-i.scroller.clientHeight,e.scrollTop));i.scroller.scrollTop=i.scrollbarV.scrollTop=n.scrollTop=r}if(null!=e.scrollLeft&&(i.scroller.scrollLeft!=e.scrollLeft||e.forceScroll)){var s=Math.max(0,Math.min(i.scroller.scrollWidth-i.scroller.clientWidth,e.scrollLeft));i.scroller.scrollLeft=i.scrollbarH.scrollLeft=n.scrollLeft=s,y(t)}if(e.scrollToPos){var a=pi(t,Z(n,e.scrollToPos.from),Z(n,e.scrollToPos.to),e.scrollToPos.margin);e.scrollToPos.isCursor&&t.state.focused&&fi(t,a)}var o=e.maybeHiddenMarkers,l=e.maybeUnhiddenMarkers;if(o)for(var c=0;c<o.length;++c)o[c].lines.length||da(o[c],"hide");if(l)for(var c=0;c<l.length;++c)l[c].lines.length&&da(l[c],"unhide");i.wrapper.offsetHeight&&(n.scrollTop=t.display.scroller.scrollTop),e.updatedDisplay&&es&&(t.options.lineWrapping&&T(t,e.barMeasure),e.barMeasure.scrollWidth>e.barMeasure.clientWidth&&e.barMeasure.scrollWidth<e.barMeasure.clientWidth+1&&!m(t)&&v(t)),e.changeObjs&&da(t,"changes",t,e.changeObjs)}function lt(e,t){if(e.curOp)return t();Ze(e);try{return t()}finally{tt(e)}}function ct(e,t){return function(){if(e.curOp)return t.apply(e,arguments);Ze(e);try{return t.apply(e,arguments)}finally{tt(e)}}}function dt(e){return function(){if(this.curOp)return e.apply(this,arguments);Ze(this);try{return e.apply(this,arguments)}finally{tt(this)}}}function ht(e){return function(){var t=this.cm;if(!t||t.curOp)return e.apply(this,arguments);Ze(t);try{return e.apply(this,arguments)}finally{tt(t)}}}function ut(e,t,i){this.line=t,this.rest=Qi(t),this.size=this.rest?Nn(hr(this.rest))-i+1:1,this.node=this.text=null,this.hidden=tn(e,t)}function ft(e,t,i){for(var n,r=[],s=t;s<i;s=n){var a=new ut(e.doc,Ln(e.doc,s),s);n=s+a.size,r.push(a)}return r}function pt(e,t,i,n){null==t&&(t=e.doc.first),null==i&&(i=e.doc.first+e.doc.size),n||(n=0);var r=e.display;if(n&&i<r.viewTo&&(null==r.updateLineNumbers||r.updateLineNumbers>t)&&(r.updateLineNumbers=t),e.curOp.viewChanged=!0,t>=r.viewTo)gs&&Zi(e.doc,t)<r.viewTo&&gt(e);else if(i<=r.viewFrom)gs&&en(e.doc,i+n)>r.viewFrom?gt(e):(r.viewFrom+=n,r.viewTo+=n);else if(t<=r.viewFrom&&i>=r.viewTo)gt(e);else if(t<=r.viewFrom){var s=_t(e,i,i+n,1);s?(r.view=r.view.slice(s.index),r.viewFrom=s.lineN,r.viewTo+=n):gt(e)}else if(i>=r.viewTo){var s=_t(e,t,t,-1);s?(r.view=r.view.slice(0,s.index),r.viewTo=s.lineN):gt(e)}else{var a=_t(e,t,t,-1),o=_t(e,i,i+n,1);a&&o?(r.view=r.view.slice(0,a.index).concat(ft(e,a.lineN,o.lineN)).concat(r.view.slice(o.index)),r.viewTo+=n):gt(e)}var l=r.externalMeasured;l&&(i<l.lineN?l.lineN+=n:t<l.lineN+l.size&&(r.externalMeasured=null))}function mt(e,t,i){e.curOp.viewChanged=!0;var n=e.display,r=e.display.externalMeasured;if(r&&t>=r.lineN&&t<r.lineN+r.size&&(n.externalMeasured=null),!(t<n.viewFrom||t>=n.viewTo)){var s=n.view[vt(e,t)];if(null!=s.node){var a=s.changes||(s.changes=[]);ur(a,i)==-1&&a.push(i)}}}function gt(e){e.display.viewFrom=e.display.viewTo=e.doc.first,e.display.view=[],e.display.viewOffset=0}function vt(e,t){if(t>=e.display.viewTo)return null;if(t-=e.display.viewFrom,t<0)return null;for(var i=e.display.view,n=0;n<i.length;n++)if(t-=i[n].size,t<0)return n}function _t(e,t,i,n){var r,s=vt(e,t),a=e.display.view;if(!gs||i==e.doc.first+e.doc.size)return{index:s,lineN:i};for(var o=0,l=e.display.viewFrom;o<s;o++)l+=a[o].size;if(l!=t){if(n>0){if(s==a.length-1)return null;r=l+a[s].size-t,s++}else r=l-t;t+=r,i+=r}for(;Zi(e.doc,i)!=i;){if(s==(n<0?0:a.length-1))return null;i+=n*a[s-(n<0?1:0)].size,s+=n}return{index:s,lineN:i}}function yt(e,t,i){var n=e.display,r=n.view;0==r.length||t>=n.viewTo||i<=n.viewFrom?(n.view=ft(e,t,i),n.viewFrom=t):(n.viewFrom>t?n.view=ft(e,t,n.viewFrom).concat(n.view):n.viewFrom<t&&(n.view=n.view.slice(vt(e,t))),n.viewFrom=t,n.viewTo<i?n.view=n.view.concat(ft(e,n.viewTo,i)):n.viewTo>i&&(n.view=n.view.slice(0,vt(e,i)))),n.viewTo=i}function bt(e){for(var t=e.display.view,i=0,n=0;n<t.length;n++){var r=t[n];r.hidden||r.node&&!r.changes||++i}return i}function xt(e){e.display.pollingFast||e.display.poll.set(e.options.pollInterval,function(){kt(e),e.state.focused&&xt(e)})}function wt(e){function t(){var n=kt(e);n||i?(e.display.pollingFast=!1,xt(e)):(i=!0,e.display.poll.set(60,t))}var i=!1;e.display.pollingFast=!0,e.display.poll.set(20,t)}function kt(e){var t=e.display.input,i=e.display.prevInput,n=e.doc;if(!e.state.focused||La(t)&&!i||jt(e)||e.options.disableInput)return!1;e.state.pasteIncoming&&e.state.fakedLastChar&&(t.value=t.value.substring(0,t.value.length-1),e.state.fakedLastChar=!1);var r=t.value;if(r==i&&!e.somethingSelected())return!1;if(Qr&&Zr>=9&&e.display.inputHasSelection===r||ds&&/[\uf700-\uf7ff]/.test(r))return Ct(e),!1;var s=!e.curOp;s&&Ze(e),e.display.shift=!1,8203!=r.charCodeAt(0)||n.sel!=e.display.selForContextMenu||i||(i="​");for(var a=0,o=Math.min(i.length,r.length);a<o&&i.charCodeAt(a)==r.charCodeAt(a);)++a;var l=r.slice(a),c=Ma(l),d=null;e.state.pasteIncoming&&n.sel.ranges.length>1&&(Ds&&Ds.join("\n")==l?d=n.sel.ranges.length%Ds.length==0&&fr(Ds,Ma):c.length==n.sel.ranges.length&&(d=fr(c,function(e){return[e]})));for(var h=n.sel.ranges.length-1;h>=0;h--){var u=n.sel.ranges[h],f=u.from(),p=u.to();a<i.length?f=vs(f.line,f.ch-(i.length-a)):e.state.overwrite&&u.empty()&&!e.state.pasteIncoming&&(p=vs(p.line,Math.min(Ln(n,p.line).text.length,p.ch+hr(c).length)));var m=e.curOp.updateInput,g={from:f,to:p,text:d?d[h%d.length]:c,origin:e.state.pasteIncoming?"paste":e.state.cutIncoming?"cut":"+input"};if(ai(e.doc,g),ir(e,"inputRead",e,g),l&&!e.state.pasteIncoming&&e.options.electricChars&&e.options.smartIndent&&u.head.ch<100&&(!h||n.sel.ranges[h-1].head.line!=u.head.line)){var v=e.getModeAt(u.head),_=Es(g);if(v.electricChars){for(var y=0;y<v.electricChars.length;y++)if(l.indexOf(v.electricChars.charAt(y))>-1){bi(e,_.line,"smart");break}}else v.electricInput&&v.electricInput.test(Ln(n,_.line).text.slice(0,_.ch))&&bi(e,_.line,"smart")}}return _i(e),e.curOp.updateInput=m,e.curOp.typing=!0,r.length>1e3||r.indexOf("\n")>-1?t.value=e.display.prevInput="":e.display.prevInput=r,s&&tt(e),e.state.pasteIncoming=e.state.cutIncoming=!1,!0}function Ct(e,t){var i,n,r=e.doc;if(e.somethingSelected()){e.display.prevInput="";var s=r.sel.primary();i=Ea&&(s.to().line-s.from().line>100||(n=e.getSelection()).length>1e3);var a=i?"-":n||e.getSelection();e.display.input.value=a,e.state.focused&&ya(e.display.input),Qr&&Zr>=9&&(e.display.inputHasSelection=a)}else t||(e.display.prevInput=e.display.input.value="",Qr&&Zr>=9&&(e.display.inputHasSelection=null));e.display.inaccurateSelection=i}function Dt(e){"nocursor"==e.options.readOnly||cs&&Cr()==e.display.input||e.display.input.focus()}function St(e){e.state.focused||(Dt(e),Jt(e))}function jt(e){return e.options.readOnly||e.doc.cantEdit}function Tt(e){function t(){e.state.focused&&setTimeout(gr(Dt,e),0)}function i(t){rr(e,t)||oa(t)}function n(t){if(e.somethingSelected())Ds=e.getSelections(),r.inaccurateSelection&&(r.prevInput="",r.inaccurateSelection=!1,r.input.value=Ds.join("\n"),ya(r.input));else{for(var i=[],n=[],s=0;s<e.doc.sel.ranges.length;s++){var a=e.doc.sel.ranges[s].head.line,o={anchor:vs(a,0),head:vs(a+1,0)};n.push(o),i.push(e.getRange(o.anchor,o.head))}"cut"==t.type?e.setSelections(n,null,pa):(r.prevInput="",r.input.value=i.join("\n"),ya(r.input)),Ds=i}"cut"==t.type&&(e.state.cutIncoming=!0)}var r=e.display;la(r.scroller,"mousedown",ct(e,Ot)),Qr&&Zr<11?la(r.scroller,"dblclick",ct(e,function(t){if(!rr(e,t)){var i=Et(e,t);if(i&&!It(e,t)&&!Lt(e.display,t)){sa(t);var n=e.findWordAt(i);re(e.doc,n.anchor,n.head)}}})):la(r.scroller,"dblclick",function(t){rr(e,t)||sa(t)}),la(r.lineSpace,"selectstart",function(e){Lt(r,e)||sa(e)}),ps||la(r.scroller,"contextmenu",function(t){Zt(e,t)}),la(r.scroller,"scroll",function(){r.scroller.clientHeight&&(Rt(e,r.scroller.scrollTop),zt(e,r.scroller.scrollLeft,!0),da(e,"scroll",e))}),la(r.scrollbarV,"scroll",function(){r.scroller.clientHeight&&Rt(e,r.scrollbarV.scrollTop)}),la(r.scrollbarH,"scroll",function(){r.scroller.clientHeight&&zt(e,r.scrollbarH.scrollLeft)}),la(r.scroller,"mousewheel",function(t){Wt(e,t)}),la(r.scroller,"DOMMouseScroll",function(t){Wt(e,t)}),la(r.scrollbarH,"mousedown",t),la(r.scrollbarV,"mousedown",t),la(r.wrapper,"scroll",function(){r.wrapper.scrollTop=r.wrapper.scrollLeft=0}),la(r.input,"keyup",function(t){Gt.call(e,t)}),la(r.input,"input",function(){Qr&&Zr>=9&&e.display.inputHasSelection&&(e.display.inputHasSelection=null),wt(e)}),la(r.input,"keydown",ct(e,Xt)),la(r.input,"keypress",ct(e,Kt)),la(r.input,"focus",gr(Jt,e)),la(r.input,"blur",gr(Qt,e)),e.options.dragDrop&&(la(r.scroller,"dragstart",function(t){$t(e,t)}),la(r.scroller,"dragenter",i),la(r.scroller,"dragover",i),la(r.scroller,"drop",ct(e,Ht))),la(r.scroller,"paste",function(t){Lt(r,t)||(e.state.pasteIncoming=!0,Dt(e),wt(e))}),la(r.input,"paste",function(){if(es&&!e.state.fakedLastChar&&!(new Date-e.state.lastMiddleDown<200)){var t=r.input.selectionStart,i=r.input.selectionEnd;r.input.value+="$",r.input.selectionEnd=i,r.input.selectionStart=t,e.state.fakedLastChar=!0}e.state.pasteIncoming=!0,wt(e)}),la(r.input,"cut",n),la(r.input,"copy",n),ss&&la(r.sizer,"mouseup",function(){Cr()==r.input&&r.input.blur(),Dt(e)})}function Mt(e){var t=e.display;t.cachedCharWidth=t.cachedTextHeight=t.cachedPaddingH=null,e.setSize()}function Lt(e,t){for(var i=er(t);i!=e.wrapper;i=i.parentNode)if(!i||i.ignoreEvents||i.parentNode==e.sizer&&i!=e.mover)return!0}function Et(e,t,i,n){var r=e.display;if(!i){var s=er(t);if(s==r.scrollbarH||s==r.scrollbarV||s==r.scrollbarFiller||s==r.gutterFiller)return null}var a,o,l=r.lineSpace.getBoundingClientRect();try{a=t.clientX-l.left,o=t.clientY-l.top}catch(t){return null}var c,d=Ge(e,a,o);if(n&&1==d.xRel&&(c=Ln(e.doc,d.line).text).length==d.ch){var h=va(c,c.length,e.options.tabSize)-c.length;d=vs(d.line,Math.max(0,Math.round((a-Te(e.display).left)/Qe(e.display))-h))}return d}function Ot(e){if(!rr(this,e)){var t=this,i=t.display;if(i.shift=e.shiftKey,Lt(i,e))return void(es||(i.scroller.draggable=!1,setTimeout(function(){i.scroller.draggable=!0},100)));if(!It(t,e)){var n=Et(t,e);switch(window.focus(),tr(e)){case 1:n?At(t,e,n):er(e)==i.scroller&&sa(e);break;case 2:es&&(t.state.lastMiddleDown=+new Date),n&&re(t.doc,n),setTimeout(gr(Dt,t),20),sa(e);break;case 3:ps&&Zt(t,e)}}}}function At(e,t,i){setTimeout(gr(St,e),0);var n,r=+new Date;xs&&xs.time>r-400&&0==_s(xs.pos,i)?n="triple":bs&&bs.time>r-400&&0==_s(bs.pos,i)?(n="double",xs={time:r,pos:i}):(n="single",bs={time:r,pos:i});var s=e.doc.sel,a=ds?t.metaKey:t.ctrlKey;e.options.dragDrop&&Ta&&!jt(e)&&"single"==n&&s.contains(i)>-1&&s.somethingSelected()?Nt(e,t,i,a):Ft(e,t,i,n,a)}function Nt(e,t,i,n){var r=e.display,s=ct(e,function(a){es&&(r.scroller.draggable=!1),e.state.draggingText=!1,ca(document,"mouseup",s),ca(r.scroller,"drop",s),Math.abs(t.clientX-a.clientX)+Math.abs(t.clientY-a.clientY)<10&&(sa(a),n||re(e.doc,i),Dt(e),Qr&&9==Zr&&setTimeout(function(){document.body.focus(),Dt(e)},20))});es&&(r.scroller.draggable=!0),e.state.draggingText=s,r.scroller.dragDrop&&r.scroller.dragDrop(),la(document,"mouseup",s),la(r.scroller,"drop",s)}function Ft(e,t,i,n,r){function s(t){if(0!=_s(m,t))if(m=t,"rect"==n){for(var r=[],s=e.options.tabSize,a=va(Ln(c,i.line).text,i.ch,s),o=va(Ln(c,t.line).text,t.ch,s),l=Math.min(a,o),f=Math.max(a,o),p=Math.min(i.line,t.line),g=Math.min(e.lastLine(),Math.max(i.line,t.line));p<=g;p++){var v=Ln(c,p).text,_=cr(v,l,s);l==f?r.push(new G(vs(p,_),vs(p,_))):v.length>_&&r.push(new G(vs(p,_),vs(p,cr(v,f,s))))}r.length||r.push(new G(i,i)),de(c,K(u.ranges.slice(0,h).concat(r),h),{origin:"*mouse",scroll:!1}),e.scrollIntoView(t)}else{var y=d,b=y.anchor,x=t;if("single"!=n){if("double"==n)var w=e.findWordAt(t);else var w=new G(vs(t.line,0),Z(c,vs(t.line+1,0)));_s(w.anchor,b)>0?(x=w.head,b=X(y.from(),w.anchor)):(x=w.anchor,b=q(y.to(),w.head))}var r=u.ranges.slice(0);r[h]=new G(Z(c,b),x),de(c,K(r,h),ma)}}function a(t){var i=++v,r=Et(e,t,!0,"rect"==n);if(r)if(0!=_s(r,m)){St(e),s(r);var o=_(l,c);(r.line>=o.to||r.line<o.from)&&setTimeout(ct(e,function(){v==i&&a(t)}),150)}else{var d=t.clientY<g.top?-20:t.clientY>g.bottom?20:0;d&&setTimeout(ct(e,function(){v==i&&(l.scroller.scrollTop+=d,a(t))}),50)}}function o(t){v=1/0,sa(t),Dt(e),ca(document,"mousemove",y),ca(document,"mouseup",b),c.history.lastSelOrigin=null}var l=e.display,c=e.doc;sa(t);var d,h,u=c.sel;if(r&&!t.shiftKey?(h=c.sel.contains(i),d=h>-1?c.sel.ranges[h]:new G(i,i)):d=c.sel.primary(),t.altKey)n="rect",r||(d=new G(i,i)),i=Et(e,t,!0,!0),h=-1;else if("double"==n){var f=e.findWordAt(i);d=e.display.shift||c.extend?ne(c,d,f.anchor,f.head):f}else if("triple"==n){var p=new G(vs(i.line,0),Z(c,vs(i.line+1,0)));d=e.display.shift||c.extend?ne(c,d,p.anchor,p.head):p}else d=ne(c,d,i);r?h>-1?ae(c,h,d,ma):(h=c.sel.ranges.length,de(c,K(c.sel.ranges.concat([d]),h),{scroll:!1,origin:"*mouse"})):(h=0,de(c,new V([d],0),ma),u=c.sel);var m=i,g=l.wrapper.getBoundingClientRect(),v=0,y=ct(e,function(e){tr(e)?a(e):o(e)}),b=ct(e,o);la(document,"mousemove",y),la(document,"mouseup",b)}function Pt(e,t,i,n,r){try{var s=t.clientX,a=t.clientY}catch(t){return!1}if(s>=Math.floor(e.display.gutters.getBoundingClientRect().right))return!1;n&&sa(t);var o=e.display,l=o.lineDiv.getBoundingClientRect();if(a>l.bottom||!ar(e,i))return Zn(t);a-=l.top-o.viewOffset;for(var c=0;c<e.options.gutters.length;++c){var d=o.gutters.childNodes[c];if(d&&d.getBoundingClientRect().right>=s){var h=Fn(e.doc,a),u=e.options.gutters[c];return r(e,i,e,h,u,t),Zn(t)}}}function It(e,t){return Pt(e,t,"gutterClick",!0,ir)}function Ht(e){var t=this;if(!rr(t,e)&&!Lt(t.display,e)){sa(e),Qr&&(Ss=+new Date);var i=Et(t,e,!0),n=e.dataTransfer.files;if(i&&!jt(t))if(n&&n.length&&window.FileReader&&window.File)for(var r=n.length,s=Array(r),a=0,o=function(e,n){var o=new FileReader;o.onload=ct(t,function(){if(s[n]=o.result,++a==r){i=Z(t.doc,i);var e={from:i,to:i,text:Ma(s.join("\n")),origin:"paste"};ai(t.doc,e),ce(t.doc,J(i,Es(e)))}}),o.readAsText(e)},l=0;l<r;++l)o(n[l],l);else{if(t.state.draggingText&&t.doc.sel.contains(i)>-1)return t.state.draggingText(e),void setTimeout(gr(Dt,t),20);try{var s=e.dataTransfer.getData("Text");if(s){if(t.state.draggingText&&!(ds?e.metaKey:e.ctrlKey))var c=t.listSelections();if(he(t.doc,J(i,i)),c)for(var l=0;l<c.length;++l)ui(t.doc,"",c[l].anchor,c[l].head,"drag");t.replaceSelection(s,"around","paste"),Dt(t)}}catch(e){}}}}function $t(e,t){if(Qr&&(!e.state.draggingText||+new Date-Ss<100))return void oa(t);if(!rr(e,t)&&!Lt(e.display,t)&&(t.dataTransfer.setData("Text",e.getSelection()),t.dataTransfer.setDragImage&&!rs)){var i=br("img",null,null,"position: fixed; left: 0; top: 0;");i.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",ns&&(i.width=i.height=1,e.display.wrapper.appendChild(i),i._top=i.offsetTop),t.dataTransfer.setDragImage(i,0,0),ns&&i.parentNode.removeChild(i)}}function Rt(e,t){Math.abs(e.doc.scrollTop-t)<2||(e.doc.scrollTop=t,Gr||S(e,{top:t}),e.display.scroller.scrollTop!=t&&(e.display.scroller.scrollTop=t),e.display.scrollbarV.scrollTop!=t&&(e.display.scrollbarV.scrollTop=t),Gr&&S(e),we(e,100))}function zt(e,t,i){(i?t==e.doc.scrollLeft:Math.abs(e.doc.scrollLeft-t)<2)||(t=Math.min(t,e.display.scroller.scrollWidth-e.display.scroller.clientWidth),e.doc.scrollLeft=t,y(e),e.display.scroller.scrollLeft!=t&&(e.display.scroller.scrollLeft=t),e.display.scrollbarH.scrollLeft!=t&&(e.display.scrollbarH.scrollLeft=t))}function Wt(e,t){var i=t.wheelDeltaX,n=t.wheelDeltaY;null==i&&t.detail&&t.axis==t.HORIZONTAL_AXIS&&(i=t.detail),null==n&&t.detail&&t.axis==t.VERTICAL_AXIS?n=t.detail:null==n&&(n=t.wheelDelta);var r=e.display,s=r.scroller;if(i&&s.scrollWidth>s.clientWidth||n&&s.scrollHeight>s.clientHeight){if(n&&ds&&es)e:for(var a=t.target,o=r.view;a!=s;a=a.parentNode)for(var l=0;l<o.length;l++)if(o[l].node==a){e.display.currentWheelTarget=a;break e}if(i&&!Gr&&!ns&&null!=Ts)return n&&Rt(e,Math.max(0,Math.min(s.scrollTop+n*Ts,s.scrollHeight-s.clientHeight))),zt(e,Math.max(0,Math.min(s.scrollLeft+i*Ts,s.scrollWidth-s.clientWidth))),sa(t),void(r.wheelStartX=null);if(n&&null!=Ts){var c=n*Ts,d=e.doc.scrollTop,h=d+r.wrapper.clientHeight;c<0?d=Math.max(0,d+c-50):h=Math.min(e.doc.height,h+c+50),S(e,{top:d,bottom:h})}js<20&&(null==r.wheelStartX?(r.wheelStartX=s.scrollLeft,r.wheelStartY=s.scrollTop,r.wheelDX=i,r.wheelDY=n,setTimeout(function(){if(null!=r.wheelStartX){var e=s.scrollLeft-r.wheelStartX,t=s.scrollTop-r.wheelStartY,i=t&&r.wheelDY&&t/r.wheelDY||e&&r.wheelDX&&e/r.wheelDX;r.wheelStartX=r.wheelStartY=null,i&&(Ts=(Ts*js+i)/(js+1),++js)}},200)):(r.wheelDX+=i,r.wheelDY+=n))}}function Yt(e,t,i){if("string"==typeof t&&(t=Ws[t],!t))return!1;e.display.pollingFast&&kt(e)&&(e.display.pollingFast=!1);var n=e.display.shift,r=!1;try{jt(e)&&(e.state.suppressEdits=!0),i&&(e.display.shift=!1),r=t(e)!=fa}finally{e.display.shift=n,e.state.suppressEdits=!1}return r}function Bt(e){var t=e.state.keyMaps.slice(0);return e.options.extraKeys&&t.push(e.options.extraKeys),t.push(e.options.keyMap),t}function Ut(e,t){var i=Si(e.options.keyMap),n=i.auto;clearTimeout(Ms),n&&!Us(t)&&(Ms=setTimeout(function(){Si(e.options.keyMap)==i&&(e.options.keyMap=n.call?n.call(null,e):n,o(e))},50));var r=qs(t,!0),s=!1;if(!r)return!1;var a=Bt(e);return s=t.shiftKey?Bs("Shift-"+r,a,function(t){return Yt(e,t,!0)})||Bs(r,a,function(t){if("string"==typeof t?/^go[A-Z]/.test(t):t.motion)return Yt(e,t)}):Bs(r,a,function(t){return Yt(e,t)}),s&&(sa(t),xe(e),ir(e,"keyHandled",e,r,t)),s}function qt(e,t,i){var n=Bs("'"+i+"'",Bt(e),function(t){return Yt(e,t,!0)});return n&&(sa(t),xe(e),ir(e,"keyHandled",e,"'"+i+"'",t)),n}function Xt(e){var t=this;if(St(t),!rr(t,e)){Qr&&Zr<11&&27==e.keyCode&&(e.returnValue=!1);var i=e.keyCode;t.display.shift=16==i||e.shiftKey;var n=Ut(t,e);ns&&(Ls=n?i:null,!n&&88==i&&!Ea&&(ds?e.metaKey:e.ctrlKey)&&t.replaceSelection("",null,"cut")),18!=i||/\bCodeMirror-crosshair\b/.test(t.display.lineDiv.className)||Vt(t)}}function Vt(e){function t(e){18!=e.keyCode&&e.altKey||(Sr(i,"CodeMirror-crosshair"),ca(document,"keyup",t),ca(document,"mouseover",t))}var i=e.display.lineDiv;jr(i,"CodeMirror-crosshair"),la(document,"keyup",t),la(document,"mouseover",t)}function Gt(e){16==e.keyCode&&(this.doc.sel.shift=!1),rr(this,e)}function Kt(e){var t=this;if(!(rr(t,e)||e.ctrlKey&&!e.altKey||ds&&e.metaKey)){var i=e.keyCode,n=e.charCode;if(ns&&i==Ls)return Ls=null,void sa(e);if(!(ns&&(!e.which||e.which<10)||ss)||!Ut(t,e)){var r=String.fromCharCode(null==n?i:n);qt(t,e,r)||(Qr&&Zr>=9&&(t.display.inputHasSelection=null),wt(t))}}}function Jt(e){"nocursor"!=e.options.readOnly&&(e.state.focused||(da(e,"focus",e),e.state.focused=!0,jr(e.display.wrapper,"CodeMirror-focused"),e.curOp||e.display.selForContextMenu==e.doc.sel||(Ct(e),es&&setTimeout(gr(Ct,e,!0),0))),xt(e),xe(e))}function Qt(e){e.state.focused&&(da(e,"blur",e),e.state.focused=!1,Sr(e.display.wrapper,"CodeMirror-focused")),clearInterval(e.display.blinker),setTimeout(function(){e.state.focused||(e.display.shift=!1)},150)}function Zt(e,t){function i(){if(null!=r.input.selectionStart){var t=e.somethingSelected(),i=r.input.value="​"+(t?r.input.value:"");r.prevInput=t?"":"​",r.input.selectionStart=1,r.input.selectionEnd=i.length,r.selForContextMenu=e.doc.sel}}function n(){if(r.inputDiv.style.position="relative",r.input.style.cssText=l,Qr&&Zr<9&&(r.scrollbarV.scrollTop=r.scroller.scrollTop=a),xt(e),null!=r.input.selectionStart){(!Qr||Qr&&Zr<9)&&i();var t=0,n=function(){r.selForContextMenu==e.doc.sel&&0==r.input.selectionStart?ct(e,Ws.selectAll)(e):t++<10?r.detectingSelectAll=setTimeout(n,500):Ct(e)};r.detectingSelectAll=setTimeout(n,200)}}if(!rr(e,t,"contextmenu")){var r=e.display;if(!Lt(r,t)&&!ei(e,t)){var s=Et(e,t),a=r.scroller.scrollTop;if(s&&!ns){var o=e.options.resetSelectionOnContextMenu;o&&e.doc.sel.contains(s)==-1&&ct(e,de)(e.doc,J(s),pa);var l=r.input.style.cssText;if(r.inputDiv.style.position="absolute",r.input.style.cssText="position: fixed; width: 30px; height: 30px; top: "+(t.clientY-5)+"px; left: "+(t.clientX-5)+"px; z-index: 1000; background: "+(Qr?"rgba(255, 255, 255, .05)":"transparent")+"; outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);",es)var c=window.scrollY;if(Dt(e),es&&window.scrollTo(null,c),Ct(e),e.somethingSelected()||(r.input.value=r.prevInput=" "),r.selForContextMenu=e.doc.sel,clearTimeout(r.detectingSelectAll),Qr&&Zr>=9&&i(),ps){oa(t);var d=function(){ca(window,"mouseup",d),setTimeout(n,20)};la(window,"mouseup",d)}else setTimeout(n,50)}}}}function ei(e,t){return!!ar(e,"gutterContextMenu")&&Pt(e,t,"gutterContextMenu",!1,da)}function ti(e,t){if(_s(e,t.from)<0)return e;if(_s(e,t.to)<=0)return Es(t);var i=e.line+t.text.length-(t.to.line-t.from.line)-1,n=e.ch;return e.line==t.to.line&&(n+=Es(t).ch-t.to.ch),vs(i,n)}function ii(e,t){for(var i=[],n=0;n<e.sel.ranges.length;n++){var r=e.sel.ranges[n];i.push(new G(ti(r.anchor,t),ti(r.head,t)))}return K(i,e.sel.primIndex)}function ni(e,t,i){return e.line==t.line?vs(i.line,e.ch-t.ch+i.ch):vs(i.line+(e.line-t.line),e.ch);
}function ri(e,t,i){for(var n=[],r=vs(e.first,0),s=r,a=0;a<t.length;a++){var o=t[a],l=ni(o.from,r,s),c=ni(Es(o),r,s);if(r=o.to,s=c,"around"==i){var d=e.sel.ranges[a],h=_s(d.head,d.anchor)<0;n[a]=new G(h?c:l,h?l:c)}else n[a]=new G(l,l)}return new V(n,e.sel.primIndex)}function si(e,t,i){var n={canceled:!1,from:t.from,to:t.to,text:t.text,origin:t.origin,cancel:function(){this.canceled=!0}};return i&&(n.update=function(t,i,n,r){t&&(this.from=Z(e,t)),i&&(this.to=Z(e,i)),n&&(this.text=n),void 0!==r&&(this.origin=r)}),da(e,"beforeChange",e,n),e.cm&&da(e.cm,"beforeChange",e.cm,n),n.canceled?null:{from:n.from,to:n.to,text:n.text,origin:n.origin}}function ai(e,t,i){if(e.cm){if(!e.cm.curOp)return ct(e.cm,ai)(e,t,i);if(e.cm.state.suppressEdits)return}if(!(ar(e,"beforeChange")||e.cm&&ar(e.cm,"beforeChange"))||(t=si(e,t,!0))){var n=ms&&!i&&zi(e,t.from,t.to);if(n)for(var r=n.length-1;r>=0;--r)oi(e,{from:n[r].from,to:n[r].to,text:r?[""]:t.text});else oi(e,t)}}function oi(e,t){if(1!=t.text.length||""!=t.text[0]||0!=_s(t.from,t.to)){var i=ii(e,t);Wn(e,t,i,e.cm?e.cm.curOp.id:NaN),di(e,t,i,Hi(e,t));var n=[];Tn(e,function(e,i){i||ur(n,e.history)!=-1||(Qn(e.history,t),n.push(e.history)),di(e,t,null,Hi(e,t))})}}function li(e,t,i){if(!e.cm||!e.cm.state.suppressEdits){for(var n,r=e.history,s=e.sel,a="undo"==t?r.done:r.undone,o="undo"==t?r.undone:r.done,l=0;l<a.length&&(n=a[l],i?!n.ranges||n.equals(e.sel):n.ranges);l++);if(l!=a.length){for(r.lastOrigin=r.lastSelOrigin=null;n=a.pop(),n.ranges;){if(Un(n,o),i&&!n.equals(e.sel))return void de(e,n,{clearRedo:!1});s=n}var c=[];Un(s,o),o.push({changes:c,generation:r.generation}),r.generation=n.generation||++r.maxGeneration;for(var d=ar(e,"beforeChange")||e.cm&&ar(e.cm,"beforeChange"),l=n.changes.length-1;l>=0;--l){var h=n.changes[l];if(h.origin=t,d&&!si(e,h,!1))return void(a.length=0);c.push($n(e,h));var u=l?ii(e,h):hr(a);di(e,h,u,Ri(e,h)),!l&&e.cm&&e.cm.scrollIntoView({from:h.from,to:Es(h)});var f=[];Tn(e,function(e,t){t||ur(f,e.history)!=-1||(Qn(e.history,h),f.push(e.history)),di(e,h,null,Ri(e,h))})}}}}function ci(e,t){if(0!=t&&(e.first+=t,e.sel=new V(fr(e.sel.ranges,function(e){return new G(vs(e.anchor.line+t,e.anchor.ch),vs(e.head.line+t,e.head.ch))}),e.sel.primIndex),e.cm)){pt(e.cm,e.first,e.first-t,t);for(var i=e.cm.display,n=i.viewFrom;n<i.viewTo;n++)mt(e.cm,n,"gutter")}}function di(e,t,i,n){if(e.cm&&!e.cm.curOp)return ct(e.cm,di)(e,t,i,n);if(t.to.line<e.first)return void ci(e,t.text.length-1-(t.to.line-t.from.line));if(!(t.from.line>e.lastLine())){if(t.from.line<e.first){var r=t.text.length-1-(e.first-t.from.line);ci(e,r),t={from:vs(e.first,0),to:vs(t.to.line+r,t.to.ch),text:[hr(t.text)],origin:t.origin}}var s=e.lastLine();t.to.line>s&&(t={from:t.from,to:vs(s,Ln(e,s).text.length),text:[t.text[0]],origin:t.origin}),t.removed=En(e,t.from,t.to),i||(i=ii(e,t)),e.cm?hi(e.cm,t,n):Dn(e,t,n),he(e,i,pa)}}function hi(e,t,i){var n=e.doc,r=e.display,a=t.from,o=t.to,l=!1,c=a.line;e.options.lineWrapping||(c=Nn(Ji(Ln(n,a.line))),n.iter(c,o.line+1,function(e){if(e==r.maxLine)return l=!0,!0})),n.sel.contains(t.from,t.to)>-1&&sr(e),Dn(n,t,i,s(e)),e.options.lineWrapping||(n.iter(c,a.line+t.text.length,function(e){var t=u(e);t>r.maxLineLength&&(r.maxLine=e,r.maxLineLength=t,r.maxLineChanged=!0,l=!1)}),l&&(e.curOp.updateMaxLine=!0)),n.frontier=Math.min(n.frontier,a.line),we(e,400);var d=t.text.length-(o.line-a.line)-1;a.line!=o.line||1!=t.text.length||Cn(e.doc,t)?pt(e,a.line,o.line+1,d):mt(e,a.line,"text");var h=ar(e,"changes"),f=ar(e,"change");if(f||h){var p={from:a,to:o,text:t.text,removed:t.removed,origin:t.origin};f&&ir(e,"change",e,p),h&&(e.curOp.changeObjs||(e.curOp.changeObjs=[])).push(p)}e.display.selForContextMenu=null}function ui(e,t,i,n,r){if(n||(n=i),_s(n,i)<0){var s=n;n=i,i=s}"string"==typeof t&&(t=Ma(t)),ai(e,{from:i,to:n,text:t,origin:r})}function fi(e,t){var i=e.display,n=i.sizer.getBoundingClientRect(),r=null;if(t.top+n.top<0?r=!0:t.bottom+n.top>(window.innerHeight||document.documentElement.clientHeight)&&(r=!1),null!=r&&!os){var s=br("div","​",null,"position: absolute; top: "+(t.top-i.viewOffset-Se(e.display))+"px; height: "+(t.bottom-t.top+ua)+"px; left: "+t.left+"px; width: 2px;");e.display.lineSpace.appendChild(s),s.scrollIntoView(r),e.display.lineSpace.removeChild(s)}}function pi(e,t,i,n){null==n&&(n=0);for(var r=0;r<5;r++){var s=!1,a=qe(e,t),o=i&&i!=t?qe(e,i):a,l=gi(e,Math.min(a.left,o.left),Math.min(a.top,o.top)-n,Math.max(a.left,o.left),Math.max(a.bottom,o.bottom)+n),c=e.doc.scrollTop,d=e.doc.scrollLeft;if(null!=l.scrollTop&&(Rt(e,l.scrollTop),Math.abs(e.doc.scrollTop-c)>1&&(s=!0)),null!=l.scrollLeft&&(zt(e,l.scrollLeft),Math.abs(e.doc.scrollLeft-d)>1&&(s=!0)),!s)return a}}function mi(e,t,i,n,r){var s=gi(e,t,i,n,r);null!=s.scrollTop&&Rt(e,s.scrollTop),null!=s.scrollLeft&&zt(e,s.scrollLeft)}function gi(e,t,i,n,r){var s=e.display,a=Je(e.display);i<0&&(i=0);var o=e.curOp&&null!=e.curOp.scrollTop?e.curOp.scrollTop:s.scroller.scrollTop,l=s.scroller.clientHeight-ua,c={};r-i>l&&(r=i+l);var d=e.doc.height+je(s),h=i<a,u=r>d-a;if(i<o)c.scrollTop=h?0:i;else if(r>o+l){var f=Math.min(i,(u?d:r)-l);f!=o&&(c.scrollTop=f)}var p=e.curOp&&null!=e.curOp.scrollLeft?e.curOp.scrollLeft:s.scroller.scrollLeft,m=s.scroller.clientWidth-ua-s.gutters.offsetWidth,g=n-t>m;return g&&(n=t+m),t<10?c.scrollLeft=0:t<p?c.scrollLeft=Math.max(0,t-(g?0:10)):n>m+p-3&&(c.scrollLeft=n+(g?0:10)-m),c}function vi(e,t,i){null==t&&null==i||yi(e),null!=t&&(e.curOp.scrollLeft=(null==e.curOp.scrollLeft?e.doc.scrollLeft:e.curOp.scrollLeft)+t),null!=i&&(e.curOp.scrollTop=(null==e.curOp.scrollTop?e.doc.scrollTop:e.curOp.scrollTop)+i)}function _i(e){yi(e);var t=e.getCursor(),i=t,n=t;e.options.lineWrapping||(i=t.ch?vs(t.line,t.ch-1):t,n=vs(t.line,t.ch+1)),e.curOp.scrollToPos={from:i,to:n,margin:e.options.cursorScrollMargin,isCursor:!0}}function yi(e){var t=e.curOp.scrollToPos;if(t){e.curOp.scrollToPos=null;var i=Xe(e,t.from),n=Xe(e,t.to),r=gi(e,Math.min(i.left,n.left),Math.min(i.top,n.top)-t.margin,Math.max(i.right,n.right),Math.max(i.bottom,n.bottom)+t.margin);e.scrollTo(r.scrollLeft,r.scrollTop)}}function bi(e,t,i,n){var r,s=e.doc;null==i&&(i="add"),"smart"==i&&(s.mode.indent?r=De(e,t):i="prev");var a=e.options.tabSize,o=Ln(s,t),l=va(o.text,null,a);o.stateAfter&&(o.stateAfter=null);var c,d=o.text.match(/^\s*/)[0];if(n||/\S/.test(o.text)){if("smart"==i&&(c=s.mode.indent(r,o.text.slice(d.length),o.text),c==fa||c>150)){if(!n)return;i="prev"}}else c=0,i="not";"prev"==i?c=t>s.first?va(Ln(s,t-1).text,null,a):0:"add"==i?c=l+e.options.indentUnit:"subtract"==i?c=l-e.options.indentUnit:"number"==typeof i&&(c=l+i),c=Math.max(0,c);var h="",u=0;if(e.options.indentWithTabs)for(var f=Math.floor(c/a);f;--f)u+=a,h+="\t";if(u<c&&(h+=dr(c-u)),h!=d)ui(s,h,vs(t,0),vs(t,d.length),"+input");else for(var f=0;f<s.sel.ranges.length;f++){var p=s.sel.ranges[f];if(p.head.line==t&&p.head.ch<d.length){var u=vs(t,d.length);ae(s,f,new G(u,u));break}}o.stateAfter=null}function xi(e,t,i,n){var r=t,s=t;return"number"==typeof t?s=Ln(e,Q(e,t)):r=Nn(t),null==r?null:(n(s,r)&&e.cm&&mt(e.cm,r,i),s)}function wi(e,t){for(var i=e.doc.sel.ranges,n=[],r=0;r<i.length;r++){for(var s=t(i[r]);n.length&&_s(s.from,hr(n).to)<=0;){var a=n.pop();if(_s(a.from,s.from)<0){s.from=a.from;break}}n.push(s)}lt(e,function(){for(var t=n.length-1;t>=0;t--)ui(e.doc,"",n[t].from,n[t].to,"+delete");_i(e)})}function ki(e,t,i,n,r){function s(){var t=o+i;return t<e.first||t>=e.first+e.size?h=!1:(o=t,d=Ln(e,t))}function a(e){var t=(r?Xr:Vr)(d,l,i,!0);if(null==t){if(e||!s())return h=!1;l=r?(i<0?Rr:$r)(d):i<0?d.text.length:0}else l=t;return!0}var o=t.line,l=t.ch,c=i,d=Ln(e,o),h=!0;if("char"==n)a();else if("column"==n)a(!0);else if("word"==n||"group"==n)for(var u=null,f="group"==n,p=e.cm&&e.cm.getHelper(t,"wordChars"),m=!0;!(i<0)||a(!m);m=!1){var g=d.text.charAt(l)||"\n",v=vr(g,p)?"w":f&&"\n"==g?"n":!f||/\s/.test(g)?null:"p";if(!f||m||v||(v="s"),u&&u!=v){i<0&&(i=1,a());break}if(v&&(u=v),i>0&&!a(!m))break}var _=me(e,vs(o,l),c,!0);return h||(_.hitSide=!0),_}function Ci(e,t,i,n){var r,s=e.doc,a=t.left;if("page"==n){var o=Math.min(e.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight);r=t.top+i*(o-(i<0?1.5:.5)*Je(e.display))}else"line"==n&&(r=i>0?t.bottom+3:t.top-3);for(;;){var l=Ge(e,a,r);if(!l.outside)break;if(i<0?r<=0:r>=s.height){l.hitSide=!0;break}r+=5*i}return l}function Di(t,i,n,r){e.defaults[t]=i,n&&(As[t]=r?function(e,t,i){i!=Ns&&n(e,t,i)}:n)}function Si(e){return"string"==typeof e?Ys[e]:e}function ji(e,t,i,n,r){if(n&&n.shared)return Ti(e,t,i,n,r);if(e.cm&&!e.cm.curOp)return ct(e.cm,ji)(e,t,i,n,r);var s=new Vs(e,r),a=_s(t,i);if(n&&mr(n,s,!1),a>0||0==a&&s.clearWhenEmpty!==!1)return s;if(s.replacedWith&&(s.collapsed=!0,s.widgetNode=br("span",[s.replacedWith],"CodeMirror-widget"),n.handleMouseEvents||(s.widgetNode.ignoreEvents=!0),n.insertLeft&&(s.widgetNode.insertLeft=!0)),s.collapsed){if(Ki(e,t.line,t,i,s)||t.line!=i.line&&Ki(e,i.line,t,i,s))throw new Error("Inserting collapsed marker partially overlapping an existing one");gs=!0}s.addToHistory&&Wn(e,{from:t,to:i,origin:"markText"},e.sel,NaN);var o,l=t.line,c=e.cm;if(e.iter(l,i.line+1,function(e){c&&s.collapsed&&!c.options.lineWrapping&&Ji(e)==c.display.maxLine&&(o=!0),s.collapsed&&l!=t.line&&An(e,0),Fi(e,new Oi(s,l==t.line?t.ch:null,l==i.line?i.ch:null)),++l}),s.collapsed&&e.iter(t.line,i.line+1,function(t){tn(e,t)&&An(t,0)}),s.clearOnEnter&&la(s,"beforeCursorEnter",function(){s.clear()}),s.readOnly&&(ms=!0,(e.history.done.length||e.history.undone.length)&&e.clearHistory()),s.collapsed&&(s.id=++Gs,s.atomic=!0),c){if(o&&(c.curOp.updateMaxLine=!0),s.collapsed)pt(c,t.line,i.line+1);else if(s.className||s.title||s.startStyle||s.endStyle)for(var d=t.line;d<=i.line;d++)mt(c,d,"text");s.atomic&&fe(c.doc),ir(c,"markerAdded",c,s)}return s}function Ti(e,t,i,n,r){n=mr(n),n.shared=!1;var s=[ji(e,t,i,n,r)],a=s[0],o=n.widgetNode;return Tn(e,function(e){o&&(n.widgetNode=o.cloneNode(!0)),s.push(ji(e,Z(e,t),Z(e,i),n,r));for(var l=0;l<e.linked.length;++l)if(e.linked[l].isParent)return;a=hr(s)}),new Ks(s,a)}function Mi(e){return e.findMarks(vs(e.first,0),e.clipPos(vs(e.lastLine())),function(e){return e.parent})}function Li(e,t){for(var i=0;i<t.length;i++){var n=t[i],r=n.find(),s=e.clipPos(r.from),a=e.clipPos(r.to);if(_s(s,a)){var o=ji(e,s,a,n.primary,n.primary.type);n.markers.push(o),o.parent=n}}}function Ei(e){for(var t=0;t<e.length;t++){var i=e[t],n=[i.primary.doc];Tn(i.primary.doc,function(e){n.push(e)});for(var r=0;r<i.markers.length;r++){var s=i.markers[r];ur(n,s.doc)==-1&&(s.parent=null,i.markers.splice(r--,1))}}}function Oi(e,t,i){this.marker=e,this.from=t,this.to=i}function Ai(e,t){if(e)for(var i=0;i<e.length;++i){var n=e[i];if(n.marker==t)return n}}function Ni(e,t){for(var i,n=0;n<e.length;++n)e[n]!=t&&(i||(i=[])).push(e[n]);return i}function Fi(e,t){e.markedSpans=e.markedSpans?e.markedSpans.concat([t]):[t],t.marker.attachLine(e)}function Pi(e,t,i){if(e)for(var n,r=0;r<e.length;++r){var s=e[r],a=s.marker,o=null==s.from||(a.inclusiveLeft?s.from<=t:s.from<t);if(o||s.from==t&&"bookmark"==a.type&&(!i||!s.marker.insertLeft)){var l=null==s.to||(a.inclusiveRight?s.to>=t:s.to>t);(n||(n=[])).push(new Oi(a,s.from,l?null:s.to))}}return n}function Ii(e,t,i){if(e)for(var n,r=0;r<e.length;++r){var s=e[r],a=s.marker,o=null==s.to||(a.inclusiveRight?s.to>=t:s.to>t);if(o||s.from==t&&"bookmark"==a.type&&(!i||s.marker.insertLeft)){var l=null==s.from||(a.inclusiveLeft?s.from<=t:s.from<t);(n||(n=[])).push(new Oi(a,l?null:s.from-t,null==s.to?null:s.to-t))}}return n}function Hi(e,t){var i=te(e,t.from.line)&&Ln(e,t.from.line).markedSpans,n=te(e,t.to.line)&&Ln(e,t.to.line).markedSpans;if(!i&&!n)return null;var r=t.from.ch,s=t.to.ch,a=0==_s(t.from,t.to),o=Pi(i,r,a),l=Ii(n,s,a),c=1==t.text.length,d=hr(t.text).length+(c?r:0);if(o)for(var h=0;h<o.length;++h){var u=o[h];if(null==u.to){var f=Ai(l,u.marker);f?c&&(u.to=null==f.to?null:f.to+d):u.to=r}}if(l)for(var h=0;h<l.length;++h){var u=l[h];if(null!=u.to&&(u.to+=d),null==u.from){var f=Ai(o,u.marker);f||(u.from=d,c&&(o||(o=[])).push(u))}else u.from+=d,c&&(o||(o=[])).push(u)}o&&(o=$i(o)),l&&l!=o&&(l=$i(l));var p=[o];if(!c){var m,g=t.text.length-2;if(g>0&&o)for(var h=0;h<o.length;++h)null==o[h].to&&(m||(m=[])).push(new Oi(o[h].marker,null,null));for(var h=0;h<g;++h)p.push(m);p.push(l)}return p}function $i(e){for(var t=0;t<e.length;++t){var i=e[t];null!=i.from&&i.from==i.to&&i.marker.clearWhenEmpty!==!1&&e.splice(t--,1)}return e.length?e:null}function Ri(e,t){var i=Vn(e,t),n=Hi(e,t);if(!i)return n;if(!n)return i;for(var r=0;r<i.length;++r){var s=i[r],a=n[r];if(s&&a)e:for(var o=0;o<a.length;++o){for(var l=a[o],c=0;c<s.length;++c)if(s[c].marker==l.marker)continue e;s.push(l)}else a&&(i[r]=a)}return i}function zi(e,t,i){var n=null;if(e.iter(t.line,i.line+1,function(e){if(e.markedSpans)for(var t=0;t<e.markedSpans.length;++t){var i=e.markedSpans[t].marker;!i.readOnly||n&&ur(n,i)!=-1||(n||(n=[])).push(i)}}),!n)return null;for(var r=[{from:t,to:i}],s=0;s<n.length;++s)for(var a=n[s],o=a.find(0),l=0;l<r.length;++l){var c=r[l];if(!(_s(c.to,o.from)<0||_s(c.from,o.to)>0)){var d=[l,1],h=_s(c.from,o.from),u=_s(c.to,o.to);(h<0||!a.inclusiveLeft&&!h)&&d.push({from:c.from,to:o.from}),(u>0||!a.inclusiveRight&&!u)&&d.push({from:o.to,to:c.to}),r.splice.apply(r,d),l+=d.length-1}}return r}function Wi(e){var t=e.markedSpans;if(t){for(var i=0;i<t.length;++i)t[i].marker.detachLine(e);e.markedSpans=null}}function Yi(e,t){if(t){for(var i=0;i<t.length;++i)t[i].marker.attachLine(e);e.markedSpans=t}}function Bi(e){return e.inclusiveLeft?-1:0}function Ui(e){return e.inclusiveRight?1:0}function qi(e,t){var i=e.lines.length-t.lines.length;if(0!=i)return i;var n=e.find(),r=t.find(),s=_s(n.from,r.from)||Bi(e)-Bi(t);if(s)return-s;var a=_s(n.to,r.to)||Ui(e)-Ui(t);return a?a:t.id-e.id}function Xi(e,t){var i,n=gs&&e.markedSpans;if(n)for(var r,s=0;s<n.length;++s)r=n[s],r.marker.collapsed&&null==(t?r.from:r.to)&&(!i||qi(i,r.marker)<0)&&(i=r.marker);return i}function Vi(e){return Xi(e,!0)}function Gi(e){return Xi(e,!1)}function Ki(e,t,i,n,r){var s=Ln(e,t),a=gs&&s.markedSpans;if(a)for(var o=0;o<a.length;++o){var l=a[o];if(l.marker.collapsed){var c=l.marker.find(0),d=_s(c.from,i)||Bi(l.marker)-Bi(r),h=_s(c.to,n)||Ui(l.marker)-Ui(r);if(!(d>=0&&h<=0||d<=0&&h>=0)&&(d<=0&&(_s(c.to,i)>0||l.marker.inclusiveRight&&r.inclusiveLeft)||d>=0&&(_s(c.from,n)<0||l.marker.inclusiveLeft&&r.inclusiveRight)))return!0}}}function Ji(e){for(var t;t=Vi(e);)e=t.find(-1,!0).line;return e}function Qi(e){for(var t,i;t=Gi(e);)e=t.find(1,!0).line,(i||(i=[])).push(e);return i}function Zi(e,t){var i=Ln(e,t),n=Ji(i);return i==n?t:Nn(n)}function en(e,t){if(t>e.lastLine())return t;var i,n=Ln(e,t);if(!tn(e,n))return t;for(;i=Gi(n);)n=i.find(1,!0).line;return Nn(n)+1}function tn(e,t){var i=gs&&t.markedSpans;if(i)for(var n,r=0;r<i.length;++r)if(n=i[r],n.marker.collapsed){if(null==n.from)return!0;if(!n.marker.widgetNode&&0==n.from&&n.marker.inclusiveLeft&&nn(e,t,n))return!0}}function nn(e,t,i){if(null==i.to){var n=i.marker.find(1,!0);return nn(e,n.line,Ai(n.line.markedSpans,i.marker))}if(i.marker.inclusiveRight&&i.to==t.text.length)return!0;for(var r,s=0;s<t.markedSpans.length;++s)if(r=t.markedSpans[s],r.marker.collapsed&&!r.marker.widgetNode&&r.from==i.to&&(null==r.to||r.to!=i.from)&&(r.marker.inclusiveLeft||i.marker.inclusiveRight)&&nn(e,t,r))return!0}function rn(e,t,i){Pn(t)<(e.curOp&&e.curOp.scrollTop||e.doc.scrollTop)&&vi(e,null,i)}function sn(e){if(null!=e.height)return e.height;if(!kr(document.body,e.node)){var t="position: relative;";e.coverGutter&&(t+="margin-left: -"+e.cm.getGutterElement().offsetWidth+"px;"),wr(e.cm.display.measure,br("div",[e.node],null,t))}return e.height=e.node.offsetHeight}function an(e,t,i,n){var r=new Js(e,i,n);return r.noHScroll&&(e.display.alignWidgets=!0),xi(e.doc,t,"widget",function(t){var i=t.widgets||(t.widgets=[]);if(null==r.insertAt?i.push(r):i.splice(Math.min(i.length-1,Math.max(0,r.insertAt)),0,r),r.line=t,!tn(e.doc,t)){var n=Pn(t)<e.doc.scrollTop;An(t,t.height+sn(r)),n&&vi(e,null,r.height),e.curOp.forceUpdate=!0}return!0}),r}function on(e,t,i,n){e.text=t,e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null),null!=e.order&&(e.order=null),Wi(e),Yi(e,i);var r=n?n(e):1;r!=e.height&&An(e,r)}function ln(e){e.parent=null,Wi(e)}function cn(e,t){if(e)for(;;){var i=e.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!i)break;e=e.slice(0,i.index)+e.slice(i.index+i[0].length);var n=i[1]?"bgClass":"textClass";null==t[n]?t[n]=i[2]:new RegExp("(?:^|s)"+i[2]+"(?:$|s)").test(t[n])||(t[n]+=" "+i[2])}return e}function dn(t,i){if(t.blankLine)return t.blankLine(i);if(t.innerMode){var n=e.innerMode(t,i);return n.mode.blankLine?n.mode.blankLine(n.state):void 0}}function hn(e,t,i){for(var n=0;n<10;n++){var r=e.token(t,i);if(t.pos>t.start)return r}throw new Error("Mode "+e.name+" failed to advance stream.")}function un(t,i,n,r,s,a,o){var l=n.flattenSpans;null==l&&(l=t.options.flattenSpans);var c,d=0,h=null,u=new Xs(i,t.options.tabSize);for(""==i&&cn(dn(n,r),a);!u.eol();){if(u.pos>t.options.maxHighlightLength?(l=!1,o&&mn(t,i,r,u.pos),u.pos=i.length,c=null):c=cn(hn(n,u,r),a),t.options.addModeClass){var f=e.innerMode(n,r).mode.name;f&&(c="m-"+(c?f+" "+c:f))}l&&h==c||(d<u.start&&s(u.start,h),d=u.start,h=c),u.start=u.pos}for(;d<u.pos;){var p=Math.min(u.pos,d+5e4);s(p,h),d=p}}function fn(e,t,i,n){var r=[e.state.modeGen],s={};un(e,t.text,e.doc.mode,i,function(e,t){r.push(e,t)},s,n);for(var a=0;a<e.state.overlays.length;++a){var o=e.state.overlays[a],l=1,c=0;un(e,t.text,o.mode,!0,function(e,t){for(var i=l;c<e;){var n=r[l];n>e&&r.splice(l,1,e,r[l+1],n),l+=2,c=Math.min(e,n)}if(t)if(o.opaque)r.splice(i,l-i,e,"cm-overlay "+t),l=i+2;else for(;i<l;i+=2){var s=r[i+1];r[i+1]=(s?s+" ":"")+"cm-overlay "+t}},s)}return{styles:r,classes:s.bgClass||s.textClass?s:null}}function pn(e,t){if(!t.styles||t.styles[0]!=e.state.modeGen){var i=fn(e,t,t.stateAfter=De(e,Nn(t)));t.styles=i.styles,i.classes?t.styleClasses=i.classes:t.styleClasses&&(t.styleClasses=null)}return t.styles}function mn(e,t,i,n){var r=e.doc.mode,s=new Xs(t,e.options.tabSize);for(s.start=s.pos=n||0,""==t&&dn(r,i);!s.eol()&&s.pos<=e.options.maxHighlightLength;)hn(r,s,i),s.start=s.pos}function gn(e,t){if(!e||/^\s*$/.test(e))return null;var i=t.addModeClass?ea:Zs;return i[e]||(i[e]=e.replace(/\S+/g,"cm-$&"))}function vn(e,t){var i=br("span",null,null,es?"padding-right: .1px":null),n={pre:br("pre",[i]),content:i,col:0,pos:0,cm:e};t.measure={};for(var r=0;r<=(t.rest?t.rest.length:0);r++){var s,a=r?t.rest[r-1]:t.line;n.pos=0,n.addToken=yn,(Qr||es)&&e.getOption("lineWrapping")&&(n.addToken=bn(n.addToken)),Nr(e.display.measure)&&(s=In(a))&&(n.addToken=xn(n.addToken,s)),n.map=[],kn(a,n,pn(e,a)),a.styleClasses&&(a.styleClasses.bgClass&&(n.bgClass=Tr(a.styleClasses.bgClass,n.bgClass||"")),a.styleClasses.textClass&&(n.textClass=Tr(a.styleClasses.textClass,n.textClass||""))),0==n.map.length&&n.map.push(0,0,n.content.appendChild(Ar(e.display.measure))),0==r?(t.measure.map=n.map,t.measure.cache={}):((t.measure.maps||(t.measure.maps=[])).push(n.map),(t.measure.caches||(t.measure.caches=[])).push({}))}return da(e,"renderLine",e,t.line,n.pre),n.pre.className&&(n.textClass=Tr(n.pre.className,n.textClass||"")),n}function _n(e){var t=br("span","•","cm-invalidchar");return t.title="\\u"+e.charCodeAt(0).toString(16),t}function yn(e,t,i,n,r,s){if(t){var a=e.cm.options.specialChars,o=!1;if(a.test(t))for(var l=document.createDocumentFragment(),c=0;;){a.lastIndex=c;var d=a.exec(t),h=d?d.index-c:t.length-c;if(h){var u=document.createTextNode(t.slice(c,c+h));Qr&&Zr<9?l.appendChild(br("span",[u])):l.appendChild(u),e.map.push(e.pos,e.pos+h,u),e.col+=h,e.pos+=h}if(!d)break;if(c+=h+1,"\t"==d[0]){var f=e.cm.options.tabSize,p=f-e.col%f,u=l.appendChild(br("span",dr(p),"cm-tab"));e.col+=p}else{var u=e.cm.options.specialCharPlaceholder(d[0]);Qr&&Zr<9?l.appendChild(br("span",[u])):l.appendChild(u),e.col+=1}e.map.push(e.pos,e.pos+1,u),e.pos++}else{e.col+=t.length;var l=document.createTextNode(t);e.map.push(e.pos,e.pos+t.length,l),Qr&&Zr<9&&(o=!0),e.pos+=t.length}if(i||n||r||o){var m=i||"";n&&(m+=n),r&&(m+=r);var g=br("span",[l],m);return s&&(g.title=s),e.content.appendChild(g)}e.content.appendChild(l)}}function bn(e){function t(e){for(var t=" ",i=0;i<e.length-2;++i)t+=i%2?" ":" ";return t+=" "}return function(i,n,r,s,a,o){e(i,n.replace(/ {3,}/g,t),r,s,a,o)}}function xn(e,t){return function(i,n,r,s,a,o){r=r?r+" cm-force-border":"cm-force-border";for(var l=i.pos,c=l+n.length;;){for(var d=0;d<t.length;d++){var h=t[d];if(h.to>l&&h.from<=l)break}if(h.to>=c)return e(i,n,r,s,a,o);e(i,n.slice(0,h.to-l),r,s,null,o),s=null,n=n.slice(h.to-l),l=h.to}}}function wn(e,t,i,n){var r=!n&&i.widgetNode;r&&(e.map.push(e.pos,e.pos+t,r),e.content.appendChild(r)),e.pos+=t}function kn(e,t,i){var n=e.markedSpans,r=e.text,s=0;if(n)for(var a,o,l,c,d,h,u=r.length,f=0,p=1,m="",g=0;;){if(g==f){o=l=c=d="",h=null,g=1/0;for(var v=[],_=0;_<n.length;++_){var y=n[_],b=y.marker;y.from<=f&&(null==y.to||y.to>f)?(null!=y.to&&g>y.to&&(g=y.to,l=""),b.className&&(o+=" "+b.className),b.startStyle&&y.from==f&&(c+=" "+b.startStyle),b.endStyle&&y.to==g&&(l+=" "+b.endStyle),b.title&&!d&&(d=b.title),b.collapsed&&(!h||qi(h.marker,b)<0)&&(h=y)):y.from>f&&g>y.from&&(g=y.from),"bookmark"==b.type&&y.from==f&&b.widgetNode&&v.push(b)}if(h&&(h.from||0)==f&&(wn(t,(null==h.to?u+1:h.to)-f,h.marker,null==h.from),null==h.to))return;if(!h&&v.length)for(var _=0;_<v.length;++_)wn(t,0,v[_])}if(f>=u)break;for(var x=Math.min(u,g);;){if(m){var w=f+m.length;if(!h){var k=w>x?m.slice(0,x-f):m;t.addToken(t,k,a?a+o:o,c,f+k.length==g?l:"",d)}if(w>=x){m=m.slice(x-f),f=x;break}f=w,c=""}m=r.slice(s,s=i[p++]),a=gn(i[p++],t.cm.options)}}else for(var p=1;p<i.length;p+=2)t.addToken(t,r.slice(s,s=i[p]),gn(i[p+1],t.cm.options))}function Cn(e,t){return 0==t.from.ch&&0==t.to.ch&&""==hr(t.text)&&(!e.cm||e.cm.options.wholeLineUpdateBefore)}function Dn(e,t,i,n){function r(e){return i?i[e]:null}function s(e,i,r){on(e,i,r,n),ir(e,"change",e,t)}var a=t.from,o=t.to,l=t.text,c=Ln(e,a.line),d=Ln(e,o.line),h=hr(l),u=r(l.length-1),f=o.line-a.line;if(Cn(e,t)){for(var p=0,m=[];p<l.length-1;++p)m.push(new Qs(l[p],r(p),n));s(d,d.text,u),f&&e.remove(a.line,f),m.length&&e.insert(a.line,m)}else if(c==d)if(1==l.length)s(c,c.text.slice(0,a.ch)+h+c.text.slice(o.ch),u);else{for(var m=[],p=1;p<l.length-1;++p)m.push(new Qs(l[p],r(p),n));m.push(new Qs(h+c.text.slice(o.ch),u,n)),s(c,c.text.slice(0,a.ch)+l[0],r(0)),e.insert(a.line+1,m)}else if(1==l.length)s(c,c.text.slice(0,a.ch)+l[0]+d.text.slice(o.ch),r(0)),e.remove(a.line+1,f);else{s(c,c.text.slice(0,a.ch)+l[0],r(0)),s(d,h+d.text.slice(o.ch),u);for(var p=1,m=[];p<l.length-1;++p)m.push(new Qs(l[p],r(p),n));f>1&&e.remove(a.line+1,f-1),e.insert(a.line+1,m)}ir(e,"change",e,t)}function Sn(e){this.lines=e,this.parent=null;for(var t=0,i=0;t<e.length;++t)e[t].parent=this,i+=e[t].height;this.height=i}function jn(e){this.children=e;for(var t=0,i=0,n=0;n<e.length;++n){var r=e[n];t+=r.chunkSize(),i+=r.height,r.parent=this}this.size=t,this.height=i,this.parent=null}function Tn(e,t,i){function n(e,r,s){if(e.linked)for(var a=0;a<e.linked.length;++a){var o=e.linked[a];if(o.doc!=r){var l=s&&o.sharedHist;i&&!l||(t(o.doc,l),n(o.doc,e,l))}}}n(e,null,!0)}function Mn(e,t){if(t.cm)throw new Error("This document is already in use.");e.doc=t,t.cm=e,a(e),i(e),e.options.lineWrapping||f(e),e.options.mode=t.modeOption,pt(e)}function Ln(e,t){if(t-=e.first,t<0||t>=e.size)throw new Error("There is no line "+(t+e.first)+" in the document.");for(var i=e;!i.lines;)for(var n=0;;++n){var r=i.children[n],s=r.chunkSize();if(t<s){i=r;break}t-=s}return i.lines[t]}function En(e,t,i){var n=[],r=t.line;return e.iter(t.line,i.line+1,function(e){var s=e.text;r==i.line&&(s=s.slice(0,i.ch)),r==t.line&&(s=s.slice(t.ch)),n.push(s),++r}),n}function On(e,t,i){var n=[];return e.iter(t,i,function(e){n.push(e.text)}),n}function An(e,t){var i=t-e.height;if(i)for(var n=e;n;n=n.parent)n.height+=i}function Nn(e){if(null==e.parent)return null;for(var t=e.parent,i=ur(t.lines,e),n=t.parent;n;t=n,n=n.parent)for(var r=0;n.children[r]!=t;++r)i+=n.children[r].chunkSize();return i+t.first}function Fn(e,t){var i=e.first;e:do{for(var n=0;n<e.children.length;++n){var r=e.children[n],s=r.height;if(t<s){e=r;continue e}t-=s,i+=r.chunkSize()}return i}while(!e.lines);for(var n=0;n<e.lines.length;++n){var a=e.lines[n],o=a.height;if(t<o)break;t-=o}return i+n}function Pn(e){e=Ji(e);for(var t=0,i=e.parent,n=0;n<i.lines.length;++n){var r=i.lines[n];if(r==e)break;t+=r.height}for(var s=i.parent;s;i=s,s=i.parent)for(var n=0;n<s.children.length;++n){var a=s.children[n];if(a==i)break;t+=a.height}return t}function In(e){var t=e.order;return null==t&&(t=e.order=Fa(e.text)),t}function Hn(e){this.done=[],this.undone=[],this.undoDepth=1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=e||1}function $n(e,t){var i={from:U(t.from),to:Es(t),text:En(e,t.from,t.to)};return qn(e,i,t.from.line,t.to.line+1),Tn(e,function(e){qn(e,i,t.from.line,t.to.line+1)},!0),i}function Rn(e){for(;e.length;){var t=hr(e);if(!t.ranges)break;e.pop()}}function zn(e,t){return t?(Rn(e.done),hr(e.done)):e.done.length&&!hr(e.done).ranges?hr(e.done):e.done.length>1&&!e.done[e.done.length-2].ranges?(e.done.pop(),hr(e.done)):void 0}function Wn(e,t,i,n){var r=e.history;r.undone.length=0;var s,a=+new Date;if((r.lastOp==n||r.lastOrigin==t.origin&&t.origin&&("+"==t.origin.charAt(0)&&e.cm&&r.lastModTime>a-e.cm.options.historyEventDelay||"*"==t.origin.charAt(0)))&&(s=zn(r,r.lastOp==n))){var o=hr(s.changes);0==_s(t.from,t.to)&&0==_s(t.from,o.to)?o.to=Es(t):s.changes.push($n(e,t))}else{var l=hr(r.done);for(l&&l.ranges||Un(e.sel,r.done),s={changes:[$n(e,t)],generation:r.generation},r.done.push(s);r.done.length>r.undoDepth;)r.done.shift(),r.done[0].ranges||r.done.shift()}r.done.push(i),r.generation=++r.maxGeneration,r.lastModTime=r.lastSelTime=a,r.lastOp=r.lastSelOp=n,r.lastOrigin=r.lastSelOrigin=t.origin,o||da(e,"historyAdded")}function Yn(e,t,i,n){var r=t.charAt(0);return"*"==r||"+"==r&&i.ranges.length==n.ranges.length&&i.somethingSelected()==n.somethingSelected()&&new Date-e.history.lastSelTime<=(e.cm?e.cm.options.historyEventDelay:500)}function Bn(e,t,i,n){var r=e.history,s=n&&n.origin;i==r.lastSelOp||s&&r.lastSelOrigin==s&&(r.lastModTime==r.lastSelTime&&r.lastOrigin==s||Yn(e,s,hr(r.done),t))?r.done[r.done.length-1]=t:Un(t,r.done),r.lastSelTime=+new Date,r.lastSelOrigin=s,r.lastSelOp=i,n&&n.clearRedo!==!1&&Rn(r.undone)}function Un(e,t){var i=hr(t);i&&i.ranges&&i.equals(e)||t.push(e)}function qn(e,t,i,n){var r=t["spans_"+e.id],s=0;e.iter(Math.max(e.first,i),Math.min(e.first+e.size,n),function(i){i.markedSpans&&((r||(r=t["spans_"+e.id]={}))[s]=i.markedSpans),++s})}function Xn(e){if(!e)return null;for(var t,i=0;i<e.length;++i)e[i].marker.explicitlyCleared?t||(t=e.slice(0,i)):t&&t.push(e[i]);return t?t.length?t:null:e}function Vn(e,t){var i=t["spans_"+e.id];if(!i)return null;for(var n=0,r=[];n<t.text.length;++n)r.push(Xn(i[n]));return r}function Gn(e,t,i){for(var n=0,r=[];n<e.length;++n){var s=e[n];if(s.ranges)r.push(i?V.prototype.deepCopy.call(s):s);else{var a=s.changes,o=[];r.push({changes:o});for(var l=0;l<a.length;++l){var c,d=a[l];if(o.push({from:d.from,to:d.to,text:d.text}),t)for(var h in d)(c=h.match(/^spans_(\d+)$/))&&ur(t,Number(c[1]))>-1&&(hr(o)[h]=d[h],delete d[h])}}}return r}function Kn(e,t,i,n){i<e.line?e.line+=n:t<e.line&&(e.line=t,e.ch=0)}function Jn(e,t,i,n){for(var r=0;r<e.length;++r){var s=e[r],a=!0;if(s.ranges){s.copied||(s=e[r]=s.deepCopy(),s.copied=!0);for(var o=0;o<s.ranges.length;o++)Kn(s.ranges[o].anchor,t,i,n),Kn(s.ranges[o].head,t,i,n)}else{for(var o=0;o<s.changes.length;++o){var l=s.changes[o];if(i<l.from.line)l.from=vs(l.from.line+n,l.from.ch),l.to=vs(l.to.line+n,l.to.ch);else if(t<=l.to.line){a=!1;break}}a||(e.splice(0,r+1),r=0)}}}function Qn(e,t){var i=t.from.line,n=t.to.line,r=t.text.length-(n-i)-1;Jn(e.done,i,n,r),Jn(e.undone,i,n,r)}function Zn(e){return null!=e.defaultPrevented?e.defaultPrevented:0==e.returnValue}function er(e){return e.target||e.srcElement}function tr(e){var t=e.which;return null==t&&(1&e.button?t=1:2&e.button?t=3:4&e.button&&(t=2)),ds&&e.ctrlKey&&1==t&&(t=3),t}function ir(e,t){function i(e){return function(){e.apply(null,s)}}var n=e._handlers&&e._handlers[t];if(n){var r,s=Array.prototype.slice.call(arguments,2);ks?r=ks.delayedCallbacks:ha?r=ha:(r=ha=[],setTimeout(nr,0));for(var a=0;a<n.length;++a)r.push(i(n[a]))}}function nr(){var e=ha;ha=null;for(var t=0;t<e.length;++t)e[t]()}function rr(e,t,i){return da(e,i||t.type,e,t),Zn(t)||t.codemirrorIgnore}function sr(e){var t=e._handlers&&e._handlers.cursorActivity;if(t)for(var i=e.curOp.cursorActivityHandlers||(e.curOp.cursorActivityHandlers=[]),n=0;n<t.length;++n)ur(i,t[n])==-1&&i.push(t[n])}function ar(e,t){var i=e._handlers&&e._handlers[t];return i&&i.length>0}function or(e){e.prototype.on=function(e,t){la(this,e,t)},e.prototype.off=function(e,t){ca(this,e,t)}}function lr(){this.id=null}function cr(e,t,i){for(var n=0,r=0;;){var s=e.indexOf("\t",n);s==-1&&(s=e.length);var a=s-n;if(s==e.length||r+a>=t)return n+Math.min(a,t-r);if(r+=s-n,r+=i-r%i,n=s+1,r>=t)return n}}function dr(e){for(;_a.length<=e;)_a.push(hr(_a)+" ");return _a[e]}function hr(e){return e[e.length-1]}function ur(e,t){for(var i=0;i<e.length;++i)if(e[i]==t)return i;return-1}function fr(e,t){for(var i=[],n=0;n<e.length;n++)i[n]=t(e[n],n);return i}function pr(e,t){var i;if(Object.create)i=Object.create(e);else{var n=function(){};n.prototype=e,i=new n}return t&&mr(t,i),i}function mr(e,t,i){t||(t={});for(var n in e)!e.hasOwnProperty(n)||i===!1&&t.hasOwnProperty(n)||(t[n]=e[n]);return t}function gr(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t)}}function vr(e,t){return t?!!(t.source.indexOf("\\w")>-1&&wa(e))||t.test(e):wa(e)}function _r(e){for(var t in e)if(e.hasOwnProperty(t)&&e[t])return!1;return!0}function yr(e){return e.charCodeAt(0)>=768&&ka.test(e)}function br(e,t,i,n){var r=document.createElement(e);if(i&&(r.className=i),n&&(r.style.cssText=n),"string"==typeof t)r.appendChild(document.createTextNode(t));else if(t)for(var s=0;s<t.length;++s)r.appendChild(t[s]);return r}function xr(e){for(var t=e.childNodes.length;t>0;--t)e.removeChild(e.firstChild);return e}function wr(e,t){return xr(e).appendChild(t)}function kr(e,t){if(e.contains)return e.contains(t);for(;t=t.parentNode;)if(t==e)return!0}function Cr(){return document.activeElement}function Dr(e){return new RegExp("\\b"+e+"\\b\\s*")}function Sr(e,t){var i=Dr(t);i.test(e.className)&&(e.className=e.className.replace(i,""))}function jr(e,t){Dr(t).test(e.className)||(e.className+=" "+t)}function Tr(e,t){for(var i=e.split(" "),n=0;n<i.length;n++)i[n]&&!Dr(i[n]).test(t)&&(t+=" "+i[n]);return t}function Mr(e){if(document.body.getElementsByClassName)for(var t=document.body.getElementsByClassName("CodeMirror"),i=0;i<t.length;i++){var n=t[i].CodeMirror;n&&e(n)}}function Lr(){ja||(Er(),ja=!0)}function Er(){var e;la(window,"resize",function(){null==e&&(e=setTimeout(function(){e=null,Ca=null,Mr(Mt)},100))}),la(window,"blur",function(){Mr(Qt)})}function Or(e){if(null!=Ca)return Ca;var t=br("div",null,null,"width: 50px; height: 50px; overflow-x: scroll");return wr(e,t),t.offsetWidth&&(Ca=t.offsetHeight-t.clientHeight),Ca||0}function Ar(e){if(null==Da){var t=br("span","​");wr(e,br("span",[t,document.createTextNode("x")])),0!=e.firstChild.offsetHeight&&(Da=t.offsetWidth<=1&&t.offsetHeight>2&&!(Qr&&Zr<8))}return Da?br("span","​"):br("span"," ",null,"display: inline-block; width: 1px; margin-right: -1px")}function Nr(e){if(null!=Sa)return Sa;var t=wr(e,document.createTextNode("AخA")),i=ba(t,0,1).getBoundingClientRect();if(!i||i.left==i.right)return!1;var n=ba(t,1,2).getBoundingClientRect();return Sa=n.right-i.right<3}function Fr(e){if(null!=Oa)return Oa;var t=wr(e,br("span","x")),i=t.getBoundingClientRect(),n=ba(t,0,1).getBoundingClientRect();
return Oa=Math.abs(i.left-n.left)>1}function Pr(e,t,i,n){if(!e)return n(t,i,"ltr");for(var r=!1,s=0;s<e.length;++s){var a=e[s];(a.from<i&&a.to>t||t==i&&a.to==t)&&(n(Math.max(a.from,t),Math.min(a.to,i),1==a.level?"rtl":"ltr"),r=!0)}r||n(t,i,"ltr")}function Ir(e){return e.level%2?e.to:e.from}function Hr(e){return e.level%2?e.from:e.to}function $r(e){var t=In(e);return t?Ir(t[0]):0}function Rr(e){var t=In(e);return t?Hr(hr(t)):e.text.length}function zr(e,t){var i=Ln(e.doc,t),n=Ji(i);n!=i&&(t=Nn(n));var r=In(n),s=r?r[0].level%2?Rr(n):$r(n):0;return vs(t,s)}function Wr(e,t){for(var i,n=Ln(e.doc,t);i=Gi(n);)n=i.find(1,!0).line,t=null;var r=In(n),s=r?r[0].level%2?$r(n):Rr(n):n.text.length;return vs(null==t?Nn(n):t,s)}function Yr(e,t){var i=zr(e,t.line),n=Ln(e.doc,i.line),r=In(n);if(!r||0==r[0].level){var s=Math.max(0,n.text.search(/\S/)),a=t.line==i.line&&t.ch<=s&&t.ch;return vs(i.line,a?0:s)}return i}function Br(e,t,i){var n=e[0].level;return t==n||i!=n&&t<i}function Ur(e,t){Na=null;for(var i,n=0;n<e.length;++n){var r=e[n];if(r.from<t&&r.to>t)return n;if(r.from==t||r.to==t){if(null!=i)return Br(e,r.level,e[i].level)?(r.from!=r.to&&(Na=i),n):(r.from!=r.to&&(Na=n),i);i=n}}return i}function qr(e,t,i,n){if(!n)return t+i;do t+=i;while(t>0&&yr(e.text.charAt(t)));return t}function Xr(e,t,i,n){var r=In(e);if(!r)return Vr(e,t,i,n);for(var s=Ur(r,t),a=r[s],o=qr(e,t,a.level%2?-i:i,n);;){if(o>a.from&&o<a.to)return o;if(o==a.from||o==a.to)return Ur(r,o)==s?o:(a=r[s+=i],i>0==a.level%2?a.to:a.from);if(a=r[s+=i],!a)return null;o=i>0==a.level%2?qr(e,a.to,-1,n):qr(e,a.from,1,n)}}function Vr(e,t,i,n){var r=t+i;if(n)for(;r>0&&yr(e.text.charAt(r));)r+=i;return r<0||r>e.text.length?null:r}var Gr=/gecko\/\d/i.test(navigator.userAgent),Kr=/MSIE \d/.test(navigator.userAgent),Jr=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),Qr=Kr||Jr,Zr=Qr&&(Kr?document.documentMode||6:Jr[1]),es=/WebKit\//.test(navigator.userAgent),ts=es&&/Qt\/\d+\.\d+/.test(navigator.userAgent),is=/Chrome\//.test(navigator.userAgent),ns=/Opera\//.test(navigator.userAgent),rs=/Apple Computer/.test(navigator.vendor),ss=/KHTML\//.test(navigator.userAgent),as=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(navigator.userAgent),os=/PhantomJS/.test(navigator.userAgent),ls=/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent),cs=ls||/Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(navigator.userAgent),ds=ls||/Mac/.test(navigator.platform),hs=/win/i.test(navigator.platform),us=ns&&navigator.userAgent.match(/Version\/(\d*\.\d*)/);us&&(us=Number(us[1])),us&&us>=15&&(ns=!1,es=!0);var fs=ds&&(ts||ns&&(null==us||us<12.11)),ps=Gr||Qr&&Zr>=9,ms=!1,gs=!1,vs=e.Pos=function(e,t){return this instanceof vs?(this.line=e,void(this.ch=t)):new vs(e,t)},_s=e.cmpPos=function(e,t){return e.line-t.line||e.ch-t.ch};V.prototype={primary:function(){return this.ranges[this.primIndex]},equals:function(e){if(e==this)return!0;if(e.primIndex!=this.primIndex||e.ranges.length!=this.ranges.length)return!1;for(var t=0;t<this.ranges.length;t++){var i=this.ranges[t],n=e.ranges[t];if(0!=_s(i.anchor,n.anchor)||0!=_s(i.head,n.head))return!1}return!0},deepCopy:function(){for(var e=[],t=0;t<this.ranges.length;t++)e[t]=new G(U(this.ranges[t].anchor),U(this.ranges[t].head));return new V(e,this.primIndex)},somethingSelected:function(){for(var e=0;e<this.ranges.length;e++)if(!this.ranges[e].empty())return!0;return!1},contains:function(e,t){t||(t=e);for(var i=0;i<this.ranges.length;i++){var n=this.ranges[i];if(_s(t,n.from())>=0&&_s(e,n.to())<=0)return i}return-1}},G.prototype={from:function(){return X(this.anchor,this.head)},to:function(){return q(this.anchor,this.head)},empty:function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch}};var ys,bs,xs,ws={left:0,right:0,top:0,bottom:0},ks=null,Cs=0,Ds=null,Ss=0,js=0,Ts=null;Qr?Ts=-.53:Gr?Ts=15:is?Ts=-.7:rs&&(Ts=-1/3);var Ms,Ls=null,Es=e.changeEnd=function(e){return e.text?vs(e.from.line+e.text.length-1,hr(e.text).length+(1==e.text.length?e.from.ch:0)):e.to};e.prototype={constructor:e,focus:function(){window.focus(),Dt(this),wt(this)},setOption:function(e,t){var i=this.options,n=i[e];i[e]==t&&"mode"!=e||(i[e]=t,As.hasOwnProperty(e)&&ct(this,As[e])(this,t,n))},getOption:function(e){return this.options[e]},getDoc:function(){return this.doc},addKeyMap:function(e,t){this.state.keyMaps[t?"push":"unshift"](e)},removeKeyMap:function(e){for(var t=this.state.keyMaps,i=0;i<t.length;++i)if(t[i]==e||"string"!=typeof t[i]&&t[i].name==e)return t.splice(i,1),!0},addOverlay:dt(function(t,i){var n=t.token?t:e.getMode(this.options,t);if(n.startState)throw new Error("Overlays may not be stateful.");this.state.overlays.push({mode:n,modeSpec:t,opaque:i&&i.opaque}),this.state.modeGen++,pt(this)}),removeOverlay:dt(function(e){for(var t=this.state.overlays,i=0;i<t.length;++i){var n=t[i].modeSpec;if(n==e||"string"==typeof e&&n.name==e)return t.splice(i,1),this.state.modeGen++,void pt(this)}}),indentLine:dt(function(e,t,i){"string"!=typeof t&&"number"!=typeof t&&(t=null==t?this.options.smartIndent?"smart":"prev":t?"add":"subtract"),te(this.doc,e)&&bi(this,e,t,i)}),indentSelection:dt(function(e){for(var t=this.doc.sel.ranges,i=-1,n=0;n<t.length;n++){var r=t[n];if(r.empty())r.head.line>i&&(bi(this,r.head.line,e,!0),i=r.head.line,n==this.doc.sel.primIndex&&_i(this));else{var s=r.from(),a=r.to(),o=Math.max(i,s.line);i=Math.min(this.lastLine(),a.line-(a.ch?0:1))+1;for(var l=o;l<i;++l)bi(this,l,e);var c=this.doc.sel.ranges;0==s.ch&&t.length==c.length&&c[n].from().ch>0&&ae(this.doc,n,new G(s,c[n].to()),pa)}}}),getTokenAt:function(e,t){var i=this.doc;e=Z(i,e);for(var n=De(this,e.line,t),r=this.doc.mode,s=Ln(i,e.line),a=new Xs(s.text,this.options.tabSize);a.pos<e.ch&&!a.eol();){a.start=a.pos;var o=hn(r,a,n)}return{start:a.start,end:a.pos,string:a.current(),type:o||null,state:n}},getTokenTypeAt:function(e){e=Z(this.doc,e);var t,i=pn(this,Ln(this.doc,e.line)),n=0,r=(i.length-1)/2,s=e.ch;if(0==s)t=i[2];else for(;;){var a=n+r>>1;if((a?i[2*a-1]:0)>=s)r=a;else{if(!(i[2*a+1]<s)){t=i[2*a+2];break}n=a+1}}var o=t?t.indexOf("cm-overlay "):-1;return o<0?t:0==o?null:t.slice(0,o-1)},getModeAt:function(t){var i=this.doc.mode;return i.innerMode?e.innerMode(i,this.getTokenAt(t).state).mode:i},getHelper:function(e,t){return this.getHelpers(e,t)[0]},getHelpers:function(e,t){var i=[];if(!$s.hasOwnProperty(t))return $s;var n=$s[t],r=this.getModeAt(e);if("string"==typeof r[t])n[r[t]]&&i.push(n[r[t]]);else if(r[t])for(var s=0;s<r[t].length;s++){var a=n[r[t][s]];a&&i.push(a)}else r.helperType&&n[r.helperType]?i.push(n[r.helperType]):n[r.name]&&i.push(n[r.name]);for(var s=0;s<n._global.length;s++){var o=n._global[s];o.pred(r,this)&&ur(i,o.val)==-1&&i.push(o.val)}return i},getStateAfter:function(e,t){var i=this.doc;return e=Q(i,null==e?i.first+i.size-1:e),De(this,e+1,t)},cursorCoords:function(e,t){var i,n=this.doc.sel.primary();return i=null==e?n.head:"object"==typeof e?Z(this.doc,e):e?n.from():n.to(),qe(this,i,t||"page")},charCoords:function(e,t){return Ue(this,Z(this.doc,e),t||"page")},coordsChar:function(e,t){return e=Be(this,e,t||"page"),Ge(this,e.left,e.top)},lineAtHeight:function(e,t){return e=Be(this,{top:e,left:0},t||"page").top,Fn(this.doc,e+this.display.viewOffset)},heightAtLine:function(e,t){var i=!1,n=this.doc.first+this.doc.size-1;e<this.doc.first?e=this.doc.first:e>n&&(e=n,i=!0);var r=Ln(this.doc,e);return Ye(this,r,{top:0,left:0},t||"page").top+(i?this.doc.height-Pn(r):0)},defaultTextHeight:function(){return Je(this.display)},defaultCharWidth:function(){return Qe(this.display)},setGutterMarker:dt(function(e,t,i){return xi(this.doc,e,"gutter",function(e){var n=e.gutterMarkers||(e.gutterMarkers={});return n[t]=i,!i&&_r(n)&&(e.gutterMarkers=null),!0})}),clearGutter:dt(function(e){var t=this,i=t.doc,n=i.first;i.iter(function(i){i.gutterMarkers&&i.gutterMarkers[e]&&(i.gutterMarkers[e]=null,mt(t,n,"gutter"),_r(i.gutterMarkers)&&(i.gutterMarkers=null)),++n})}),addLineWidget:dt(function(e,t,i){return an(this,e,t,i)}),removeLineWidget:function(e){e.clear()},lineInfo:function(e){if("number"==typeof e){if(!te(this.doc,e))return null;var t=e;if(e=Ln(this.doc,e),!e)return null}else{var t=Nn(e);if(null==t)return null}return{line:t,handle:e,text:e.text,gutterMarkers:e.gutterMarkers,textClass:e.textClass,bgClass:e.bgClass,wrapClass:e.wrapClass,widgets:e.widgets}},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(e,t,i,n,r){var s=this.display;e=qe(this,Z(this.doc,e));var a=e.bottom,o=e.left;if(t.style.position="absolute",s.sizer.appendChild(t),"over"==n)a=e.top;else if("above"==n||"near"==n){var l=Math.max(s.wrapper.clientHeight,this.doc.height),c=Math.max(s.sizer.clientWidth,s.lineSpace.clientWidth);("above"==n||e.bottom+t.offsetHeight>l)&&e.top>t.offsetHeight?a=e.top-t.offsetHeight:e.bottom+t.offsetHeight<=l&&(a=e.bottom),o+t.offsetWidth>c&&(o=c-t.offsetWidth)}t.style.top=a+"px",t.style.left=t.style.right="","right"==r?(o=s.sizer.clientWidth-t.offsetWidth,t.style.right="0px"):("left"==r?o=0:"middle"==r&&(o=(s.sizer.clientWidth-t.offsetWidth)/2),t.style.left=o+"px"),i&&mi(this,o,a,o+t.offsetWidth,a+t.offsetHeight)},triggerOnKeyDown:dt(Xt),triggerOnKeyPress:dt(Kt),triggerOnKeyUp:Gt,execCommand:function(e){if(Ws.hasOwnProperty(e))return Ws[e](this)},findPosH:function(e,t,i,n){var r=1;t<0&&(r=-1,t=-t);for(var s=0,a=Z(this.doc,e);s<t&&(a=ki(this.doc,a,r,i,n),!a.hitSide);++s);return a},moveH:dt(function(e,t){var i=this;i.extendSelectionsBy(function(n){return i.display.shift||i.doc.extend||n.empty()?ki(i.doc,n.head,e,t,i.options.rtlMoveVisually):e<0?n.from():n.to()},ga)}),deleteH:dt(function(e,t){var i=this.doc.sel,n=this.doc;i.somethingSelected()?n.replaceSelection("",null,"+delete"):wi(this,function(i){var r=ki(n,i.head,e,t,!1);return e<0?{from:r,to:i.head}:{from:i.head,to:r}})}),findPosV:function(e,t,i,n){var r=1,s=n;t<0&&(r=-1,t=-t);for(var a=0,o=Z(this.doc,e);a<t;++a){var l=qe(this,o,"div");if(null==s?s=l.left:l.left=s,o=Ci(this,l,r,i),o.hitSide)break}return o},moveV:dt(function(e,t){var i=this,n=this.doc,r=[],s=!i.display.shift&&!n.extend&&n.sel.somethingSelected();if(n.extendSelectionsBy(function(a){if(s)return e<0?a.from():a.to();var o=qe(i,a.head,"div");null!=a.goalColumn&&(o.left=a.goalColumn),r.push(o.left);var l=Ci(i,o,e,t);return"page"==t&&a==n.sel.primary()&&vi(i,null,Ue(i,l,"div").top-o.top),l},ga),r.length)for(var a=0;a<n.sel.ranges.length;a++)n.sel.ranges[a].goalColumn=r[a]}),findWordAt:function(e){var t=this.doc,i=Ln(t,e.line).text,n=e.ch,r=e.ch;if(i){var s=this.getHelper(e,"wordChars");(e.xRel<0||r==i.length)&&n?--n:++r;for(var a=i.charAt(n),o=vr(a,s)?function(e){return vr(e,s)}:/\s/.test(a)?function(e){return/\s/.test(e)}:function(e){return!/\s/.test(e)&&!vr(e)};n>0&&o(i.charAt(n-1));)--n;for(;r<i.length&&o(i.charAt(r));)++r}return new G(vs(e.line,n),vs(e.line,r))},toggleOverwrite:function(e){null!=e&&e==this.state.overwrite||((this.state.overwrite=!this.state.overwrite)?jr(this.display.cursorDiv,"CodeMirror-overwrite"):Sr(this.display.cursorDiv,"CodeMirror-overwrite"),da(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return Cr()==this.display.input},scrollTo:dt(function(e,t){null==e&&null==t||yi(this),null!=e&&(this.curOp.scrollLeft=e),null!=t&&(this.curOp.scrollTop=t)}),getScrollInfo:function(){var e=this.display.scroller,t=ua;return{left:e.scrollLeft,top:e.scrollTop,height:e.scrollHeight-t,width:e.scrollWidth-t,clientHeight:e.clientHeight-t,clientWidth:e.clientWidth-t}},scrollIntoView:dt(function(e,t){if(null==e?(e={from:this.doc.sel.primary().head,to:null},null==t&&(t=this.options.cursorScrollMargin)):"number"==typeof e?e={from:vs(e,0),to:null}:null==e.from&&(e={from:e,to:null}),e.to||(e.to=e.from),e.margin=t||0,null!=e.from.line)yi(this),this.curOp.scrollToPos=e;else{var i=gi(this,Math.min(e.from.left,e.to.left),Math.min(e.from.top,e.to.top)-e.margin,Math.max(e.from.right,e.to.right),Math.max(e.from.bottom,e.to.bottom)+e.margin);this.scrollTo(i.scrollLeft,i.scrollTop)}}),setSize:dt(function(e,t){function i(e){return"number"==typeof e||/^\d+$/.test(String(e))?e+"px":e}var n=this;null!=e&&(n.display.wrapper.style.width=i(e)),null!=t&&(n.display.wrapper.style.height=i(t)),n.options.lineWrapping&&$e(this);var r=n.display.viewFrom;n.doc.iter(r,n.display.viewTo,function(e){if(e.widgets)for(var t=0;t<e.widgets.length;t++)if(e.widgets[t].noHScroll){mt(n,r,"widget");break}++r}),n.curOp.forceUpdate=!0,da(n,"refresh",this)}),operation:function(e){return lt(this,e)},refresh:dt(function(){var e=this.display.cachedTextHeight;pt(this),this.curOp.forceUpdate=!0,Re(this),this.scrollTo(this.doc.scrollLeft,this.doc.scrollTop),h(this),(null==e||Math.abs(e-Je(this.display))>.5)&&a(this),da(this,"refresh",this)}),swapDoc:dt(function(e){var t=this.doc;return t.cm=null,Mn(this,e),Re(this),Ct(this),this.scrollTo(e.scrollLeft,e.scrollTop),this.curOp.forceScroll=!0,ir(this,"swapDoc",this,t),t}),getInputField:function(){return this.display.input},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},or(e);var Os=e.defaults={},As=e.optionHandlers={},Ns=e.Init={toString:function(){return"CodeMirror.Init"}};Di("value","",function(e,t){e.setValue(t)},!0),Di("mode",null,function(e,t){e.doc.modeOption=t,i(e)},!0),Di("indentUnit",2,i,!0),Di("indentWithTabs",!1),Di("smartIndent",!0),Di("tabSize",4,function(e){n(e),Re(e),pt(e)},!0),Di("specialChars",/[\t\u0000-\u0019\u00ad\u200b-\u200f\u2028\u2029\ufeff]/g,function(e,t){e.options.specialChars=new RegExp(t.source+(t.test("\t")?"":"|\t"),"g"),e.refresh()},!0),Di("specialCharPlaceholder",_n,function(e){e.refresh()},!0),Di("electricChars",!0),Di("rtlMoveVisually",!hs),Di("wholeLineUpdateBefore",!0),Di("theme","default",function(e){l(e),c(e)},!0),Di("keyMap","default",o),Di("extraKeys",null),Di("lineWrapping",!1,r,!0),Di("gutters",[],function(e){p(e.options),c(e)},!0),Di("fixedGutter",!0,function(e,t){e.display.gutters.style.left=t?w(e.display)+"px":"0",e.refresh()},!0),Di("coverGutterNextToScrollbar",!1,v,!0),Di("lineNumbers",!1,function(e){p(e.options),c(e)},!0),Di("firstLineNumber",1,c,!0),Di("lineNumberFormatter",function(e){return e},c,!0),Di("showCursorWhenSelecting",!1,_e,!0),Di("resetSelectionOnContextMenu",!0),Di("readOnly",!1,function(e,t){"nocursor"==t?(Qt(e),e.display.input.blur(),e.display.disabled=!0):(e.display.disabled=!1,t||Ct(e))}),Di("disableInput",!1,function(e,t){t||Ct(e)},!0),Di("dragDrop",!0),Di("cursorBlinkRate",530),Di("cursorScrollMargin",0),Di("cursorHeight",1,_e,!0),Di("singleCursorHeightPerLine",!0,_e,!0),Di("workTime",100),Di("workDelay",100),Di("flattenSpans",!0,n,!0),Di("addModeClass",!1,n,!0),Di("pollInterval",100),Di("undoDepth",200,function(e,t){e.doc.history.undoDepth=t}),Di("historyEventDelay",1250),Di("viewportMargin",10,function(e){e.refresh()},!0),Di("maxHighlightLength",1e4,n,!0),Di("moveInputWithCursor",!0,function(e,t){t||(e.display.inputDiv.style.top=e.display.inputDiv.style.left=0)}),Di("tabindex",null,function(e,t){e.display.input.tabIndex=t||""}),Di("autofocus",null);var Fs=e.modes={},Ps=e.mimeModes={};e.defineMode=function(t,i){e.defaults.mode||"null"==t||(e.defaults.mode=t),arguments.length>2&&(i.dependencies=Array.prototype.slice.call(arguments,2)),Fs[t]=i},e.defineMIME=function(e,t){Ps[e]=t},e.resolveMode=function(t){if("string"==typeof t&&Ps.hasOwnProperty(t))t=Ps[t];else if(t&&"string"==typeof t.name&&Ps.hasOwnProperty(t.name)){var i=Ps[t.name];"string"==typeof i&&(i={name:i}),t=pr(i,t),t.name=i.name}else if("string"==typeof t&&/^[\w\-]+\/[\w\-]+\+xml$/.test(t))return e.resolveMode("application/xml");return"string"==typeof t?{name:t}:t||{name:"null"}},e.getMode=function(t,i){var i=e.resolveMode(i),n=Fs[i.name];if(!n)return e.getMode(t,"text/plain");var r=n(t,i);if(Is.hasOwnProperty(i.name)){var s=Is[i.name];for(var a in s)s.hasOwnProperty(a)&&(r.hasOwnProperty(a)&&(r["_"+a]=r[a]),r[a]=s[a])}if(r.name=i.name,i.helperType&&(r.helperType=i.helperType),i.modeProps)for(var a in i.modeProps)r[a]=i.modeProps[a];return r},e.defineMode("null",function(){return{token:function(e){e.skipToEnd()}}}),e.defineMIME("text/plain","null");var Is=e.modeExtensions={};e.extendMode=function(e,t){var i=Is.hasOwnProperty(e)?Is[e]:Is[e]={};mr(t,i)},e.defineExtension=function(t,i){e.prototype[t]=i},e.defineDocExtension=function(e,t){ia.prototype[e]=t},e.defineOption=Di;var Hs=[];e.defineInitHook=function(e){Hs.push(e)};var $s=e.helpers={};e.registerHelper=function(t,i,n){$s.hasOwnProperty(t)||($s[t]=e[t]={_global:[]}),$s[t][i]=n},e.registerGlobalHelper=function(t,i,n,r){e.registerHelper(t,i,r),$s[t]._global.push({pred:n,val:r})};var Rs=e.copyState=function(e,t){if(t===!0)return t;if(e.copyState)return e.copyState(t);var i={};for(var n in t){var r=t[n];r instanceof Array&&(r=r.concat([])),i[n]=r}return i},zs=e.startState=function(e,t,i){return!e.startState||e.startState(t,i)};e.innerMode=function(e,t){for(;e.innerMode;){var i=e.innerMode(t);if(!i||i.mode==e)break;t=i.state,e=i.mode}return i||{mode:e,state:t}};var Ws=e.commands={selectAll:function(e){e.setSelection(vs(e.firstLine(),0),vs(e.lastLine()),pa)},singleSelection:function(e){e.setSelection(e.getCursor("anchor"),e.getCursor("head"),pa)},killLine:function(e){wi(e,function(t){if(t.empty()){var i=Ln(e.doc,t.head.line).text.length;return t.head.ch==i&&t.head.line<e.lastLine()?{from:t.head,to:vs(t.head.line+1,0)}:{from:t.head,to:vs(t.head.line,i)}}return{from:t.from(),to:t.to()}})},deleteLine:function(e){wi(e,function(t){return{from:vs(t.from().line,0),to:Z(e.doc,vs(t.to().line+1,0))}})},delLineLeft:function(e){wi(e,function(e){return{from:vs(e.from().line,0),to:e.from()}})},delWrappedLineLeft:function(e){wi(e,function(t){var i=e.charCoords(t.head,"div").top+5,n=e.coordsChar({left:0,top:i},"div");return{from:n,to:t.from()}})},delWrappedLineRight:function(e){wi(e,function(t){var i=e.charCoords(t.head,"div").top+5,n=e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:i},"div");return{from:t.from(),to:n}})},undo:function(e){e.undo()},redo:function(e){e.redo()},undoSelection:function(e){e.undoSelection()},redoSelection:function(e){e.redoSelection()},goDocStart:function(e){e.extendSelection(vs(e.firstLine(),0))},goDocEnd:function(e){e.extendSelection(vs(e.lastLine()))},goLineStart:function(e){e.extendSelectionsBy(function(t){return zr(e,t.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(e){e.extendSelectionsBy(function(t){return Yr(e,t.head)},{origin:"+move",bias:1})},goLineEnd:function(e){e.extendSelectionsBy(function(t){return Wr(e,t.head.line)},{origin:"+move",bias:-1})},goLineRight:function(e){e.extendSelectionsBy(function(t){var i=e.charCoords(t.head,"div").top+5;return e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:i},"div")},ga)},goLineLeft:function(e){e.extendSelectionsBy(function(t){var i=e.charCoords(t.head,"div").top+5;return e.coordsChar({left:0,top:i},"div")},ga)},goLineLeftSmart:function(e){e.extendSelectionsBy(function(t){var i=e.charCoords(t.head,"div").top+5,n=e.coordsChar({left:0,top:i},"div");return n.ch<e.getLine(n.line).search(/\S/)?Yr(e,t.head):n},ga)},goLineUp:function(e){e.moveV(-1,"line")},goLineDown:function(e){e.moveV(1,"line")},goPageUp:function(e){e.moveV(-1,"page")},goPageDown:function(e){e.moveV(1,"page")},goCharLeft:function(e){e.moveH(-1,"char")},goCharRight:function(e){e.moveH(1,"char")},goColumnLeft:function(e){e.moveH(-1,"column")},goColumnRight:function(e){e.moveH(1,"column")},goWordLeft:function(e){e.moveH(-1,"word")},goGroupRight:function(e){e.moveH(1,"group")},goGroupLeft:function(e){e.moveH(-1,"group")},goWordRight:function(e){e.moveH(1,"word")},delCharBefore:function(e){e.deleteH(-1,"char")},delCharAfter:function(e){e.deleteH(1,"char")},delWordBefore:function(e){e.deleteH(-1,"word")},delWordAfter:function(e){e.deleteH(1,"word")},delGroupBefore:function(e){e.deleteH(-1,"group")},delGroupAfter:function(e){e.deleteH(1,"group")},indentAuto:function(e){e.indentSelection("smart")},indentMore:function(e){e.indentSelection("add")},indentLess:function(e){e.indentSelection("subtract")},insertTab:function(e){e.replaceSelection("\t")},insertSoftTab:function(e){for(var t=[],i=e.listSelections(),n=e.options.tabSize,r=0;r<i.length;r++){var s=i[r].from(),a=va(e.getLine(s.line),s.ch,n);t.push(new Array(n-a%n+1).join(" "))}e.replaceSelections(t)},defaultTab:function(e){e.somethingSelected()?e.indentSelection("add"):e.execCommand("insertTab")},transposeChars:function(e){lt(e,function(){for(var t=e.listSelections(),i=[],n=0;n<t.length;n++){var r=t[n].head,s=Ln(e.doc,r.line).text;if(s)if(r.ch==s.length&&(r=new vs(r.line,r.ch-1)),r.ch>0)r=new vs(r.line,r.ch+1),e.replaceRange(s.charAt(r.ch-1)+s.charAt(r.ch-2),vs(r.line,r.ch-2),r,"+transpose");else if(r.line>e.doc.first){var a=Ln(e.doc,r.line-1).text;a&&e.replaceRange(s.charAt(0)+"\n"+a.charAt(a.length-1),vs(r.line-1,a.length-1),vs(r.line,1),"+transpose")}i.push(new G(r,r))}e.setSelections(i)})},newlineAndIndent:function(e){lt(e,function(){for(var t=e.listSelections().length,i=0;i<t;i++){var n=e.listSelections()[i];e.replaceRange("\n",n.anchor,n.head,"+input"),e.indentLine(n.from().line+1,null,!0),_i(e)}})},toggleOverwrite:function(e){e.toggleOverwrite()}},Ys=e.keyMap={};Ys.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},Ys.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},Ys.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]},Ys.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars"},Ys["default"]=ds?Ys.macDefault:Ys.pcDefault;var Bs=e.lookupKey=function(e,t,i){function n(t){t=Si(t);var r=t[e];if(r===!1)return"stop";if(null!=r&&i(r))return!0;if(t.nofallthrough)return"stop";var s=t.fallthrough;if(null==s)return!1;if("[object Array]"!=Object.prototype.toString.call(s))return n(s);for(var a=0;a<s.length;++a){var o=n(s[a]);if(o)return o}return!1}for(var r=0;r<t.length;++r){var s=n(t[r]);if(s)return"stop"!=s}},Us=e.isModifierKey=function(e){var t=Aa[e.keyCode];return"Ctrl"==t||"Alt"==t||"Shift"==t||"Mod"==t},qs=e.keyName=function(e,t){if(ns&&34==e.keyCode&&e["char"])return!1;var i=Aa[e.keyCode];return null!=i&&!e.altGraphKey&&(e.altKey&&(i="Alt-"+i),(fs?e.metaKey:e.ctrlKey)&&(i="Ctrl-"+i),(fs?e.ctrlKey:e.metaKey)&&(i="Cmd-"+i),!t&&e.shiftKey&&(i="Shift-"+i),i)};e.fromTextArea=function(t,i){function n(){t.value=c.getValue()}if(i||(i={}),i.value=t.value,!i.tabindex&&t.tabindex&&(i.tabindex=t.tabindex),!i.placeholder&&t.placeholder&&(i.placeholder=t.placeholder),null==i.autofocus){var r=Cr();i.autofocus=r==t||null!=t.getAttribute("autofocus")&&r==document.body}if(t.form&&(la(t.form,"submit",n),!i.leaveSubmitMethodAlone)){var s=t.form,a=s.submit;try{var o=s.submit=function(){n(),s.submit=a,s.submit(),s.submit=o}}catch(l){}}t.style.display="none";var c=e(function(e){t.parentNode.insertBefore(e,t.nextSibling)},i);return c.save=n,c.getTextArea=function(){return t},c.toTextArea=function(){c.toTextArea=isNaN,n(),t.parentNode.removeChild(c.getWrapperElement()),t.style.display="",t.form&&(ca(t.form,"submit",n),"function"==typeof t.form.submit&&(t.form.submit=a))},c};var Xs=e.StringStream=function(e,t){this.pos=this.start=0,this.string=e,this.tabSize=t||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0};Xs.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return this.pos==this.lineStart},peek:function(){return this.string.charAt(this.pos)||void 0},next:function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},eat:function(e){var t=this.string.charAt(this.pos);if("string"==typeof e)var i=t==e;else var i=t&&(e.test?e.test(t):e(t));if(i)return++this.pos,t},eatWhile:function(e){for(var t=this.pos;this.eat(e););return this.pos>t},eatSpace:function(){for(var e=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e},skipToEnd:function(){this.pos=this.string.length},skipTo:function(e){var t=this.string.indexOf(e,this.pos);if(t>-1)return this.pos=t,!0},backUp:function(e){this.pos-=e},column:function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=va(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?va(this.string,this.lineStart,this.tabSize):0)},indentation:function(){return va(this.string,null,this.tabSize)-(this.lineStart?va(this.string,this.lineStart,this.tabSize):0)},match:function(e,t,i){if("string"!=typeof e){var n=this.string.slice(this.pos).match(e);return n&&n.index>0?null:(n&&t!==!1&&(this.pos+=n[0].length),n)}var r=function(e){return i?e.toLowerCase():e},s=this.string.substr(this.pos,e.length);if(r(s)==r(e))return t!==!1&&(this.pos+=e.length),!0},current:function(){return this.string.slice(this.start,this.pos)},hideFirstChars:function(e,t){this.lineStart+=e;try{return t()}finally{this.lineStart-=e}}};var Vs=e.TextMarker=function(e,t){this.lines=[],this.type=t,this.doc=e};or(Vs),Vs.prototype.clear=function(){if(!this.explicitlyCleared){var e=this.doc.cm,t=e&&!e.curOp;if(t&&Ze(e),ar(this,"clear")){var i=this.find();i&&ir(this,"clear",i.from,i.to)}for(var n=null,r=null,s=0;s<this.lines.length;++s){var a=this.lines[s],o=Ai(a.markedSpans,this);e&&!this.collapsed?mt(e,Nn(a),"text"):e&&(null!=o.to&&(r=Nn(a)),null!=o.from&&(n=Nn(a))),a.markedSpans=Ni(a.markedSpans,o),null==o.from&&this.collapsed&&!tn(this.doc,a)&&e&&An(a,Je(e.display))}if(e&&this.collapsed&&!e.options.lineWrapping)for(var s=0;s<this.lines.length;++s){var l=Ji(this.lines[s]),c=u(l);c>e.display.maxLineLength&&(e.display.maxLine=l,e.display.maxLineLength=c,e.display.maxLineChanged=!0)}null!=n&&e&&this.collapsed&&pt(e,n,r+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,e&&fe(e.doc)),e&&ir(e,"markerCleared",e,this),t&&tt(e),this.parent&&this.parent.clear()}},Vs.prototype.find=function(e,t){null==e&&"bookmark"==this.type&&(e=1);for(var i,n,r=0;r<this.lines.length;++r){var s=this.lines[r],a=Ai(s.markedSpans,this);if(null!=a.from&&(i=vs(t?s:Nn(s),a.from),e==-1))return i;if(null!=a.to&&(n=vs(t?s:Nn(s),a.to),1==e))return n}return i&&{from:i,to:n}},Vs.prototype.changed=function(){var e=this.find(-1,!0),t=this,i=this.doc.cm;e&&i&&lt(i,function(){var n=e.line,r=Nn(e.line),s=Ae(i,r);if(s&&(He(s),i.curOp.selectionChanged=i.curOp.forceUpdate=!0),i.curOp.updateMaxLine=!0,!tn(t.doc,n)&&null!=t.height){var a=t.height;t.height=null;var o=sn(t)-a;o&&An(n,n.height+o)}})},Vs.prototype.attachLine=function(e){if(!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;t.maybeHiddenMarkers&&ur(t.maybeHiddenMarkers,this)!=-1||(t.maybeUnhiddenMarkers||(t.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(e)},Vs.prototype.detachLine=function(e){if(this.lines.splice(ur(this.lines,e),1),!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;(t.maybeHiddenMarkers||(t.maybeHiddenMarkers=[])).push(this)}};var Gs=0,Ks=e.SharedTextMarker=function(e,t){this.markers=e,this.primary=t;for(var i=0;i<e.length;++i)e[i].parent=this};or(Ks),Ks.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var e=0;e<this.markers.length;++e)this.markers[e].clear();ir(this,"clear")}},Ks.prototype.find=function(e,t){return this.primary.find(e,t)};var Js=e.LineWidget=function(e,t,i){if(i)for(var n in i)i.hasOwnProperty(n)&&(this[n]=i[n]);this.cm=e,this.node=t};or(Js),Js.prototype.clear=function(){var e=this.cm,t=this.line.widgets,i=this.line,n=Nn(i);if(null!=n&&t){for(var r=0;r<t.length;++r)t[r]==this&&t.splice(r--,1);t.length||(i.widgets=null);var s=sn(this);lt(e,function(){rn(e,i,-s),mt(e,n,"widget"),An(i,Math.max(0,i.height-s))})}},Js.prototype.changed=function(){var e=this.height,t=this.cm,i=this.line;this.height=null;var n=sn(this)-e;n&&lt(t,function(){t.curOp.forceUpdate=!0,rn(t,i,n),An(i,i.height+n)})};var Qs=e.Line=function(e,t,i){this.text=e,Yi(this,t),this.height=i?i(this):1};or(Qs),Qs.prototype.lineNo=function(){return Nn(this)};var Zs={},ea={};Sn.prototype={chunkSize:function(){return this.lines.length},removeInner:function(e,t){for(var i=e,n=e+t;i<n;++i){var r=this.lines[i];this.height-=r.height,ln(r),ir(r,"delete")}this.lines.splice(e,t)},collapse:function(e){e.push.apply(e,this.lines)},insertInner:function(e,t,i){this.height+=i,this.lines=this.lines.slice(0,e).concat(t).concat(this.lines.slice(e));for(var n=0;n<t.length;++n)t[n].parent=this},iterN:function(e,t,i){for(var n=e+t;e<n;++e)if(i(this.lines[e]))return!0}},jn.prototype={chunkSize:function(){return this.size},removeInner:function(e,t){this.size-=t;for(var i=0;i<this.children.length;++i){var n=this.children[i],r=n.chunkSize();if(e<r){var s=Math.min(t,r-e),a=n.height;if(n.removeInner(e,s),this.height-=a-n.height,r==s&&(this.children.splice(i--,1),n.parent=null),0==(t-=s))break;e=0}else e-=r}if(this.size-t<25&&(this.children.length>1||!(this.children[0]instanceof Sn))){var o=[];this.collapse(o),this.children=[new Sn(o)],this.children[0].parent=this}},collapse:function(e){for(var t=0;t<this.children.length;++t)this.children[t].collapse(e)},insertInner:function(e,t,i){this.size+=t.length,this.height+=i;for(var n=0;n<this.children.length;++n){var r=this.children[n],s=r.chunkSize();if(e<=s){if(r.insertInner(e,t,i),r.lines&&r.lines.length>50){for(;r.lines.length>50;){var a=r.lines.splice(r.lines.length-25,25),o=new Sn(a);r.height-=o.height,this.children.splice(n+1,0,o),o.parent=this}this.maybeSpill()}break}e-=s}},maybeSpill:function(){if(!(this.children.length<=10)){var e=this;do{var t=e.children.splice(e.children.length-5,5),i=new jn(t);if(e.parent){e.size-=i.size,e.height-=i.height;var n=ur(e.parent.children,e);e.parent.children.splice(n+1,0,i)}else{var r=new jn(e.children);r.parent=e,e.children=[r,i],e=r}i.parent=e.parent}while(e.children.length>10);e.parent.maybeSpill()}},iterN:function(e,t,i){for(var n=0;n<this.children.length;++n){var r=this.children[n],s=r.chunkSize();if(e<s){var a=Math.min(t,s-e);if(r.iterN(e,a,i))return!0;if(0==(t-=a))break;e=0}else e-=s}}};var ta=0,ia=e.Doc=function(e,t,i){if(!(this instanceof ia))return new ia(e,t,i);
null==i&&(i=0),jn.call(this,[new Sn([new Qs("",null)])]),this.first=i,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1,this.frontier=i;var n=vs(i,0);this.sel=J(n),this.history=new Hn(null),this.id=++ta,this.modeOption=t,"string"==typeof e&&(e=Ma(e)),Dn(this,{from:n,to:n,text:e}),de(this,J(n),pa)};ia.prototype=pr(jn.prototype,{constructor:ia,iter:function(e,t,i){i?this.iterN(e-this.first,t-e,i):this.iterN(this.first,this.first+this.size,e)},insert:function(e,t){for(var i=0,n=0;n<t.length;++n)i+=t[n].height;this.insertInner(e-this.first,t,i)},remove:function(e,t){this.removeInner(e-this.first,t)},getValue:function(e){var t=On(this,this.first,this.first+this.size);return e===!1?t:t.join(e||"\n")},setValue:ht(function(e){var t=vs(this.first,0),i=this.first+this.size-1;ai(this,{from:t,to:vs(i,Ln(this,i).text.length),text:Ma(e),origin:"setValue"},!0),de(this,J(t))}),replaceRange:function(e,t,i,n){t=Z(this,t),i=i?Z(this,i):t,ui(this,e,t,i,n)},getRange:function(e,t,i){var n=En(this,Z(this,e),Z(this,t));return i===!1?n:n.join(i||"\n")},getLine:function(e){var t=this.getLineHandle(e);return t&&t.text},getLineHandle:function(e){if(te(this,e))return Ln(this,e)},getLineNumber:function(e){return Nn(e)},getLineHandleVisualStart:function(e){return"number"==typeof e&&(e=Ln(this,e)),Ji(e)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(e){return Z(this,e)},getCursor:function(e){var t,i=this.sel.primary();return t=null==e||"head"==e?i.head:"anchor"==e?i.anchor:"end"==e||"to"==e||e===!1?i.to():i.from()},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:ht(function(e,t,i){oe(this,Z(this,"number"==typeof e?vs(e,t||0):e),null,i)}),setSelection:ht(function(e,t,i){oe(this,Z(this,e),Z(this,t||e),i)}),extendSelection:ht(function(e,t,i){re(this,Z(this,e),t&&Z(this,t),i)}),extendSelections:ht(function(e,t){se(this,ie(this,e,t))}),extendSelectionsBy:ht(function(e,t){se(this,fr(this.sel.ranges,e),t)}),setSelections:ht(function(e,t,i){if(e.length){for(var n=0,r=[];n<e.length;n++)r[n]=new G(Z(this,e[n].anchor),Z(this,e[n].head));null==t&&(t=Math.min(e.length-1,this.sel.primIndex)),de(this,K(r,t),i)}}),addSelection:ht(function(e,t,i){var n=this.sel.ranges.slice(0);n.push(new G(Z(this,e),Z(this,t||e))),de(this,K(n,n.length-1),i)}),getSelection:function(e){for(var t,i=this.sel.ranges,n=0;n<i.length;n++){var r=En(this,i[n].from(),i[n].to());t=t?t.concat(r):r}return e===!1?t:t.join(e||"\n")},getSelections:function(e){for(var t=[],i=this.sel.ranges,n=0;n<i.length;n++){var r=En(this,i[n].from(),i[n].to());e!==!1&&(r=r.join(e||"\n")),t[n]=r}return t},replaceSelection:function(e,t,i){for(var n=[],r=0;r<this.sel.ranges.length;r++)n[r]=e;this.replaceSelections(n,t,i||"+input")},replaceSelections:ht(function(e,t,i){for(var n=[],r=this.sel,s=0;s<r.ranges.length;s++){var a=r.ranges[s];n[s]={from:a.from(),to:a.to(),text:Ma(e[s]),origin:i}}for(var o=t&&"end"!=t&&ri(this,n,t),s=n.length-1;s>=0;s--)ai(this,n[s]);o?ce(this,o):this.cm&&_i(this.cm)}),undo:ht(function(){li(this,"undo")}),redo:ht(function(){li(this,"redo")}),undoSelection:ht(function(){li(this,"undo",!0)}),redoSelection:ht(function(){li(this,"redo",!0)}),setExtending:function(e){this.extend=e},getExtending:function(){return this.extend},historySize:function(){for(var e=this.history,t=0,i=0,n=0;n<e.done.length;n++)e.done[n].ranges||++t;for(var n=0;n<e.undone.length;n++)e.undone[n].ranges||++i;return{undo:t,redo:i}},clearHistory:function(){this.history=new Hn(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(e){return e&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(e){return this.history.generation==(e||this.cleanGeneration)},getHistory:function(){return{done:Gn(this.history.done),undone:Gn(this.history.undone)}},setHistory:function(e){var t=this.history=new Hn(this.history.maxGeneration);t.done=Gn(e.done.slice(0),null,!0),t.undone=Gn(e.undone.slice(0),null,!0)},addLineClass:ht(function(e,t,i){return xi(this,e,"class",function(e){var n="text"==t?"textClass":"background"==t?"bgClass":"wrapClass";if(e[n]){if(new RegExp("(?:^|\\s)"+i+"(?:$|\\s)").test(e[n]))return!1;e[n]+=" "+i}else e[n]=i;return!0})}),removeLineClass:ht(function(e,t,i){return xi(this,e,"class",function(e){var n="text"==t?"textClass":"background"==t?"bgClass":"wrapClass",r=e[n];if(!r)return!1;if(null==i)e[n]=null;else{var s=r.match(new RegExp("(?:^|\\s+)"+i+"(?:$|\\s+)"));if(!s)return!1;var a=s.index+s[0].length;e[n]=r.slice(0,s.index)+(s.index&&a!=r.length?" ":"")+r.slice(a)||null}return!0})}),markText:function(e,t,i){return ji(this,Z(this,e),Z(this,t),i,"range")},setBookmark:function(e,t){var i={replacedWith:t&&(null==t.nodeType?t.widget:t),insertLeft:t&&t.insertLeft,clearWhenEmpty:!1,shared:t&&t.shared};return e=Z(this,e),ji(this,e,e,i,"bookmark")},findMarksAt:function(e){e=Z(this,e);var t=[],i=Ln(this,e.line).markedSpans;if(i)for(var n=0;n<i.length;++n){var r=i[n];(null==r.from||r.from<=e.ch)&&(null==r.to||r.to>=e.ch)&&t.push(r.marker.parent||r.marker)}return t},findMarks:function(e,t,i){e=Z(this,e),t=Z(this,t);var n=[],r=e.line;return this.iter(e.line,t.line+1,function(s){var a=s.markedSpans;if(a)for(var o=0;o<a.length;o++){var l=a[o];r==e.line&&e.ch>l.to||null==l.from&&r!=e.line||r==t.line&&l.from>t.ch||i&&!i(l.marker)||n.push(l.marker.parent||l.marker)}++r}),n},getAllMarks:function(){var e=[];return this.iter(function(t){var i=t.markedSpans;if(i)for(var n=0;n<i.length;++n)null!=i[n].from&&e.push(i[n].marker)}),e},posFromIndex:function(e){var t,i=this.first;return this.iter(function(n){var r=n.text.length+1;return r>e?(t=e,!0):(e-=r,void++i)}),Z(this,vs(i,t))},indexFromPos:function(e){e=Z(this,e);var t=e.ch;return e.line<this.first||e.ch<0?0:(this.iter(this.first,e.line,function(e){t+=e.text.length+1}),t)},copy:function(e){var t=new ia(On(this,this.first,this.first+this.size),this.modeOption,this.first);return t.scrollTop=this.scrollTop,t.scrollLeft=this.scrollLeft,t.sel=this.sel,t.extend=!1,e&&(t.history.undoDepth=this.history.undoDepth,t.setHistory(this.getHistory())),t},linkedDoc:function(e){e||(e={});var t=this.first,i=this.first+this.size;null!=e.from&&e.from>t&&(t=e.from),null!=e.to&&e.to<i&&(i=e.to);var n=new ia(On(this,t,i),e.mode||this.modeOption,t);return e.sharedHist&&(n.history=this.history),(this.linked||(this.linked=[])).push({doc:n,sharedHist:e.sharedHist}),n.linked=[{doc:this,isParent:!0,sharedHist:e.sharedHist}],Li(n,Mi(this)),n},unlinkDoc:function(t){if(t instanceof e&&(t=t.doc),this.linked)for(var i=0;i<this.linked.length;++i){var n=this.linked[i];if(n.doc==t){this.linked.splice(i,1),t.unlinkDoc(this),Ei(Mi(this));break}}if(t.history==this.history){var r=[t.id];Tn(t,function(e){r.push(e.id)},!0),t.history=new Hn(null),t.history.done=Gn(this.history.done,r),t.history.undone=Gn(this.history.undone,r)}},iterLinkedDocs:function(e){Tn(this,e)},getMode:function(){return this.mode},getEditor:function(){return this.cm}}),ia.prototype.eachLine=ia.prototype.iter;var na="iter insert remove copy getEditor".split(" ");for(var ra in ia.prototype)ia.prototype.hasOwnProperty(ra)&&ur(na,ra)<0&&(e.prototype[ra]=function(e){return function(){return e.apply(this.doc,arguments)}}(ia.prototype[ra]));or(ia);var sa=e.e_preventDefault=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},aa=e.e_stopPropagation=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},oa=e.e_stop=function(e){sa(e),aa(e)},la=e.on=function(e,t,i){if(e.addEventListener)e.addEventListener(t,i,!1);else if(e.attachEvent)e.attachEvent("on"+t,i);else{var n=e._handlers||(e._handlers={}),r=n[t]||(n[t]=[]);r.push(i)}},ca=e.off=function(e,t,i){if(e.removeEventListener)e.removeEventListener(t,i,!1);else if(e.detachEvent)e.detachEvent("on"+t,i);else{var n=e._handlers&&e._handlers[t];if(!n)return;for(var r=0;r<n.length;++r)if(n[r]==i){n.splice(r,1);break}}},da=e.signal=function(e,t){var i=e._handlers&&e._handlers[t];if(i)for(var n=Array.prototype.slice.call(arguments,2),r=0;r<i.length;++r)i[r].apply(null,n)},ha=null,ua=30,fa=e.Pass={toString:function(){return"CodeMirror.Pass"}},pa={scroll:!1},ma={origin:"*mouse"},ga={origin:"+move"};lr.prototype.set=function(e,t){clearTimeout(this.id),this.id=setTimeout(t,e)};var va=e.countColumn=function(e,t,i,n,r){null==t&&(t=e.search(/[^\s\u00a0]/),t==-1&&(t=e.length));for(var s=n||0,a=r||0;;){var o=e.indexOf("\t",s);if(o<0||o>=t)return a+(t-s);a+=o-s,a+=i-a%i,s=o+1}},_a=[""],ya=function(e){e.select()};ls?ya=function(e){e.selectionStart=0,e.selectionEnd=e.value.length}:Qr&&(ya=function(e){try{e.select()}catch(t){}}),[].indexOf&&(ur=function(e,t){return e.indexOf(t)}),[].map&&(fr=function(e,t){return e.map(t)});var ba,xa=/[\u00df\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/,wa=e.isWordChar=function(e){return/\w/.test(e)||e>""&&(e.toUpperCase()!=e.toLowerCase()||xa.test(e))},ka=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;ba=document.createRange?function(e,t,i){var n=document.createRange();return n.setEnd(e,i),n.setStart(e,t),n}:function(e,t,i){var n=document.body.createTextRange();return n.moveToElementText(e.parentNode),n.collapse(!0),n.moveEnd("character",i),n.moveStart("character",t),n},Qr&&Zr<11&&(Cr=function(){try{return document.activeElement}catch(e){return document.body}});var Ca,Da,Sa,ja=!1,Ta=function(){if(Qr&&Zr<9)return!1;var e=br("div");return"draggable"in e||"dragDrop"in e}(),Ma=e.splitLines=3!="\n\nb".split(/\n/).length?function(e){for(var t=0,i=[],n=e.length;t<=n;){var r=e.indexOf("\n",t);r==-1&&(r=e.length);var s=e.slice(t,"\r"==e.charAt(r-1)?r-1:r),a=s.indexOf("\r");a!=-1?(i.push(s.slice(0,a)),t+=a+1):(i.push(s),t=r+1)}return i}:function(e){return e.split(/\r\n?|\n/)},La=window.getSelection?function(e){try{return e.selectionStart!=e.selectionEnd}catch(t){return!1}}:function(e){try{var t=e.ownerDocument.selection.createRange()}catch(i){}return!(!t||t.parentElement()!=e)&&0!=t.compareEndPoints("StartToEnd",t)},Ea=function(){var e=br("div");return"oncopy"in e||(e.setAttribute("oncopy","return;"),"function"==typeof e.oncopy)}(),Oa=null,Aa={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",107:"=",109:"-",127:"Delete",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"};e.keyNames=Aa,function(){for(var e=0;e<10;e++)Aa[e+48]=Aa[e+96]=String(e);for(var e=65;e<=90;e++)Aa[e]=String.fromCharCode(e);for(var e=1;e<=12;e++)Aa[e+111]=Aa[e+63235]="F"+e}();var Na,Fa=function(){function e(e){return e<=247?i.charAt(e):1424<=e&&e<=1524?"R":1536<=e&&e<=1773?n.charAt(e-1536):1774<=e&&e<=2220?"r":8192<=e&&e<=8203?"w":8204==e?"b":"L"}function t(e,t,i){this.level=e,this.from=t,this.to=i}var i="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN",n="rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmm",r=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,s=/[stwN]/,a=/[LRr]/,o=/[Lb1n]/,l=/[1n]/,c="L";return function(i){if(!r.test(i))return!1;for(var n,d=i.length,h=[],u=0;u<d;++u)h.push(n=e(i.charCodeAt(u)));for(var u=0,f=c;u<d;++u){var n=h[u];"m"==n?h[u]=f:f=n}for(var u=0,p=c;u<d;++u){var n=h[u];"1"==n&&"r"==p?h[u]="n":a.test(n)&&(p=n,"r"==n&&(h[u]="R"))}for(var u=1,f=h[0];u<d-1;++u){var n=h[u];"+"==n&&"1"==f&&"1"==h[u+1]?h[u]="1":","!=n||f!=h[u+1]||"1"!=f&&"n"!=f||(h[u]=f),f=n}for(var u=0;u<d;++u){var n=h[u];if(","==n)h[u]="N";else if("%"==n){for(var m=u+1;m<d&&"%"==h[m];++m);for(var g=u&&"!"==h[u-1]||m<d&&"1"==h[m]?"1":"N",v=u;v<m;++v)h[v]=g;u=m-1}}for(var u=0,p=c;u<d;++u){var n=h[u];"L"==p&&"1"==n?h[u]="L":a.test(n)&&(p=n)}for(var u=0;u<d;++u)if(s.test(h[u])){for(var m=u+1;m<d&&s.test(h[m]);++m);for(var _="L"==(u?h[u-1]:c),y="L"==(m<d?h[m]:c),g=_||y?"L":"R",v=u;v<m;++v)h[v]=g;u=m-1}for(var b,x=[],u=0;u<d;)if(o.test(h[u])){var w=u;for(++u;u<d&&o.test(h[u]);++u);x.push(new t(0,w,u))}else{var k=u,C=x.length;for(++u;u<d&&"L"!=h[u];++u);for(var v=k;v<u;)if(l.test(h[v])){k<v&&x.splice(C,0,new t(1,k,v));var D=v;for(++v;v<u&&l.test(h[v]);++v);x.splice(C,0,new t(2,D,v)),k=v}else++v;k<u&&x.splice(C,0,new t(1,k,u))}return 1==x[0].level&&(b=i.match(/^\s+/))&&(x[0].from=b[0].length,x.unshift(new t(0,0,b[0].length))),1==hr(x).level&&(b=i.match(/\s+$/))&&(hr(x).to-=b[0].length,x.push(new t(0,d-b[0].length,d))),x[0].level!=hr(x).level&&x.push(new t(x[0].level,d,d)),x}}();return e.version="4.7.0",e}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";e.defineMode("javascript",function(t,i){function n(e){for(var t,i=!1,n=!1;null!=(t=e.next());){if(!i){if("/"==t&&!n)return;"["==t?n=!0:n&&"]"==t&&(n=!1)}i=!i&&"\\"==t}}function r(e,t,i){return pe=e,me=i,t}function s(e,t){var i=e.next();if('"'==i||"'"==i)return t.tokenize=a(i),t.tokenize(e,t);if("."==i&&e.match(/^\d+(?:[eE][+\-]?\d+)?/))return r("number","number");if("."==i&&e.match(".."))return r("spread","meta");if(/[\[\]{}\(\),;\:\.]/.test(i))return r(i);if("="==i&&e.eat(">"))return r("=>","operator");if("0"==i&&e.eat(/x/i))return e.eatWhile(/[\da-f]/i),r("number","number");if(/\d/.test(i))return e.match(/^\d*(?:\.\d*)?(?:[eE][+\-]?\d+)?/),r("number","number");if("/"==i)return e.eat("*")?(t.tokenize=o,o(e,t)):e.eat("/")?(e.skipToEnd(),r("comment","comment")):"operator"==t.lastType||"keyword c"==t.lastType||"sof"==t.lastType||/^[\[{}\(,;:]$/.test(t.lastType)?(n(e),e.eatWhile(/[gimy]/),r("regexp","string-2")):(e.eatWhile(ke),r("operator","operator",e.current()));if("`"==i)return t.tokenize=l,l(e,t);if("#"==i)return e.skipToEnd(),r("error","error");if(ke.test(i))return e.eatWhile(ke),r("operator","operator",e.current());if(xe.test(i)){e.eatWhile(xe);var s=e.current(),c=we.propertyIsEnumerable(s)&&we[s];return c&&"."!=t.lastType?r(c.type,c.style,s):r("variable","variable",s)}}function a(e){return function(t,i){var n,a=!1;if(_e&&"@"==t.peek()&&t.match(Ce))return i.tokenize=s,r("jsonld-keyword","meta");for(;null!=(n=t.next())&&(n!=e||a);)a=!a&&"\\"==n;return a||(i.tokenize=s),r("string","string")}}function o(e,t){for(var i,n=!1;i=e.next();){if("/"==i&&n){t.tokenize=s;break}n="*"==i}return r("comment","comment")}function l(e,t){for(var i,n=!1;null!=(i=e.next());){if(!n&&("`"==i||"$"==i&&e.eat("{"))){t.tokenize=s;break}n=!n&&"\\"==i}return r("quasi","string-2",e.current())}function c(e,t){t.fatArrowAt&&(t.fatArrowAt=null);var i=e.string.indexOf("=>",e.start);if(!(i<0)){for(var n=0,r=!1,s=i-1;s>=0;--s){var a=e.string.charAt(s),o=De.indexOf(a);if(o>=0&&o<3){if(!n){++s;break}if(0==--n)break}else if(o>=3&&o<6)++n;else if(xe.test(a))r=!0;else if(r&&!n){++s;break}}r&&!n&&(t.fatArrowAt=s)}}function d(e,t,i,n,r,s){this.indented=e,this.column=t,this.type=i,this.prev=r,this.info=s,null!=n&&(this.align=n)}function h(e,t){for(var i=e.localVars;i;i=i.next)if(i.name==t)return!0;for(var n=e.context;n;n=n.prev)for(var i=n.vars;i;i=i.next)if(i.name==t)return!0}function u(e,t,i,n,r){var s=e.cc;for(je.state=e,je.stream=r,je.marked=null,je.cc=s,je.style=t,e.lexical.hasOwnProperty("align")||(e.lexical.align=!0);;){var a=s.length?s.pop():ye?w:x;if(a(i,n)){for(;s.length&&s[s.length-1].lex;)s.pop()();return je.marked?je.marked:"variable"==i&&h(e,n)?"variable-2":t}}}function f(){for(var e=arguments.length-1;e>=0;e--)je.cc.push(arguments[e])}function p(){return f.apply(null,arguments),!0}function m(e){function t(t){for(var i=t;i;i=i.next)if(i.name==e)return!0;return!1}var n=je.state;if(n.context){if(je.marked="def",t(n.localVars))return;n.localVars={name:e,next:n.localVars}}else{if(t(n.globalVars))return;i.globalVars&&(n.globalVars={name:e,next:n.globalVars})}}function g(){je.state.context={prev:je.state.context,vars:je.state.localVars},je.state.localVars=Te}function v(){je.state.localVars=je.state.context.vars,je.state.context=je.state.context.prev}function _(e,t){var i=function(){var i=je.state,n=i.indented;if("stat"==i.lexical.type)n=i.lexical.indented;else for(var r=i.lexical;r&&")"==r.type&&r.align;r=r.prev)n=r.indented;i.lexical=new d(n,je.stream.column(),e,null,i.lexical,t)};return i.lex=!0,i}function y(){var e=je.state;e.lexical.prev&&(")"==e.lexical.type&&(e.indented=e.lexical.indented),e.lexical=e.lexical.prev)}function b(e){function t(i){return i==e?p():";"==e?f():p(t)}return t}function x(e,t){return"var"==e?p(_("vardef",t.length),Y,b(";"),y):"keyword a"==e?p(_("form"),w,x,y):"keyword b"==e?p(_("form"),x,y):"{"==e?p(_("}"),R,y):";"==e?p():"if"==e?("else"==je.state.lexical.info&&je.state.cc[je.state.cc.length-1]==y&&je.state.cc.pop()(),p(_("form"),w,x,y,V)):"function"==e?p(ee):"for"==e?p(_("form"),G,x,y):"variable"==e?p(_("stat"),A):"switch"==e?p(_("form"),w,_("}","switch"),b("{"),R,y,y):"case"==e?p(w,b(":")):"default"==e?p(b(":")):"catch"==e?p(_("form"),g,b("("),te,b(")"),x,y,v):"module"==e?p(_("form"),g,ae,v,y):"class"==e?p(_("form"),ie,y):"export"==e?p(_("form"),oe,y):"import"==e?p(_("form"),le,y):f(_("stat"),w,b(";"),y)}function w(e){return C(e,!1)}function k(e){return C(e,!0)}function C(e,t){if(je.state.fatArrowAt==je.stream.start){var i=t?O:E;if("("==e)return p(g,_(")"),H(B,")"),y,b("=>"),i,v);if("variable"==e)return f(g,B,b("=>"),i,v)}var n=t?T:j;return Se.hasOwnProperty(e)?p(n):"function"==e?p(ee,n):"keyword c"==e?p(t?S:D):"("==e?p(_(")"),D,fe,b(")"),y,n):"operator"==e||"spread"==e?p(t?k:w):"["==e?p(_("]"),he,y,n):"{"==e?$(F,"}",null,n):"quasi"==e?f(M,n):p()}function D(e){return e.match(/[;\}\)\],]/)?f():f(w)}function S(e){return e.match(/[;\}\)\],]/)?f():f(k)}function j(e,t){return","==e?p(w):T(e,t,!1)}function T(e,t,i){var n=0==i?j:T,r=0==i?w:k;return"=>"==e?p(g,i?O:E,v):"operator"==e?/\+\+|--/.test(t)?p(n):"?"==t?p(w,b(":"),r):p(r):"quasi"==e?f(M,n):";"!=e?"("==e?$(k,")","call",n):"."==e?p(N,n):"["==e?p(_("]"),D,b("]"),y,n):void 0:void 0}function M(e,t){return"quasi"!=e?f():"${"!=t.slice(t.length-2)?p(M):p(w,L)}function L(e){if("}"==e)return je.marked="string-2",je.state.tokenize=l,p(M)}function E(e){return c(je.stream,je.state),f("{"==e?x:w)}function O(e){return c(je.stream,je.state),f("{"==e?x:k)}function A(e){return":"==e?p(y,x):f(j,b(";"),y)}function N(e){if("variable"==e)return je.marked="property",p()}function F(e,t){return"variable"==e||"keyword"==je.style?(je.marked="property",p("get"==t||"set"==t?P:I)):"number"==e||"string"==e?(je.marked=_e?"property":je.style+" property",p(I)):"jsonld-keyword"==e?p(I):"["==e?p(w,b("]"),I):void 0}function P(e){return"variable"!=e?f(I):(je.marked="property",p(ee))}function I(e){return":"==e?p(k):"("==e?f(ee):void 0}function H(e,t){function i(n){if(","==n){var r=je.state.lexical;return"call"==r.info&&(r.pos=(r.pos||0)+1),p(e,i)}return n==t?p():p(b(t))}return function(n){return n==t?p():f(e,i)}}function $(e,t,i){for(var n=3;n<arguments.length;n++)je.cc.push(arguments[n]);return p(_(t,i),H(e,t),y)}function R(e){return"}"==e?p():f(x,R)}function z(e){if(be&&":"==e)return p(W)}function W(e){if("variable"==e)return je.marked="variable-3",p()}function Y(){return f(B,z,q,X)}function B(e,t){return"variable"==e?(m(t),p()):"["==e?$(B,"]"):"{"==e?$(U,"}"):void 0}function U(e,t){return"variable"!=e||je.stream.match(/^\s*:/,!1)?("variable"==e&&(je.marked="property"),p(b(":"),B,q)):(m(t),p(q))}function q(e,t){if("="==t)return p(k)}function X(e){if(","==e)return p(Y)}function V(e,t){if("keyword b"==e&&"else"==t)return p(_("form","else"),x,y)}function G(e){if("("==e)return p(_(")"),K,b(")"),y)}function K(e){return"var"==e?p(Y,b(";"),Q):";"==e?p(Q):"variable"==e?p(J):f(w,b(";"),Q)}function J(e,t){return"in"==t||"of"==t?(je.marked="keyword",p(w)):p(j,Q)}function Q(e,t){return";"==e?p(Z):"in"==t||"of"==t?(je.marked="keyword",p(w)):f(w,b(";"),Z)}function Z(e){")"!=e&&p(w)}function ee(e,t){return"*"==t?(je.marked="keyword",p(ee)):"variable"==e?(m(t),p(ee)):"("==e?p(g,_(")"),H(te,")"),y,x,v):void 0}function te(e){return"spread"==e?p(te):f(B,z)}function ie(e,t){if("variable"==e)return m(t),p(ne)}function ne(e,t){return"extends"==t?p(w,ne):"{"==e?p(_("}"),re,y):void 0}function re(e,t){return"variable"==e||"keyword"==je.style?(je.marked="property","get"==t||"set"==t?p(se,ee,re):p(ee,re)):"*"==t?(je.marked="keyword",p(re)):";"==e?p(re):"}"==e?p():void 0}function se(e){return"variable"!=e?f():(je.marked="property",p())}function ae(e,t){return"string"==e?p(x):"variable"==e?(m(t),p(de)):void 0}function oe(e,t){return"*"==t?(je.marked="keyword",p(de,b(";"))):"default"==t?(je.marked="keyword",p(w,b(";"))):f(x)}function le(e){return"string"==e?p():f(ce,de)}function ce(e,t){return"{"==e?$(ce,"}"):("variable"==e&&m(t),p())}function de(e,t){if("from"==t)return je.marked="keyword",p(w)}function he(e){return"]"==e?p():f(k,ue)}function ue(e){return"for"==e?f(fe,b("]")):","==e?p(H(S,"]")):f(H(k,"]"))}function fe(e){return"for"==e?p(G,fe):"if"==e?p(w,fe):void 0}var pe,me,ge=t.indentUnit,ve=i.statementIndent,_e=i.jsonld,ye=i.json||_e,be=i.typescript,xe=i.wordCharacters||/[\w$\xa1-\uffff]/,we=function(){function e(e){return{type:e,style:"keyword"}}var t=e("keyword a"),i=e("keyword b"),n=e("keyword c"),r=e("operator"),s={type:"atom",style:"atom"},a={"if":e("if"),"while":t,"with":t,"else":i,"do":i,"try":i,"finally":i,"return":n,"break":n,"continue":n,"new":n,"delete":n,"throw":n,"debugger":n,"var":e("var"),"const":e("var"),"let":e("var"),"function":e("function"),"catch":e("catch"),"for":e("for"),"switch":e("switch"),"case":e("case"),"default":e("default"),"in":r,"typeof":r,"instanceof":r,"true":s,"false":s,"null":s,undefined:s,NaN:s,Infinity:s,"this":e("this"),module:e("module"),"class":e("class"),"super":e("atom"),"yield":n,"export":e("export"),"import":e("import"),"extends":n};if(be){var o={type:"variable",style:"variable-3"},l={"interface":e("interface"),"extends":e("extends"),constructor:e("constructor"),"public":e("public"),"private":e("private"),"protected":e("protected"),"static":e("static"),string:o,number:o,bool:o,any:o};for(var c in l)a[c]=l[c]}return a}(),ke=/[+\-*&%=<>!?|~^]/,Ce=/^@(context|id|value|language|type|container|list|set|reverse|index|base|vocab|graph)"/,De="([{}])",Se={atom:!0,number:!0,variable:!0,string:!0,regexp:!0,"this":!0,"jsonld-keyword":!0},je={state:null,column:null,marked:null,cc:null},Te={name:"this",next:{name:"arguments"}};return y.lex=!0,{startState:function(e){var t={tokenize:s,lastType:"sof",cc:[],lexical:new d((e||0)-ge,0,"block",(!1)),localVars:i.localVars,context:i.localVars&&{vars:i.localVars},indented:0};return i.globalVars&&"object"==typeof i.globalVars&&(t.globalVars=i.globalVars),t},token:function(e,t){if(e.sol()&&(t.lexical.hasOwnProperty("align")||(t.lexical.align=!1),t.indented=e.indentation(),c(e,t)),t.tokenize!=o&&e.eatSpace())return null;var i=t.tokenize(e,t);return"comment"==pe?i:(t.lastType="operator"!=pe||"++"!=me&&"--"!=me?pe:"incdec",u(t,i,pe,me,e))},indent:function(t,n){if(t.tokenize==o)return e.Pass;if(t.tokenize!=s)return 0;var r=n&&n.charAt(0),a=t.lexical;if(!/^\s*else\b/.test(n))for(var l=t.cc.length-1;l>=0;--l){var c=t.cc[l];if(c==y)a=a.prev;else if(c!=V)break}"stat"==a.type&&"}"==r&&(a=a.prev),ve&&")"==a.type&&"stat"==a.prev.type&&(a=a.prev);var d=a.type,h=r==d;return"vardef"==d?a.indented+("operator"==t.lastType||","==t.lastType?a.info+1:0):"form"==d&&"{"==r?a.indented:"form"==d?a.indented+ge:"stat"==d?a.indented+("operator"==t.lastType||","==t.lastType?ve||ge:0):"switch"!=a.info||h||0==i.doubleIndentSwitch?a.align?a.column+(h?0:1):a.indented+(h?0:ge):a.indented+(/^(?:case|default)\b/.test(n)?ge:2*ge)},electricInput:/^\s*(?:case .*?:|default:|\{|\})$/,blockCommentStart:ye?null:"/*",blockCommentEnd:ye?null:"*/",lineComment:ye?null:"//",fold:"brace",helperType:ye?"json":"javascript",jsonldMode:_e,jsonMode:ye}}),e.registerHelper("wordChars","javascript",/[\w$]/),e.defineMIME("text/javascript","javascript"),e.defineMIME("text/ecmascript","javascript"),e.defineMIME("application/javascript","javascript"),e.defineMIME("application/x-javascript","javascript"),e.defineMIME("application/ecmascript","javascript"),e.defineMIME("application/json",{name:"javascript",json:!0}),e.defineMIME("application/x-json",{name:"javascript",json:!0}),e.defineMIME("application/ld+json",{name:"javascript",jsonld:!0}),e.defineMIME("text/typescript",{name:"javascript",typescript:!0}),e.defineMIME("application/typescript",{name:"javascript",typescript:!0})}),function(e){"use strict";var t={i18n:{ar:{months:["كانون الثاني","شباط","آذار","نيسان","مايو","حزيران","تموز","آب","أيلول","تشرين الأول","تشرين الثاني","كانون الأول"],dayOfWeek:["ن","ث","ع","خ","ج","س","ح"]},ro:{months:["ianuarie","februarie","martie","aprilie","mai","iunie","iulie","august","septembrie","octombrie","noiembrie","decembrie"],dayOfWeek:["l","ma","mi","j","v","s","d"]},id:{months:["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],dayOfWeek:["Sen","Sel","Rab","Kam","Jum","Sab","Min"]},bg:{months:["Януари","Февруари","Март","Април","Май","Юни","Юли","Август","Септември","Октомври","Ноември","Декември"],dayOfWeek:["Нд","Пн","Вт","Ср","Чт","Пт","Сб"]},fa:{months:["فروردین","اردیبهشت","خرداد","تیر","مرداد","شهریور","مهر","آبان","آذر","دی","بهمن","اسفند"],dayOfWeek:["یکشنبه","دوشنبه","سه شنبه","چهارشنبه","پنجشنبه","جمعه","شنبه"]},ru:{months:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],dayOfWeek:["Вск","Пн","Вт","Ср","Чт","Пт","Сб"]},uk:{months:["Січень","Лютий","Березень","Квітень","Травень","Червень","Липень","Серпень","Вересень","Жовтень","Листопад","Грудень"],dayOfWeek:["Ндл","Пнд","Втр","Срд","Чтв","Птн","Сбт"]},en:{months:["January","February","March","April","May","June","July","August","September","October","November","December"],dayOfWeek:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},el:{months:["Ιανουάριος","Φεβρουάριος","Μάρτιος","Απρίλιος","Μάιος","Ιούνιος","Ιούλιος","Αύγουστος","Σεπτέμβριος","Οκτώβριος","Νοέμβριος","Δεκέμβριος"],dayOfWeek:["Κυρ","Δευ","Τρι","Τετ","Πεμ","Παρ","Σαβ"]},de:{months:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],dayOfWeek:["So","Mo","Di","Mi","Do","Fr","Sa"]},nl:{months:["januari","februari","maart","april","mei","juni","juli","augustus","september","oktober","november","december"],dayOfWeek:["zo","ma","di","wo","do","vr","za"]},tr:{months:["Ocak","Şubat","Mart","Nisan","Mayıs","Haziran","Temmuz","Ağustos","Eylül","Ekim","Kasım","Aralık"],dayOfWeek:["Paz","Pts","Sal","Çar","Per","Cum","Cts"]},fr:{months:["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"],dayOfWeek:["Dim","Lun","Mar","Mer","Jeu","Ven","Sam"]},es:{months:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],dayOfWeek:["Dom","Lun","Mar","Mié","Jue","Vie","Sáb"]},th:{months:["มกราคม","กุมภาพันธ์","มีนาคม","เมษายน","พฤษภาคม","มิถุนายน","กรกฎาคม","สิงหาคม","กันยายน","ตุลาคม","พฤศจิกายน","ธันวาคม"],dayOfWeek:["อา.","จ.","อ.","พ.","พฤ.","ศ.","ส."]},pl:{months:["styczeń","luty","marzec","kwiecień","maj","czerwiec","lipiec","sierpień","wrzesień","październik","listopad","grudzień"],dayOfWeek:["nd","pn","wt","śr","cz","pt","sb"]},pt:{months:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],dayOfWeek:["Dom","Seg","Ter","Qua","Qui","Sex","Sab"]},ch:{months:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],dayOfWeek:["日","一","二","三","四","五","六"]},se:{months:["Januari","Februari","Mars","April","Maj","Juni","Juli","Augusti","September","Oktober","November","December"],dayOfWeek:["Sön","Mån","Tis","Ons","Tor","Fre","Lör"]},kr:{months:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],dayOfWeek:["일","월","화","수","목","금","토"]},it:{months:["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"],dayOfWeek:["Dom","Lun","Mar","Mer","Gio","Ven","Sab"]},da:{months:["January","Februar","Marts","April","Maj","Juni","July","August","September","Oktober","November","December"],dayOfWeek:["Søn","Man","Tir","Ons","Tor","Fre","Lør"]},no:{months:["Januar","Februar","Mars","April","Mai","Juni","Juli","August","September","Oktober","November","Desember"],dayOfWeek:["Søn","Man","Tir","Ons","Tor","Fre","Lør"]},ja:{months:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],dayOfWeek:["日","月","火","水","木","金","土"]},vi:{months:["Tháng 1","Tháng 2","Tháng 3","Tháng 4","Tháng 5","Tháng 6","Tháng 7","Tháng 8","Tháng 9","Tháng 10","Tháng 11","Tháng 12"],dayOfWeek:["CN","T2","T3","T4","T5","T6","T7"]},sl:{months:["Januar","Februar","Marec","April","Maj","Junij","Julij","Avgust","September","Oktober","November","December"],dayOfWeek:["Ned","Pon","Tor","Sre","Čet","Pet","Sob"]},cs:{months:["Leden","Únor","Březen","Duben","Květen","Červen","Červenec","Srpen","Září","Říjen","Listopad","Prosinec"],dayOfWeek:["Ne","Po","Út","St","Čt","Pá","So"]},hu:{months:["Január","Február","Március","Április","Május","Június","Július","Augusztus","Szeptember","Október","November","December"],dayOfWeek:["Va","Hé","Ke","Sze","Cs","Pé","Szo"]},az:{months:["Yanvar","Fevral","Mart","Aprel","May","Iyun","Iyul","Avqust","Sentyabr","Oktyabr","Noyabr","Dekabr"],
dayOfWeek:["B","Be","Ça","Ç","Ca","C","Ş"]},bs:{months:["Januar","Februar","Mart","April","Maj","Jun","Jul","Avgust","Septembar","Oktobar","Novembar","Decembar"],dayOfWeek:["Ned","Pon","Uto","Sri","Čet","Pet","Sub"]},ca:{months:["Gener","Febrer","Març","Abril","Maig","Juny","Juliol","Agost","Setembre","Octubre","Novembre","Desembre"],dayOfWeek:["Dg","Dl","Dt","Dc","Dj","Dv","Ds"]},"en-GB":{months:["January","February","March","April","May","June","July","August","September","October","November","December"],dayOfWeek:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},et:{months:["Jaanuar","Veebruar","Märts","Aprill","Mai","Juuni","Juuli","August","September","Oktoober","November","Detsember"],dayOfWeek:["P","E","T","K","N","R","L"]},eu:{months:["Urtarrila","Otsaila","Martxoa","Apirila","Maiatza","Ekaina","Uztaila","Abuztua","Iraila","Urria","Azaroa","Abendua"],dayOfWeek:["Ig.","Al.","Ar.","Az.","Og.","Or.","La."]},fi:{months:["Tammikuu","Helmikuu","Maaliskuu","Huhtikuu","Toukokuu","Kesäkuu","Heinäkuu","Elokuu","Syyskuu","Lokakuu","Marraskuu","Joulukuu"],dayOfWeek:["Su","Ma","Ti","Ke","To","Pe","La"]},gl:{months:["Xan","Feb","Maz","Abr","Mai","Xun","Xul","Ago","Set","Out","Nov","Dec"],dayOfWeek:["Dom","Lun","Mar","Mer","Xov","Ven","Sab"]},hr:{months:["Siječanj","Veljača","Ožujak","Travanj","Svibanj","Lipanj","Srpanj","Kolovoz","Rujan","Listopad","Studeni","Prosinac"],dayOfWeek:["Ned","Pon","Uto","Sri","Čet","Pet","Sub"]},ko:{months:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],dayOfWeek:["일","월","화","수","목","금","토"]},lt:{months:["Sausio","Vasario","Kovo","Balandžio","Gegužės","Birželio","Liepos","Rugpjūčio","Rugsėjo","Spalio","Lapkričio","Gruodžio"],dayOfWeek:["Sek","Pir","Ant","Tre","Ket","Pen","Šeš"]},lv:{months:["Janvāris","Februāris","Marts","Aprīlis ","Maijs","Jūnijs","Jūlijs","Augusts","Septembris","Oktobris","Novembris","Decembris"],dayOfWeek:["Sv","Pr","Ot","Tr","Ct","Pk","St"]},mk:{months:["јануари","февруари","март","април","мај","јуни","јули","август","септември","октомври","ноември","декември"],dayOfWeek:["нед","пон","вто","сре","чет","пет","саб"]},mn:{months:["1-р сар","2-р сар","3-р сар","4-р сар","5-р сар","6-р сар","7-р сар","8-р сар","9-р сар","10-р сар","11-р сар","12-р сар"],dayOfWeek:["Дав","Мяг","Лха","Пүр","Бсн","Бям","Ням"]},"pt-BR":{months:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],dayOfWeek:["Dom","Seg","Ter","Qua","Qui","Sex","Sáb"]},sk:{months:["Január","Február","Marec","Apríl","Máj","Jún","Júl","August","September","Október","November","December"],dayOfWeek:["Ne","Po","Ut","St","Št","Pi","So"]},sq:{months:["January","February","March","April","May","June","July","August","September","October","November","December"],dayOfWeek:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},"sr-YU":{months:["Januar","Februar","Mart","April","Maj","Jun","Jul","Avgust","Septembar","Oktobar","Novembar","Decembar"],dayOfWeek:["Ned","Pon","Uto","Sre","čet","Pet","Sub"]},sr:{months:["јануар","фебруар","март","април","мај","јун","јул","август","септембар","октобар","новембар","децембар"],dayOfWeek:["нед","пон","уто","сре","чет","пет","суб"]},sv:{months:["Januari","Februari","Mars","April","Maj","Juni","Juli","Augusti","September","Oktober","November","December"],dayOfWeek:["Sön","Mån","Tis","Ons","Tor","Fre","Lör"]},"zh-TW":{months:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],dayOfWeek:["日","一","二","三","四","五","六"]},zh:{months:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],dayOfWeek:["日","一","二","三","四","五","六"]},he:{months:["ינואר","פברואר","מרץ","אפריל","מאי","יוני","יולי","אוגוסט","ספטמבר","אוקטובר","נובמבר","דצמבר"],dayOfWeek:["א'","ב'","ג'","ד'","ה'","ו'","שבת"]}},value:"",lang:"en",format:"Y/m/d H:i",formatTime:"H:i",formatDate:"Y/m/d",startDate:!1,step:60,monthChangeSpinner:!0,closeOnDateSelect:!1,closeOnWithoutClick:!0,closeOnInputClick:!0,timepicker:!0,datepicker:!0,weeks:!1,defaultTime:!1,defaultDate:!1,minDate:!1,maxDate:!1,minTime:!1,maxTime:!1,allowTimes:[],opened:!1,initTime:!0,inline:!1,theme:"",onSelectDate:function(){},onSelectTime:function(){},onChangeMonth:function(){},onChangeYear:function(){},onChangeDateTime:function(){},onShow:function(){},onClose:function(){},onGenerate:function(){},withoutCopyright:!0,inverseButton:!1,hours12:!1,next:"xdsoft_next",prev:"xdsoft_prev",dayOfWeekStart:0,parentID:"body",timeHeightInTimePicker:25,timepickerScrollbar:!0,todayButton:!0,defaultSelect:!0,scrollMonth:!0,scrollTime:!0,scrollInput:!0,lazyInit:!1,mask:!1,validateOnBlur:!0,allowBlank:!0,yearStart:1950,yearEnd:2050,style:"",id:"",fixed:!1,roundTime:"round",className:"",weekends:[],disabledDates:[],yearOffset:0,beforeShowDay:null,enterLikeTab:!0};Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){var i,n;for(i=t||0,n=this.length;i<n;i+=1)if(this[i]===e)return i;return-1}),Date.prototype.countDaysInMonth=function(){return new Date(this.getFullYear(),this.getMonth()+1,0).getDate()},e.fn.xdsoftScroller=function(t){return this.each(function(){var i,n,r,s,a,o=e(this),l=function(e){var t,i={x:0,y:0};return"touchstart"===e.type||"touchmove"===e.type||"touchend"===e.type||"touchcancel"===e.type?(t=e.originalEvent.touches[0]||e.originalEvent.changedTouches[0],i.x=t.clientX,i.y=t.clientY):"mousedown"!==e.type&&"mouseup"!==e.type&&"mousemove"!==e.type&&"mouseover"!==e.type&&"mouseout"!==e.type&&"mouseenter"!==e.type&&"mouseleave"!==e.type||(i.x=e.clientX,i.y=e.clientY),i},c=100,d=!1,h=0,u=0,f=0,p=!1,m=0,g=function(){};return"hide"===t?void o.find(".xdsoft_scrollbar").hide():(e(this).hasClass("xdsoft_scroller_box")||(i=o.children().eq(0),n=o[0].clientHeight,r=i[0].offsetHeight,s=e('<div class="xdsoft_scrollbar"></div>'),a=e('<div class="xdsoft_scroller"></div>'),s.append(a),o.addClass("xdsoft_scroller_box").append(s),g=function(e){var t=l(e).y-h+m;t<0&&(t=0),t+a[0].offsetHeight>f&&(t=f-a[0].offsetHeight),o.trigger("scroll_element.xdsoft_scroller",[c?t/c:0])},a.on("touchstart.xdsoft_scroller mousedown.xdsoft_scroller",function(i){n||o.trigger("resize_scroll.xdsoft_scroller",[t]),h=l(i).y,m=parseInt(a.css("margin-top"),10),f=s[0].offsetHeight,"mousedown"===i.type?(document&&e(document.body).addClass("xdsoft_noselect"),e([document.body,window]).on("mouseup.xdsoft_scroller",function r(){e([document.body,window]).off("mouseup.xdsoft_scroller",r).off("mousemove.xdsoft_scroller",g).removeClass("xdsoft_noselect")}),e(document.body).on("mousemove.xdsoft_scroller",g)):(p=!0,i.stopPropagation(),i.preventDefault())}).on("touchmove",function(e){p&&(e.preventDefault(),g(e))}).on("touchend touchcancel",function(e){p=!1,m=0}),o.on("scroll_element.xdsoft_scroller",function(e,t){n||o.trigger("resize_scroll.xdsoft_scroller",[t,!0]),t=t>1?1:t<0||isNaN(t)?0:t,a.css("margin-top",c*t),setTimeout(function(){i.css("marginTop",-parseInt((i[0].offsetHeight-n)*t,10))},10)}).on("resize_scroll.xdsoft_scroller",function(e,t,l){var d,h;n=o[0].clientHeight,r=i[0].offsetHeight,d=n/r,h=d*s[0].offsetHeight,d>1?a.hide():(a.show(),a.css("height",parseInt(h>10?h:10,10)),c=s[0].offsetHeight-a[0].offsetHeight,l!==!0&&o.trigger("scroll_element.xdsoft_scroller",[t||Math.abs(parseInt(i.css("marginTop"),10))/(r-n)]))}),o.on("mousewheel",function(e){var t=Math.abs(parseInt(i.css("marginTop"),10));return t-=20*e.deltaY,t<0&&(t=0),o.trigger("scroll_element.xdsoft_scroller",[t/(r-n)]),e.stopPropagation(),!1}),o.on("touchstart",function(e){d=l(e),u=Math.abs(parseInt(i.css("marginTop"),10))}),o.on("touchmove",function(e){if(d){e.preventDefault();var t=l(e);o.trigger("scroll_element.xdsoft_scroller",[(u-(t.y-d.y))/(r-n)])}}),o.on("touchend touchcancel",function(e){d=!1,u=0})),void o.trigger("resize_scroll.xdsoft_scroller",[t]))})},e.fn.datetimepicker=function(i){var n,r,s,a=48,o=57,l=96,c=105,d=17,h=46,u=13,f=27,p=8,m=37,g=38,v=39,_=40,y=9,b=116,x=65,w=67,k=86,C=90,D=89,S=!1,j=e.isPlainObject(i)||!i?e.extend(!0,{},t,i):e.extend(!0,{},t),T=0,M=function(e){e.on("open.xdsoft focusin.xdsoft mousedown.xdsoft",function t(i){e.is(":disabled")||e.is(":hidden")||!e.is(":visible")||e.data("xdsoft_datetimepicker")||(clearTimeout(T),T=setTimeout(function(){e.data("xdsoft_datetimepicker")||n(e),e.off("open.xdsoft focusin.xdsoft mousedown.xdsoft",t).trigger("open.xdsoft")},100))})};return n=function(t){function n(){var e,i=!1;return j.startDate?i=s.strToDate(j.startDate):(i=j.value||(t&&t.val&&t.val()?t.val():""),i?i=s.strToDateTime(i):j.defaultDate&&(i=s.strToDate(j.defaultDate),j.defaultTime&&(e=s.strtotime(j.defaultTime),i.setHours(e.getHours()),i.setMinutes(e.getMinutes())))),i&&s.isValidDate(i)?O.data("changed",!0):i="",i||0}var r,T,M,L,E,O=e("<div "+(j.id?'id="'+j.id+'"':"")+" "+(j.style?'style="'+j.style+'"':"")+' class="xdsoft_datetimepicker xdsoft_'+j.theme+" xdsoft_noselect "+(j.weeks?" xdsoft_showweeks":"")+j.className+'"></div>'),A=e('<div class="xdsoft_copyright"><a target="_blank" href="http://xdsoft.net/jqplugins/datetimepicker/">xdsoft.net</a></div>'),N=e('<div class="xdsoft_datepicker active"></div>'),F=e('<div class="xdsoft_mounthpicker"><button type="button" class="xdsoft_prev"></button><button type="button" class="xdsoft_today_button"></button><div class="xdsoft_label xdsoft_month"><span></span><i></i></div><div class="xdsoft_label xdsoft_year"><span></span><i></i></div><button type="button" class="xdsoft_next"></button></div>'),P=e('<div class="xdsoft_calendar"></div>'),I=e('<div class="xdsoft_timepicker active"><button type="button" class="xdsoft_prev"></button><div class="xdsoft_time_box"></div><button type="button" class="xdsoft_next"></button></div>'),H=I.find(".xdsoft_time_box").eq(0),$=e('<div class="xdsoft_time_variant"></div>'),R=e('<div class="xdsoft_select xdsoft_monthselect"><div></div></div>'),z=e('<div class="xdsoft_select xdsoft_yearselect"><div></div></div>'),W=!1,Y=0,B=0;F.find(".xdsoft_month span").after(R),F.find(".xdsoft_year span").after(z),F.find(".xdsoft_month,.xdsoft_year").on("mousedown.xdsoft",function(t){var i,n,r=e(this).find(".xdsoft_select").eq(0),a=0,o=0,l=r.is(":visible");for(F.find(".xdsoft_select").hide(),s.currentTime&&(a=s.currentTime[e(this).hasClass("xdsoft_month")?"getMonth":"getFullYear"]()),r[l?"hide":"show"](),i=r.find("div.xdsoft_option"),n=0;n<i.length&&i.eq(n).data("value")!==a;n+=1)o+=i[0].offsetHeight;return r.xdsoftScroller(o/(r.children()[0].offsetHeight-r[0].clientHeight)),t.stopPropagation(),!1}),F.find(".xdsoft_select").xdsoftScroller().on("mousedown.xdsoft",function(e){e.stopPropagation(),e.preventDefault()}).on("mousedown.xdsoft",".xdsoft_option",function(t){var i=s.currentTime.getFullYear();s&&s.currentTime&&s.currentTime[e(this).parent().parent().hasClass("xdsoft_monthselect")?"setMonth":"setFullYear"](e(this).data("value")),e(this).parent().parent().hide(),O.trigger("xchange.xdsoft"),j.onChangeMonth&&e.isFunction(j.onChangeMonth)&&j.onChangeMonth.call(O,s.currentTime,O.data("input")),i!==s.currentTime.getFullYear()&&e.isFunction(j.onChangeYear)&&j.onChangeYear.call(O,s.currentTime,O.data("input"))}),O.setOptions=function(i){if(j=e.extend(!0,{},j,i),i.allowTimes&&e.isArray(i.allowTimes)&&i.allowTimes.length&&(j.allowTimes=e.extend(!0,[],i.allowTimes)),i.weekends&&e.isArray(i.weekends)&&i.weekends.length&&(j.weekends=e.extend(!0,[],i.weekends)),i.disabledDates&&e.isArray(i.disabledDates)&&i.disabledDates.length&&(j.disabledDates=e.extend(!0,[],i.disabledDates)),!j.open&&!j.opened||j.inline||t.trigger("open.xdsoft"),j.inline&&(W=!0,O.addClass("xdsoft_inline"),t.after(O).hide()),j.inverseButton&&(j.next="xdsoft_prev",j.prev="xdsoft_next"),j.datepicker?N.addClass("active"):N.removeClass("active"),j.timepicker?I.addClass("active"):I.removeClass("active"),j.value&&(t&&t.val&&t.val(j.value),s.setCurrentTime(j.value)),isNaN(j.dayOfWeekStart)?j.dayOfWeekStart=0:j.dayOfWeekStart=parseInt(j.dayOfWeekStart,10)%7,j.timepickerScrollbar||H.xdsoftScroller("hide"),j.minDate&&/^-(.*)$/.test(j.minDate)&&(j.minDate=s.strToDateTime(j.minDate).dateFormat(j.formatDate)),j.maxDate&&/^\+(.*)$/.test(j.maxDate)&&(j.maxDate=s.strToDateTime(j.maxDate).dateFormat(j.formatDate)),F.find(".xdsoft_today_button").css("visibility",j.todayButton?"visible":"hidden"),j.mask){var n=function(e){try{if(document.selection&&document.selection.createRange){var t=document.selection.createRange();return t.getBookmark().charCodeAt(2)-2}if(e.setSelectionRange)return e.selectionStart}catch(i){return 0}},r=function(e,t){if(e="string"==typeof e||e instanceof String?document.getElementById(e):e,!e)return!1;if(e.createTextRange){var i=e.createTextRange();return i.collapse(!0),i.moveEnd("character",t),i.moveStart("character",t),i.select(),!0}return!!e.setSelectionRange&&(e.setSelectionRange(t,t),!0)},T=function(e,t){var i=e.replace(/([\[\]\/\{\}\(\)\-\.\+]{1})/g,"\\$1").replace(/_/g,"{digit+}").replace(/([0-9]{1})/g,"{digit$1}").replace(/\{digit([0-9]{1})\}/g,"[0-$1_]{1}").replace(/\{digit[\+]\}/g,"[0-9_]{1}");return new RegExp(i).test(t)};t.off("keydown.xdsoft"),j.mask===!0&&(j.mask=j.format.replace(/Y/g,"9999").replace(/F/g,"9999").replace(/m/g,"19").replace(/d/g,"39").replace(/H/g,"29").replace(/i/g,"59").replace(/s/g,"59")),"string"===e.type(j.mask)&&(T(j.mask,t.val())||t.val(j.mask.replace(/[0-9]/g,"_")),t.on("keydown.xdsoft",function(i){var s,M,L=this.value,E=i.which;if(E>=a&&E<=o||E>=l&&E<=c||E===p||E===h){for(s=n(this),M=E!==p&&E!==h?String.fromCharCode(l<=E&&E<=c?E-a:E):"_",E!==p&&E!==h||!s||(s-=1,M="_");/[^0-9_]/.test(j.mask.substr(s,1))&&s<j.mask.length&&s>0;)s+=E===p||E===h?-1:1;if(L=L.substr(0,s)+M+L.substr(s+1),""===e.trim(L))L=j.mask.replace(/[0-9]/g,"_");else if(s===j.mask.length)return i.preventDefault(),!1;for(s+=E===p||E===h?0:1;/[^0-9_]/.test(j.mask.substr(s,1))&&s<j.mask.length&&s>0;)s+=E===p||E===h?-1:1;T(j.mask,L)?(this.value=L,r(this,s)):""===e.trim(L)?this.value=j.mask.replace(/[0-9]/g,"_"):t.trigger("error_input.xdsoft")}else if([x,w,k,C,D].indexOf(E)!==-1&&S||[f,g,_,m,v,b,d,y,u].indexOf(E)!==-1)return!0;return i.preventDefault(),!1}))}j.validateOnBlur&&t.off("blur.xdsoft").on("blur.xdsoft",function(){j.allowBlank&&!e.trim(e(this).val()).length?(e(this).val(null),O.data("xdsoft_datetime").empty()):Date.parseDate(e(this).val(),j.format)?O.data("xdsoft_datetime").setCurrentTime(e(this).val()):(e(this).val(s.now().dateFormat(j.format)),O.data("xdsoft_datetime").setCurrentTime(e(this).val())),O.trigger("changedatetime.xdsoft")}),j.dayOfWeekStartPrev=0===j.dayOfWeekStart?6:j.dayOfWeekStart-1,O.trigger("xchange.xdsoft").trigger("afterOpen.xdsoft")},O.data("options",j).on("mousedown.xdsoft",function(e){return e.stopPropagation(),e.preventDefault(),z.hide(),R.hide(),!1}),H.append($),H.xdsoftScroller(),O.on("afterOpen.xdsoft",function(){H.xdsoftScroller()}),O.append(N).append(I),j.withoutCopyright!==!0&&O.append(A),N.append(F).append(P),e(j.parentID).append(O),r=function(){var t=this;t.now=function(e){var i,n,r=new Date;return!e&&j.defaultDate&&(i=t.strToDate(j.defaultDate),r.setFullYear(i.getFullYear()),r.setMonth(i.getMonth()),r.setDate(i.getDate())),j.yearOffset&&r.setFullYear(r.getFullYear()+j.yearOffset),!e&&j.defaultTime&&(n=t.strtotime(j.defaultTime),r.setHours(n.getHours()),r.setMinutes(n.getMinutes())),r},t.isValidDate=function(e){return"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e.getTime())},t.setCurrentTime=function(e){t.currentTime="string"==typeof e?t.strToDateTime(e):t.isValidDate(e)?e:t.now(),O.trigger("xchange.xdsoft")},t.empty=function(){t.currentTime=null},t.getCurrentTime=function(e){return t.currentTime},t.nextMonth=function(){var i,n=t.currentTime.getMonth()+1;return 12===n&&(t.currentTime.setFullYear(t.currentTime.getFullYear()+1),n=0),i=t.currentTime.getFullYear(),t.currentTime.setDate(Math.min(new Date(t.currentTime.getFullYear(),n+1,0).getDate(),t.currentTime.getDate())),t.currentTime.setMonth(n),j.onChangeMonth&&e.isFunction(j.onChangeMonth)&&j.onChangeMonth.call(O,s.currentTime,O.data("input")),i!==t.currentTime.getFullYear()&&e.isFunction(j.onChangeYear)&&j.onChangeYear.call(O,s.currentTime,O.data("input")),O.trigger("xchange.xdsoft"),n},t.prevMonth=function(){var i=t.currentTime.getMonth()-1;return i===-1&&(t.currentTime.setFullYear(t.currentTime.getFullYear()-1),i=11),t.currentTime.setDate(Math.min(new Date(t.currentTime.getFullYear(),i+1,0).getDate(),t.currentTime.getDate())),t.currentTime.setMonth(i),j.onChangeMonth&&e.isFunction(j.onChangeMonth)&&j.onChangeMonth.call(O,s.currentTime,O.data("input")),O.trigger("xchange.xdsoft"),i},t.getWeekOfYear=function(e){var t=new Date(e.getFullYear(),0,1);return Math.ceil(((e-t)/864e5+t.getDay()+1)/7)},t.strToDateTime=function(e){var i,n,r=[];return e&&e instanceof Date&&t.isValidDate(e)?e:(r=/^(\+|\-)(.*)$/.exec(e),r&&(r[2]=Date.parseDate(r[2],j.formatDate)),r&&r[2]?(i=r[2].getTime()-6e4*r[2].getTimezoneOffset(),n=new Date(s.now().getTime()+parseInt(r[1]+"1",10)*i)):n=e?Date.parseDate(e,j.format):t.now(),t.isValidDate(n)||(n=t.now()),n)},t.strToDate=function(e){if(e&&e instanceof Date&&t.isValidDate(e))return e;var i=e?Date.parseDate(e,j.formatDate):t.now(!0);return t.isValidDate(i)||(i=t.now(!0)),i},t.strtotime=function(e){if(e&&e instanceof Date&&t.isValidDate(e))return e;var i=e?Date.parseDate(e,j.formatTime):t.now(!0);return t.isValidDate(i)||(i=t.now(!0)),i},t.str=function(){return t.currentTime.dateFormat(j.format)},t.currentTime=this.now()},s=new r,F.find(".xdsoft_today_button").on("mousedown.xdsoft",function(){O.data("changed",!0),s.setCurrentTime(0),O.trigger("afterOpen.xdsoft")}).on("dblclick.xdsoft",function(){t.val(s.str()),O.trigger("close.xdsoft")}),F.find(".xdsoft_prev,.xdsoft_next").on("mousedown.xdsoft",function(){var t=e(this),i=0,n=!1;!function r(e){s.currentTime.getMonth();t.hasClass(j.next)?s.nextMonth():t.hasClass(j.prev)&&s.prevMonth(),j.monthChangeSpinner&&(n||(i=setTimeout(r,e||100)))}(500),e([document.body,window]).on("mouseup.xdsoft",function a(){clearTimeout(i),n=!0,e([document.body,window]).off("mouseup.xdsoft",a)})}),I.find(".xdsoft_prev,.xdsoft_next").on("mousedown.xdsoft",function(){var t=e(this),i=0,n=!1,r=110;!function s(e){var a=H[0].clientHeight,o=$[0].offsetHeight,l=Math.abs(parseInt($.css("marginTop"),10));t.hasClass(j.next)&&o-a-j.timeHeightInTimePicker>=l?$.css("marginTop","-"+(l+j.timeHeightInTimePicker)+"px"):t.hasClass(j.prev)&&l-j.timeHeightInTimePicker>=0&&$.css("marginTop","-"+(l-j.timeHeightInTimePicker)+"px"),H.trigger("scroll_element.xdsoft_scroller",[Math.abs(parseInt($.css("marginTop"),10)/(o-a))]),r=r>10?10:r-10,n||(i=setTimeout(s,e||r))}(500),e([document.body,window]).on("mouseup.xdsoft",function a(){clearTimeout(i),n=!0,e([document.body,window]).off("mouseup.xdsoft",a)})}),T=0,O.on("xchange.xdsoft",function(t){clearTimeout(T),T=setTimeout(function(){for(var t,n,r,a,o,l,c,d="",h=new Date(s.currentTime.getFullYear(),s.currentTime.getMonth(),1,12,0,0),u=0,f=s.now(),p=!1,m=!1,g=[],v=!0,_="",y="";h.getDay()!==j.dayOfWeekStart;)h.setDate(h.getDate()-1);for(d+="<table><thead><tr>",j.weeks&&(d+="<th></th>"),t=0;t<7;t+=1)d+="<th>"+j.i18n[j.lang].dayOfWeek[(t+j.dayOfWeekStart)%7]+"</th>";for(d+="</tr></thead>",d+="<tbody>",j.maxDate!==!1&&(p=s.strToDate(j.maxDate),p=new Date(p.getFullYear(),p.getMonth(),p.getDate(),23,59,59,999)),j.minDate!==!1&&(m=s.strToDate(j.minDate),m=new Date(m.getFullYear(),m.getMonth(),m.getDate()));u<s.currentTime.countDaysInMonth()||h.getDay()!==j.dayOfWeekStart||s.currentTime.getMonth()===h.getMonth();)g=[],u+=1,n=h.getDate(),r=h.getFullYear(),a=h.getMonth(),o=s.getWeekOfYear(h),g.push("xdsoft_date"),l=j.beforeShowDay&&e.isFunction(j.beforeShowDay.call)?j.beforeShowDay.call(O,h):null,p!==!1&&h>p||m!==!1&&h<m||l&&l[0]===!1?g.push("xdsoft_disabled"):j.disabledDates.indexOf(h.dateFormat(j.formatDate))!==-1&&g.push("xdsoft_disabled"),l&&""!==l[1]&&g.push(l[1]),s.currentTime.getMonth()!==a&&g.push("xdsoft_other_month"),(j.defaultSelect||O.data("changed"))&&s.currentTime.dateFormat(j.formatDate)===h.dateFormat(j.formatDate)&&g.push("xdsoft_current"),f.dateFormat(j.formatDate)===h.dateFormat(j.formatDate)&&g.push("xdsoft_today"),0!==h.getDay()&&6!==h.getDay()&&j.weekends.indexOf(h.dateFormat(j.formatDate))!==-1||g.push("xdsoft_weekend"),j.beforeShowDay&&e.isFunction(j.beforeShowDay)&&g.push(j.beforeShowDay(h)),v&&(d+="<tr>",v=!1,j.weeks&&(d+="<th>"+o+"</th>")),d+='<td data-date="'+n+'" data-month="'+a+'" data-year="'+r+'" class="xdsoft_date xdsoft_day_of_week'+h.getDay()+" "+g.join(" ")+'"><div>'+n+"</div></td>",h.getDay()===j.dayOfWeekStartPrev&&(d+="</tr>",v=!0),h.setDate(n+1);if(d+="</tbody></table>",P.html(d),F.find(".xdsoft_label span").eq(0).text(j.i18n[j.lang].months[s.currentTime.getMonth()]),F.find(".xdsoft_label span").eq(1).text(s.currentTime.getFullYear()),_="",y="",a="",c=function(e,t){var i=s.now();i.setHours(e),e=parseInt(i.getHours(),10),i.setMinutes(t),t=parseInt(i.getMinutes(),10),g=[],(j.maxTime!==!1&&s.strtotime(j.maxTime).getTime()<i.getTime()||j.minTime!==!1&&s.strtotime(j.minTime).getTime()>i.getTime())&&g.push("xdsoft_disabled"),(j.initTime||j.defaultSelect||O.data("changed"))&&parseInt(s.currentTime.getHours(),10)===parseInt(e,10)&&(j.step>59||Math[j.roundTime](s.currentTime.getMinutes()/j.step)*j.step===parseInt(t,10))&&(j.defaultSelect||O.data("changed")?g.push("xdsoft_current"):j.initTime&&g.push("xdsoft_init_time")),parseInt(f.getHours(),10)===parseInt(e,10)&&parseInt(f.getMinutes(),10)===parseInt(t,10)&&g.push("xdsoft_today"),_+='<div class="xdsoft_time '+g.join(" ")+'" data-hour="'+e+'" data-minute="'+t+'">'+i.dateFormat(j.formatTime)+"</div>"},j.allowTimes&&e.isArray(j.allowTimes)&&j.allowTimes.length)for(u=0;u<j.allowTimes.length;u+=1)y=s.strtotime(j.allowTimes[u]).getHours(),a=s.strtotime(j.allowTimes[u]).getMinutes(),c(y,a);else for(u=0,t=0;u<(j.hours12?12:24);u+=1)for(t=0;t<60;t+=j.step)y=(u<10?"0":"")+u,a=(t<10?"0":"")+t,c(y,a);for($.html(_),i="",u=0,u=parseInt(j.yearStart,10)+j.yearOffset;u<=parseInt(j.yearEnd,10)+j.yearOffset;u+=1)i+='<div class="xdsoft_option '+(s.currentTime.getFullYear()===u?"xdsoft_current":"")+'" data-value="'+u+'">'+u+"</div>";for(z.children().eq(0).html(i),u=0,i="";u<=11;u+=1)i+='<div class="xdsoft_option '+(s.currentTime.getMonth()===u?"xdsoft_current":"")+'" data-value="'+u+'">'+j.i18n[j.lang].months[u]+"</div>";R.children().eq(0).html(i),e(O).trigger("generate.xdsoft")},10),t.stopPropagation()}).on("afterOpen.xdsoft",function(){if(j.timepicker){var e,t,i,n;$.find(".xdsoft_current").length?e=".xdsoft_current":$.find(".xdsoft_init_time").length&&(e=".xdsoft_init_time"),e?(t=H[0].clientHeight,i=$[0].offsetHeight,n=$.find(e).index()*j.timeHeightInTimePicker+1,i-t<n&&(n=i-t),H.trigger("scroll_element.xdsoft_scroller",[parseInt(n,10)/(i-t)])):H.trigger("scroll_element.xdsoft_scroller",[0])}}),M=0,P.on("click.xdsoft","td",function(i){i.stopPropagation(),M+=1;var n=e(this),r=s.currentTime;return void 0!==r&&null!==r||(s.currentTime=s.now(),r=s.currentTime),!n.hasClass("xdsoft_disabled")&&(r.setDate(1),r.setFullYear(n.data("year")),r.setMonth(n.data("month")),r.setDate(n.data("date")),O.trigger("select.xdsoft",[r]),t.val(s.str()),(M>1||j.closeOnDateSelect===!0||0===j.closeOnDateSelect&&!j.timepicker)&&!j.inline&&O.trigger("close.xdsoft"),j.onSelectDate&&e.isFunction(j.onSelectDate)&&j.onSelectDate.call(O,s.currentTime,O.data("input"),i),O.data("changed",!0),O.trigger("xchange.xdsoft"),O.trigger("changedatetime.xdsoft"),void setTimeout(function(){M=0},200))}),$.on("click.xdsoft","div",function(t){t.stopPropagation();var i=e(this),n=s.currentTime;return void 0!==n&&null!==n||(s.currentTime=s.now(),n=s.currentTime),!i.hasClass("xdsoft_disabled")&&(n.setHours(i.data("hour")),n.setMinutes(i.data("minute")),O.trigger("select.xdsoft",[n]),O.data("input").val(s.str()),j.inline||O.trigger("close.xdsoft"),j.onSelectTime&&e.isFunction(j.onSelectTime)&&j.onSelectTime.call(O,s.currentTime,O.data("input"),t),O.data("changed",!0),O.trigger("xchange.xdsoft"),void O.trigger("changedatetime.xdsoft"))}),N.on("mousewheel.xdsoft",function(e){return!j.scrollMonth||(e.deltaY<0?s.nextMonth():s.prevMonth(),!1)}),t.on("mousewheel.xdsoft",function(e){return!j.scrollInput||(!j.datepicker&&j.timepicker?(L=$.find(".xdsoft_current").length?$.find(".xdsoft_current").eq(0).index():0,L+e.deltaY>=0&&L+e.deltaY<$.children().length&&(L+=e.deltaY),$.children().eq(L).length&&$.children().eq(L).trigger("mousedown"),!1):j.datepicker&&!j.timepicker?(N.trigger(e,[e.deltaY,e.deltaX,e.deltaY]),t.val&&t.val(s.str()),O.trigger("changedatetime.xdsoft"),!1):void 0)}),O.on("changedatetime.xdsoft",function(t){if(j.onChangeDateTime&&e.isFunction(j.onChangeDateTime)){var i=O.data("input");j.onChangeDateTime.call(O,s.currentTime,i,t),delete j.value,i.trigger("change")}}).on("generate.xdsoft",function(){j.onGenerate&&e.isFunction(j.onGenerate)&&j.onGenerate.call(O,s.currentTime,O.data("input")),W&&(O.trigger("afterOpen.xdsoft"),W=!1)}).on("click.xdsoft",function(e){e.stopPropagation()}),L=0,E=function(){var t=O.data("input").offset(),i=t.top+O.data("input")[0].offsetHeight-1,n=t.left,r="absolute";j.fixed?(i-=e(window).scrollTop(),n-=e(window).scrollLeft(),r="fixed"):(i+O[0].offsetHeight>e(window).height()+e(window).scrollTop()&&(i=t.top-O[0].offsetHeight+1),i<0&&(i=0),n+O[0].offsetWidth>e(window).width()&&(n=e(window).width()-O[0].offsetWidth)),O.css({left:n,top:i,position:r})},O.on("open.xdsoft",function(t){var i=!0;j.onShow&&e.isFunction(j.onShow)&&(i=j.onShow.call(O,s.currentTime,O.data("input"),t)),i!==!1&&(O.show(),E(),e(window).off("resize.xdsoft",E).on("resize.xdsoft",E),j.closeOnWithoutClick&&e([document.body,window]).on("mousedown.xdsoft",function n(){O.trigger("close.xdsoft"),e([document.body,window]).off("mousedown.xdsoft",n)}))}).on("close.xdsoft",function(t){var i=!0;F.find(".xdsoft_month,.xdsoft_year").find(".xdsoft_select").hide(),j.onClose&&e.isFunction(j.onClose)&&(i=j.onClose.call(O,s.currentTime,O.data("input"),t)),i===!1||j.opened||j.inline||O.hide(),t.stopPropagation()}).on("toggle.xdsoft",function(e){O.is(":visible")?O.trigger("close.xdsoft"):O.trigger("open.xdsoft")}).data("input",t),Y=0,B=0,O.data("xdsoft_datetime",s),O.setOptions(j),s.setCurrentTime(n()),t.data("xdsoft_datetimepicker",O).on("open.xdsoft focusin.xdsoft mousedown.xdsoft",function(e){t.is(":disabled")||t.is(":hidden")||!t.is(":visible")||t.data("xdsoft_datetimepicker").is(":visible")&&j.closeOnInputClick||(clearTimeout(Y),Y=setTimeout(function(){t.is(":disabled")||t.is(":hidden")||!t.is(":visible")||(W=!0,s.setCurrentTime(n()),O.trigger("open.xdsoft"))},100))}).on("keydown.xdsoft",function(t){var i,n=(this.value,t.which);return[u].indexOf(n)!==-1&&j.enterLikeTab?(i=e("input:visible,textarea:visible"),O.trigger("close.xdsoft"),i.eq(i.index(this)+1).focus(),!1):[y].indexOf(n)!==-1?(O.trigger("close.xdsoft"),!0):void 0})},r=function(t){var i=t.data("xdsoft_datetimepicker");i&&(i.data("xdsoft_datetime",null),i.remove(),t.data("xdsoft_datetimepicker",null).off(".xdsoft"),e(window).off("resize.xdsoft"),e([window,document.body]).off("mousedown.xdsoft"),t.unmousewheel&&t.unmousewheel())},e(document).off("keydown.xdsoftctrl keyup.xdsoftctrl").on("keydown.xdsoftctrl",function(e){e.keyCode===d&&(S=!0)}).on("keyup.xdsoftctrl",function(e){e.keyCode===d&&(S=!1)}),this.each(function(){var t=e(this).data("xdsoft_datetimepicker");if(t){if("string"===e.type(i))switch(i){case"show":e(this).select().focus(),t.trigger("open.xdsoft");break;case"hide":t.trigger("close.xdsoft");break;case"toggle":t.trigger("toggle.xdsoft");break;case"destroy":r(e(this));break;case"reset":this.value=this.defaultValue,this.value&&t.data("xdsoft_datetime").isValidDate(Date.parseDate(this.value,j.format))||t.data("changed",!1),t.data("xdsoft_datetime").setCurrentTime(this.value)}else t.setOptions(i);return 0}"string"!==e.type(i)&&(!j.lazyInit||j.open||j.inline?n(e(this)):M(e(this)))})},e.fn.datetimepicker.defaults=t}(jQuery),function(){!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e:e(jQuery)}(function(e){function t(t){var a=t||window.event,o=l.call(arguments,1),c=0,h=0,u=0,f=0,p=0,m=0;if(t=e.event.fix(a),t.type="mousewheel","detail"in a&&(u=-1*a.detail),"wheelDelta"in a&&(u=a.wheelDelta),"wheelDeltaY"in a&&(u=a.wheelDeltaY),"wheelDeltaX"in a&&(h=-1*a.wheelDeltaX),"axis"in a&&a.axis===a.HORIZONTAL_AXIS&&(h=-1*u,u=0),c=0===u?h:u,"deltaY"in a&&(u=-1*a.deltaY,c=u),"deltaX"in a&&(h=a.deltaX,0===u&&(c=-1*h)),0!==u||0!==h){if(1===a.deltaMode){var g=e.data(this,"mousewheel-line-height");c*=g,u*=g,h*=g}else if(2===a.deltaMode){var v=e.data(this,"mousewheel-page-height");c*=v,u*=v,h*=v}if(f=Math.max(Math.abs(u),Math.abs(h)),(!s||s>f)&&(s=f,n(a,f)&&(s/=40)),n(a,f)&&(c/=40,h/=40,u/=40),c=Math[c>=1?"floor":"ceil"](c/s),h=Math[h>=1?"floor":"ceil"](h/s),u=Math[u>=1?"floor":"ceil"](u/s),d.settings.normalizeOffset&&this.getBoundingClientRect){var _=this.getBoundingClientRect();p=t.clientX-_.left,m=t.clientY-_.top}return t.deltaX=h,t.deltaY=u,t.deltaFactor=s,t.offsetX=p,t.offsetY=m,t.deltaMode=0,o.unshift(t,c,h,u),r&&clearTimeout(r),r=setTimeout(i,200),(e.event.dispatch||e.event.handle).apply(this,o)}}function i(){s=null}function n(e,t){return d.settings.adjustOldDeltas&&"mousewheel"===e.type&&t%120===0}var r,s,a=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],o="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],l=Array.prototype.slice;if(e.event.fixHooks)for(var c=a.length;c;)e.event.fixHooks[a[--c]]=e.event.mouseHooks;var d=e.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var i=o.length;i;)this.addEventListener(o[--i],t,!1);else this.onmousewheel=t;e.data(this,"mousewheel-line-height",d.getLineHeight(this)),e.data(this,"mousewheel-page-height",d.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var i=o.length;i;)this.removeEventListener(o[--i],t,!1);else this.onmousewheel=null;e.removeData(this,"mousewheel-line-height"),e.removeData(this,"mousewheel-page-height")},getLineHeight:function(t){var i=e(t),n=i["offsetParent"in e.fn?"offsetParent":"parent"]();return n.length||(n=e("body")),parseInt(n.css("fontSize"),10)||parseInt(i.css("fontSize"),10)||16},getPageHeight:function(t){return e(t).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})}),Date.parseFunctions={count:0},Date.parseRegexes=[],Date.formatFunctions={count:0},Date.prototype.dateFormat=function(e){if("unixtime"==e)return parseInt(this.getTime()/1e3);null==Date.formatFunctions[e]&&Date.createNewFormat(e);var t=Date.formatFunctions[e];return this[t]()},Date.createNewFormat=function(format){var funcName="format"+Date.formatFunctions.count++;Date.formatFunctions[format]=funcName;for(var code="Date.prototype."+funcName+" = function() {return ",special=!1,ch="",i=0;i<format.length;++i)ch=format.charAt(i),special||"\\"!=ch?special?(special=!1,code+="'"+String.escape(ch)+"' + "):code+=Date.getFormatCode(ch):special=!0;eval(code.substring(0,code.length-3)+";}")},Date.getFormatCode=function(e){switch(e){case"d":return"String.leftPad(this.getDate(), 2, '0') + ";case"D":return"Date.dayNames[this.getDay()].substring(0, 3) + ";case"j":return"this.getDate() + ";case"l":return"Date.dayNames[this.getDay()] + ";case"S":return"this.getSuffix() + ";case"w":return"this.getDay() + ";case"z":return"this.getDayOfYear() + ";case"W":return"this.getWeekOfYear() + ";case"F":return"Date.monthNames[this.getMonth()] + ";case"m":return"String.leftPad(this.getMonth() + 1, 2, '0') + ";case"M":return"Date.monthNames[this.getMonth()].substring(0, 3) + ";case"n":return"(this.getMonth() + 1) + ";case"t":return"this.getDaysInMonth() + ";case"L":return"(this.isLeapYear() ? 1 : 0) + ";case"Y":return"this.getFullYear() + ";case"y":return"('' + this.getFullYear()).substring(2, 4) + ";case"a":return"(this.getHours() < 12 ? 'am' : 'pm') + ";
case"A":return"(this.getHours() < 12 ? 'AM' : 'PM') + ";case"g":return"((this.getHours() %12) ? this.getHours() % 12 : 12) + ";case"G":return"this.getHours() + ";case"h":return"String.leftPad((this.getHours() %12) ? this.getHours() % 12 : 12, 2, '0') + ";case"H":return"String.leftPad(this.getHours(), 2, '0') + ";case"i":return"String.leftPad(this.getMinutes(), 2, '0') + ";case"s":return"String.leftPad(this.getSeconds(), 2, '0') + ";case"O":return"this.getGMTOffset() + ";case"T":return"this.getTimezone() + ";case"Z":return"(this.getTimezoneOffset() * -60) + ";default:return"'"+String.escape(e)+"' + "}},Date.parseDate=function(e,t){if("unixtime"==t)return new Date(isNaN(parseInt(e))?0:1e3*parseInt(e));null==Date.parseFunctions[t]&&Date.createParser(t);var i=Date.parseFunctions[t];return Date[i](e)},Date.createParser=function(format){var funcName="parse"+Date.parseFunctions.count++,regexNum=Date.parseRegexes.length,currentGroup=1;Date.parseFunctions[format]=funcName;for(var code="Date."+funcName+" = function(input) {\nvar y = -1, m = -1, d = -1, h = -1, i = -1, s = -1, z = -1;\nvar d = new Date();\ny = d.getFullYear();\nm = d.getMonth();\nd = d.getDate();\nvar results = input.match(Date.parseRegexes["+regexNum+"]);\nif (results && results.length > 0) {",regex="",special=!1,ch="",i=0;i<format.length;++i)ch=format.charAt(i),special||"\\"!=ch?special?(special=!1,regex+=String.escape(ch)):(obj=Date.formatCodeToRegex(ch,currentGroup),currentGroup+=obj.g,regex+=obj.s,obj.g&&obj.c&&(code+=obj.c)):special=!0;code+="if (y > 0 && z > 0){\nvar doyDate = new Date(y,0);\ndoyDate.setDate(z);\nm = doyDate.getMonth();\nd = doyDate.getDate();\n}",code+="if (y > 0 && m >= 0 && d > 0 && h >= 0 && i >= 0 && s >= 0)\n{return new Date(y, m, d, h, i, s);}\nelse if (y > 0 && m >= 0 && d > 0 && h >= 0 && i >= 0)\n{return new Date(y, m, d, h, i);}\nelse if (y > 0 && m >= 0 && d > 0 && h >= 0)\n{return new Date(y, m, d, h);}\nelse if (y > 0 && m >= 0 && d > 0)\n{return new Date(y, m, d);}\nelse if (y > 0 && m >= 0)\n{return new Date(y, m);}\nelse if (y > 0)\n{return new Date(y);}\n}return null;}",Date.parseRegexes[regexNum]=new RegExp("^"+regex+"$"),eval(code)},Date.formatCodeToRegex=function(e,t){switch(e){case"D":return{g:0,c:null,s:"(?:Sun|Mon|Tue|Wed|Thu|Fri|Sat)"};case"j":case"d":return{g:1,c:"d = parseInt(results["+t+"], 10);\n",s:"(\\d{1,2})"};case"l":return{g:0,c:null,s:"(?:"+Date.dayNames.join("|")+")"};case"S":return{g:0,c:null,s:"(?:st|nd|rd|th)"};case"w":return{g:0,c:null,s:"\\d"};case"z":return{g:1,c:"z = parseInt(results["+t+"], 10);\n",s:"(\\d{1,3})"};case"W":return{g:0,c:null,s:"(?:\\d{2})"};case"F":return{g:1,c:"m = parseInt(Date.monthNumbers[results["+t+"].substring(0, 3)], 10);\n",s:"("+Date.monthNames.join("|")+")"};case"M":return{g:1,c:"m = parseInt(Date.monthNumbers[results["+t+"]], 10);\n",s:"(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)"};case"n":case"m":return{g:1,c:"m = parseInt(results["+t+"], 10) - 1;\n",s:"(\\d{1,2})"};case"t":return{g:0,c:null,s:"\\d{1,2}"};case"L":return{g:0,c:null,s:"(?:1|0)"};case"Y":return{g:1,c:"y = parseInt(results["+t+"], 10);\n",s:"(\\d{4})"};case"y":return{g:1,c:"var ty = parseInt(results["+t+"], 10);\ny = ty > Date.y2kYear ? 1900 + ty : 2000 + ty;\n",s:"(\\d{1,2})"};case"a":return{g:1,c:"if (results["+t+"] == 'am') {\nif (h == 12) { h = 0; }\n} else { if (h < 12) { h += 12; }}",s:"(am|pm)"};case"A":return{g:1,c:"if (results["+t+"] == 'AM') {\nif (h == 12) { h = 0; }\n} else { if (h < 12) { h += 12; }}",s:"(AM|PM)"};case"g":case"G":case"h":case"H":return{g:1,c:"h = parseInt(results["+t+"], 10);\n",s:"(\\d{1,2})"};case"i":return{g:1,c:"i = parseInt(results["+t+"], 10);\n",s:"(\\d{2})"};case"s":return{g:1,c:"s = parseInt(results["+t+"], 10);\n",s:"(\\d{2})"};case"O":return{g:0,c:null,s:"[+-]\\d{4}"};case"T":return{g:0,c:null,s:"[A-Z]{3}"};case"Z":return{g:0,c:null,s:"[+-]\\d{1,5}"};default:return{g:0,c:null,s:String.escape(e)}}},Date.prototype.getTimezone=function(){return this.toString().replace(/^.*? ([A-Z]{3}) [0-9]{4}.*$/,"$1").replace(/^.*?\(([A-Z])[a-z]+ ([A-Z])[a-z]+ ([A-Z])[a-z]+\)$/,"$1$2$3")},Date.prototype.getGMTOffset=function(){return(this.getTimezoneOffset()>0?"-":"+")+String.leftPad(Math.floor(Math.abs(this.getTimezoneOffset())/60),2,"0")+String.leftPad(Math.abs(this.getTimezoneOffset())%60,2,"0")},Date.prototype.getDayOfYear=function(){var e=0;Date.daysInMonth[1]=this.isLeapYear()?29:28;for(var t=0;t<this.getMonth();++t)e+=Date.daysInMonth[t];return e+this.getDate()},Date.prototype.getWeekOfYear=function(){var e=this.getDayOfYear()+(4-this.getDay()),t=new Date(this.getFullYear(),0,1),i=7-t.getDay()+4;return String.leftPad(Math.ceil((e-i)/7)+1,2,"0")},Date.prototype.isLeapYear=function(){var e=this.getFullYear();return 0==(3&e)&&(e%100||e%400==0&&e)},Date.prototype.getFirstDayOfMonth=function(){var e=(this.getDay()-(this.getDate()-1))%7;return e<0?e+7:e},Date.prototype.getLastDayOfMonth=function(){var e=(this.getDay()+(Date.daysInMonth[this.getMonth()]-this.getDate()))%7;return e<0?e+7:e},Date.prototype.getDaysInMonth=function(){return Date.daysInMonth[1]=this.isLeapYear()?29:28,Date.daysInMonth[this.getMonth()]},Date.prototype.getSuffix=function(){switch(this.getDate()){case 1:case 21:case 31:return"st";case 2:case 22:return"nd";case 3:case 23:return"rd";default:return"th"}},String.escape=function(e){return e.replace(/('|\\)/g,"\\$1")},String.leftPad=function(e,t,i){var n=new String(e);for(null==i&&(i=" ");n.length<t;)n=i+n;return n},Date.daysInMonth=[31,28,31,30,31,30,31,31,30,31,30,31],Date.monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"],Date.dayNames=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Date.y2kYear=50,Date.monthNumbers={Jan:0,Feb:1,Mar:2,Apr:3,May:4,Jun:5,Jul:6,Aug:7,Sep:8,Oct:9,Nov:10,Dec:11},Date.patterns={ISO8601LongPattern:"Y-m-d H:i:s",ISO8601ShortPattern:"Y-m-d",ShortDatePattern:"n/j/Y",LongDatePattern:"l, F d, Y",FullDateTimePattern:"l, F d, Y g:i:s A",MonthDayPattern:"F d",ShortTimePattern:"g:i A",LongTimePattern:"g:i:s A",SortableDateTimePattern:"Y-m-d\\TH:i:s",UniversalSortableDateTimePattern:"Y-m-d H:i:sO",YearMonthPattern:"F, Y"}}(),!function(e){"undefined"==typeof e.fn.each2&&e.extend(e.fn,{each2:function(t){for(var i=e([0]),n=-1,r=this.length;++n<r&&(i.context=i[0]=this[n])&&t.call(i[0],n,i)!==!1;);return this}})}(jQuery),function(e,t){"use strict";function i(t){var i=e(document.createTextNode(""));t.before(i),i.before(t),i.remove()}function n(e){function t(e){return R[e]||e}return e.replace(/[^\u0000-\u007E]/g,t)}function r(e,t){for(var i=0,n=t.length;n>i;i+=1)if(a(e,t[i]))return i;return-1}function s(){var t=e($);t.appendTo(document.body);var i={width:t.width()-t[0].clientWidth,height:t.height()-t[0].clientHeight};return t.remove(),i}function a(e,i){return e===i||e!==t&&i!==t&&(null!==e&&null!==i&&(e.constructor===String?e+""==i+"":i.constructor===String&&i+""==e+""))}function o(e,t,i){var n,r,s;if(null===e||e.length<1)return[];for(n=e.split(t),r=0,s=n.length;s>r;r+=1)n[r]=i(n[r]);return n}function l(e){return e.outerWidth(!1)-e.width()}function c(i){var n="keyup-change-value";i.on("keydown",function(){e.data(i,n)===t&&e.data(i,n,i.val())}),i.on("keyup",function(){var r=e.data(i,n);r!==t&&i.val()!==r&&(e.removeData(i,n),i.trigger("keyup-change"))})}function d(i){i.on("mousemove",function(i){var n=I;(n===t||n.x!==i.pageX||n.y!==i.pageY)&&e(i.target).trigger("mousemove-filtered",i)})}function h(e,i,n){n=n||t;var r;return function(){var t=arguments;window.clearTimeout(r),r=window.setTimeout(function(){i.apply(n,t)},e)}}function u(e,t){var i=h(e,function(e){t.trigger("scroll-debounced",e)});t.on("scroll",function(e){r(e.target,t.get())>=0&&i(e)})}function f(e){e[0]!==document.activeElement&&window.setTimeout(function(){var t,i=e[0],n=e.val().length;e.focus();var r=i.offsetWidth>0||i.offsetHeight>0;r&&i===document.activeElement&&(i.setSelectionRange?i.setSelectionRange(n,n):i.createTextRange&&(t=i.createTextRange(),t.collapse(!1),t.select()))},0)}function p(t){t=e(t)[0];var i=0,n=0;if("selectionStart"in t)i=t.selectionStart,n=t.selectionEnd-i;else if("selection"in document){t.focus();var r=document.selection.createRange();n=document.selection.createRange().text.length,r.moveStart("character",-t.value.length),i=r.text.length-n}return{offset:i,length:n}}function m(e){e.preventDefault(),e.stopPropagation()}function g(e){e.preventDefault(),e.stopImmediatePropagation()}function v(t){if(!N){var i=t[0].currentStyle||window.getComputedStyle(t[0],null);N=e(document.createElement("div")).css({position:"absolute",left:"-10000px",top:"-10000px",display:"none",fontSize:i.fontSize,fontFamily:i.fontFamily,fontStyle:i.fontStyle,fontWeight:i.fontWeight,letterSpacing:i.letterSpacing,textTransform:i.textTransform,whiteSpace:"nowrap"}),N.attr("class","select2-sizer"),e(document.body).append(N)}return N.text(t.val()),N.width()}function _(t,i,n){var r,s,a=[];r=e.trim(t.attr("class")),r&&(r=""+r,e(r.split(/\s+/)).each2(function(){0===this.indexOf("select2-")&&a.push(this)})),r=e.trim(i.attr("class")),r&&(r=""+r,e(r.split(/\s+/)).each2(function(){0!==this.indexOf("select2-")&&(s=n(this),s&&a.push(s))})),t.attr("class",a.join(" "))}function y(e,t,i,r){var s=n(e.toUpperCase()).indexOf(n(t.toUpperCase())),a=t.length;return 0>s?void i.push(r(e)):(i.push(r(e.substring(0,s))),i.push("<span class='select2-match'>"),i.push(r(e.substring(s,s+a))),i.push("</span>"),void i.push(r(e.substring(s+a,e.length))))}function b(e){var t={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};return String(e).replace(/[&<>"'\/\\]/g,function(e){return t[e]})}function x(i){var n,r=null,s=i.quietMillis||100,a=i.url,o=this;return function(l){window.clearTimeout(n),n=window.setTimeout(function(){var n=i.data,s=a,c=i.transport||e.fn.select2.ajaxDefaults.transport,d={type:i.type||"GET",cache:i.cache||!1,jsonpCallback:i.jsonpCallback||t,dataType:i.dataType||"json"},h=e.extend({},e.fn.select2.ajaxDefaults.params,d);n=n?n.call(o,l.term,l.page,l.context):null,s="function"==typeof s?s.call(o,l.term,l.page,l.context):s,r&&"function"==typeof r.abort&&r.abort(),i.params&&(e.isFunction(i.params)?e.extend(h,i.params.call(o)):e.extend(h,i.params)),e.extend(h,{url:s,dataType:i.dataType,data:n,success:function(e){var t=i.results(e,l.page,l);l.callback(t)},error:function(e,t,i){var n={hasError:!0,jqXHR:e,textStatus:t,errorThrown:i};l.callback(n)}}),r=c.call(o,h)},s)}}function w(t){var i,n,r=t,s=function(e){return""+e.text};e.isArray(r)&&(n=r,r={results:n}),e.isFunction(r)===!1&&(n=r,r=function(){return n});var a=r();return a.text&&(s=a.text,e.isFunction(s)||(i=a.text,s=function(e){return e[i]})),function(t){var i,n=t.term,a={results:[]};return""===n?void t.callback(r()):(i=function(r,a){var o,l;if(r=r[0],r.children){o={};for(l in r)r.hasOwnProperty(l)&&(o[l]=r[l]);o.children=[],e(r.children).each2(function(e,t){i(t,o.children)}),(o.children.length||t.matcher(n,s(o),r))&&a.push(o)}else t.matcher(n,s(r),r)&&a.push(r)},e(r().results).each2(function(e,t){i(t,a.results)}),void t.callback(a))}}function k(i){var n=e.isFunction(i);return function(r){var s=r.term,a={results:[]},o=n?i(r):i;e.isArray(o)&&(e(o).each(function(){var e=this.text!==t,i=e?this.text:this;(""===s||r.matcher(s,i))&&a.results.push(e?this:{id:this,text:this})}),r.callback(a))}}function C(t,i){if(e.isFunction(t))return!0;if(!t)return!1;if("string"==typeof t)return!0;throw new Error(i+" must be a string, function, or falsy value")}function D(t,i){if(e.isFunction(t)){var n=Array.prototype.slice.call(arguments,2);return t.apply(i,n)}return t}function S(t){var i=0;return e.each(t,function(e,t){t.children?i+=S(t.children):i++}),i}function j(e,i,n,r){var s,o,l,c,d,h=e,u=!1;if(!r.createSearchChoice||!r.tokenSeparators||r.tokenSeparators.length<1)return t;for(;;){for(o=-1,l=0,c=r.tokenSeparators.length;c>l&&(d=r.tokenSeparators[l],o=e.indexOf(d),!(o>=0));l++);if(0>o)break;if(s=e.substring(0,o),e=e.substring(o+d.length),s.length>0&&(s=r.createSearchChoice.call(this,s,i),s!==t&&null!==s&&r.id(s)!==t&&null!==r.id(s))){for(u=!1,l=0,c=i.length;c>l;l++)if(a(r.id(s),r.id(i[l]))){u=!0;break}u||n(s)}}return h!==e?e:void 0}function T(){var t=this;e.each(arguments,function(e,i){t[i].remove(),t[i]=null})}function M(t,i){var n=function(){};return n.prototype=new t,n.prototype.constructor=n,n.prototype.parent=t.prototype,n.prototype=e.extend(n.prototype,i),n}if(window.Select2===t){var L,E,O,A,N,F,P,I={x:0,y:0},H={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(e){switch(e=e.which?e.which:e){case H.LEFT:case H.RIGHT:case H.UP:case H.DOWN:return!0}return!1},isControl:function(e){var t=e.which;switch(t){case H.SHIFT:case H.CTRL:case H.ALT:return!0}return!!e.metaKey},isFunctionKey:function(e){return e=e.which?e.which:e,e>=112&&123>=e}},$="<div class='select2-measure-scrollbar'></div>",R={"Ⓐ":"A","Ａ":"A","À":"A","Á":"A","Â":"A","Ầ":"A","Ấ":"A","Ẫ":"A","Ẩ":"A","Ã":"A","Ā":"A","Ă":"A","Ằ":"A","Ắ":"A","Ẵ":"A","Ẳ":"A","Ȧ":"A","Ǡ":"A","Ä":"A","Ǟ":"A","Ả":"A","Å":"A","Ǻ":"A","Ǎ":"A","Ȁ":"A","Ȃ":"A","Ạ":"A","Ậ":"A","Ặ":"A","Ḁ":"A","Ą":"A","Ⱥ":"A","Ɐ":"A","Ꜳ":"AA","Æ":"AE","Ǽ":"AE","Ǣ":"AE","Ꜵ":"AO","Ꜷ":"AU","Ꜹ":"AV","Ꜻ":"AV","Ꜽ":"AY","Ⓑ":"B","Ｂ":"B","Ḃ":"B","Ḅ":"B","Ḇ":"B","Ƀ":"B","Ƃ":"B","Ɓ":"B","Ⓒ":"C","Ｃ":"C","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","Ç":"C","Ḉ":"C","Ƈ":"C","Ȼ":"C","Ꜿ":"C","Ⓓ":"D","Ｄ":"D","Ḋ":"D","Ď":"D","Ḍ":"D","Ḑ":"D","Ḓ":"D","Ḏ":"D","Đ":"D","Ƌ":"D","Ɗ":"D","Ɖ":"D","Ꝺ":"D","Ǳ":"DZ","Ǆ":"DZ","ǲ":"Dz","ǅ":"Dz","Ⓔ":"E","Ｅ":"E","È":"E","É":"E","Ê":"E","Ề":"E","Ế":"E","Ễ":"E","Ể":"E","Ẽ":"E","Ē":"E","Ḕ":"E","Ḗ":"E","Ĕ":"E","Ė":"E","Ë":"E","Ẻ":"E","Ě":"E","Ȅ":"E","Ȇ":"E","Ẹ":"E","Ệ":"E","Ȩ":"E","Ḝ":"E","Ę":"E","Ḙ":"E","Ḛ":"E","Ɛ":"E","Ǝ":"E","Ⓕ":"F","Ｆ":"F","Ḟ":"F","Ƒ":"F","Ꝼ":"F","Ⓖ":"G","Ｇ":"G","Ǵ":"G","Ĝ":"G","Ḡ":"G","Ğ":"G","Ġ":"G","Ǧ":"G","Ģ":"G","Ǥ":"G","Ɠ":"G","Ꞡ":"G","Ᵹ":"G","Ꝿ":"G","Ⓗ":"H","Ｈ":"H","Ĥ":"H","Ḣ":"H","Ḧ":"H","Ȟ":"H","Ḥ":"H","Ḩ":"H","Ḫ":"H","Ħ":"H","Ⱨ":"H","Ⱶ":"H","Ɥ":"H","Ⓘ":"I","Ｉ":"I","Ì":"I","Í":"I","Î":"I","Ĩ":"I","Ī":"I","Ĭ":"I","İ":"I","Ï":"I","Ḯ":"I","Ỉ":"I","Ǐ":"I","Ȉ":"I","Ȋ":"I","Ị":"I","Į":"I","Ḭ":"I","Ɨ":"I","Ⓙ":"J","Ｊ":"J","Ĵ":"J","Ɉ":"J","Ⓚ":"K","Ｋ":"K","Ḱ":"K","Ǩ":"K","Ḳ":"K","Ķ":"K","Ḵ":"K","Ƙ":"K","Ⱪ":"K","Ꝁ":"K","Ꝃ":"K","Ꝅ":"K","Ꞣ":"K","Ⓛ":"L","Ｌ":"L","Ŀ":"L","Ĺ":"L","Ľ":"L","Ḷ":"L","Ḹ":"L","Ļ":"L","Ḽ":"L","Ḻ":"L","Ł":"L","Ƚ":"L","Ɫ":"L","Ⱡ":"L","Ꝉ":"L","Ꝇ":"L","Ꞁ":"L","Ǉ":"LJ","ǈ":"Lj","Ⓜ":"M","Ｍ":"M","Ḿ":"M","Ṁ":"M","Ṃ":"M","Ɱ":"M","Ɯ":"M","Ⓝ":"N","Ｎ":"N","Ǹ":"N","Ń":"N","Ñ":"N","Ṅ":"N","Ň":"N","Ṇ":"N","Ņ":"N","Ṋ":"N","Ṉ":"N","Ƞ":"N","Ɲ":"N","Ꞑ":"N","Ꞥ":"N","Ǌ":"NJ","ǋ":"Nj","Ⓞ":"O","Ｏ":"O","Ò":"O","Ó":"O","Ô":"O","Ồ":"O","Ố":"O","Ỗ":"O","Ổ":"O","Õ":"O","Ṍ":"O","Ȭ":"O","Ṏ":"O","Ō":"O","Ṑ":"O","Ṓ":"O","Ŏ":"O","Ȯ":"O","Ȱ":"O","Ö":"O","Ȫ":"O","Ỏ":"O","Ő":"O","Ǒ":"O","Ȍ":"O","Ȏ":"O","Ơ":"O","Ờ":"O","Ớ":"O","Ỡ":"O","Ở":"O","Ợ":"O","Ọ":"O","Ộ":"O","Ǫ":"O","Ǭ":"O","Ø":"O","Ǿ":"O","Ɔ":"O","Ɵ":"O","Ꝋ":"O","Ꝍ":"O","Ƣ":"OI","Ꝏ":"OO","Ȣ":"OU","Ⓟ":"P","Ｐ":"P","Ṕ":"P","Ṗ":"P","Ƥ":"P","Ᵽ":"P","Ꝑ":"P","Ꝓ":"P","Ꝕ":"P","Ⓠ":"Q","Ｑ":"Q","Ꝗ":"Q","Ꝙ":"Q","Ɋ":"Q","Ⓡ":"R","Ｒ":"R","Ŕ":"R","Ṙ":"R","Ř":"R","Ȑ":"R","Ȓ":"R","Ṛ":"R","Ṝ":"R","Ŗ":"R","Ṟ":"R","Ɍ":"R","Ɽ":"R","Ꝛ":"R","Ꞧ":"R","Ꞃ":"R","Ⓢ":"S","Ｓ":"S","ẞ":"S","Ś":"S","Ṥ":"S","Ŝ":"S","Ṡ":"S","Š":"S","Ṧ":"S","Ṣ":"S","Ṩ":"S","Ș":"S","Ş":"S","Ȿ":"S","Ꞩ":"S","Ꞅ":"S","Ⓣ":"T","Ｔ":"T","Ṫ":"T","Ť":"T","Ṭ":"T","Ț":"T","Ţ":"T","Ṱ":"T","Ṯ":"T","Ŧ":"T","Ƭ":"T","Ʈ":"T","Ⱦ":"T","Ꞇ":"T","Ꜩ":"TZ","Ⓤ":"U","Ｕ":"U","Ù":"U","Ú":"U","Û":"U","Ũ":"U","Ṹ":"U","Ū":"U","Ṻ":"U","Ŭ":"U","Ü":"U","Ǜ":"U","Ǘ":"U","Ǖ":"U","Ǚ":"U","Ủ":"U","Ů":"U","Ű":"U","Ǔ":"U","Ȕ":"U","Ȗ":"U","Ư":"U","Ừ":"U","Ứ":"U","Ữ":"U","Ử":"U","Ự":"U","Ụ":"U","Ṳ":"U","Ų":"U","Ṷ":"U","Ṵ":"U","Ʉ":"U","Ⓥ":"V","Ｖ":"V","Ṽ":"V","Ṿ":"V","Ʋ":"V","Ꝟ":"V","Ʌ":"V","Ꝡ":"VY","Ⓦ":"W","Ｗ":"W","Ẁ":"W","Ẃ":"W","Ŵ":"W","Ẇ":"W","Ẅ":"W","Ẉ":"W","Ⱳ":"W","Ⓧ":"X","Ｘ":"X","Ẋ":"X","Ẍ":"X","Ⓨ":"Y","Ｙ":"Y","Ỳ":"Y","Ý":"Y","Ŷ":"Y","Ỹ":"Y","Ȳ":"Y","Ẏ":"Y","Ÿ":"Y","Ỷ":"Y","Ỵ":"Y","Ƴ":"Y","Ɏ":"Y","Ỿ":"Y","Ⓩ":"Z","Ｚ":"Z","Ź":"Z","Ẑ":"Z","Ż":"Z","Ž":"Z","Ẓ":"Z","Ẕ":"Z","Ƶ":"Z","Ȥ":"Z","Ɀ":"Z","Ⱬ":"Z","Ꝣ":"Z","ⓐ":"a","ａ":"a","ẚ":"a","à":"a","á":"a","â":"a","ầ":"a","ấ":"a","ẫ":"a","ẩ":"a","ã":"a","ā":"a","ă":"a","ằ":"a","ắ":"a","ẵ":"a","ẳ":"a","ȧ":"a","ǡ":"a","ä":"a","ǟ":"a","ả":"a","å":"a","ǻ":"a","ǎ":"a","ȁ":"a","ȃ":"a","ạ":"a","ậ":"a","ặ":"a","ḁ":"a","ą":"a","ⱥ":"a","ɐ":"a","ꜳ":"aa","æ":"ae","ǽ":"ae","ǣ":"ae","ꜵ":"ao","ꜷ":"au","ꜹ":"av","ꜻ":"av","ꜽ":"ay","ⓑ":"b","ｂ":"b","ḃ":"b","ḅ":"b","ḇ":"b","ƀ":"b","ƃ":"b","ɓ":"b","ⓒ":"c","ｃ":"c","ć":"c","ĉ":"c","ċ":"c","č":"c","ç":"c","ḉ":"c","ƈ":"c","ȼ":"c","ꜿ":"c","ↄ":"c","ⓓ":"d","ｄ":"d","ḋ":"d","ď":"d","ḍ":"d","ḑ":"d","ḓ":"d","ḏ":"d","đ":"d","ƌ":"d","ɖ":"d","ɗ":"d","ꝺ":"d","ǳ":"dz","ǆ":"dz","ⓔ":"e","ｅ":"e","è":"e","é":"e","ê":"e","ề":"e","ế":"e","ễ":"e","ể":"e","ẽ":"e","ē":"e","ḕ":"e","ḗ":"e","ĕ":"e","ė":"e","ë":"e","ẻ":"e","ě":"e","ȅ":"e","ȇ":"e","ẹ":"e","ệ":"e","ȩ":"e","ḝ":"e","ę":"e","ḙ":"e","ḛ":"e","ɇ":"e","ɛ":"e","ǝ":"e","ⓕ":"f","ｆ":"f","ḟ":"f","ƒ":"f","ꝼ":"f","ⓖ":"g","ｇ":"g","ǵ":"g","ĝ":"g","ḡ":"g","ğ":"g","ġ":"g","ǧ":"g","ģ":"g","ǥ":"g","ɠ":"g","ꞡ":"g","ᵹ":"g","ꝿ":"g","ⓗ":"h","ｈ":"h","ĥ":"h","ḣ":"h","ḧ":"h","ȟ":"h","ḥ":"h","ḩ":"h","ḫ":"h","ẖ":"h","ħ":"h","ⱨ":"h","ⱶ":"h","ɥ":"h","ƕ":"hv","ⓘ":"i","ｉ":"i","ì":"i","í":"i","î":"i","ĩ":"i","ī":"i","ĭ":"i","ï":"i","ḯ":"i","ỉ":"i","ǐ":"i","ȉ":"i","ȋ":"i","ị":"i","į":"i","ḭ":"i","ɨ":"i","ı":"i","ⓙ":"j","ｊ":"j","ĵ":"j","ǰ":"j","ɉ":"j","ⓚ":"k","ｋ":"k","ḱ":"k","ǩ":"k","ḳ":"k","ķ":"k","ḵ":"k","ƙ":"k","ⱪ":"k","ꝁ":"k","ꝃ":"k","ꝅ":"k","ꞣ":"k","ⓛ":"l","ｌ":"l","ŀ":"l","ĺ":"l","ľ":"l","ḷ":"l","ḹ":"l","ļ":"l","ḽ":"l","ḻ":"l","ſ":"l","ł":"l","ƚ":"l","ɫ":"l","ⱡ":"l","ꝉ":"l","ꞁ":"l","ꝇ":"l","ǉ":"lj","ⓜ":"m","ｍ":"m","ḿ":"m","ṁ":"m","ṃ":"m","ɱ":"m","ɯ":"m","ⓝ":"n","ｎ":"n","ǹ":"n","ń":"n","ñ":"n","ṅ":"n","ň":"n","ṇ":"n","ņ":"n","ṋ":"n","ṉ":"n","ƞ":"n","ɲ":"n","ŉ":"n","ꞑ":"n","ꞥ":"n","ǌ":"nj","ⓞ":"o","ｏ":"o","ò":"o","ó":"o","ô":"o","ồ":"o","ố":"o","ỗ":"o","ổ":"o","õ":"o","ṍ":"o","ȭ":"o","ṏ":"o","ō":"o","ṑ":"o","ṓ":"o","ŏ":"o","ȯ":"o","ȱ":"o","ö":"o","ȫ":"o","ỏ":"o","ő":"o","ǒ":"o","ȍ":"o","ȏ":"o","ơ":"o","ờ":"o","ớ":"o","ỡ":"o","ở":"o","ợ":"o","ọ":"o","ộ":"o","ǫ":"o","ǭ":"o","ø":"o","ǿ":"o","ɔ":"o","ꝋ":"o","ꝍ":"o","ɵ":"o","ƣ":"oi","ȣ":"ou","ꝏ":"oo","ⓟ":"p","ｐ":"p","ṕ":"p","ṗ":"p","ƥ":"p","ᵽ":"p","ꝑ":"p","ꝓ":"p","ꝕ":"p","ⓠ":"q","ｑ":"q","ɋ":"q","ꝗ":"q","ꝙ":"q","ⓡ":"r","ｒ":"r","ŕ":"r","ṙ":"r","ř":"r","ȑ":"r","ȓ":"r","ṛ":"r","ṝ":"r","ŗ":"r","ṟ":"r","ɍ":"r","ɽ":"r","ꝛ":"r","ꞧ":"r","ꞃ":"r","ⓢ":"s","ｓ":"s","ß":"s","ś":"s","ṥ":"s","ŝ":"s","ṡ":"s","š":"s","ṧ":"s","ṣ":"s","ṩ":"s","ș":"s","ş":"s","ȿ":"s","ꞩ":"s","ꞅ":"s","ẛ":"s","ⓣ":"t","ｔ":"t","ṫ":"t","ẗ":"t","ť":"t","ṭ":"t","ț":"t","ţ":"t","ṱ":"t","ṯ":"t","ŧ":"t","ƭ":"t","ʈ":"t","ⱦ":"t","ꞇ":"t","ꜩ":"tz","ⓤ":"u","ｕ":"u","ù":"u","ú":"u","û":"u","ũ":"u","ṹ":"u","ū":"u","ṻ":"u","ŭ":"u","ü":"u","ǜ":"u","ǘ":"u","ǖ":"u","ǚ":"u","ủ":"u","ů":"u","ű":"u","ǔ":"u","ȕ":"u","ȗ":"u","ư":"u","ừ":"u","ứ":"u","ữ":"u","ử":"u","ự":"u","ụ":"u","ṳ":"u","ų":"u","ṷ":"u","ṵ":"u","ʉ":"u","ⓥ":"v","ｖ":"v","ṽ":"v","ṿ":"v","ʋ":"v","ꝟ":"v","ʌ":"v","ꝡ":"vy","ⓦ":"w","ｗ":"w","ẁ":"w","ẃ":"w","ŵ":"w","ẇ":"w","ẅ":"w","ẘ":"w","ẉ":"w","ⱳ":"w","ⓧ":"x","ｘ":"x","ẋ":"x","ẍ":"x","ⓨ":"y","ｙ":"y","ỳ":"y","ý":"y","ŷ":"y","ỹ":"y","ȳ":"y","ẏ":"y","ÿ":"y","ỷ":"y","ẙ":"y","ỵ":"y","ƴ":"y","ɏ":"y","ỿ":"y","ⓩ":"z","ｚ":"z","ź":"z","ẑ":"z","ż":"z","ž":"z","ẓ":"z","ẕ":"z","ƶ":"z","ȥ":"z","ɀ":"z","ⱬ":"z","ꝣ":"z","Ά":"Α","Έ":"Ε","Ή":"Η","Ί":"Ι","Ϊ":"Ι","Ό":"Ο","Ύ":"Υ","Ϋ":"Υ","Ώ":"Ω","ά":"α","έ":"ε","ή":"η","ί":"ι","ϊ":"ι","ΐ":"ι","ό":"ο","ύ":"υ","ϋ":"υ","ΰ":"υ","ω":"ω","ς":"σ"};F=e(document),A=function(){var e=1;return function(){return e++}}(),L=M(Object,{bind:function(e){var t=this;return function(){e.apply(t,arguments)}},init:function(i){var n,r,a=".select2-results";this.opts=i=this.prepareOpts(i),this.id=i.id,i.element.data("select2")!==t&&null!==i.element.data("select2")&&i.element.data("select2").destroy(),this.container=this.createContainer(),this.liveRegion=e(".select2-hidden-accessible"),0==this.liveRegion.length&&(this.liveRegion=e("<span>",{role:"status","aria-live":"polite"}).addClass("select2-hidden-accessible").appendTo(document.body)),this.containerId="s2id_"+(i.element.attr("id")||"autogen"+A()),this.containerEventName=this.containerId.replace(/([.])/g,"_").replace(/([;&,\-\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1"),this.container.attr("id",this.containerId),this.container.attr("title",i.element.attr("title")),this.body=e(document.body),_(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.attr("style",i.element.attr("style")),this.container.css(D(i.containerCss,this.opts.element)),this.container.addClass(D(i.containerCssClass,this.opts.element)),this.elementTabIndex=this.opts.element.attr("tabindex"),this.opts.element.data("select2",this).attr("tabindex","-1").before(this.container).on("click.select2",m),this.container.data("select2",this),this.dropdown=this.container.find(".select2-drop"),_(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass),this.dropdown.addClass(D(i.dropdownCssClass,this.opts.element)),this.dropdown.data("select2",this),this.dropdown.on("click",m),this.results=n=this.container.find(a),this.search=r=this.container.find("input.select2-input"),this.queryCount=0,this.resultsPage=0,this.context=null,this.initContainer(),this.container.on("click",m),d(this.results),this.dropdown.on("mousemove-filtered",a,this.bind(this.highlightUnderEvent)),this.dropdown.on("touchstart touchmove touchend",a,this.bind(function(e){this._touchEvent=!0,this.highlightUnderEvent(e)})),this.dropdown.on("touchmove",a,this.bind(this.touchMoved)),this.dropdown.on("touchstart touchend",a,this.bind(this.clearTouchMoved)),this.dropdown.on("click",this.bind(function(){this._touchEvent&&(this._touchEvent=!1,this.selectHighlighted())})),u(80,this.results),this.dropdown.on("scroll-debounced",a,this.bind(this.loadMoreIfNeeded)),e(this.container).on("change",".select2-input",function(e){e.stopPropagation()}),e(this.dropdown).on("change",".select2-input",function(e){e.stopPropagation()}),e.fn.mousewheel&&n.mousewheel(function(e,t,i,r){var s=n.scrollTop();r>0&&0>=s-r?(n.scrollTop(0),m(e)):0>r&&n.get(0).scrollHeight-n.scrollTop()+r<=n.height()&&(n.scrollTop(n.get(0).scrollHeight-n.height()),m(e))}),c(r),r.on("keyup-change input paste",this.bind(this.updateResults)),r.on("focus",function(){r.addClass("select2-focused")}),r.on("blur",function(){r.removeClass("select2-focused")}),this.dropdown.on("mouseup",a,this.bind(function(t){e(t.target).closest(".select2-result-selectable").length>0&&(this.highlightUnderEvent(t),this.selectHighlighted(t))})),this.dropdown.on("click mouseup mousedown touchstart touchend focusin",function(e){e.stopPropagation()}),this.nextSearchTerm=t,e.isFunction(this.opts.initSelection)&&(this.initSelection(),this.monitorSource()),null!==i.maximumInputLength&&this.search.attr("maxlength",i.maximumInputLength);var o=i.element.prop("disabled");o===t&&(o=!1),this.enable(!o);var l=i.element.prop("readonly");l===t&&(l=!1),this.readonly(l),P=P||s(),this.autofocus=i.element.prop("autofocus"),i.element.prop("autofocus",!1),this.autofocus&&this.focus(),this.search.attr("placeholder",i.searchInputPlaceholder)},destroy:function(){var e=this.opts.element,i=e.data("select2"),n=this;this.close(),e.length&&e[0].detachEvent&&n._sync&&e.each(function(){n._sync&&this.detachEvent("onpropertychange",n._sync)}),this.propertyObserver&&(this.propertyObserver.disconnect(),this.propertyObserver=null),this._sync=null,i!==t&&(i.container.remove(),i.liveRegion.remove(),i.dropdown.remove(),e.show().removeData("select2").off(".select2").prop("autofocus",this.autofocus||!1),this.elementTabIndex?e.attr({tabindex:this.elementTabIndex}):e.removeAttr("tabindex"),e.show()),T.call(this,"container","liveRegion","dropdown","results","search")},optionToData:function(e){return e.is("option")?{id:e.prop("value"),text:e.text(),element:e.get(),css:e.attr("class"),disabled:e.prop("disabled"),locked:a(e.attr("locked"),"locked")||a(e.data("locked"),!0)}:e.is("optgroup")?{text:e.attr("label"),children:[],element:e.get(),css:e.attr("class")}:void 0},prepareOpts:function(i){var n,r,s,l,c=this;if(n=i.element,"select"===n.get(0).tagName.toLowerCase()&&(this.select=r=i.element),r&&e.each(["id","multiple","ajax","query","createSearchChoice","initSelection","data","tags"],function(){if(this in i)throw new Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.")}),i=e.extend({},{populateResults:function(n,r,s){var a,o=this.opts.id,l=this.liveRegion;(a=function(n,r,d){var h,u,f,p,m,g,v,_,y,b;n=i.sortResults(n,r,s);var x=[];for(h=0,u=n.length;u>h;h+=1)f=n[h],m=f.disabled===!0,p=!m&&o(f)!==t,g=f.children&&f.children.length>0,v=e("<li></li>"),v.addClass("select2-results-dept-"+d),v.addClass("select2-result"),v.addClass(p?"select2-result-selectable":"select2-result-unselectable"),m&&v.addClass("select2-disabled"),g&&v.addClass("select2-result-with-children"),v.addClass(c.opts.formatResultCssClass(f)),v.attr("role","presentation"),_=e(document.createElement("div")),_.addClass("select2-result-label"),_.attr("id","select2-result-label-"+A()),_.attr("role","option"),b=i.formatResult(f,_,s,c.opts.escapeMarkup),b!==t&&(_.html(b),v.append(_)),g&&(y=e("<ul></ul>"),y.addClass("select2-result-sub"),a(f.children,y,d+1),v.append(y)),v.data("select2-data",f),x.push(v[0]);r.append(x),l.text(i.formatMatches(n.length))})(r,n,0)}},e.fn.select2.defaults,i),"function"!=typeof i.id&&(s=i.id,i.id=function(e){return e[s]}),e.isArray(i.element.data("select2Tags"))){if("tags"in i)throw"tags specified as both an attribute 'data-select2-tags' and in options of Select2 "+i.element.attr("id");i.tags=i.element.data("select2Tags")}if(r?(i.query=this.bind(function(e){var i,r,s,a={results:[],more:!1},o=e.term;s=function(t,i){var n;t.is("option")?e.matcher(o,t.text(),t)&&i.push(c.optionToData(t)):t.is("optgroup")&&(n=c.optionToData(t),t.children().each2(function(e,t){s(t,n.children)}),n.children.length>0&&i.push(n))},i=n.children(),this.getPlaceholder()!==t&&i.length>0&&(r=this.getPlaceholderOption(),r&&(i=i.not(r))),i.each2(function(e,t){s(t,a.results)}),e.callback(a)}),i.id=function(e){return e.id}):"query"in i||("ajax"in i?(l=i.element.data("ajax-url"),l&&l.length>0&&(i.ajax.url=l),i.query=x.call(i.element,i.ajax)):"data"in i?i.query=w(i.data):"tags"in i&&(i.query=k(i.tags),i.createSearchChoice===t&&(i.createSearchChoice=function(t){return{id:e.trim(t),text:e.trim(t)}}),i.initSelection===t&&(i.initSelection=function(t,n){var r=[];e(o(t.val(),i.separator,i.transformVal)).each(function(){var t={id:this,text:this},n=i.tags;e.isFunction(n)&&(n=n()),e(n).each(function(){return a(this.id,t.id)?(t=this,!1):void 0}),r.push(t)}),n(r)}))),"function"!=typeof i.query)throw"query function not defined for Select2 "+i.element.attr("id");if("top"===i.createSearchChoicePosition)i.createSearchChoicePosition=function(e,t){e.unshift(t)};else if("bottom"===i.createSearchChoicePosition)i.createSearchChoicePosition=function(e,t){e.push(t)};else if("function"!=typeof i.createSearchChoicePosition)throw"invalid createSearchChoicePosition option must be 'top', 'bottom' or a custom function";return i},monitorSource:function(){var i,n=this.opts.element,r=this;n.on("change.select2",this.bind(function(){this.opts.element.data("select2-change-triggered")!==!0&&this.initSelection()})),this._sync=this.bind(function(){var e=n.prop("disabled");e===t&&(e=!1),this.enable(!e);var i=n.prop("readonly");i===t&&(i=!1),this.readonly(i),this.container&&(_(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.addClass(D(this.opts.containerCssClass,this.opts.element))),this.dropdown&&(_(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass),this.dropdown.addClass(D(this.opts.dropdownCssClass,this.opts.element)))}),n.length&&n[0].attachEvent&&n.each(function(){this.attachEvent("onpropertychange",r._sync)}),i=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver,i!==t&&(this.propertyObserver&&(delete this.propertyObserver,this.propertyObserver=null),this.propertyObserver=new i(function(t){e.each(t,r._sync)}),this.propertyObserver.observe(n.get(0),{attributes:!0,subtree:!1}))},triggerSelect:function(t){var i=e.Event("select2-selecting",{val:this.id(t),object:t,choice:t});return this.opts.element.trigger(i),!i.isDefaultPrevented()},triggerChange:function(t){t=t||{},t=e.extend({},t,{type:"change",val:this.val()}),this.opts.element.data("select2-change-triggered",!0),this.opts.element.trigger(t),this.opts.element.data("select2-change-triggered",!1),this.opts.element.click(),this.opts.blurOnChange&&this.opts.element.blur()},isInterfaceEnabled:function(){return this.enabledInterface===!0},enableInterface:function(){var e=this._enabled&&!this._readonly,t=!e;return e!==this.enabledInterface&&(this.container.toggleClass("select2-container-disabled",t),this.close(),this.enabledInterface=e,!0)},enable:function(e){e===t&&(e=!0),this._enabled!==e&&(this._enabled=e,this.opts.element.prop("disabled",!e),this.enableInterface())},disable:function(){this.enable(!1)},readonly:function(e){e===t&&(e=!1),this._readonly!==e&&(this._readonly=e,this.opts.element.prop("readonly",e),this.enableInterface())},opened:function(){return!!this.container&&this.container.hasClass("select2-dropdown-open")},positionDropdown:function(){var t,i,n,r,s,a=this.dropdown,o=this.container,l=o.offset(),c=o.outerHeight(!1),d=o.outerWidth(!1),h=a.outerHeight(!1),u=e(window),f=u.width(),p=u.height(),m=u.scrollLeft()+f,g=u.scrollTop()+p,v=l.top+c,_=l.left,y=g>=v+h,b=l.top-h>=u.scrollTop(),x=a.outerWidth(!1),w=function(){return m>=_+x},k=function(){return l.left+m+o.outerWidth(!1)>x},C=a.hasClass("select2-drop-above");C?(i=!0,!b&&y&&(n=!0,i=!1)):(i=!1,!y&&b&&(n=!0,i=!0)),n&&(a.hide(),l=this.container.offset(),c=this.container.outerHeight(!1),d=this.container.outerWidth(!1),h=a.outerHeight(!1),m=u.scrollLeft()+f,g=u.scrollTop()+p,v=l.top+c,_=l.left,x=a.outerWidth(!1),a.show(),this.focusSearch()),this.opts.dropdownAutoWidth?(s=e(".select2-results",a)[0],a.addClass("select2-drop-auto-width"),a.css("width",""),x=a.outerWidth(!1)+(s.scrollHeight===s.clientHeight?0:P.width),x>d?d=x:x=d,h=a.outerHeight(!1)):this.container.removeClass("select2-drop-auto-width"),"static"!==this.body.css("position")&&(t=this.body.offset(),v-=t.top,_-=t.left),!w()&&k()&&(_=l.left+this.container.outerWidth(!1)-x),r={left:_,width:d},i?(r.top=l.top-h,r.bottom="auto",this.container.addClass("select2-drop-above"),a.addClass("select2-drop-above")):(r.top=v,r.bottom="auto",this.container.removeClass("select2-drop-above"),a.removeClass("select2-drop-above")),r=e.extend(r,D(this.opts.dropdownCss,this.opts.element)),a.css(r)},shouldOpen:function(){var t;return!this.opened()&&(this._enabled!==!1&&this._readonly!==!0&&(t=e.Event("select2-opening"),this.opts.element.trigger(t),!t.isDefaultPrevented()))},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above"),this.dropdown.removeClass("select2-drop-above")},open:function(){return!!this.shouldOpen()&&(this.opening(),F.on("mousemove.select2Event",function(e){I.x=e.pageX,I.y=e.pageY}),!0)},opening:function(){var t,n=this.containerEventName,r="scroll."+n,s="resize."+n,a="orientationchange."+n;this.container.addClass("select2-dropdown-open").addClass("select2-container-active"),this.clearDropdownAlignmentPreference(),this.dropdown[0]!==this.body.children().last()[0]&&this.dropdown.detach().appendTo(this.body),t=e("#select2-drop-mask"),0===t.length&&(t=e(document.createElement("div")),t.attr("id","select2-drop-mask").attr("class","select2-drop-mask"),t.hide(),t.appendTo(this.body),t.on("mousedown touchstart click",function(n){i(t);var r,s=e("#select2-drop");s.length>0&&(r=s.data("select2"),
r.opts.selectOnBlur&&r.selectHighlighted({noFocus:!0}),r.close(),n.preventDefault(),n.stopPropagation())})),this.dropdown.prev()[0]!==t[0]&&this.dropdown.before(t),e("#select2-drop").removeAttr("id"),this.dropdown.attr("id","select2-drop"),t.show(),this.positionDropdown(),this.dropdown.show(),this.positionDropdown(),this.dropdown.addClass("select2-drop-active");var o=this;this.container.parents().add(window).each(function(){e(this).on(s+" "+r+" "+a,function(){o.opened()&&o.positionDropdown()})})},close:function(){if(this.opened()){var t=this.containerEventName,i="scroll."+t,n="resize."+t,r="orientationchange."+t;this.container.parents().add(window).each(function(){e(this).off(i).off(n).off(r)}),this.clearDropdownAlignmentPreference(),e("#select2-drop-mask").hide(),this.dropdown.removeAttr("id"),this.dropdown.hide(),this.container.removeClass("select2-dropdown-open").removeClass("select2-container-active"),this.results.empty(),F.off("mousemove.select2Event"),this.clearSearch(),this.search.removeClass("select2-active"),this.opts.element.trigger(e.Event("select2-close"))}},externalSearch:function(e){this.open(),this.search.val(e),this.updateResults(!1)},clearSearch:function(){},getMaximumSelectionSize:function(){return D(this.opts.maximumSelectionSize,this.opts.element)},ensureHighlightVisible:function(){var t,i,n,r,s,a,o,l,c=this.results;if(i=this.highlight(),!(0>i)){if(0==i)return void c.scrollTop(0);t=this.findHighlightableChoices().find(".select2-result-label"),n=e(t[i]),l=(n.offset()||{}).top||0,r=l+n.outerHeight(!0),i===t.length-1&&(o=c.find("li.select2-more-results"),o.length>0&&(r=o.offset().top+o.outerHeight(!0))),s=c.offset().top+c.outerHeight(!1),r>s&&c.scrollTop(c.scrollTop()+(r-s)),a=l-c.offset().top,0>a&&"none"!=n.css("display")&&c.scrollTop(c.scrollTop()+a)}},findHighlightableChoices:function(){return this.results.find(".select2-result-selectable:not(.select2-disabled):not(.select2-selected)")},moveHighlight:function(t){for(var i=this.findHighlightableChoices(),n=this.highlight();n>-1&&n<i.length;){n+=t;var r=e(i[n]);if(r.hasClass("select2-result-selectable")&&!r.hasClass("select2-disabled")&&!r.hasClass("select2-selected")){this.highlight(n);break}}},highlight:function(t){var i,n,s=this.findHighlightableChoices();return 0===arguments.length?r(s.filter(".select2-highlighted")[0],s.get()):(t>=s.length&&(t=s.length-1),0>t&&(t=0),this.removeHighlight(),i=e(s[t]),i.addClass("select2-highlighted"),this.search.attr("aria-activedescendant",i.find(".select2-result-label").attr("id")),this.ensureHighlightVisible(),this.liveRegion.text(i.text()),n=i.data("select2-data"),void(n&&this.opts.element.trigger({type:"select2-highlight",val:this.id(n),choice:n})))},removeHighlight:function(){this.results.find(".select2-highlighted").removeClass("select2-highlighted")},touchMoved:function(){this._touchMoved=!0},clearTouchMoved:function(){this._touchMoved=!1},countSelectableResults:function(){return this.findHighlightableChoices().length},highlightUnderEvent:function(t){var i=e(t.target).closest(".select2-result-selectable");if(i.length>0&&!i.is(".select2-highlighted")){var n=this.findHighlightableChoices();this.highlight(n.index(i))}else 0==i.length&&this.removeHighlight()},loadMoreIfNeeded:function(){var e,t=this.results,i=t.find("li.select2-more-results"),n=this.resultsPage+1,r=this,s=this.search.val(),a=this.context;0!==i.length&&(e=i.offset().top-t.offset().top-t.height(),e<=this.opts.loadMorePadding&&(i.addClass("select2-active"),this.opts.query({element:this.opts.element,term:s,page:n,context:a,matcher:this.opts.matcher,callback:this.bind(function(e){r.opened()&&(r.opts.populateResults.call(this,t,e.results,{term:s,page:n,context:a}),r.postprocessResults(e,!1,!1),e.more===!0?(i.detach().appendTo(t).html(r.opts.escapeMarkup(D(r.opts.formatLoadMore,r.opts.element,n+1))),window.setTimeout(function(){r.loadMoreIfNeeded()},10)):i.remove(),r.positionDropdown(),r.resultsPage=n,r.context=e.context,this.opts.element.trigger({type:"select2-loaded",items:e}))})})))},tokenize:function(){},updateResults:function(i){function n(){c.removeClass("select2-active"),u.positionDropdown(),d.find(".select2-no-results,.select2-selection-limit,.select2-searching").length?u.liveRegion.text(d.text()):u.liveRegion.text(u.opts.formatMatches(d.find('.select2-result-selectable:not(".select2-selected")').length))}function r(e){d.html(e),n()}var s,o,l,c=this.search,d=this.results,h=this.opts,u=this,f=c.val(),p=e.data(this.container,"select2-last-term");if((i===!0||!p||!a(f,p))&&(e.data(this.container,"select2-last-term",f),i===!0||this.showSearchInput!==!1&&this.opened())){l=++this.queryCount;var m=this.getMaximumSelectionSize();if(m>=1&&(s=this.data(),e.isArray(s)&&s.length>=m&&C(h.formatSelectionTooBig,"formatSelectionTooBig")))return void r("<li class='select2-selection-limit'>"+D(h.formatSelectionTooBig,h.element,m)+"</li>");if(c.val().length<h.minimumInputLength)return r(C(h.formatInputTooShort,"formatInputTooShort")?"<li class='select2-no-results'>"+D(h.formatInputTooShort,h.element,c.val(),h.minimumInputLength)+"</li>":""),void(i&&this.showSearch&&this.showSearch(!0));if(h.maximumInputLength&&c.val().length>h.maximumInputLength)return void r(C(h.formatInputTooLong,"formatInputTooLong")?"<li class='select2-no-results'>"+D(h.formatInputTooLong,h.element,c.val(),h.maximumInputLength)+"</li>":"");h.formatSearching&&0===this.findHighlightableChoices().length&&r("<li class='select2-searching'>"+D(h.formatSearching,h.element)+"</li>"),c.addClass("select2-active"),this.removeHighlight(),o=this.tokenize(),o!=t&&null!=o&&c.val(o),this.resultsPage=1,h.query({element:h.element,term:c.val(),page:this.resultsPage,context:null,matcher:h.matcher,callback:this.bind(function(s){var o;if(l==this.queryCount){if(!this.opened())return void this.search.removeClass("select2-active");if(s.hasError!==t&&C(h.formatAjaxError,"formatAjaxError"))return void r("<li class='select2-ajax-error'>"+D(h.formatAjaxError,h.element,s.jqXHR,s.textStatus,s.errorThrown)+"</li>");if(this.context=s.context===t?null:s.context,this.opts.createSearchChoice&&""!==c.val()&&(o=this.opts.createSearchChoice.call(u,c.val(),s.results),o!==t&&null!==o&&u.id(o)!==t&&null!==u.id(o)&&0===e(s.results).filter(function(){return a(u.id(this),u.id(o))}).length&&this.opts.createSearchChoicePosition(s.results,o)),0===s.results.length&&C(h.formatNoMatches,"formatNoMatches"))return void r("<li class='select2-no-results'>"+D(h.formatNoMatches,h.element,c.val())+"</li>");d.empty(),u.opts.populateResults.call(this,d,s.results,{term:c.val(),page:this.resultsPage,context:null}),s.more===!0&&C(h.formatLoadMore,"formatLoadMore")&&(d.append("<li class='select2-more-results'>"+h.escapeMarkup(D(h.formatLoadMore,h.element,this.resultsPage))+"</li>"),window.setTimeout(function(){u.loadMoreIfNeeded()},10)),this.postprocessResults(s,i),n(),this.opts.element.trigger({type:"select2-loaded",items:s})}})})}},cancel:function(){this.close()},blur:function(){this.opts.selectOnBlur&&this.selectHighlighted({noFocus:!0}),this.close(),this.container.removeClass("select2-container-active"),this.search[0]===document.activeElement&&this.search.blur(),this.clearSearch(),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")},focusSearch:function(){f(this.search)},selectHighlighted:function(e){if(this._touchMoved)return void this.clearTouchMoved();var t=this.highlight(),i=this.results.find(".select2-highlighted"),n=i.closest(".select2-result").data("select2-data");n?(this.highlight(t),this.onSelect(n,e)):e&&e.noFocus&&this.close()},getPlaceholder:function(){var e;return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder||((e=this.getPlaceholderOption())!==t?e.text():t)},getPlaceholderOption:function(){if(this.select){var i=this.select.children("option").first();if(this.opts.placeholderOption!==t)return"first"===this.opts.placeholderOption&&i||"function"==typeof this.opts.placeholderOption&&this.opts.placeholderOption(this.select);if(""===e.trim(i.text())&&""===i.val())return i}},initContainerWidth:function(){function i(){var i,n,r,s,a,o;if("off"===this.opts.width)return null;if("element"===this.opts.width)return 0===this.opts.element.outerWidth(!1)?"auto":this.opts.element.outerWidth(!1)+"px";if("copy"===this.opts.width||"resolve"===this.opts.width){if(i=this.opts.element.attr("style"),i!==t)for(n=i.split(";"),s=0,a=n.length;a>s;s+=1)if(o=n[s].replace(/\s/g,""),r=o.match(/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i),null!==r&&r.length>=1)return r[1];return"resolve"===this.opts.width?(i=this.opts.element.css("width"),i.indexOf("%")>0?i:0===this.opts.element.outerWidth(!1)?"auto":this.opts.element.outerWidth(!1)+"px"):null}return e.isFunction(this.opts.width)?this.opts.width():this.opts.width}var n=i.call(this);null!==n&&this.container.css("width",n)}}),E=M(L,{createContainer:function(){var t=e(document.createElement("div")).attr({"class":"select2-container"}).html(["<a href='javascript:void(0)' class='select2-choice' tabindex='-1'>","   <span class='select2-chosen'>&#160;</span><abbr class='select2-search-choice-close'></abbr>","   <span class='select2-arrow' role='presentation'><b role='presentation'></b></span>","</a>","<label for='' class='select2-offscreen'></label>","<input class='select2-focusser select2-offscreen' type='text' aria-haspopup='true' role='button' />","<div class='select2-drop select2-display-none'>","   <div class='select2-search'>","       <label for='' class='select2-offscreen'></label>","       <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input' role='combobox' aria-expanded='true'","       aria-autocomplete='list' />","   </div>","   <ul class='select2-results' role='listbox'>","   </ul>","</div>"].join(""));return t},enableInterface:function(){this.parent.enableInterface.apply(this,arguments)&&this.focusser.prop("disabled",!this.isInterfaceEnabled())},opening:function(){var i,n,r;this.opts.minimumResultsForSearch>=0&&this.showSearch(!0),this.parent.opening.apply(this,arguments),this.showSearchInput!==!1&&this.search.val(this.focusser.val()),this.opts.shouldFocusInput(this)&&(this.search.focus(),i=this.search.get(0),i.createTextRange?(n=i.createTextRange(),n.collapse(!1),n.select()):i.setSelectionRange&&(r=this.search.val().length,i.setSelectionRange(r,r))),""===this.search.val()&&this.nextSearchTerm!=t&&(this.search.val(this.nextSearchTerm),this.search.select()),this.focusser.prop("disabled",!0).val(""),this.updateResults(!0),this.opts.element.trigger(e.Event("select2-open"))},close:function(){this.opened()&&(this.parent.close.apply(this,arguments),this.focusser.prop("disabled",!1),this.opts.shouldFocusInput(this)&&this.focusser.focus())},focus:function(){this.opened()?this.close():(this.focusser.prop("disabled",!1),this.opts.shouldFocusInput(this)&&this.focusser.focus())},isFocused:function(){return this.container.hasClass("select2-container-active")},cancel:function(){this.parent.cancel.apply(this,arguments),this.focusser.prop("disabled",!1),this.opts.shouldFocusInput(this)&&this.focusser.focus()},destroy:function(){e("label[for='"+this.focusser.attr("id")+"']").attr("for",this.opts.element.attr("id")),this.parent.destroy.apply(this,arguments),T.call(this,"selection","focusser")},initContainer:function(){var t,n,r=this.container,s=this.dropdown,a=A();this.opts.minimumResultsForSearch<0?this.showSearch(!1):this.showSearch(!0),this.selection=t=r.find(".select2-choice"),this.focusser=r.find(".select2-focusser"),t.find(".select2-chosen").attr("id","select2-chosen-"+a),this.focusser.attr("aria-labelledby","select2-chosen-"+a),this.results.attr("id","select2-results-"+a),this.search.attr("aria-owns","select2-results-"+a),this.focusser.attr("id","s2id_autogen"+a),n=e("label[for='"+this.opts.element.attr("id")+"']"),this.opts.element.focus(this.bind(function(){this.focus()})),this.focusser.prev().text(n.text()).attr("for",this.focusser.attr("id"));var o=this.opts.element.attr("title");this.opts.element.attr("title",o||n.text()),this.focusser.attr("tabindex",this.elementTabIndex),this.search.attr("id",this.focusser.attr("id")+"_search"),this.search.prev().text(e("label[for='"+this.focusser.attr("id")+"']").text()).attr("for",this.search.attr("id")),this.search.on("keydown",this.bind(function(e){if(this.isInterfaceEnabled()&&229!=e.keyCode){if(e.which===H.PAGE_UP||e.which===H.PAGE_DOWN)return void m(e);switch(e.which){case H.UP:case H.DOWN:return this.moveHighlight(e.which===H.UP?-1:1),void m(e);case H.ENTER:return this.selectHighlighted(),void m(e);case H.TAB:return void this.selectHighlighted({noFocus:!0});case H.ESC:return this.cancel(e),void m(e)}}})),this.search.on("blur",this.bind(function(){document.activeElement===this.body.get(0)&&window.setTimeout(this.bind(function(){this.opened()&&this.search.focus()}),0)})),this.focusser.on("keydown",this.bind(function(e){if(this.isInterfaceEnabled()&&e.which!==H.TAB&&!H.isControl(e)&&!H.isFunctionKey(e)&&e.which!==H.ESC){if(this.opts.openOnEnter===!1&&e.which===H.ENTER)return void m(e);if(e.which==H.DOWN||e.which==H.UP||e.which==H.ENTER&&this.opts.openOnEnter){if(e.altKey||e.ctrlKey||e.shiftKey||e.metaKey)return;return this.open(),void m(e)}return e.which==H.DELETE||e.which==H.BACKSPACE?(this.opts.allowClear&&this.clear(),void m(e)):void 0}})),c(this.focusser),this.focusser.on("keyup-change input",this.bind(function(e){if(this.opts.minimumResultsForSearch>=0){if(e.stopPropagation(),this.opened())return;this.open()}})),t.on("mousedown touchstart","abbr",this.bind(function(e){this.isInterfaceEnabled()&&(this.clear(),g(e),this.close(),this.selection&&this.selection.focus())})),t.on("mousedown touchstart",this.bind(function(n){i(t),this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.opened()?this.close():this.isInterfaceEnabled()&&this.open(),m(n)})),s.on("mousedown touchstart",this.bind(function(){this.opts.shouldFocusInput(this)&&this.search.focus()})),t.on("focus",this.bind(function(e){m(e)})),this.focusser.on("focus",this.bind(function(){this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.container.addClass("select2-container-active")})).on("blur",this.bind(function(){this.opened()||(this.container.removeClass("select2-container-active"),this.opts.element.trigger(e.Event("select2-blur")))})),this.search.on("focus",this.bind(function(){this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.container.addClass("select2-container-active")})),this.initContainerWidth(),this.opts.element.hide(),this.setPlaceholder()},clear:function(t){var i=this.selection.data("select2-data");if(i){var n=e.Event("select2-clearing");if(this.opts.element.trigger(n),n.isDefaultPrevented())return;var r=this.getPlaceholderOption();this.opts.element.val(r?r.val():""),this.selection.find(".select2-chosen").empty(),this.selection.removeData("select2-data"),this.setPlaceholder(),t!==!1&&(this.opts.element.trigger({type:"select2-removed",val:this.id(i),choice:i}),this.triggerChange({removed:i}))}},initSelection:function(){if(this.isPlaceholderOptionSelected())this.updateSelection(null),this.close(),this.setPlaceholder();else{var e=this;this.opts.initSelection.call(null,this.opts.element,function(i){i!==t&&null!==i&&(e.updateSelection(i),e.close(),e.setPlaceholder(),e.nextSearchTerm=e.opts.nextSearchTerm(i,e.search.val()))})}},isPlaceholderOptionSelected:function(){var e;return this.getPlaceholder()!==t&&((e=this.getPlaceholderOption())!==t&&e.prop("selected")||""===this.opts.element.val()||this.opts.element.val()===t||null===this.opts.element.val())},prepareOpts:function(){var t=this.parent.prepareOpts.apply(this,arguments),i=this;return"select"===t.element.get(0).tagName.toLowerCase()?t.initSelection=function(e,t){var n=e.find("option").filter(function(){return this.selected&&!this.disabled});t(i.optionToData(n))}:"data"in t&&(t.initSelection=t.initSelection||function(i,n){var r=i.val(),s=null;t.query({matcher:function(e,i,n){var o=a(r,t.id(n));return o&&(s=n),o},callback:e.isFunction(n)?function(){n(s)}:e.noop})}),t},getPlaceholder:function(){return this.select&&this.getPlaceholderOption()===t?t:this.parent.getPlaceholder.apply(this,arguments)},setPlaceholder:function(){var e=this.getPlaceholder();if(this.isPlaceholderOptionSelected()&&e!==t){if(this.select&&this.getPlaceholderOption()===t)return;this.selection.find(".select2-chosen").html(this.opts.escapeMarkup(e)),this.selection.addClass("select2-default"),this.container.removeClass("select2-allowclear")}},postprocessResults:function(e,t,i){var n=0,r=this;if(this.findHighlightableChoices().each2(function(e,t){return a(r.id(t.data("select2-data")),r.opts.element.val())?(n=e,!1):void 0}),i!==!1&&(t===!0&&n>=0?this.highlight(n):this.highlight(0)),t===!0){var s=this.opts.minimumResultsForSearch;s>=0&&this.showSearch(S(e.results)>=s)}},showSearch:function(t){this.showSearchInput!==t&&(this.showSearchInput=t,this.dropdown.find(".select2-search").toggleClass("select2-search-hidden",!t),this.dropdown.find(".select2-search").toggleClass("select2-offscreen",!t),e(this.dropdown,this.container).toggleClass("select2-with-searchbox",t))},onSelect:function(e,t){if(this.triggerSelect(e)){var i=this.opts.element.val(),n=this.data();this.opts.element.val(this.id(e)),this.updateSelection(e),this.opts.element.trigger({type:"select2-selected",val:this.id(e),choice:e}),this.nextSearchTerm=this.opts.nextSearchTerm(e,this.search.val()),this.close(),t&&t.noFocus||!this.opts.shouldFocusInput(this)||this.focusser.focus(),a(i,this.id(e))||this.triggerChange({added:e,removed:n})}},updateSelection:function(e){var i,n,r=this.selection.find(".select2-chosen");this.selection.data("select2-data",e),r.empty(),null!==e&&(i=this.opts.formatSelection(e,r,this.opts.escapeMarkup)),i!==t&&r.append(i),n=this.opts.formatSelectionCssClass(e,r),n!==t&&r.addClass(n),this.selection.removeClass("select2-default"),this.opts.allowClear&&this.getPlaceholder()!==t&&this.container.addClass("select2-allowclear")},val:function(){var e,i=!1,n=null,r=this,s=this.data();if(0===arguments.length)return this.opts.element.val();if(e=arguments[0],arguments.length>1&&(i=arguments[1]),this.select)this.select.val(e).find("option").filter(function(){return this.selected}).each2(function(e,t){return n=r.optionToData(t),!1}),this.updateSelection(n),this.setPlaceholder(),i&&this.triggerChange({added:n,removed:s});else{if(!e&&0!==e)return void this.clear(i);if(this.opts.initSelection===t)throw new Error("cannot call val() if initSelection() is not defined");this.opts.element.val(e),this.opts.initSelection(this.opts.element,function(e){r.opts.element.val(e?r.id(e):""),r.updateSelection(e),r.setPlaceholder(),i&&r.triggerChange({added:e,removed:s})})}},clearSearch:function(){this.search.val(""),this.focusser.val("")},data:function(e){var i,n=!1;return 0===arguments.length?(i=this.selection.data("select2-data"),i==t&&(i=null),i):(arguments.length>1&&(n=arguments[1]),void(e?(i=this.data(),this.opts.element.val(e?this.id(e):""),this.updateSelection(e),n&&this.triggerChange({added:e,removed:i})):this.clear(n)))}}),O=M(L,{createContainer:function(){var t=e(document.createElement("div")).attr({"class":"select2-container select2-container-multi"}).html(["<ul class='select2-choices'>","  <li class='select2-search-field'>","    <label for='' class='select2-offscreen'></label>","    <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input'>","  </li>","</ul>","<div class='select2-drop select2-drop-multi select2-display-none'>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return t},prepareOpts:function(){var t=this.parent.prepareOpts.apply(this,arguments),i=this;return"select"===t.element.get(0).tagName.toLowerCase()?t.initSelection=function(e,t){var n=[];e.find("option").filter(function(){return this.selected&&!this.disabled}).each2(function(e,t){n.push(i.optionToData(t))}),t(n)}:"data"in t&&(t.initSelection=t.initSelection||function(i,n){var r=o(i.val(),t.separator,t.transformVal),s=[];t.query({matcher:function(i,n,o){var l=e.grep(r,function(e){return a(e,t.id(o))}).length;return l&&s.push(o),l},callback:e.isFunction(n)?function(){for(var e=[],i=0;i<r.length;i++)for(var o=r[i],l=0;l<s.length;l++){var c=s[l];if(a(o,t.id(c))){e.push(c),s.splice(l,1);break}}n(e)}:e.noop})}),t},selectChoice:function(e){var t=this.container.find(".select2-search-choice-focus");t.length&&e&&e[0]==t[0]||(t.length&&this.opts.element.trigger("choice-deselected",t),t.removeClass("select2-search-choice-focus"),e&&e.length&&(this.close(),e.addClass("select2-search-choice-focus"),this.opts.element.trigger("choice-selected",e)))},destroy:function(){e("label[for='"+this.search.attr("id")+"']").attr("for",this.opts.element.attr("id")),this.parent.destroy.apply(this,arguments),T.call(this,"searchContainer","selection")},initContainer:function(){var t,i=".select2-choices";this.searchContainer=this.container.find(".select2-search-field"),this.selection=t=this.container.find(i);var n=this;this.selection.on("click",".select2-container:not(.select2-container-disabled) .select2-search-choice:not(.select2-locked)",function(){n.search[0].focus(),n.selectChoice(e(this))}),this.search.attr("id","s2id_autogen"+A()),this.search.prev().text(e("label[for='"+this.opts.element.attr("id")+"']").text()).attr("for",this.search.attr("id")),this.opts.element.focus(this.bind(function(){this.focus()})),this.search.on("input paste",this.bind(function(){this.search.attr("placeholder")&&0==this.search.val().length||this.isInterfaceEnabled()&&(this.opened()||this.open())})),this.search.attr("tabindex",this.elementTabIndex),this.keydowns=0,this.search.on("keydown",this.bind(function(e){if(this.isInterfaceEnabled()){++this.keydowns;var i=t.find(".select2-search-choice-focus"),n=i.prev(".select2-search-choice:not(.select2-locked)"),r=i.next(".select2-search-choice:not(.select2-locked)"),s=p(this.search);if(i.length&&(e.which==H.LEFT||e.which==H.RIGHT||e.which==H.BACKSPACE||e.which==H.DELETE||e.which==H.ENTER)){var a=i;return e.which==H.LEFT&&n.length?a=n:e.which==H.RIGHT?a=r.length?r:null:e.which===H.BACKSPACE?this.unselect(i.first())&&(this.search.width(10),a=n.length?n:r):e.which==H.DELETE?this.unselect(i.first())&&(this.search.width(10),a=r.length?r:null):e.which==H.ENTER&&(a=null),this.selectChoice(a),m(e),void(a&&a.length||this.open())}if((e.which===H.BACKSPACE&&1==this.keydowns||e.which==H.LEFT)&&0==s.offset&&!s.length)return this.selectChoice(t.find(".select2-search-choice:not(.select2-locked)").last()),void m(e);if(this.selectChoice(null),this.opened())switch(e.which){case H.UP:case H.DOWN:return this.moveHighlight(e.which===H.UP?-1:1),void m(e);case H.ENTER:return this.selectHighlighted(),void m(e);case H.TAB:return this.selectHighlighted({noFocus:!0}),void this.close();case H.ESC:return this.cancel(e),void m(e)}if(e.which!==H.TAB&&!H.isControl(e)&&!H.isFunctionKey(e)&&e.which!==H.BACKSPACE&&e.which!==H.ESC){if(e.which===H.ENTER){if(this.opts.openOnEnter===!1)return;if(e.altKey||e.ctrlKey||e.shiftKey||e.metaKey)return}this.open(),(e.which===H.PAGE_UP||e.which===H.PAGE_DOWN)&&m(e),e.which===H.ENTER&&m(e)}}})),this.search.on("keyup",this.bind(function(){this.keydowns=0,this.resizeSearch()})),this.search.on("blur",this.bind(function(t){this.container.removeClass("select2-container-active"),this.search.removeClass("select2-focused"),this.selectChoice(null),this.opened()||this.clearSearch(),t.stopImmediatePropagation(),this.opts.element.trigger(e.Event("select2-blur"))})),this.container.on("click",i,this.bind(function(t){this.isInterfaceEnabled()&&(e(t.target).closest(".select2-search-choice").length>0||(this.selectChoice(null),this.clearPlaceholder(),this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.open(),this.focusSearch(),t.preventDefault()))})),this.container.on("focus",i,this.bind(function(){this.isInterfaceEnabled()&&(this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"),this.clearPlaceholder())})),this.initContainerWidth(),this.opts.element.hide(),this.clearSearch()},enableInterface:function(){this.parent.enableInterface.apply(this,arguments)&&this.search.prop("disabled",!this.isInterfaceEnabled())},initSelection:function(){if(""===this.opts.element.val()&&""===this.opts.element.text()&&(this.updateSelection([]),this.close(),this.clearSearch()),this.select||""!==this.opts.element.val()){var e=this;this.opts.initSelection.call(null,this.opts.element,function(i){i!==t&&null!==i&&(e.updateSelection(i),e.close(),e.clearSearch())})}},clearSearch:function(){var e=this.getPlaceholder(),i=this.getMaxSearchWidth();e!==t&&0===this.getVal().length&&this.search.hasClass("select2-focused")===!1?(this.search.val(e).addClass("select2-default"),this.search.width(i>0?i:this.container.css("width"))):this.search.val("").width(10)},clearPlaceholder:function(){this.search.hasClass("select2-default")&&this.search.val("").removeClass("select2-default")},opening:function(){this.clearPlaceholder(),this.resizeSearch(),this.parent.opening.apply(this,arguments),this.focusSearch(),""===this.search.val()&&this.nextSearchTerm!=t&&(this.search.val(this.nextSearchTerm),this.search.select()),this.updateResults(!0),this.opts.shouldFocusInput(this)&&this.search.focus(),this.opts.element.trigger(e.Event("select2-open"))},close:function(){this.opened()&&this.parent.close.apply(this,arguments)},focus:function(){this.close(),this.search.focus()},isFocused:function(){return this.search.hasClass("select2-focused")},updateSelection:function(t){var i=[],n=[],s=this;e(t).each(function(){r(s.id(this),i)<0&&(i.push(s.id(this)),n.push(this))}),t=n,this.selection.find(".select2-search-choice").remove(),e(t).each(function(){s.addSelectedChoice(this)}),s.postprocessResults()},tokenize:function(){var e=this.search.val();e=this.opts.tokenizer.call(this,e,this.data(),this.bind(this.onSelect),this.opts),null!=e&&e!=t&&(this.search.val(e),e.length>0&&this.open())},onSelect:function(e,i){this.triggerSelect(e)&&""!==e.text&&(this.addSelectedChoice(e),this.opts.element.trigger({type:"selected",val:this.id(e),choice:e}),this.nextSearchTerm=this.opts.nextSearchTerm(e,this.search.val()),this.clearSearch(),this.updateResults(),(this.select||!this.opts.closeOnSelect)&&this.postprocessResults(e,!1,this.opts.closeOnSelect===!0),this.opts.closeOnSelect?(this.close(),this.search.width(10)):this.countSelectableResults()>0?(this.search.width(10),this.resizeSearch(),this.getMaximumSelectionSize()>0&&this.val().length>=this.getMaximumSelectionSize()?this.updateResults(!0):this.nextSearchTerm!=t&&(this.search.val(this.nextSearchTerm),this.updateResults(),this.search.select()),this.positionDropdown()):(this.close(),this.search.width(10)),this.triggerChange({added:e}),i&&i.noFocus||this.focusSearch())},cancel:function(){this.close(),this.focusSearch()},addSelectedChoice:function(i){var n,r,s=!i.locked,a=e("<li class='select2-search-choice'>    <div></div>    <a href='#' class='select2-search-choice-close' tabindex='-1'></a></li>"),o=e("<li class='select2-search-choice select2-locked'><div></div></li>"),l=s?a:o,c=this.id(i),d=this.getVal();n=this.opts.formatSelection(i,l.find("div"),this.opts.escapeMarkup),n!=t&&l.find("div").replaceWith(e("<div></div>").html(n)),r=this.opts.formatSelectionCssClass(i,l.find("div")),r!=t&&l.addClass(r),s&&l.find(".select2-search-choice-close").on("mousedown",m).on("click dblclick",this.bind(function(t){this.isInterfaceEnabled()&&(this.unselect(e(t.target)),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus"),m(t),this.close(),this.focusSearch())})).on("focus",this.bind(function(){this.isInterfaceEnabled()&&(this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"))})),l.data("select2-data",i),l.insertBefore(this.searchContainer),d.push(c),this.setVal(d)},unselect:function(t){var i,n,s=this.getVal();if(t=t.closest(".select2-search-choice"),0===t.length)throw"Invalid argument: "+t+". Must be .select2-search-choice";if(i=t.data("select2-data")){var a=e.Event("select2-removing");if(a.val=this.id(i),a.choice=i,this.opts.element.trigger(a),a.isDefaultPrevented())return!1;for(;(n=r(this.id(i),s))>=0;)s.splice(n,1),this.setVal(s),this.select&&this.postprocessResults();return t.remove(),this.opts.element.trigger({type:"select2-removed",val:this.id(i),choice:i}),this.triggerChange({removed:i}),!0}},postprocessResults:function(e,t,i){var n=this.getVal(),s=this.results.find(".select2-result"),a=this.results.find(".select2-result-with-children"),o=this;s.each2(function(e,t){var i=o.id(t.data("select2-data"));r(i,n)>=0&&(t.addClass("select2-selected"),t.find(".select2-result-selectable").addClass("select2-selected"))}),a.each2(function(e,t){t.is(".select2-result-selectable")||0!==t.find(".select2-result-selectable:not(.select2-selected)").length||t.addClass("select2-selected")}),-1==this.highlight()&&i!==!1&&this.opts.closeOnSelect===!0&&o.highlight(0),!this.opts.createSearchChoice&&!s.filter(".select2-result:not(.select2-selected)").length>0&&(!e||e&&!e.more&&0===this.results.find(".select2-no-results").length)&&C(o.opts.formatNoMatches,"formatNoMatches")&&this.results.append("<li class='select2-no-results'>"+D(o.opts.formatNoMatches,o.opts.element,o.search.val())+"</li>")},getMaxSearchWidth:function(){return this.selection.width()-l(this.search)},resizeSearch:function(){var e,t,i,n,r,s=l(this.search);e=v(this.search)+10,t=this.search.offset().left,i=this.selection.width(),n=this.selection.offset().left,r=i-(t-n)-s,e>r&&(r=i-s),40>r&&(r=i-s),0>=r&&(r=e),this.search.width(Math.floor(r))},getVal:function(){var e;return this.select?(e=this.select.val(),null===e?[]:e):(e=this.opts.element.val(),o(e,this.opts.separator,this.opts.transformVal))},setVal:function(t){var i;this.select?this.select.val(t):(i=[],e(t).each(function(){r(this,i)<0&&i.push(this)}),this.opts.element.val(0===i.length?"":i.join(this.opts.separator)))},buildChangeDetails:function(e,t){for(var t=t.slice(0),e=e.slice(0),i=0;i<t.length;i++)for(var n=0;n<e.length;n++)a(this.opts.id(t[i]),this.opts.id(e[n]))&&(t.splice(i,1),i>0&&i--,e.splice(n,1),n--);return{added:t,removed:e}},val:function(i,n){var r,s=this;if(0===arguments.length)return this.getVal();if(r=this.data(),r.length||(r=[]),!i&&0!==i)return this.opts.element.val(""),this.updateSelection([]),this.clearSearch(),void(n&&this.triggerChange({added:this.data(),removed:r}));if(this.setVal(i),this.select)this.opts.initSelection(this.select,this.bind(this.updateSelection)),n&&this.triggerChange(this.buildChangeDetails(r,this.data()));else{if(this.opts.initSelection===t)throw new Error("val() cannot be called if initSelection() is not defined");this.opts.initSelection(this.opts.element,function(t){var i=e.map(t,s.id);s.setVal(i),s.updateSelection(t),s.clearSearch(),n&&s.triggerChange(s.buildChangeDetails(r,s.data()))})}this.clearSearch()},onSortStart:function(){if(this.select)throw new Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.");this.search.width(0),this.searchContainer.hide()},onSortEnd:function(){var t=[],i=this;this.searchContainer.show(),this.searchContainer.appendTo(this.searchContainer.parent()),this.resizeSearch(),this.selection.find(".select2-search-choice").each(function(){t.push(i.opts.id(e(this).data("select2-data")))}),this.setVal(t),this.triggerChange()},data:function(t,i){var n,r,s=this;return 0===arguments.length?this.selection.children(".select2-search-choice").map(function(){
return e(this).data("select2-data")}).get():(r=this.data(),t||(t=[]),n=e.map(t,function(e){return s.opts.id(e)}),this.setVal(n),this.updateSelection(t),this.clearSearch(),void(i&&this.triggerChange(this.buildChangeDetails(r,this.data()))))}}),e.fn.select2=function(){var i,n,s,a,o,l=Array.prototype.slice.call(arguments,0),c=["val","destroy","opened","open","close","focus","isFocused","container","dropdown","onSortStart","onSortEnd","enable","disable","readonly","positionDropdown","data","search"],d=["opened","isFocused","container","dropdown"],h=["val","data"],u={search:"externalSearch"};return this.each(function(){if(0===l.length||"object"==typeof l[0])i=0===l.length?{}:e.extend({},l[0]),i.element=e(this),"select"===i.element.get(0).tagName.toLowerCase()?o=i.element.prop("multiple"):(o=i.multiple||!1,"tags"in i&&(i.multiple=o=!0)),n=o?new window.Select2["class"].multi:new window.Select2["class"].single,n.init(i);else{if("string"!=typeof l[0])throw"Invalid arguments to select2 plugin: "+l;if(r(l[0],c)<0)throw"Unknown method: "+l[0];if(a=t,n=e(this).data("select2"),n===t)return;if(s=l[0],"container"===s?a=n.container:"dropdown"===s?a=n.dropdown:(u[s]&&(s=u[s]),a=n[s].apply(n,l.slice(1))),r(l[0],d)>=0||r(l[0],h)>=0&&1==l.length)return!1}}),a===t?this:a},e.fn.select2.defaults={width:"copy",loadMorePadding:0,closeOnSelect:!0,openOnEnter:!0,containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",formatResult:function(e,t,i,n){var r=[];return y(this.text(e),i.term,r,n),r.join("")},transformVal:function(t){return e.trim(t)},formatSelection:function(e,i,n){return e?n(this.text(e)):t},sortResults:function(e){return e},formatResultCssClass:function(e){return e.css},formatSelectionCssClass:function(){return t},minimumResultsForSearch:0,minimumInputLength:0,maximumInputLength:null,maximumSelectionSize:0,id:function(e){return e==t?null:e.id},text:function(t){return t&&this.data&&this.data.text?e.isFunction(this.data.text)?this.data.text(t):t[this.data.text]:t.text},matcher:function(e,t){return n(""+t).toUpperCase().indexOf(n(""+e).toUpperCase())>=0},separator:",",tokenSeparators:[],tokenizer:j,escapeMarkup:b,blurOnChange:!1,selectOnBlur:!1,adaptContainerCssClass:function(e){return e},adaptDropdownCssClass:function(){return null},nextSearchTerm:function(){return t},searchInputPlaceholder:"",createSearchChoicePosition:"top",shouldFocusInput:function(e){var t="ontouchstart"in window||navigator.msMaxTouchPoints>0;return!t||!(e.opts.minimumResultsForSearch<0)}},e.fn.select2.locales=[],e.fn.select2.locales.en={formatMatches:function(e){return 1===e?"One result is available, press enter to select it.":e+" results are available, use up and down arrow keys to navigate."},formatNoMatches:function(){return"No matches found"},formatAjaxError:function(){return"Loading failed"},formatInputTooShort:function(e,t){var i=t-e.length;return"Please enter "+i+" or more character"+(1==i?"":"s")},formatInputTooLong:function(e,t){var i=e.length-t;return"Please delete "+i+" character"+(1==i?"":"s")},formatSelectionTooBig:function(e){return"You can only select "+e+" item"+(1==e?"":"s")},formatLoadMore:function(){return"Loading more results…"},formatSearching:function(){return"Searching…"}},e.extend(e.fn.select2.defaults,e.fn.select2.locales.en),e.fn.select2.ajaxDefaults={transport:e.ajax,params:{type:"GET",cache:!1,dataType:"json"}},window.Select2={query:{ajax:x,local:w,tags:k},util:{debounce:h,markMatch:y,escapeMarkup:b,stripDiacritics:n},"class":{"abstract":L,single:E,multi:O}}}}(jQuery),function(e,t,i,n){function r(i,n){this.w=e(t),this.el=e(i),this.options=e.extend({},d,n),this.init()}var s="ontouchstart"in t,a=function(){var e=i.createElement("div"),n=i.documentElement;if(!("pointerEvents"in e.style))return!1;e.style.pointerEvents="auto",e.style.pointerEvents="x",n.appendChild(e);var r=t.getComputedStyle&&"auto"===t.getComputedStyle(e,"").pointerEvents;return n.removeChild(e),!!r}(),o=s?"touchstart":"mousedown",l=s?"touchmove":"mousemove",c=s?"touchend":"mouseup";eCancel=s?"touchcancel":"mouseup";var d={listNodeName:"ol",itemNodeName:"li",rootClass:"dd",listClass:"dd-list",itemClass:"dd-item",dragClass:"dd-dragel",handleClass:"dd-handle",collapsedClass:"dd-collapsed",placeClass:"dd-placeholder",noDragClass:"dd-nodrag",emptyClass:"dd-empty",expandBtnHTML:'<button data-action="expand" type="button">Expand</button>',collapseBtnHTML:'<button data-action="collapse" type="button">Collapse</button>',group:0,maxDepth:1,threshold:20,dropCallback:null};r.prototype={init:function(){var i=this;i.reset(),i.el.data("nestable-group",this.options.group),i.placeEl=e('<div class="'+i.options.placeClass+'"/>'),e.each(this.el.find(i.options.itemNodeName),function(t,n){i.setParent(e(n))}),i.el.on("click","button",function(t){if(!i.dragEl&&(s||0===t.button)){var n=e(t.currentTarget),r=n.data("action"),a=n.parent(i.options.itemNodeName);"collapse"===r&&i.collapseItem(a),"expand"===r&&i.expandItem(a)}});var n=function(t){var n=e(t.target);if(!n.hasClass(i.options.handleClass)){if(n.closest("."+i.options.noDragClass).length)return;n=n.closest("."+i.options.handleClass)}!n.length||i.dragEl||!s&&0!==t.button||s&&1!==t.touches.length||(t.preventDefault(),i.dragStart(s?t.touches[0]:t))},r=function(e){i.dragEl&&(e.preventDefault(),i.dragMove(s?e.touches[0]:e))},a=function(e){i.dragEl&&(e.preventDefault(),i.dragStop(s?e.touches[0]:e))};s?(i.el[0].addEventListener(o,n,!1),t.addEventListener(l,r,!1),t.addEventListener(c,a,!1),t.addEventListener(eCancel,a,!1)):(i.el.on(o,n),i.w.on(l,r),i.w.on(c,a))},serialize:function(){var t,i=0,n=this;return step=function(t,i){var r=[],s=t.children(n.options.itemNodeName);return s.each(function(){var t=e(this),s=e.extend({},t.data()),a=t.children(n.options.listNodeName);a.length&&(s.children=step(a,i+1)),r.push(s)}),r},t=step(n.el.find(n.options.listNodeName).first(),i)},serialise:function(){return this.serialize()},reset:function(){this.mouse={offsetX:0,offsetY:0,startX:0,startY:0,lastX:0,lastY:0,nowX:0,nowY:0,distX:0,distY:0,dirAx:0,dirX:0,dirY:0,lastDirX:0,lastDirY:0,distAxX:0,distAxY:0},this.moving=!1,this.dragEl=null,this.dragRootEl=null,this.dragDepth=0,this.hasNewRoot=!1,this.pointEl=null,this.sourceRoot=null},expandItem:function(e){e.removeClass(this.options.collapsedClass),e.children('[data-action="expand"]').hide(),e.children('[data-action="collapse"]').show(),e.children(this.options.listNodeName).show()},collapseItem:function(e){var t=e.children(this.options.listNodeName);t.length&&(e.addClass(this.options.collapsedClass),e.children('[data-action="collapse"]').hide(),e.children('[data-action="expand"]').show(),e.children(this.options.listNodeName).hide())},expandAll:function(){var t=this;t.el.find(t.options.itemNodeName).each(function(){t.expandItem(e(this))})},collapseAll:function(){var t=this;t.el.find(t.options.itemNodeName).each(function(){t.collapseItem(e(this))})},setParent:function(t){t.children(this.options.listNodeName).length&&(t.prepend(e(this.options.expandBtnHTML)),t.prepend(e(this.options.collapseBtnHTML))),t.children('[data-action="expand"]').hide()},unsetParent:function(e){e.removeClass(this.options.collapsedClass),e.children("[data-action]").remove(),e.children(this.options.listNodeName).remove()},dragStart:function(t){var r=this.mouse,s=e(t.target),a=s.closest(this.options.itemNodeName);this.sourceRoot=s.closest("."+this.options.rootClass),this.placeEl.css("height",a.height()),r.offsetX=t.offsetX!==n?t.offsetX:t.pageX-s.offset().left,r.offsetY=t.offsetY!==n?t.offsetY:t.pageY-s.offset().top,r.startX=r.lastX=t.pageX,r.startY=r.lastY=t.pageY,this.dragRootEl=this.el,this.dragEl=e(i.createElement(this.options.listNodeName)).addClass(this.options.listClass+" "+this.options.dragClass),this.dragEl.css("width",a.width()),a.after(this.placeEl),a[0].parentNode.removeChild(a[0]),a.appendTo(this.dragEl),e(i.body).append(this.dragEl),this.dragEl.css({left:t.pageX-r.offsetX,top:t.pageY-r.offsetY});var o,l,c=this.dragEl.find(this.options.itemNodeName);for(o=0;o<c.length;o++)l=e(c[o]).parents(this.options.listNodeName).length,l>this.dragDepth&&(this.dragDepth=l)},dragStop:function(t){var i=this.dragEl.children(this.options.itemNodeName).first();i[0].parentNode.removeChild(i[0]),this.placeEl.replaceWith(i),this.dragEl.remove(),this.el.trigger("change");var n=i.parent().parent(),r=null;if(null===n||n.is("."+this.options.rootClass)||(r=n.data("id")),e.isFunction(this.options.dropCallback)){var s={sourceId:i.data("id"),destId:r,sourceEl:i,destParent:n,destRoot:i.closest("."+this.options.rootClass),sourceRoot:this.sourceRoot};this.options.dropCallback.call(this,s)}this.hasNewRoot&&this.dragRootEl.trigger("change"),this.reset()},dragMove:function(n){var r,s,o,l,c,d=this.options,h=this.mouse;this.dragEl.css({left:n.pageX-h.offsetX,top:n.pageY-h.offsetY}),h.lastX=h.nowX,h.lastY=h.nowY,h.nowX=n.pageX,h.nowY=n.pageY,h.distX=h.nowX-h.lastX,h.distY=h.nowY-h.lastY,h.lastDirX=h.dirX,h.lastDirY=h.dirY,h.dirX=0===h.distX?0:h.distX>0?1:-1,h.dirY=0===h.distY?0:h.distY>0?1:-1;var u=Math.abs(h.distX)>Math.abs(h.distY)?1:0;if(!h.moving)return h.dirAx=u,void(h.moving=!0);h.dirAx!==u?(h.distAxX=0,h.distAxY=0):(h.distAxX+=Math.abs(h.distX),0!==h.dirX&&h.dirX!==h.lastDirX&&(h.distAxX=0),h.distAxY+=Math.abs(h.distY),0!==h.dirY&&h.dirY!==h.lastDirY&&(h.distAxY=0)),h.dirAx=u,h.dirAx&&h.distAxX>=d.threshold&&(h.distAxX=0,o=this.placeEl.prev(d.itemNodeName),h.distX>0&&o.length&&!o.hasClass(d.collapsedClass)&&(r=o.find(d.listNodeName).last(),c=this.placeEl.parents(d.listNodeName).length,c+this.dragDepth<=d.maxDepth&&(r.length?(r=o.children(d.listNodeName).last(),r.append(this.placeEl)):(r=e("<"+d.listNodeName+"/>").addClass(d.listClass),r.append(this.placeEl),o.append(r),this.setParent(o)))),h.distX<0&&(l=this.placeEl.next(d.itemNodeName),l.length||(s=this.placeEl.parent(),this.placeEl.closest(d.itemNodeName).after(this.placeEl),s.children().length||this.unsetParent(s.parent()))));var f=!1;if(a||(this.dragEl[0].style.visibility="hidden"),this.pointEl=e(i.elementFromPoint(n.pageX-i.body.scrollLeft,n.pageY-(t.pageYOffset||i.documentElement.scrollTop))),a||(this.dragEl[0].style.visibility="visible"),this.pointEl.hasClass(d.handleClass)&&(this.pointEl=this.pointEl.parent(d.itemNodeName)),this.pointEl.hasClass(d.emptyClass))f=!0;else if(!this.pointEl.length||!this.pointEl.hasClass(d.itemClass))return;var p=this.pointEl.closest("."+d.rootClass),m=this.dragRootEl.data("nestable-id")!==p.data("nestable-id");if(!h.dirAx||m||f){if(m&&d.group!==p.data("nestable-group"))return;if(c=this.dragDepth-1+this.pointEl.parents(d.listNodeName).length,c>d.maxDepth)return;var g=n.pageY<this.pointEl.offset().top+this.pointEl.height()/2;s=this.placeEl.parent(),f?(r=e(i.createElement(d.listNodeName)).addClass(d.listClass),r.append(this.placeEl),this.pointEl.replaceWith(r)):g?this.pointEl.before(this.placeEl):this.pointEl.after(this.placeEl),s.children().length||this.unsetParent(s.parent()),this.dragRootEl.find(d.itemNodeName).length||this.dragRootEl.append('<div class="'+d.emptyClass+'"/>'),m&&(this.dragRootEl=p,this.hasNewRoot=this.el[0]!==this.dragRootEl[0])}}},e.fn.nestable=function(t){var i=this,n=this;return i.each(function(){var i=e(this).data("nestable");i?"string"==typeof t&&"function"==typeof i[t]&&(n=i[t]()):(e(this).data("nestable",new r(this,t)),e(this).data("nestable-id",(new Date).getTime()))}),n||i}}(window.jQuery||window.Zepto,window,document);var DateRange=function(){var e=null,t=["Janvāris","Februāris","Marts","Aprīlis","Maijs","Jūnijs","Jūlijs","Augusts","Septembris","Oktobris","Novembris","Decembris"],i=[],n=null,r=function(e){if(0==e.length)return"";var t=e.split("-");return t[2]+"."+t[1]+"."+t[0]},s=function(e){if(0==e.length)return"";var i=e.split("-");return parseInt(i[2])+" "+t[parseInt(i[1])-1]+", "+i[0]},a=function(e,t){return 0==e.length||0==t.length?"":s(e)+" - "+s(t)},o=function(){if(jQuery().daterangepicker){$("#"+i.range_id).daterangepicker({opens:App.isRTL()?"left":"right",locale:{format:"DD.MM.YYYY",separator:" - ",applyLabel:"Labi",cancelLabel:"Atcelt",fromLabel:"No",toLabel:"Līdz",customRangeLabel:"Intervāls",daysOfWeek:["Sv","P","O","T","C","P","S"],monthNames:t,firstDay:1},startDate:moment().subtract("days",29),endDate:moment(),ranges:i.arr_ranges,autoUpdateInput:!0,alwaysShowCalendars:!0},function(e,t){$("#"+i.range_id+" input").val(a(e.format("YYYY-MM-DD"),t.format("YYYY-MM-DD")))}),$("#"+i.range_id).on("apply.daterangepicker",function(t,r){e.find("[name="+i.el_date_from+"]").val(r.startDate.format("YYYY-MM-DD")),e.find("[name="+i.el_date_to+"]").val(r.endDate.format("YYYY-MM-DD")),n()});var s=e.find("[name="+i.el_date_from+"]").val(),o=e.find("[name="+i.el_date_to+"]").val();s&&o&&($("#"+i.range_id).data("daterangepicker").setStartDate(r(s)),$("#"+i.range_id).data("daterangepicker").setEndDate(r(o)),$("#"+i.range_id+" input").val(a(s,o)))}},l=function(t,r){i=t,n=r;var s=$(i.page_selector);e=s.find(i.form_selector),o()};return{init:function(e,t){l(e,t)}}}();$(document).ready(function(e){init_textarea()}),$(document).on("focusin",function(e){$(e.target).closest(".mce-window").length&&e.stopImmediatePropagation()});var SearchTools=function(){var e=null,t=null,i=null,n=function(){var n=e.find(".search-tools-btn");if(n.find("i").hasClass("fa-caret-down"))n.find("i").removeClass("fa-caret-down").addClass("fa-caret-up"),n.removeClass("btn-primary").addClass("btn-default"),e.removeClass("search-tools-hiden").addClass("search-tools-shown");else{n.find("i").removeClass("fa-caret-up").addClass("fa-caret-down"),n.removeClass("btn-default").addClass("btn-primary"),e.removeClass("search-tools-shown").addClass("search-tools-hiden");var r=e.find("input[name=criteria]").val();i(),e.find("input[name=criteria]").val(r),t()}},r=function(){e.find(".search-simple-btn").click(function(t){show_page_splash(),e.submit()})},s=function(){e.find(".search-tools-btn").click(function(e){n()})},a=function(n,a){e=$(".search-tools-form"),t=n,i=a,r(),s()};return{init:function(e,t){a(e,t)},showHideTools:function(){n()}}}(),BlockViews=function(){var e="",t=0,i=0,n=function(e,t){t?reload_tab_grid(e):reload_grid(e)},r=function(e){var i=null;i=e?$("#"+e).find(".modal-body"):$(document),setTimeout(function(){i.scrollTop(t)},100)},s=function(e){var i=null;i=e?$("#"+e).find(".modal-body"):$(document),t=i.scrollTop()},a=function(e,t,i){$("#paginator_"+e+" .dx-paginator-butons button").on("click",function(r){r.preventDefault(),$("#"+e).data("grid_page_nr",$(this).attr("data_page_nr")),$("#"+e).data("view_id",$("#"+i+"_viewcbo option:selected").val()),n(e,t)})},o=function(t,i,n,r,s,a){$("#"+t+"_viewcbo").change(function(o){if(o.preventDefault(),i)load_tab_grid(i,n,$("#"+t+"_viewcbo option:selected").val(),r,s,a,1,5,1);else{var l=e+"skats_"+$("#"+t+"_viewcbo option:selected").val();window.location.assign(encodeURI(l))}})},l=function(e,t){$("#filter_"+e+" input").on("keypress",function(i){13===i.which&&($("#"+e).data("grid_page_nr","1"),n(e,t))})},c=function(e,t){$("#"+e+" th.t_header").on("click",function(i){i.preventDefault(),$("#"+e).data("sorting_field")==$(this).attr("fld_name")?"1"==$("#"+e).data("sorting_direction")?$("#"+e).data("sorting_direction","2"):"2"==$("#"+e).data("sorting_direction")&&($("#"+e).data("sorting_direction","0"),$("#"+e).data("sorting_field","")):($("#"+e).data("sorting_field",$(this).attr("fld_name")),$("#"+e).data("sorting_direction","1")),n(e,t)})},d=function(e,t,i,n,r,s){$("#"+t+"_new").button().click(function(t){t.preventDefault(),new_list_item(i,n,r,s,e)})},h=function(e,t,i){$("#"+e+"_refresh").button().click(function(e){e.preventDefault(),n(t,i)})},u=function(e,t,i,n){$("#"+e+"_excel").button().click(function(e){e.preventDefault(),download_excel(t,i,n)})},f=function(e){$("#"+e+"_import").button().click(function(t){t.preventDefault();var i=$("#form_import_"+e);i.modal("show")})},p=function(e){$("#btn_start_import_"+e).button().click(function(t){t.preventDefault();var i=$("#form_import_"+e),n=i.find("input[name=import_file]").val(),r=new FormData;if(!process_Input_simple(i.attr("id"),r)||0==n.length)return void notify_err(i.attr("data-trans-invalid-file"));var s=n.split(".").pop().toLowerCase();if($.inArray(s,["xlsx"])==-1&&$.inArray(s,["xls"])==-1&&$.inArray(s,["csv"])==-1)return void notify_err(i.attr("data-trans-invalid-file-format"));r.append("list_id",i.attr("data-list-id")),i.find(".dx-import-fields").hide(),i.find(".dx-import-progress").show(),i.find(".alert-error").hide(),$("#btn_start_import_"+e).hide();var a=new FormAjaxRequest("import_excel","","",r);a.progress_info="",a.err_callback=function(t){i.find(".dx-import-progress").hide(),i.find(".dx-import-fields").show(),$("#btn_start_import_"+e).show(),i.find(".alert-error").html(t).show()},a.callback=function(e){reload_grid(i.attr("data-grid-id")),notify_info(i.attr("data-trans-success")+e.count),i.find(".dx-import-progress").hide(),i.find(".alert-info").html(i.attr("data-trans-success")+e.count).show(),m(e,i)},a.doRequest()})},m=function(e,t){var i=[];i[0]=v(t,e.not_match),i[1]=g(t,e.duplicate,"data-trans-excel-row"),i[2]=g(t,e.dependency,"data-trans-excel-dependent");for(var n="",r=0;r<i.length;r++)n.length>0&&(n+="<br /><br />"),n+=i[r];n.length>0&&t.find(".alert-error").html(n).show()},g=function(e,t,i){if(!t)return"";var n="";return t.length>0&&(n=e.attr(i)+t),n},v=function(e,t){if(!t)return"";var i="",n=function(e,t){i.length>0&&(i+=", "),i+=e};return t.forEach(n),i.length>0&&(i=e.attr("data-trans-ignored-columns")+i),i},_=function(e,t,i,n,r,s){$("#"+t+" a.dx-grid-cmd-view").click(function(a){a.preventDefault(),show_form_splash(),show_page_splash(),view_list_item(e,$(this).attr("dx_item_id"),i,n,r,t,s)})},y=function(e,t,i,n,r){$("#"+t+" a.dx-grid-cmd-edit").click(function(s){s.preventDefault(),show_form_splash(),show_page_splash(),open_form(e,$(this).attr("dx_item_id"),i,n,r,t,1,"")})},b=function(e,t){$("#"+e+" a.dx-grid-cmd-delete").click(function(i){i.preventDefault(),confirm(DX_CORE.trans_confirm_delete)&&delete_multiple_items(t,e,$(this).attr("dx_item_id"),1)})},x=function(e,t,i){$("#paginator_"+t+" a.dx-grid-cmd-delall").click(function(n){n.preventDefault();var r="",s=0;if($("#"+t+" input.dx-grid-input-check:checked").each(function(){r.length>0&&(r+="|"),r+=$(this).attr("dx_item_id"),s++}),0===s)return void notify_err(e.attr("data-trans-msg-marked"));var a=e.attr("data-trans-confirm-del1");s>1&&(a=e.attr("data-trans-confirm-del-all").replace("%s",s)),confirm(a)&&delete_multiple_items(i,t,r,s>1?0:1)})},w=function(e,t){$("#paginator_"+e+" a.dx-grid-cmd-markall").click(function(i){s(t);var n=0;$("#"+e+" input.dx-grid-input-check").each(function(){$(this).prop("checked",!0),n++}),$("#paginator_"+e+" span.dx-marked-count-lbl").text(n),r(t)})},k=function(e){$("#"+e+" input.dx-grid-input-check").change(function(){$("#paginator_"+e+" span.dx-marked-count-lbl").text($("#"+e+" input.dx-grid-input-check:checked").length)})},C=function(e,t,i){e.find(".dx-register-tools a.dx-register-settings").click(function(){view_list_item("form",i,3,0,0,t,"")})},D=function(e,t,n,r,s,a,o){if(!(i>0)){var l=parseInt(e.attr("dx_open_item_id"));!isNaN(l)&&l>0&&(i=l,view_list_item(t,l,r,s,a,n,o))}},S=function(){e=getBaseUrl(),$(".dx-block-container-view[dx_block_init='0']").each(function(){var e=$(this).attr("dx_grid_id"),t=$(this).attr("dx_tab_id"),i=$(this).attr("dx_menu_id"),n=$(this).attr("dx_list_id"),r=$(this).attr("dx_rel_field_id"),s=$(this).attr("dx_rel_field_value"),m=$(this).attr("dx_form_htm_id"),g=$(this).attr("dx_view_id"),v=$(this).attr("dx_grid_form");o(i,t,n,r,s,m),d(e,i,n,r,s,m),h(i,e,t),u(i,g,r,s),C($(this),e,n),f(i),p(i),l(e,t),c(e,t),a(e,t,i),_(v,e,n,r,s,m),y(v,e,n,r,s),b(e,n),x($(this),e,n),w(e,m),k(e),D($(this),v,e,n,r,s,m),$(this).attr("dx_block_init",1)})};return{init:function(){S()}}}();$(function(){BlockViews.init()}),$(document).ajaxComplete(function(e,t,i){BlockViews.init()});var TaskLogic=function(){var e=function(e){var t=i(e);if(null!=t){var n=new FormAjaxRequest("save_delegate","","",t);n.callback=function(t){var i=e.attr("dx_frm_uniq_id");$("#item_edit_form_"+i).find("input[name=task_status]").val(t.status),reload_grid(e.attr("dx_grid_htm_id")),notify_info("Uzdevums veiksmīgi deleģēts!")},n.doRequest()}},t=function(e,t){var i="list_item_view_form_"+t.attr("dx_frm_uniq_id"),s=n(i,e);if(null!=s){var a=new FormAjaxRequest(e,i,t.attr("dx_grid_htm_id"),s);a.callback=function(e){r(t,e)},a.doRequest()}},i=function(e){var t=e.find("select[name=employee_id]").val();if(0==t)return notify_err("Jānorāda darbinieks, kuram tiks deleģēts uzdevums!"),e.find("select[name=employee_id]").focus(),null;var i=e.find("textarea[name=task_txt]").val();if(0==i.length)return notify_err("Jānorāda uzdevuma apraksts!"),e.find("textarea[name=task_txt]").focus(),null;var n=new FormData;return n.append("employee_id",t),n.append("task_txt",i),n.append("task_id",e.attr("dx_task_id")),n.append("due_date",e.find("input[name=due_date]").val()),n},n=function(e,t){var i=$("#"+e+" textarea[name='task_comment']").val().trim();if("task_no"==t&&0==i.length)return notify_err("Noraidīšanas gadījumā ir obligāti jānorāda komentārs!"),$("#"+e+" textarea[name='task_comment']").focus(),null;var n=$("#"+e+" input[name='item_id']").val(),r=new FormData;return r.append("task_comment",i),r.append("item_id",n),r},r=function(e,t){try{if(1==t.success){var i="list_item_view_form_"+e.attr("dx_frm_uniq_id"),n=e.attr("dx_grid_htm_id");n&&reload_grid(n),$("#"+i+" input[name='task_status']").val(t.task_status),$("#"+i+" textarea[name='task_comment']").attr("disabled","disabled"),$("#btns_sec_"+e.attr("dx_frm_uniq_id")).hide(),0==t.tasks_count?($("#dx_tasks_count_li").hide(),setTimeout(function(){$.gritter.add({title:"Apsveicam!",text:'<i class="fa fa-thumbs-o-up"></i> Labs darbs - jums visi uzdevumi ir izpildīti.',time:7e3})},3e3)):$("#dx_tasks_count_badge").html(t.tasks_count),notify_info("Uzdevuma dati veiksmīgi saglabāti!")}else notify_err(t.error)}catch(r){notify_err(escapeHtml(r))}},s=function(e){e.find(".dx-cms-task-btn-open-item").click(function(){rel_new_form(e.attr("dx_form_url"),e.attr("dx_rel_list_id"),e.attr("dx_item_id"),e.attr("dx_rel_field_id"),"list_item_view_form_"+e.attr("dx_frm_uniq_id"),null)})},a=function(e){e.find(".dx-cms-task-btn-delegate").click(function(t){t.stopPropagation();var i=$("#form_delegate_"+e.attr("dx_frm_uniq_id"));"0"==i.attr("dx_is_init")&&(p(i),i.find("textarea[name=task_txt]").html(e.find("input[name=task_title]").val())),i.modal("show"),setTimeout(function(){i.find("select[name=employee_id]").focus()},1e3)})},o=function(e){e.find(".dx-cms-task-btn-yes").click(function(i){i.stopPropagation(),t("task_yes",e)})},l=function(e){e.find(".dx-cms-task-btn-no").click(function(i){i.stopPropagation(),t("task_no",e)})},c=function(e){e.on("show.bs.modal",function(){e.find(".modal-body").css("overflow-y","auto")})},d=function(e){e.on("hidden.bs.modal",function(t){var i=e.attr("dx_grid_htm_id");i&&stop_executing(i),setTimeout(function(){e.remove()},200)})},h=function(t){t.find(".dx-cms-task-btn-delegate").click(function(i){i.stopPropagation(),t.find("form").validator("validate"),e(t)})},u=function(e){e.find(".dx-cms-date-field input[name=due_date]").datetimepicker({lang:"lv",format:e.attr("dx_date_format"),timepicker:!1,dayOfWeekStart:1,closeOnDateSelect:!0}),e.find(".dx-cms-date-field button").click(function(){e.find(".dx-cms-date-field input[name=due_date]").datetimepicker("show")})},f=function(e){e.find("form").validator({custom:{foo:function(e){return e.val()>0||!e.attr("required")}},errors:{foo:"Nav norādīta vērtība!"},feedback:{success:"glyphicon-ok",error:"glyphicon-alert"}})},p=function(e){h(e),f(e),u(e),e.attr("dx_is_init",1)},m=function(){$(".dx-cms-task-form[dx_is_init='0']").each(function(){c($(this)),d($(this)),s($(this)),a($(this)),o($(this)),l($(this)),$(this).attr("dx_is_init",1),$(this).modal("show")})};return{init:function(){m()}}}();$(document).ajaxComplete(function(e,t,i){TaskLogic.init()});var FormLogic=function(){function e(e,t,i,n,r,s,a,o){var l=new FormData;l.append("list_id",n),l.append("item_id",r),l.append("approvers",s),l.append("is_paralel",o);var c=new FormAjaxRequest(e,t,i,l);c.callback=function(e){i&&reload_grid(i),$("#"+t+" input[dx_fld_name='dx_item_status_id']").val(e.doc_status),$("#top_toolbar_"+t).hide(),notify_info("Darbplūsmas process veiksmīgi uzsākts!"),$("#"+t+" button[dx_attr='refresh']").click(),a&&a.modal("hide")},c.doRequest()}var t="",i=function(e){var t=e.parent().find("input[name=item_id]").val(),i=e.find(".dx-reg-nr-field").attr("dx_list_id"),n=e.find(".dx-reg-nr-field").attr("dx_reg_nr_field_id"),r="item_id="+t+"&list_id="+i+"&regn_nr_field_id="+n,s=e.attr("dx_grid_id"),a=new FormAjaxRequestIE9("register_document","",s,r);a.progress_info="Reģistrēšana... Lūdzu, uzgaidiet...",a.callback=function(t){e.find(".dx-reg-nr-field input").val(t.reg_nr),t.reg_date_fld&&e.find("div[dx_fld_name="+t.reg_date_fld+"]").html(t.reg_date_htm),e.find(".dx-reg-nr-field .input-group-btn").hide(),s&&reload_grid(s),notify_info("Dokuments veiksmīgi reģistrēts!")},a.doRequest()},n=function(e,i){var n=$("#form_init_wf_"+e.attr("dx_form_id"));"0"==n.attr("dx_is_init")&&a(n,e);var o=new FormData;o.append("list_id",e.attr("dx_list_id")),o.append("item_id",i);var l=new FormAjaxRequest("workflow_custom_approve","","",o);l.callback=function(e){var i=n.find(".modal-body .dx-cms-init-approvers");i.html(e.html),t=r(i),n.find(".dx-cms-nested-list").nestable(),s(i),n.modal("show")},l.doRequest()},r=function(e){var t=new Array;return e.find(".dd-item").each(function(){var e={empl_id:$(this).attr("data-id"),due_days:$(this).find("input[name=due_days]").val()};t.push(e)}),JSON.stringify(t)},s=function(e){e.find(".dx-cms-approver-remove[dx_is_init=0]").click(function(){$(this).parent().parent().parent().parent().remove()}),e.find(".dx-cms-approver-remove[dx_is_init=0]").attr("dx_is_init",1)},a=function(e,t){l(e),c(e);var i=$("#form_init_wf_approver_"+e.attr("dx_frm_uniq_id"));d(i),o(e,t),e.attr("dx_is_init",1)},o=function(i,n){i.find(".dx-cms-wf-btn-start").click(function(){var s=$("#item_edit_form_"+n.attr("dx_form_id")+" input[name='item_id']").val(),a=i.find(".modal-body .dx-cms-init-approvers"),o=r(a);if("[]"==o)return void notify_err("Lūdzu, norādiet vismaz vienu saskaņotāju!");var l=0;t==o?o="":l=i.find("input[name=order]:checked").val(),e("workflow_init","list_item_view_form_"+n.attr("dx_form_id"),n.attr("dx_grid_id"),n.attr("dx_list_id"),s,o,i,l)})},l=function(e){var t=$("#form_init_wf_approver_"+e.attr("dx_frm_uniq_id"));t.on("shown",function(){t.find("input[name=empl_txt]").select2("data",{id:0,text:"",position_title:""}),t.find("input[name=empl_txt]").select2("open"),t.find(".dx-cms-empl-position-title").text("")}),e.find(".dx-cms-wf-btn-add-approver").click(function(){t.modal("show")})},c=function(e){var t=$("#form_init_wf_approver_"+e.attr("dx_frm_uniq_id"));t.find(".dx-cms-wf-btn-add-approver").click(function(){var i=t.find("input[name=empl_txt]").select2("data");if(!i||0==i.id)return void notify_err(t.attr("dx_error_empl_not_set"));if(h(e,i.id)){var n=t.find(".dx-cms-approver-item-template").html();n=n.replace("[empl_id]",i.id),n=n.replace("[display_name]",i.text),n=n.replace("[position_title]",i.position_title),n=n.replace("[due_days]",1);var r=e.find(".modal-body .dx-cms-nested-list");r.append(n),s(r),e.find(".dx-cms-nested-list").nestable("init"),t.find("input[name=empl_txt]").select2("data",{id:0,text:"",position_title:""}),t.find(".dx-cms-empl-position-title").text(""),t.find("input[name=empl_txt]").select2("open"),notify_info(t.attr("dx_added_success"))}})},d=function(e){e.find("input[name=empl_txt]").select2({placeholder:e.attr("dx_search_placeholder"),minimumInputLength:3,ajax:{type:"POST",url:DX_CORE.site_url+"workflow_find_approver",processData:!1,contentType:!1,dataType:"json",quietMillis:250,cache:!0,data:function(e,t){return{q:e}},results:function(t,i){return 1==t.success?{results:t.data}:void(t.error?notify_err(t.error):notify_err(e.attr("dx_system_error")))},error:function(t,i,n){if(422===t.status){var r=t.responseJSON,s="<ul>";$.each(r,function(e,t){s+="<li>"+t[0]+"</li>"}),s+="</ul>",toastr.error(s)}else notify_err(e.attr("dx_system_error"))}}}).on("change",function(t){var i=$(this).select2("data"),n="";i&&(n=i.position_title),e.find(".dx-cms-empl-position-title").text(n)})},h=function(e,t){if(e.find(".modal-body .dx-cms-init-approvers").find(".dd-item[data-id="+t+"]").length>0){var i=$("#form_init_wf_approver_"+e.attr("dx_frm_uniq_id"));return notify_err(i.attr("dx_error_already_added")),!1}return!0},u=function(e){e.find(".dx-reg-nr-field button").click(function(){confirm("Lūdzu, apstipriniet - vai reģistrēt dokumentu?")&&i(e)})},f=function(t){$("#list_item_view_form_"+t.attr("dx_form_id")).find(".dx-init-wf-btn").click(function(){var i=$("#item_edit_form_"+t.attr("dx_form_id")+" input[name='item_id']").val();return 0===i?void notify_err("Lai uzsāktu darbplūsmu, vispirms veiciet datu saglabāšanu!"):void("1"==t.attr("dx_is_custom_approve")?n(t,i):e("workflow_init","list_item_view_form_"+t.attr("dx_form_id"),t.attr("dx_grid_id"),t.attr("dx_list_id"),i,"",null,0))})},p=function(e){$("#list_item_view_form_"+e.attr("dx_form_id")).find(".dx-for-info-btn").click(function(){var t=$("#item_edit_form_"+e.attr("dx_form_id")+" input[name='item_id']").val();if(0===t)return void notify_err("Lai dokumentu nodotu informācijai, vispirms tas ir jāsaglabā!");var i=$("#form_task_info_"+e.attr("dx_form_id"));"0"==i.attr("dx_is_init")&&(d(i),m(i,e,t),App.initSlimScroll(".scroller"),i.attr("dx_is_init","1")),i.on("shown",function(){var e=parseInt(i.find(".dx-cms-info-task-count").text());0==e&&(i.find("input[name=empl_txt]").select2("data",{id:0,text:"",position_title:""}),i.find("input[name=empl_txt]").select2("open"),i.find(".dx-cms-empl-position-title").text(""))}),i.modal("show")})},m=function(e,t,i){e.find(".dx-cms-info-btn-send").click(function(){var n=e.find("input[name=empl_txt]").select2("data");if(!n||0==n.id)return notify_err(e.attr("dx_error_empl_not_set")),void e.find("input[name=empl_txt]").select2("open");var r=new FormData;r.append("list_id",t.attr("dx_list_id")),r.append("item_id",i),r.append("empl_id",n.id),r.append("task_info",e.find("textarea[name=task_details]").val());var s=new FormAjaxRequest("send_info_task","","",r);s.callback=function(){notify_info("Dokuments veiksmīgi nodots informācijai darbiniekam "+n.text+"!"),e.find(".dx-cms-no-info").remove(),e.find(".dx-cms-info-list .scroller").append("<p>"+n.text+"</p>");var i=parseInt(e.find(".dx-cms-info-task-count").text())+1;$("#list_item_view_form_"+t.attr("dx_form_id")).find(".dx-cms-info-task-count").text(i),$("#list_item_view_form_"+t.attr("dx_form_id")).find(".dx-cms-info-task-count").show(),e.find(".dx-cms-info-task-count").text(i),e.find("input[name=empl_txt]").select2("data",{id:0,text:"",position_title:""}),e.find(".dx-cms-empl-position-title").text("")},s.doRequest()})},g=function(e){var t=$("#list_item_view_form_"+e.attr("dx_form_id"));t.on("shown",function(){v(e)})},v=function(e){var t=$("#item_edit_form_"+e.attr("dx_form_id")),i=t.find(".dx-cms-left-tabs");if(i.length>0){var n=i.first().width(),r=-(n+40+2);t.find(".tab-content .form-horizontal").each(function(){$(this).css("margin-left",r+"px")}),t.find(".tab-content .dx-group-label").each(function(){$(this).css("margin-left",Math.abs(r)+"px")})}},_=function(e){setTimeout(function(){e.find(":input:enabled:visible:not(.dx-not-focus):first").focus()},1e3)},y=function(){$(".dx-cms-form-fields-section[dx_is_init='0']").each(function(){u($(this)),f($(this)),p($(this)),g($(this)),_($(this)),$(this).attr("dx_is_init",1)})};return{init:function(){y()},adjustDataTabs:function(e){v(e)}}}();$(document).ajaxComplete(function(e,t,i){FormLogic.init()});var TreeField=function(){var e=null,t=0,i=0,n="",r=function(){$("#tree_form .dx-tree-content").on("changed.jstree",function(e,i){$("#tree_form_txt").html(i.instance.get_node(i.selected[0],!0).attr("data-full")),
t=i.instance.get_node(i.selected[0],!0).attr("data-id")})},s=function(e){e.find(".dx-tree-btn-del").click(function(){e.find(".dx-tree-txt-visible").val(""),e.find(".dx-tree-txt-hidden").val("")})},a=function(i){i.find(".dx-tree-btn-add").click(function(){n!=i.attr("dx_tree_id")&&($("#tree_form .dx-tree-frame").html("<div class='dx-tree-content'></div>"),$("#tree_form .dx-tree-content").html(i.attr("dx_tree_content")),$("#tree_form .modal-title").html(i.attr("dx_tree_title")),$("#tree_form_txt").html(i.attr("dx_tree_default_node_txt")),t=i.attr("dx_tree_item_value"),e=i,$("#tree_form .dx-tree-content").jstree({core:{multiple:!1}}),r(),n=i.attr("dx_tree_id")),$("#tree_form").modal("show")})},o=function(){$("#tree_form .dx-tree-btn-choose").click(function(){e.find(".dx-tree-txt-visible").val($("#tree_form_txt").text()),e.find(".dx-tree-txt-hidden").val(t),$("#tree_form").modal("hide")})},l=function(){var e="";e+="<div class='modal fade' aria-hidden='true' id='tree_form' role='dialog' data-backdrop='static'>",e+="\t<div class='modal-dialog modal-md'>",e+="\t\t<div class='modal-content' style='margin-top: -20px;'>",e+="",e+="\t\t\t<div class='modal-header' style='background-color: #31708f;'>",e+="\t\t\t\t<button type='button' class='close' data-dismiss='modal' title='"+DX_CORE.trans_tree_close+"'><i class='fa fa-times' style='color: white'></i></button>",e+="\t\t\t\t<h4 class='modal-title' style='color: white;'>",e+="\t\t\t\t</h4>",e+="\t\t\t</div>",e+="",e+="\t\t\t<div class='modal-body'>",e+="\t\t\t\t<div style='margin-left: 20px;'>",e+="\t\t\t\t\t<div class='dx-tree-frame' style='height: 350px; overflow-y: auto; border-width: 1px; border-color: lightgray; border-style: solid; margin-bottom: 20px;'>",e+="\t\t\t\t\t\t<div class='dx-tree-content'>",e+="\t\t\t\t\t\t</div>",e+="\t\t\t\t\t</div>",e+="\t\t\t\t\t<div class='alert alert-info'>",e+="\t\t\t\t\t\t<p><b>"+DX_CORE.trans_tree_chosen+"</b></p>",e+="\t\t\t\t\t\t<p id='tree_form_txt'></p>",e+="\t\t\t\t\t</div>",e+="\t\t\t\t</div>",e+="\t\t\t</div>",e+="\t\t\t<div class='modal-footer'>",e+="\t\t\t\t<button type='button' class='btn btn-primary dx-tree-btn-choose'><i class='fa fa-check'></i>&nbsp;"+DX_CORE.trans_tree_choose+"</button>",e+="\t\t\t\t<button type='button' class='btn btn-white' data-dismiss='modal'><i class='fa fa-undo'></i>&nbsp;"+DX_CORE.trans_tree_cancel+"</button>",e+="\t\t\t</div>",e+="\t\t</div>",e+="\t</div>",e+="</div>",$("body").append(e)},c=function(){0==i&&(l(),o(),i=1),$(".dx-tree-field[dx_is_init=0]").each(function(){s($(this)),a($(this)),$(this).attr("dx_is_init",1)})};return{init:function(){c()}}}();$(document).ajaxComplete(function(e,t,i){TreeField.init()});var RelIdField=function(){var e=function(e){e.find(".dx-rel-id-add-btn").click(function(){rel_new_form(e.attr("data-form-url"),e.attr("data-rel-list-id"),0,e.attr("data-rel-field-id"),e.attr("id"),"RelIdField")})},t=function(e){e.find(".dx-rel-id-edit-btn").click(function(){var t=0,i=e.find("select");return i.length>0&&(t=i.val()),0==t?void notify_err(e.attr("data-trans-must-choose")):void rel_new_form(e.attr("data-form-url"),e.attr("data-rel-list-id"),t,e.attr("data-rel-field-id"),e.attr("id"),"RelIdField")})},i=function(e,t,i){var n=$("#"+e).find("select");if(n&&n.length>0){var r=n.find("option[value="+t+"]");r.length>0?r.html(i):n.append($("<option></option>").val(t).html(i).attr("selected",!0))}else{var s=$("#"+e).find("input.dx-rel-id-text");s&&s.length>0&&s.val(i)}},n=function(e){e.attr("data-binded-field-name").length>0&&e.attr("data-item-value")>0&&setTimeout(function(){0==$("#"+e.attr("data-frm-uniq-id")+"_"+e.attr("data-binded_field-name")).val()&&load_binded_field(e.attr("data-frm-uniq-id")+"_"+e.attr("data-item-field"),e.attr("data-frm-uniq-id")+"_"+e.attr("data-binded-field-name"),e.attr("data-binded-field-id"),e.attr("data-binded-rel-field-id"))},2e3)},r=function(){$(".dx-rel-id-field[data-is-init=0]").each(function(){e($(this)),t($(this)),n($(this)),$(this).attr("data-is-init",1)})};return{init:function(){r()},update_callback:function(e,t,n){i(e,t,n)}}}();$(document).ajaxComplete(function(e,t,i){RelIdField.init()});var AutocompleateField=function(){var e=function(e){e.find(".dx-rel-id-add-btn").click(function(){var t=e.find(".dx-auto-input-id").val();rel_new_form(e.attr("data-form-url"),e.attr("data-rel-list-id"),t,e.attr("data-rel-field-id"),e.attr("id"),"AutocompleateField")})},t=function(e){e.find(".dx-rel-id-del-btn").click(function(){e.find(".dx-auto-input-select2").select2("data",{id:0,text:""}),e.find("input.dx-auto-input-id").val(0)})},i=function(e,t,i){var n=$("#"+e).find(".dx-auto-input-select2");n&&n.length>0?n.select2("data",{id:t,text:i}):$("#"+e).find("input.dx-auto-input-txt").val(i),$("#"+e).find("input.dx-auto-input-id").val(t)},n=function(e){var t=document.createElement("span");return t.innerHTML=e,t.innerText},r=function(e){e.find(".dx-auto-input-select2").select2({placeholder:e.attr("data-trans-search"),minimumInputLength:3,ajax:{type:"POST",url:DX_CORE.site_url+"fill_autocompleate",processData:!1,contentType:!1,dataType:"json",quietMillis:250,cache:!0,data:function(t,i){return{q:t,list_id:e.attr("data-rel-list-id"),txt_field_id:e.attr("data-rel-field-id"),rel_view_id:e.attr("data-rel-view_id"),rel_display_formula_field:e.attr("data-rel-formula-field")}},results:function(e,t){return 1==e.success?{results:e.data}:void(e.error?notify_err(e.error):notify_err(DX_CORE.trans_general_error))},error:function(e,t,i){if(422===e.status){var n=e.responseJSON,r="<ul>";$.each(n,function(e,t){r+="<li>"+t[0]+"</li>"}),r+="</ul>",toastr.error(r)}else notify_err(DX_CORE.trans_general_error)}}}).on("change",function(t){t.val?e.find("input.dx-auto-input-id").val(t.val):e.find("input.dx-auto-input-id").val(0)}),e.find(".dx-auto-input-select2").select2("data",{id:e.attr("data-item-value"),text:n(e.attr("data-item-text"))})},s=function(){$(".dx-autocompleate-field[data-is-init=0]").each(function(){e($(this)),t($(this)),r($(this)),$(this).attr("data-is-init",1)})};return{init:function(){s()},update_callback:function(e,t,n){i(e,t,n)}}}();$(document).ajaxComplete(function(e,t,i){AutocompleateField.init()});