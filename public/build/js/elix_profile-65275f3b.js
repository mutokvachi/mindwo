!function(e){e.fn.FreeForm=function(t){var i=e.extend({},e.fn.FreeForm.defaults,t);return this.each(function(){new e.FreeForm(this,i)})},e.fn.FreeForm.defaults={editBtnSelector:".dx-edit-general",saveBtnSelector:".dx-save-general",cancelBtnSelector:".dx-cancel-general",names:[]},e.FreeForm=function(t,i){e.data(t,"FreeForm",this);var o=this;this.root=e(t),this.options=i,this.fields=e("[data-name]",this.root).filter(function(){if(0==o.options.names.length||o.options.names.indexOf(e(this).data("name"))!=-1)return!0}),this.originalData={},this.editButton=e(this.options.editBtnSelector,this.root),this.saveButton=e(this.options.saveBtnSelector,this.root),this.cancelButton=e(this.options.cancelBtnSelector,this.root),this.editButton.click(function(){o.edit()}),this.saveButton.click(function(){o.save()}),this.cancelButton.click(function(){o.cancel()})},e.extend(e.FreeForm.prototype,{edit:function(){var t=this,i={model:this.root.data("model"),item_id:this.root.data("item_id"),list_id:this.root.data("list_id"),fields:[]};this.fields.each(function(){t.originalData[e(this).data("name")]=e(this).html(),i.fields.push({name:e(this).data("name"),display:e(this).data("display")?e(this).data("display"):"raw"})}),show_page_splash(1),e.ajax({type:"POST",url:DX_CORE.site_url+"freeform/"+i.item_id+"/edit",dataType:"json",data:i,success:function(i){if("undefined"!=typeof i.success&&0==i.success)return notify_err(i.error),void hide_page_splash(1);t.editButton.hide(),t.saveButton.show(),t.cancelButton.show();for(var o=0;o<i.fields.length;o++){var n=i.fields[o].name,s=i.fields[o].input,a=e('[data-name="'+n+'"]',t.root);a.length&&a.html(s)}hide_page_splash(1)},error:function(e,t,i){console.log(t),console.log(e),console.log(i)}})},save:function(){var t=this,i={},o=process_data_fields(this.root.attr("id"));o.append("model",this.root.data("model")),o.append("item_id",this.root.data("item_id")),o.append("list_id",this.root.data("list_id")),o.append("edit_form_id",this.root.data("form_id")),this.fields.each(function(){i[e(this).data("name")]={display:e(this).data("display")?e(this).data("display"):"raw"}}),o.append("field_metadata",JSON.stringify(i)),show_page_splash(1),e.ajax({type:"POST",url:DX_CORE.site_url+"freeform/"+this.root.data("item_id")+"?_method=PUT",dataType:"json",processData:!1,contentType:!1,data:o,success:function(i){if("undefined"!=typeof i.success&&0==i.success)return notify_err(i.error),void hide_page_splash(1);t.editButton.show(),t.saveButton.hide(),t.cancelButton.hide();for(var o=0;o<i.fields.length;o++){var n=i.fields[o].name,s=i.fields[o].html,a=e('[data-name="'+n+'"]',t.root);a.length&&a.html(s)}hide_page_splash(1)},error:function(e,t,i){console.log(t),console.log(e),console.log(i)}})},cancel:function(){var t=this;this.editButton.show(),this.saveButton.hide(),this.cancelButton.hide(),this.fields.each(function(){e(this).html(t.originalData[e(this).data("name")])})}})}(jQuery),function(e){e.fn.InlineForm=function(t){var i=e.extend({},e.fn.InlineForm.defaults,t);return this.each(function(){new e.InlineForm(this,i)})},e.fn.InlineForm.defaults={beforeSave:null,afterSave:null,empl_search_page_url:"/search"},e.InlineForm=function(t,i){e.data(t,"InlineForm",this);var o=this;this.options=i,this.root=e(t),this.tabs=e(".tab-pane",this.root).not(".dx-grid-tab-pane"),this.fields=e("[data-name]",this.root),this.fieldNames=[],this.fields.each(function(){o.fieldNames.push(e(this).data("name"))}),this.originalTabs={},this.originalFields={},this.editButton=e(".dx-edit-profile",this.root),this.saveButton=e(".dx-save-profile",this.root),this.cancelButton=e(".dx-cancel-profile",this.root),this.deleteButton=e(".dx-delete-profile",this.root),this.requests={},this.onRequestSuccess=[],this.onRequestFailed=[],this.editButton.click(function(){o.edit()}),this.saveButton.click(function(){o.save()}),this.cancelButton.click(function(){o.cancel()}),this.deleteButton.click(function(){o.destroy()})},e.extend(e.InlineForm.prototype,{initRequest:function(e){this.requests={total:e,succeeded:0,failed:0},this.onRequestSuccess=[],this.onRequestFailed=[]},setRequestStatus:function(e){if(e?this.requests.succeeded++:this.requests.failed++,this.requests.total===this.requests.succeeded+this.requests.failed){if(0===this.requests.failed)for(var t=0;t<this.onRequestSuccess.length;t++)this.onRequestSuccess[t].func(this.onRequestSuccess[t].args);else for(var t=0;t<this.onRequestFailed.length;t++)this.onRequestFailed[t].func(this.onRequestFailed[t].args);hide_page_splash(1)}},storeOriginalData:function(){var t=this;this.fields=e("[data-name]",this.root),this.tabs.each(function(){t.originalTabs[e(this).data("tabTitle")]=e(this).html()}),this.fields.each(function(){t.originalFields[e(this).data("name")]=e(this).html()})},edit:function(){var t=this,i={list_id:this.root.data("list_id"),tab_list:[],field_list:this.fieldNames};this.storeOriginalData(),show_page_splash(1),e.ajax({type:"POST",url:DX_CORE.site_url+"inlineform/"+this.root.data("item_id")+"/edit",dataType:"json",data:i,success:function(i){if("undefined"!=typeof i.success&&0==i.success)return notify_err(i.error),void hide_page_splash(1);t.editButton.hide();for(var o=e(e.parseHTML("<div>"+i.tabs+"</div>")).find(".tab-pane").not(".dx-grid-tab-pane"),n=0;n<o.length;n++){var s=e(o[n]),a=e('[data-tab-title="'+s.data("tabTitle")+'"]',t.root);a.length&&a.html(s.html())}for(var r in i.fields)e('[data-name="'+r+'"]').html(i.fields[r]);1==t.root.data("has_users_documents_access")&&window.DxEmpPersDocs.toggleDisable(!1),hide_page_splash(1),e(".dx-stick-footer").show()},error:function(e,t,i){console.log(t),console.log(e),hide_page_splash(1)}})},save:function(){var t=this,i=process_data_fields(this.root.attr("id"));i.append("item_id",this.root.data("item_id")),i.append("list_id",this.root.data("list_id")),i.append("edit_form_id",this.root.data("form_id")),i.append("redirect_url",this.root.data("redirect_url")),i.append("field_list",JSON.stringify(this.fieldNames));var o=DX_CORE.site_url+"inlineform";"create"!=this.root.data("mode")&&(o+="/"+this.root.data("item_id")+"?_method=PUT"),show_page_splash(1),e.ajax({type:"POST",url:o,dataType:"json",processData:!1,contentType:!1,data:i,success:function(i){if("undefined"!=typeof i.success&&0==i.success)return notify_err(i.error),void hide_page_splash(1);if("create"==t.root.data("mode"))return void(1==t.root.data("has_users_documents_access")?(window.DxEmpPersDocs.userId=i.item_id,window.DxEmpPersDocs.onClickSaveDocs(function(){hide_page_splash(1),e(".dx-stick-footer").hide(),window.location=i.redirect})):(hide_page_splash(1),e(".dx-stick-footer").hide(),window.location=i.redirect));if(1==t.root.data("has_users_documents_access"))window.DxEmpPersDocs.onClickSaveDocs(function(){window.DxEmpPersDocs.toggleDisable(!0),t.editButton.show();for(var o=e(e.parseHTML("<div>"+i.tabs+"</div>")).find(".tab-pane").not(".dx-grid-tab-pane"),n=0;n<o.length;n++){var s=e(o[n]),a=e('[data-tab-title="'+s.data("tabTitle")+'"]',t.root);a.length&&a.html(s.html())}t.options.afterSave&&t.options.afterSave(),hide_page_splash(1),e(".dx-stick-footer").hide()});else{t.editButton.show();for(var o=e(e.parseHTML("<div>"+i.tabs+"</div>")).find(".tab-pane").not(".dx-grid-tab-pane"),n=0;n<o.length;n++){var s=e(o[n]),a=e('[data-tab-title="'+s.data("tabTitle")+'"]',t.root);a.length&&a.html(s.html())}for(var r in i.fields)e('[data-name="'+r+'"]').html(i.fields[r]);t.options.afterSave&&t.options.afterSave(),hide_page_splash(1),e(".dx-stick-footer").hide()}},error:function(e,t,i){console.log(e),console.log(i)}})},cancel:function(){if("create"==this.root.data("mode"))return show_page_splash(1),void(window.location=this.options.empl_search_page_url);this.editButton.show();for(var t in this.originalTabs)this.tabs.filter('[data-tab-title="'+t+'"]').html(this.originalTabs[t]);for(var i in this.originalFields)this.fields.filter('[data-name="'+i+'"]').html(this.originalFields[i]);e(".dx-stick-footer").hide(),1==this.root.data("has_users_documents_access")&&window.DxEmpPersDocs.cancelEditMode()},destroy:function(){if(confirm(Lang.get("frame.confirm_delete"))){var t={edit_form_id:this.root.data("form_id"),item_id:this.root.data("item_id")};show_page_splash(1),e.ajax({type:"POST",url:DX_CORE.site_url+"inlineform/"+this.root.data("item_id")+"?_method=DELETE",dataType:"json",data:t,success:function(e){return"undefined"!=typeof e.success&&0==e.success?(notify_err(e.error),void hide_page_splash(1)):void(window.location=e.redirect)},error:function(e,t,i){console.log(t),console.log(e),hide_page_splash(1)}})}}})}(jQuery),function(e){e.fn.EmplLinksFix=function(t){var i=e.extend({},e.fn.EmplLinksFix.defaults,t);return this.each(function(){new e.EmplLinksFix(this,i)})},e.fn.EmplLinksFix.defaults={profile_url:"/employee/profile/"},e.EmplLinksFix=function(t,i){e.data(t,"EmplLinksFix",this);var o=this;this.options=i,this.root=e(t),this.flds_managers=e(".dx-autocompleate-field[data-item-field=manager_id], .dx-autocompleate-field[data-item-field=reporting_manager_id]",this.root),this.tiles_managers=e(".employee-manager-tile",this.root),this.tiles_managers.each(function(){e(this).data("is-fix-init")||(e(this).click(function(){o.show_tile_manager(e(this).data("empl-id"))}),e(this).data("is-fix-init",1))}),this.flds_managers.each(function(){if(!e(this).data("is-fix-init")){var t=e(this);t.find(".dx-rel-id-add-btn").off("click"),t.find(".dx-rel-id-add-btn").click(function(){o.show_manager(t)}),t.find(".dx-rel-id-add-btn").tooltipster("destroy"),t.find(".dx-rel-id-add-btn").attr("title",Lang.get("empl_profile.hint_view_profile")),t.find(".dx-rel-id-add-btn").tooltipster({theme:"tooltipster-light",animation:"grow",maxWidth:300}),e(this).data("is-fix-init",1)}})},e.extend(e.EmplLinksFix.prototype,{show_manager:function(e){var t=e.find(".dx-auto-input-id").val();0!=t&&(show_page_splash(1),window.location=this.options.profile_url+t)},show_tile_manager:function(e){show_page_splash(1),window.location=this.options.profile_url+e}})}(jQuery),$(document).ajaxComplete(function(){$(".dx-employee-profile.freeform").EmplLinksFix()}),$(document).ready(function(){$(".dx-employee-profile.freeform").EmplLinksFix()}),window.DxEmpPersDocs=window.DxEmpPersDocs||{rowCount:0,userId:0,dateFormat:"",locale:"en",empDocListId:0,empDocFldId:0,isInit:!1,viewClone:"",callbackOnInitiSuccess:function(e){},callbackOnSaveSuccess:function(e){},callbackOnError:function(e){},init:function(e){e?window.DxEmpPersDocs.callbackOnInitiSuccess=e:window.DxEmpPersDocs.callbackOnInitiSuccess=function(){},window.DxEmpPersDocs.userId=""==$("#dx-emp-pers-docs-panel").attr("data-user-id")?0:$("#dx-emp-pers-docs-panel").attr("data-user-id"),window.DxEmpPersDocs.dateFormat=$("#dx-emp-pers-docs-panel").attr("data-date-format"),window.DxEmpPersDocs.locale=$("#dx-emp-pers-docs-panel").attr("data-locale"),window.DxEmpPersDocs.empDocListId=$("#dx-emp-pers-docs-panel").attr("data-emp-docs-list-id"),window.DxEmpPersDocs.empDocFldId=$("#dx-emp-pers-docs-panel").attr("data-emp-docs-fld-id"),$("#dx-emp-pers-docs-country").change(window.DxEmpPersDocs.onChangeCountry),window.DxEmpPersDocs.loadEmployeeData()},enterEditMode:function(){window.DxEmpPersDocs.viewClone=$("#dx-emp-pers-docs-panel").clone(!0,!0)},cancelEditMode:function(){$("#dx-emp-pers-docs-panel").replaceWith(window.DxEmpPersDocs.viewClone),window.DxEmpPersDocs.viewClone=null,window.DxEmpPersDocs.toggleDisable(!0)},loadEmployeeData:function(){$.ajax({url:"/employee/personal_docs/get/employee_docs/"+window.DxEmpPersDocs.userId,type:"get",success:window.DxEmpPersDocs.onSuccessLoadEmployeeData,error:window.DxEmpPersDocs.onAjaxError})},onSuccessLoadEmployeeData:function(e){if(""!=e)for(var t=JSON.parse(e),i=0;i<t.length;i++)window.DxEmpPersDocs.createNewDocRow(!1,t[i]);$("#dx-emp-pers-docs-country").trigger("change")},createNewDocRow:function(e,t){var i=$($("#dx-emp-pers-docs-new-row").html());i=e?window.DxEmpPersDocs.setDocTypeValue(i,t):window.DxEmpPersDocs.setValues(i,t),e?$("#dx-emp-pers-docs-table").append(i):$("#dx-emp-pers-docs-table-history").append(i),window.DxEmpPersDocs.bindDocRowEvenets(i),window.DxEmpPersDocs.rowCount++},initValidToDatePicker:function(e,t){var i=e.find(".dx-emp-pers-docs-validto-input");return i.attr("id","dx-emp-pers-docs-validto-input-"+window.DxEmpPersDocs.rowCount),i.val(t),i.datetimepicker({lang:window.DxEmpPersDocs.locale,format:window.DxEmpPersDocs.dateFormat,timepicker:0,dayOfWeekStart:1,closeOnDateSelect:!0}),e.find(".dx-emp-pers-docs-validto-input-calc").click({picker_num:window.DxEmpPersDocs.rowCount},function(e){jQuery("#dx-emp-pers-docs-validto-input-"+e.data.picker_num).datetimepicker("show")}),e},setDocTypeValue:function(e,t){return e=window.DxEmpPersDocs.initValidToDatePicker(e,""),e.attr("id","dx-emp-pers-docs-row-"+t.id),e.find(".dx-emp-pers-docs-type-input").val(t.id),e.find(".dx-emp-pers-docs-type-label").html(t.name),e},setValues:function(e,t){return e=window.DxEmpPersDocs.initValidToDatePicker(e,t.valid_to),e.attr("id","dx-emp-pers-docs-row-"+t.doc_id),e.find(".dx-emp-pers-docs-id-input").val(t.id),e.find(".dx-emp-pers-docs-type-input").val(t.doc_id),e.find(".dx-emp-pers-docs-type-label").html(t.personal_document.name),e.find(".dx-emp-pers-docs-docnr-input").val(t.doc_nr),e.find(".dx-emp-pers-docs-publisher-input").val(t.publisher),window.DxEmpPersDocs.setFileValue(e,t.id,t.file_name),e},setFileValue:function(e,t,i){if(i&&null!=i){var o="<a href='JavaScript: download_file("+t+" , "+window.DxEmpPersDocs.empDocListId+", "+window.DxEmpPersDocs.empDocFldId+");'>"+i+"</a>";e.find(".dx-emp-pers-docs-file-input-download").html(o),e.find(".dx-emp-pers-docs-file-input-isset").val(1)}},clearDocRow:function(e){var t=$(e.target).parents(".dx-emp-pers-docs-row");t.find(".dx-emp-pers-docs-id-input").val(0),t.find(".dx-emp-pers-docs-docnr-input").val(""),t.find(".dx-emp-pers-docs-validto-input").val(""),t.find(".dx-emp-pers-docs-publisher-input").val(""),t.find(".dx-emp-pers-docs-file-input-remove-btn").trigger("click")},getDataForSave:function(){for(var e=$("#dx-emp-pers-docs-table .dx-emp-pers-docs-row"),t={user_id:window.DxEmpPersDocs.userId,rows:[]},i=new FormData,o=0;o<e.length;o++){var n=$(e[o]),s={};s.id=n.find(".dx-emp-pers-docs-id-input").val(),s.document_type=n.find(".dx-emp-pers-docs-type-input").val(),s.publisher=n.find(".dx-emp-pers-docs-publisher-input").val(),s.valid_to=n.find(".dx-emp-pers-docs-validto-input").val(),s.doc_nr=n.find(".dx-emp-pers-docs-docnr-input").val(),s.file_remove=""===$.trim(n.find(".dx-emp-pers-docs-file-input-download").html());var a=n.find(".dx-emp-pers-docs-file-input-file").prop("files")[0];i.append("file"+o,a),t.rows.push(s)}return i.append("doc_country_id",$("#dx-emp-pers-docs-country").val()),i.append("data",JSON.stringify(t)),i},bindDocRowEvenets:function(e){e.find(".dx-emp-pers-docs-clear-btn").click(window.DxEmpPersDocs.clearDocRow)},onChangeCountry:function(e){var t=$(e.target).val();$.ajax({url:DX_CORE.site_url+"employee/personal_docs/get/docs_by_country/"+t,type:"get",success:window.DxEmpPersDocs.onSuccessChangeCountry,error:window.DxEmpPersDocs.onAjaxError})},onSuccessChangeCountry:function(e){var t=JSON.parse(e);window.DxEmpPersDocs.drawRows(t),window.DxEmpPersDocs.finishInit()},drawRows:function(e){$("#dx-emp-pers-docs-table").contents().appendTo("#dx-emp-pers-docs-table-history");for(var t=0;t<e.length;t++){var i=e[t],o=$("#dx-emp-pers-docs-row-"+i.id);o.length>0?o.appendTo("#dx-emp-pers-docs-table"):window.DxEmpPersDocs.createNewDocRow(!0,i)}$("#dx-emp-pers-docs-table").find("[data-tooltip-title]").each(function(e,t){$(t).attr("title",$(t).data("tooltip-title")),$(t).tooltip()})},finishInit:function(){window.DxEmpPersDocs.isInit||(window.DxEmpPersDocs.isInit=!0,0==window.DxEmpPersDocs.userId?window.DxEmpPersDocs.toggleDisable(!1):window.DxEmpPersDocs.toggleDisable(!0),window.DxEmpPersDocs.callbackOnInitiSuccess())},onClickSaveDocs:function(e,t){e?window.DxEmpPersDocs.callbackOnSaveSuccess=e:window.DxEmpPersDocs.callbackOnSaveSuccess=function(){},t?window.DxEmpPersDocs.callbackOnError=t:window.DxEmpPersDocs.callbackOnError=function(){};var i=window.DxEmpPersDocs.getDataForSave();$.ajax({url:DX_CORE.site_url+"employee/personal_docs/save",data:i,type:"post",processData:!1,dataType:"json",contentType:!1,success:window.DxEmpPersDocs.onSuccessSave,error:window.DxEmpPersDocs.onAjaxError})},onSuccessSave:function(e){for(var t=0;t<e.length;t++){var i=e[t],o=$("#dx-emp-pers-docs-row-"+i.doc_id);o.length>0&&(o.find(".dx-emp-pers-docs-id-input").val(i.id),o.find(".dx-emp-pers-docs-file-input-remove-btn").trigger("click"),window.DxEmpPersDocs.setFileValue(o,i.id,i.file_name))}$("#dx-emp-pers-docs-table-history").empty(),window.DxEmpPersDocs.callbackOnSaveSuccess()},onAjaxError:function(e){window.DxEmpPersDocs.finishInit(),window.DxEmpPersDocs.callbackOnError()},toggleDisable:function(e){e||window.DxEmpPersDocs.enterEditMode();for(var t=$("#dx-emp-pers-docs-table .dx-emp-pers-docs-row"),i=0;i<t.length;i++){var o=$(t[i]);o.find(".dx-emp-pers-docs-publisher-input").prop("disabled",e),o.find(".dx-emp-pers-docs-validto-input").prop("disabled",e),o.find(".dx-emp-pers-docs-validto-input-calc").prop("disabled",e),o.find(".dx-emp-pers-docs-docnr-input").prop("disabled",e),e?(o.find(".dx-emp-pers-docs-file-input-set-btn").hide(),o.find(".dx-emp-pers-docs-file-input-file").prop("files")[0]&&o.find(".dx-emp-pers-docs-file-input-remove-btn").hide(),o.find(".dx-emp-pers-docs-clear-btn").hide()):(o.find(".dx-emp-pers-docs-validto-input").datetimepicker("destroy"),o.find(".dx-emp-pers-docs-validto-input").datetimepicker({lang:window.DxEmpPersDocs.locale,format:window.DxEmpPersDocs.dateFormat,timepicker:0,dayOfWeekStart:1,closeOnDateSelect:!0}),o.find(".dx-emp-pers-docs-file-input-set-btn").show(),o.find(".dx-emp-pers-docs-file-input-file").prop("files")[0]&&o.find(".dx-emp-pers-docs-file-input-remove-btn").show(),o.find(".dx-emp-pers-docs-clear-btn").show())}$("#dx-emp-pers-docs-country").prop("disabled",e)}},window.DxEmpNotes=window.DxEmpNotes||{userId:0,isLoaded:!1,isSending:!1,chatFormColorDefault:"white",init:function(e){window.DxEmpNotes.userId=e},loadView:function(){window.DxEmpNotes.isLoaded||(show_page_splash(1),$.ajax({url:DX_CORE.site_url+"employee/notes/get/view/"+window.DxEmpNotes.userId,type:"get",success:window.DxEmpNotes.onLoadViewSuccess,error:function(e){hide_page_splash(1)}}))},onLoadViewSuccess:function(e){$("#dx-tab_notes").html(e),window.DxEmpNotes.chatFormColorDefault=$(".dx-emp-notes-chat-form").css("background-color"),$(".dx-emp-notes-btn").click(window.DxEmpNotes.onNoteEnter),$(".dx-emp-notes-input-text").keyup(function(e){13==e.keyCode&&window.DxEmpNotes.onNoteEnter()}),$(".dx-emp-notes-chat").on("click",".dx-emp-notes-btn-link-edit",{},window.DxEmpNotes.onEditClick),$(".dx-emp-notes-chat").on("click",".dx-emp-notes-btn-link-delete",{},window.DxEmpNotes.onDeleteClick),window.DxEmpNotes.isLoaded=!0,hide_page_splash(1)},getDataForSave:function(){var e={};return e.note_id=$(".dx-emp-notes-input-id").val(),e.user_id=window.DxEmpNotes.userId,e.note_text=$(".dx-emp-notes-input-text").val(),e},onNoteEnter:function(){if(!window.DxEmpNotes.isSending){window.DxEmpNotes.showLoading();var e=window.DxEmpNotes.getDataForSave();$.ajax({url:DX_CORE.site_url+"employee/notes/save",data:e,type:"post",success:window.DxEmpNotes.onSuccessSave,error:window.DxEmpNotes.onAjaxError})}},onEditClick:function(e){var t=$(e.target),i=t.closest(".message").find(".dx-emp-notes-edit-id").val(),o=t.closest(".message").find(".dx-emp-notes-edit-body").html();$(".dx-emp-notes-input-id").val(i),$(".dx-emp-notes-input-text").val(o),$(".dx-emp-notes-input-text").focus();var n=$(".dx-emp-notes-chat-form");n.animate({backgroundColor:"#7bb6de"},"slow",function(){n.animate({backgroundColor:window.DxEmpNotes.chatFormColorDefault},"slow")})},onDeleteClick:function(e){var t=$(e.target),i=t.closest(".message").find(".dx-emp-notes-edit-id").val();PageMain.showConfirm(window.DxEmpNotes.onDeleteConfirm,i,Lang.get("employee.notes.delete_note_title"),Lang.get("employee.notes.delete_note_text"),Lang.get("form.btn_delete"),"")},onDeleteConfirm:function(e){if(!window.DxEmpNotes.isSending){window.DxEmpNotes.showLoading();var t={note_id:e};$.ajax({url:DX_CORE.site_url+"employee/notes/delete",data:t,type:"delete",success:window.DxEmpNotes.onSuccessDelete,error:window.DxEmpNotes.onAjaxError})}},showLoading:function(){window.DxEmpNotes.isSending=!0,show_page_splash(1)},hideLoading:function(){window.DxEmpNotes.isSending=!1,hide_page_splash(1)},onSuccessDelete:function(e){e&&$(".dx-emp-notes-edit-id[value="+e+"]").closest("li").remove(),window.DxEmpNotes.hideLoading()},onSuccessSave:function(e){var t=$(".dx-emp-notes-input-id").val();t&&$(".dx-emp-notes-edit-id[value="+t+"]").closest("li").remove(),$(".dx-emp-notes-input-id").val(""),$(".dx-emp-notes-input-text").val(""),window.DxEmpNotes.hideLoading(),e.view&&$(".dx-emp-notes-chat").prepend($(e.view).fadeIn())},onAjaxError:function(e){window.DxEmpNotes.hideLoading()}},window.DxEmpTimeoff=window.DxEmpTimeoff||{userId:0,isLoaded:!1,isSending:!1,year:2016,timeoff:1,init:function(e){window.DxEmpTimeoff.userId=e},loadView:function(){window.DxEmpTimeoff.isLoaded||(window.DxEmpTimeoff.showLoading(),$.ajax({url:DX_CORE.site_url+"employee/timeoff/get/view/"+window.DxEmpTimeoff.userId,type:"get",success:window.DxEmpTimeoff.onLoadViewSuccess,error:function(e){window.DxEmpTimeoff.hideLoading()}}))},onLoadViewSuccess:function(e){$("#dx-tab_timeoff").html(e),$("#dx-tab_timeoff [data-counter='counterup']").counterUp({delay:10,time:700}),$(".dx-accrual-calc").click(function(){window.DxEmpTimeoff.showLoading();var e=$(this);$.ajax({url:DX_CORE.site_url+"employee/timeoff/get/calculate/"+window.DxEmpTimeoff.userId+"/"+e.data("timeoff"),type:"get",success:function(t){window.DxEmpTimeoff.onCalculateSuccess(e,t)}})}),$(".dx-accrual-delete").click(function(){PageMain.showConfirm(window.DxEmpTimeoff.deleteCalculation,$(this),Lang.get("form.modal_confirm_title"),Lang.get("timeoff.delete_confirm"),Lang.get("form.btn_delete"),Lang.get("form.btn_cancel"))}),$(".dx-accrual-policy").click(function(){window.DxEmpTimeoff.showLoading(),view_list_item("form",$(this).data("policy-id"),$(this).data("policy-list-id"),$(this).data("policy-user-field-id"),window.DxEmpTimeoff.userId,"","")}),$(".dx-emp-timeoff-sel-timeoff").click(window.DxEmpTimeoff.timeoffSelect),$(".dx-emp-timeoff-sel-year").click(window.DxEmpTimeoff.yearSelect),window.DxEmpTimeoff.year=$("#dx-emp-timeoff-panel").data("year"),window.DxEmpTimeoff.timeoff=$("#dx-emp-timeoff-panel").data("timeoff"),window.DxEmpTimeoff.timeoffTitle=$("#dx-emp-timeoff-panel").data("timeoff_title"),window.DxEmpTimeoff.initDataTable(),window.DxEmpTimeoff.isLoaded=!0},onCalculateSuccess:function(e,t){var i=e.closest("div.widget-thumb"),o=i.find(".widget-thumb-body-stat").first();o.attr("data-value",t.balance),o.html(t.balance),i.find(".widget-thumb-subtitle").first().html(t.unit),o.counterUp({delay:10,time:700}),window.DxEmpTimeoff.timeoff==e.data("timeoff")?window.DxEmpTimeoff.refreshDataTable():window.DxEmpTimeoff.hideLoading()},deleteCalculation:function(e){window.DxEmpTimeoff.showLoading(),$.ajax({url:DX_CORE.site_url+"employee/timeoff/get/delete_calculated/"+window.DxEmpTimeoff.userId+"/"+e.data("timeoff"),type:"get",success:function(t){window.DxEmpTimeoff.onCalculateSuccess(e,t)}})},refreshDataTable:function(){var e=DX_CORE.site_url+"employee/timeoff/get/table/"+window.DxEmpTimeoff.userId+"/"+window.DxEmpTimeoff.timeoff+"/"+window.DxEmpTimeoff.year;window.DxEmpTimeoff.dataTable.ajax.url(e).load()},initDataTable:function(){window.DxEmpTimeoff.dataTable=$("#dx-empt-datatable-timeoff").DataTable({serverSide:!0,searching:!1,order:[[0,"desc"]],ajax:DX_CORE.site_url+"employee/timeoff/get/table/"+window.DxEmpTimeoff.userId+"/"+window.DxEmpTimeoff.timeoff+"/"+window.DxEmpTimeoff.year,columns:[{data:"calc_date",name:"calc_date"},{data:"from_date",name:"from_date"},{data:"to_date",name:"to_date"},{data:"timeoff_record_type.title",name:"timeoffRecordType.title"},{data:"notes",name:"notes"},{data:"amount",name:"amount"},{data:"balance",name:"balance"}],fnPreDrawCallback:function(){window.DxEmpTimeoff.showLoading()},fnDrawCallback:function(){window.DxEmpTimeoff.hideLoading()}})},yearSelect:function(e){var t=$(e.target);window.DxEmpTimeoff.year=t.data("value"),$(".dx-emp-timeoff-curr-year").html(window.DxEmpTimeoff.year),window.DxEmpTimeoff.refreshDataTable()},timeoffSelect:function(e){var t=$(e.target);window.DxEmpTimeoff.timeoff=t.data("value"),window.DxEmpTimeoff.timeoffTitle=t.data("title"),$(".dx-emp-timeoff-curr-timeoff").html(window.DxEmpTimeoff.timeoffTitle),window.DxEmpTimeoff.refreshDataTable()},showLoading:function(){window.DxEmpTimeoff.inProgressCount++,show_page_splash(1)},hideLoading:function(){window.DxEmpTimeoff.isSending=!1,hide_page_splash(1)},onAjaxError:function(e){window.DxEmpTimeoff.hideLoading()}},!function(e){"use strict";e.fn.counterUp=function(t){var i=e.extend({time:400,delay:10},t);return this.each(function(){var t=e(this),o=i,n=function(){var e=o.time/o.delay,i=t.attr("data-value"),n=[i],s=/[0-9]+,[0-9]+/.test(i);i=i.replace(/,/g,"");for(var a=(/^[0-9]+$/.test(i),/^[0-9]+\.[0-9]+$/.test(i)),r=a?(i.split(".")[1]||[]).length:0,d=e;d>=1;d--){var l=parseInt(i/e*d);if(a&&(l=parseFloat(i/e*d).toFixed(r)),s)for(;/(\d+)(\d{3})/.test(l.toString());)l=l.toString().replace(/(\d+)(\d{3})/,"$1,$2");n.unshift(l)}t.data("counterup-nums",n),t.text("0");var c=function(){t.text(t.data("counterup-nums").shift()),t.data("counterup-nums").length?setTimeout(t.data("counterup-func"),o.delay):(delete t.data("counterup-nums"),t.data("counterup-nums",null),t.data("counterup-func",null))};t.data("counterup-func",c),setTimeout(t.data("counterup-func"),o.delay)};t.waypoint(n,{offset:"100%",triggerOnce:!0})})}}(jQuery),function(){var e=[].indexOf||function(e){for(var t=0,i=this.length;t<i;t++)if(t in this&&this[t]===e)return t;return-1},t=[].slice;!function(e,t){return"function"==typeof define&&define.amd?define("waypoints",["jquery"],function(i){return t(i,e)}):t(e.jQuery,e)}(this,function(i,o){var n,s,a,r,d,l,c,p,f,u,m,h,w,x,D,g;return n=i(o),p=e.call(o,"ontouchstart")>=0,r={horizontal:{},vertical:{}},d=1,c={},l="waypoints-context-id",m="resize.waypoints",h="scroll.waypoints",w=1,x="waypoints-waypoint-ids",D="waypoint",g="waypoints",s=function(){function e(e){var t=this;this.$element=e,this.element=e[0],this.didResize=!1,this.didScroll=!1,this.id="context"+d++,this.oldScroll={x:e.scrollLeft(),y:e.scrollTop()},this.waypoints={horizontal:{},vertical:{}},e.data(l,this.id),c[this.id]=this,e.bind(h,function(){var e;if(!t.didScroll&&!p)return t.didScroll=!0,e=function(){return t.doScroll(),t.didScroll=!1},o.setTimeout(e,i[g].settings.scrollThrottle)}),e.bind(m,function(){var e;if(!t.didResize)return t.didResize=!0,e=function(){return i[g]("refresh"),t.didResize=!1},o.setTimeout(e,i[g].settings.resizeThrottle)})}return e.prototype.doScroll=function(){var e,t=this;return e={horizontal:{newScroll:this.$element.scrollLeft(),oldScroll:this.oldScroll.x,forward:"right",backward:"left"},vertical:{newScroll:this.$element.scrollTop(),oldScroll:this.oldScroll.y,forward:"down",backward:"up"}},!p||e.vertical.oldScroll&&e.vertical.newScroll||i[g]("refresh"),i.each(e,function(e,o){var n,s,a;return a=[],s=o.newScroll>o.oldScroll,n=s?o.forward:o.backward,i.each(t.waypoints[e],function(e,t){var i,n;return o.oldScroll<(i=t.offset)&&i<=o.newScroll?a.push(t):o.newScroll<(n=t.offset)&&n<=o.oldScroll?a.push(t):void 0}),a.sort(function(e,t){return e.offset-t.offset}),s||a.reverse(),i.each(a,function(e,t){if(t.options.continuous||e===a.length-1)return t.trigger([n])})}),this.oldScroll={x:e.horizontal.newScroll,y:e.vertical.newScroll}},e.prototype.refresh=function(){var e,t,o,n=this;return o=i.isWindow(this.element),t=this.$element.offset(),this.doScroll(),e={horizontal:{contextOffset:o?0:t.left,contextScroll:o?0:this.oldScroll.x,contextDimension:this.$element.width(),oldScroll:this.oldScroll.x,forward:"right",backward:"left",offsetProp:"left"},vertical:{contextOffset:o?0:t.top,contextScroll:o?0:this.oldScroll.y,contextDimension:o?i[g]("viewportHeight"):this.$element.height(),oldScroll:this.oldScroll.y,forward:"down",backward:"up",offsetProp:"top"}},i.each(e,function(e,t){return i.each(n.waypoints[e],function(e,o){var n,s,a,r,d;if(n=o.options.offset,a=o.offset,s=i.isWindow(o.element)?0:o.$element.offset()[t.offsetProp],i.isFunction(n)?n=n.apply(o.element):"string"==typeof n&&(n=parseFloat(n),o.options.offset.indexOf("%")>-1&&(n=Math.ceil(t.contextDimension*n/100))),o.offset=s-t.contextOffset+t.contextScroll-n,(!o.options.onlyOnScroll||null==a)&&o.enabled)return null!==a&&a<(r=t.oldScroll)&&r<=o.offset?o.trigger([t.backward]):null!==a&&a>(d=t.oldScroll)&&d>=o.offset?o.trigger([t.forward]):null===a&&t.oldScroll>=o.offset?o.trigger([t.forward]):void 0})})},e.prototype.checkEmpty=function(){if(i.isEmptyObject(this.waypoints.horizontal)&&i.isEmptyObject(this.waypoints.vertical))return this.$element.unbind([m,h].join(" ")),delete c[this.id]},e}(),a=function(){function e(e,t,o){var n,s;o=i.extend({},i.fn[D].defaults,o),"bottom-in-view"===o.offset&&(o.offset=function(){var e;return e=i[g]("viewportHeight"),i.isWindow(t.element)||(e=t.$element.height()),e-i(this).outerHeight()}),this.$element=e,this.element=e[0],this.axis=o.horizontal?"horizontal":"vertical",this.callback=o.handler,this.context=t,this.enabled=o.enabled,this.id="waypoints"+w++,this.offset=null,this.options=o,t.waypoints[this.axis][this.id]=this,r[this.axis][this.id]=this,n=null!=(s=e.data(x))?s:[],n.push(this.id),e.data(x,n)}return e.prototype.trigger=function(e){if(this.enabled)return null!=this.callback&&this.callback.apply(this.element,e),this.options.triggerOnce?this.destroy():void 0},e.prototype.disable=function(){return this.enabled=!1},e.prototype.enable=function(){return this.context.refresh(),this.enabled=!0},e.prototype.destroy=function(){return delete r[this.axis][this.id],delete this.context.waypoints[this.axis][this.id],this.context.checkEmpty()},e.getWaypointsByElement=function(e){var t,o;return(o=i(e).data(x))?(t=i.extend({},r.horizontal,r.vertical),i.map(o,function(e){return t[e]})):[]},e}(),u={init:function(e,t){var o;return null==t&&(t={}),null==(o=t.handler)&&(t.handler=e),this.each(function(){var e,o,n,r;return e=i(this),n=null!=(r=t.context)?r:i.fn[D].defaults.context,i.isWindow(n)||(n=e.closest(n)),n=i(n),o=c[n.data(l)],o||(o=new s(n)),new a(e,o,t)}),i[g]("refresh"),this},disable:function(){return u._invoke(this,"disable")},enable:function(){return u._invoke(this,"enable")},destroy:function(){return u._invoke(this,"destroy")},prev:function(e,t){return u._traverse.call(this,e,t,function(e,t,i){if(t>0)return e.push(i[t-1])})},next:function(e,t){return u._traverse.call(this,e,t,function(e,t,i){if(t<i.length-1)return e.push(i[t+1])})},_traverse:function(e,t,n){var s,a;return null==e&&(e="vertical"),null==t&&(t=o),a=f.aggregate(t),s=[],this.each(function(){var t;return t=i.inArray(this,a[e]),n(s,t,a[e])}),this.pushStack(s)},_invoke:function(e,t){return e.each(function(){var e;return e=a.getWaypointsByElement(this),i.each(e,function(e,i){return i[t](),!0})}),this}},i.fn[D]=function(){var e,o;return o=arguments[0],e=2<=arguments.length?t.call(arguments,1):[],u[o]?u[o].apply(this,e):i.isFunction(o)?u.init.apply(this,arguments):i.isPlainObject(o)?u.init.apply(this,[null,o]):o?i.error("The "+o+" method does not exist in jQuery Waypoints."):i.error("jQuery Waypoints needs a callback function or handler option.")},i.fn[D].defaults={context:o,continuous:!0,enabled:!0,horizontal:!1,offset:0,triggerOnce:!1},f={refresh:function(){return i.each(c,function(e,t){return t.refresh()})},viewportHeight:function(){var e;return null!=(e=o.innerHeight)?e:n.height()},aggregate:function(e){var t,o,n;return t=r,e&&(t=null!=(n=c[i(e).data(l)])?n.waypoints:void 0),t?(o={horizontal:[],vertical:[]},i.each(o,function(e,n){return i.each(t[e],function(e,t){
return n.push(t)}),n.sort(function(e,t){return e.offset-t.offset}),o[e]=i.map(n,function(e){return e.element}),o[e]=i.unique(o[e])}),o):[]},above:function(e){return null==e&&(e=o),f._filter(e,"vertical",function(e,t){return t.offset<=e.oldScroll.y})},below:function(e){return null==e&&(e=o),f._filter(e,"vertical",function(e,t){return t.offset>e.oldScroll.y})},left:function(e){return null==e&&(e=o),f._filter(e,"horizontal",function(e,t){return t.offset<=e.oldScroll.x})},right:function(e){return null==e&&(e=o),f._filter(e,"horizontal",function(e,t){return t.offset>e.oldScroll.x})},enable:function(){return f._invoke("enable")},disable:function(){return f._invoke("disable")},destroy:function(){return f._invoke("destroy")},extendFn:function(e,t){return u[e]=t},_invoke:function(e){var t;return t=i.extend({},r.vertical,r.horizontal),i.each(t,function(t,i){return i[e](),!0})},_filter:function(e,t,o){var n,s;return(n=c[i(e).data(l)])?(s=[],i.each(n.waypoints[t],function(e,t){if(o(n,t))return s.push(t)}),s.sort(function(e,t){return e.offset-t.offset}),i.map(s,function(e){return e.element})):[]}},i[g]=function(){var e,i;return i=arguments[0],e=2<=arguments.length?t.call(arguments,1):[],f[i]?f[i].apply(null,e):f.aggregate.call(null,i)},i[g].settings={resizeThrottle:100,scrollThrottle:30},n.load(function(){return i[g]("refresh")})})}.call(this);