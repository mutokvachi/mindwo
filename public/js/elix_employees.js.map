{"version":3,"sources":["jquery.simulate.js","search_tools.js","employees.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACvJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC/GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"elix_employees.js","sourcesContent":["/*\n * jquery.simulate - simulate browser mouse and keyboard events\n *\n * Copyright (c) 2009 Eduardo Lundgren (eduardolundgren@gmail.com)\n * and Richard D. Worth (rdworth@gmail.com)\n *\n * Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php) \n * and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.\n *\n */\n\n;(function($) {\n\n$.fn.extend({\n\tsimulate: function(type, options) {\n\t\treturn this.each(function() {\n\t\t\tvar opt = $.extend({}, $.simulate.defaults, options || {});\n\t\t\tnew $.simulate(this, type, opt);\n\t\t});\n\t}\n});\n\n$.simulate = function(el, type, options) {\n\tthis.target = el;\n\tthis.options = options;\n\n\tif (/^drag$/.test(type)) {\n\t\tthis[type].apply(this, [this.target, options]);\n\t} else {\n\t\tthis.simulateEvent(el, type, options);\n\t}\n};\n\n$.extend($.simulate.prototype, {\n\tsimulateEvent: function(el, type, options) {\n\t\tvar evt = this.createEvent(type, options);\n\t\tthis.dispatchEvent(el, type, evt, options);\n\t\treturn evt;\n\t},\n\tcreateEvent: function(type, options) {\n\t\tif (/^mouse(over|out|down|up|move)|(dbl)?click$/.test(type)) {\n\t\t\treturn this.mouseEvent(type, options);\n\t\t} else if (/^key(up|down|press)$/.test(type)) {\n\t\t\treturn this.keyboardEvent(type, options);\n\t\t}\n\t},\n\tmouseEvent: function(type, options) {\n\t\tvar evt;\n\t\tvar e = $.extend({\n\t\t\tbubbles: true, cancelable: (type != \"mousemove\"), view: window, detail: 0,\n\t\t\tscreenX: 0, screenY: 0, clientX: 0, clientY: 0,\n\t\t\tctrlKey: false, altKey: false, shiftKey: false, metaKey: false,\n\t\t\tbutton: 0, relatedTarget: undefined\n\t\t}, options);\n\n\t\tvar relatedTarget = $(e.relatedTarget)[0];\n\n\t\tif ($.isFunction(document.createEvent)) {\n\t\t\tevt = document.createEvent(\"MouseEvents\");\n\t\t\tevt.initMouseEvent(type, e.bubbles, e.cancelable, e.view, e.detail,\n\t\t\t\te.screenX, e.screenY, e.clientX, e.clientY,\n\t\t\t\te.ctrlKey, e.altKey, e.shiftKey, e.metaKey,\n\t\t\t\te.button, e.relatedTarget || document.body.parentNode);\n\t\t} else if (document.createEventObject) {\n\t\t\tevt = document.createEventObject();\n\t\t\t$.extend(evt, e);\n\t\t\tevt.button = { 0:1, 1:4, 2:2 }[evt.button] || evt.button;\n\t\t}\n\t\treturn evt;\n\t},\n\tkeyboardEvent: function(type, options) {\n\t\tvar evt;\n\n\t\tvar e = $.extend({ bubbles: true, cancelable: true, view: window,\n\t\t\tctrlKey: false, altKey: false, shiftKey: false, metaKey: false,\n\t\t\tkeyCode: 0, charCode: 0\n\t\t}, options);\n\n\t\tif ($.isFunction(document.createEvent)) {\n\t\t\ttry {\n\t\t\t\tevt = document.createEvent(\"KeyEvents\");\n\t\t\t\tevt.initKeyEvent(type, e.bubbles, e.cancelable, e.view,\n\t\t\t\t\te.ctrlKey, e.altKey, e.shiftKey, e.metaKey,\n\t\t\t\t\te.keyCode, e.charCode);\n\t\t\t} catch(err) {\n\t\t\t\tevt = document.createEvent(\"Events\");\n\t\t\t\tevt.initEvent(type, e.bubbles, e.cancelable);\n\t\t\t\t$.extend(evt, { view: e.view,\n\t\t\t\t\tctrlKey: e.ctrlKey, altKey: e.altKey, shiftKey: e.shiftKey, metaKey: e.metaKey,\n\t\t\t\t\tkeyCode: e.keyCode, charCode: e.charCode\n\t\t\t\t});\n\t\t\t}\n\t\t} else if (document.createEventObject) {\n\t\t\tevt = document.createEventObject();\n\t\t\t$.extend(evt, e);\n\t\t}\n\t\tif (($.browser !== undefined) && ($.browser.msie || $.browser.opera)) {\n\t\t\tevt.keyCode = (e.charCode > 0) ? e.charCode : e.keyCode;\n\t\t\tevt.charCode = undefined;\n\t\t}\n\t\treturn evt;\n\t},\n\n\tdispatchEvent: function(el, type, evt) {\n\t\tif (el.dispatchEvent) {\n\t\t\tel.dispatchEvent(evt);\n\t\t} else if (el.fireEvent) {\n\t\t\tel.fireEvent('on' + type, evt);\n\t\t}\n\t\treturn evt;\n\t},\n\n\tdrag: function(el) {\n\t\tvar self = this, center = this.findCenter(this.target), \n\t\t\toptions = this.options,\tx = Math.floor(center.x), y = Math.floor(center.y), \n\t\t\tdx = options.dx || 0, dy = options.dy || 0, target = this.target;\n\t\tvar coord = { clientX: x, clientY: y };\n\t\tthis.simulateEvent(target, \"mousedown\", coord);\n\t\tcoord = { clientX: x + 1, clientY: y + 1 };\n\t\tthis.simulateEvent(document, \"mousemove\", coord);\n\t\tcoord = { clientX: x + dx, clientY: y + dy };\n\t\tthis.simulateEvent(document, \"mousemove\", coord);\n\t\tthis.simulateEvent(document, \"mousemove\", coord);\n\t\tthis.simulateEvent(target, \"mouseup\", coord);\n\t},\n\tfindCenter: function(el) {\n\t\tvar el = $(this.target), o = el.offset();\n\t\treturn {\n\t\t\tx: o.left + el.outerWidth() / 2,\n\t\t\ty: o.top + el.outerHeight() / 2\n\t\t};\n\t}\n});\n\n$.extend($.simulate, {\n\tdefaults: {\n\t\tspeed: 'sync'\n\t},\n\tVK_TAB: 9,\n\tVK_ENTER: 13,\n\tVK_ESC: 27,\n\tVK_PGUP: 33,\n\tVK_PGDN: 34,\n\tVK_END: 35,\n\tVK_HOME: 36,\n\tVK_LEFT: 37,\n\tVK_UP: 38,\n\tVK_RIGHT: 39,\n\tVK_DOWN: 40\n});\n\n})(jQuery);","/**\n * Meklēšanas rīku pogas JavaScript funkcionalitāte\n * \n * @type _L4.Anonym$0|Function\n */\nvar SearchTools = function()\n{    \n    /**\n     * Meklēšanas rīku HTML formas elements\n     * \n     * @type Object\n     */\n    var form_elem = null;\n    \n    /**\n     * Funkcija, kas parāda vai paslēp saiti \"Notīrīt\"\n     * Funkcija tiek uzstādīta pie meklēšanas rīku inicializēšanas\n     * \n     * @type Function\n     */\n    var clearLinkShowHide = null;\n    \n    /**\n     * Funkcija, kas notīra meklēšanas lauku vērtības.\n     * Funkcija tiek uzstādīta pie meklēšanas rīku inicializēšanas\n     * \n     * @type Function\n     */\n    var clearFields = null;\n    \n    /**\n     * Parāda vai paslēp meklēšanas rīkus\n     * \n     * @returns {undefined}\n     */\n    var showHideTools = function() {\n\n        var tools_btn = form_elem.find('.search-tools-btn');\n\n        if (tools_btn.find('i').hasClass('fa-caret-down'))\n        {\n            tools_btn.find('i').removeClass('fa-caret-down').addClass('fa-caret-up');\n            tools_btn.removeClass('btn-primary').addClass('btn-default');\n            form_elem.removeClass('search-tools-hiden').addClass('search-tools-shown');\n        }\n        else\n        {\n            tools_btn.find('i').removeClass('fa-caret-up').addClass('fa-caret-down');\n            tools_btn.removeClass('btn-default').addClass('btn-primary');\n\n            form_elem.removeClass('search-tools-shown').addClass('search-tools-hiden');\n\n            var phrase = form_elem.find('input[name=criteria]').val();\n            \n            clearFields();\n            \n            form_elem.find('input[name=criteria]').val(phrase);\n            \n            clearLinkShowHide();\n        }\n    };\n\n    /**\n     * Nodrošina meklēšanas pogas nospiešanas funkcionalitāti - veic meklēšanu\n     * \n     * @returns {undefined}\n     */\n    var handleBtnSearch = function() {\n        form_elem.find(\".search-simple-btn\").click(function(e) {\n            \n            show_page_splash();\n            form_elem.submit();\n        });\n    };\n\n    /**\n     * Nodrošina meklēšanas rīku pogas nospiešanas funkcionalitāti - parāda vai paslēpj meklēšanas rīkus\n     * \n     * @returns {undefined}\n     */\n    var handleBtnTools = function() {\n        form_elem.find('.search-tools-btn').click(function(e) {\n            showHideTools();\n        });\n    }; \n    \n    /**\n     * Inicializē meklēšanas rīku JavaScript funkcionalitāti\n     * \n     * @returns {undefined}\n     */\n    var initTools = function(callback_clearLinkShowHide, callback_clearFields) {        \n\n        form_elem = $('.search-tools-form');\n        \n        clearLinkShowHide = callback_clearLinkShowHide;\n        clearFields = callback_clearFields;\n        \n        handleBtnSearch();\n        handleBtnTools();\n    };\n\n    return {\n        init: function(callback_clearLinkShowHide, callback_clearFields) {\n            initTools(callback_clearLinkShowHide, callback_clearFields);\n        },\n        showHideTools: function() {\n            showHideTools();\n        }\n    };\n}();\n","/**\n * Darbinieku meklēšanas lapas JavaScript funkcionalitāte\n * \n * @type _L4.Anonym$0|Function\n */\nvar PageEmployees = function()\n{ \n    /**\n     * Meklēšanas rīku HTML formas elements\n     * \n     * @type Object\n     */\n    var form_elem = null;\n    \n    /**\n     * Darbinieku meklēšanas bloka HTML elements\n     * \n     * @type type\n     */\n    var page_elem = null;\n    \n    /**\n     * Atgriež elementa vērtību. Ja elements nav atrasts, tad noklusēto vērtību\n     * \n     * @param {Object} parent_elem Vecākais elements, kurā tiks veikta meklēšana\n     * @param {string} selector    Meklējamais elements\n     * @param {mixed} default_val  Noklusētā vērtība\n     * @returns {mixed}\n     */\n    var getElementVal = function(parent_elem, selector, default_val) {\n        var elem = parent_elem.find(selector);\n\n        if (!elem.length)\n        {\n            return default_val;\n        }\n\n        return elem.val();\n    };\n\n    /**\n     * Parāda vai paslēpj brīdinājumu, ka jānorāda uzņēmums, lai izvēlētos sturktūrvienību\n     * \n     * @param {Object} page_elem Lapas elements\n     * @returns {undefined}\n     */\n    var showHideWarning = function(){\n        var btn_choose = page_elem.find(\".dx-tree-value-choose-btn\");\n        \n        if (getElementVal(page_elem, 'select[name=source_id]', 0) > 0){\n            // noņemam brīdinājumu, ja bija uzstādīts            \n            if (btn_choose.hasClass('tooltipstered')) {\n                btn_choose.tooltipster('disable');\n            }            \n        }\n        else{             \n            if (!btn_choose.hasClass('tooltipstered')) {\n                // uzstādam brīdinājumu pirmo reizi\n                btn_choose.tooltipster({\n                    theme: 'tooltipster-light',\n                    animation: 'grow',\n                    content: page_elem.attr(\"trans_unit_hint\")\n                });\n            }\n            else\n            {\n                // iespjojam jau uzstādītu brīdinājumu\n                btn_choose.tooltipster('enable');\n            }\n        }\n    };\n\n    /**\n     * Parāda vai paslēpj saiti \"Notīrīt kritērijus\" atkarība ir vai nav norādīts vismaz viens kritērijis\n     * \n     * @returns {undefined}\n     */\n    var clearLinkShowHide = function() {\n        if (\n                getElementVal(page_elem, 'select[name=source_id]', 0) > 0 ||\n                getElementVal(page_elem, 'input[name=department]', \"\") ||\n                getElementVal(page_elem, 'input[name=criteria]', \"\") ||\n                getElementVal(page_elem, 'input[name=phone]', \"\") ||\n                getElementVal(page_elem, 'input[name=position]', \"\")\n                )\n        {\n            page_elem.find(\".dx-clear-link\").show();\n        }\n        else\n        {\n            page_elem.find(\".dx-clear-link\").hide();\n        }\n    };\n\n    /**\n     * Notīra meklēšanas kritēriju lauku vērtības\n     * \n     * @returns {undefined}\n     */\n    var clearFields = function() {\n        form_elem.find('input[name=criteria]').val('');\n        form_elem.find('select[name=source_id]').val(0);\n        form_elem.find('input[name=department]').val('');\n        form_elem.find('input[name=position]').val('');\n        form_elem.find('input[name=phone]').val('');\n        form_elem.find('input[name=department_id]').val(0);\n        \n        // uzstāda brdīdinājumu, ka nav norādīts uzņēmums (nevar izvēlēties struktūrvienību)\n        showHideWarning();\n    };\n\n    /**\n     * Nodrošina struktūrvienību izvēlnes loga popup atvēršanu\n     * \n     * @returns {undefined}\n     */\n    var handleDepartmentChoose = function() {\n        page_elem.find(\".dx-tree-value-choose-btn\").click(function(e) {\n\n            var company_id = page_elem.find(\"select[name=source_id]\").val();\n\n            if (company_id == 0)\n            {\n                page_elem.find(\"select[name=source_id]\").focus();\n                page_elem.find(\"select[name=source_id]\").simulate('mousedown');\n                return;\n            }\n\n            get_popup_item_by_id_ie9(company_id, 'ajax/departments', page_elem.find(\"select[name=source_id] option:selected\").text() + ' - ' + page_elem.attr(\"trans_choosing_unit\"), initTree);\n        });\n        \n        // uzstāda deparamenta id uz 0, gadījumā ja manuāli rediģē departamenta teksta lauku\n        page_elem.find(\"input[name=department]\").change(function(e) {\n           page_elem.find('input[name=department_id]').val(0); \n        });\n    };\n\n    /**\n     * Nodrošina struktūrvienības lauka notīrīšanu\n     * \n     * @returns {undefined}\n     */\n    var handleDepartmentClear = function() {\n        page_elem.find(\".dx-tree-value-clear-btn\").click(function(e) {\n            page_elem.find(\"input[name=department]\").val('');\n            page_elem.find(\"input[name=department_id]\").val(0);\n            clearLinkShowHide(page_elem);\n        });\n    };\n   \n    /**\n     * Nodrošina saites \"Notīrīt\" funkcionalitāti - dzēš formas lauku vērtības\n     *\n     * @returns {undefined}\n     */\n    var handleLinkClear = function() {\n        page_elem.find(\".dx-clear-link\").click(function() {\n            clearFields();\n            clearLinkShowHide();\n        });\n    };\n\n    /**\n     * Inicializē vērtību notīrīšanas saites parādīšanu/paslēpšanu, mainoties formas lauku vērtībām\n     * \n     * @returns {undefined}\n     */\n    var handleValueChange = function() {\n        form_elem.find(\"input\").keyup(function() {\n            clearLinkShowHide();\n        });\n\n        form_elem.find(\"select\").change(function() {\n            clearLinkShowHide();\n        });\n    };\n    \n    /**\n     * Nodrošina brīdinajuma uzstādīšanu/paslēpšanu, atkarībā vai norādīts uzņēmums\n     * \n     * @returns {undefined}\n     */\n    var handleSourceChange = function(){\n        form_elem.find(\"select[name=source_id]\").change(function() {\n            showHideWarning();\n        });       \n    };\n    \n    /**\n     * Handles new employee button click - opens form for new employee entering\n     * \n     * @returns {undefined}\n     */\n    var handleNewEmployeeBtn = function() {\n        page_elem.find(\".dx-employee-new-add-btn\").click(function() {\n            new_list_item(page_elem.attr(\"dx_empl_list_id\"), 0, 0, \"\", \"\");\n        });\n    }\n\n    /**\n     * Inicializē meklēšnas rīku parādīšanu pie lapas ielādes - parāda, ja bija meklēšanas pēc kāda no redzamajiem formas laukiem\n     * \n     * @returns {undefined}\n     */\n    var initSearchTools = function()\n    {\n        if (\n                getElementVal(page_elem, 'select[name=source_id]', 0) > 0 ||\n                getElementVal(page_elem, 'input[name=department]', \"\") ||\n                getElementVal(page_elem, 'input[name=phone]', \"\") ||\n                getElementVal(page_elem, 'input[name=position]')\n                )\n        {\n            SearchTools.showHideTools();\n        }\n    };\n    \n    /**\n     * Inicializē darbinieku lapas JavaScript funkcionalitāti\n     * \n     * @returns {undefined}\n     */\n    var initPage = function() {        \n        \n        page_elem = $(\".dx-employees-page\");\n        form_elem = page_elem.find('.search-tools-form');\n        \n        SearchTools.init(clearLinkShowHide, clearFields);\n                \n        handleDepartmentChoose();\n        handleDepartmentClear();\n\n        EmployeesLinks.init(page_elem, clearFields);\n\n        handleValueChange();\n        handleLinkClear();\n        handleSourceChange();\n\n        clearLinkShowHide();\n        initSearchTools();\n        showHideWarning();\n        handleNewEmployeeBtn();\n    };\n\n    /**\n     * Inicializē struktūrvienību koku\n     * \n     * @returns {undefined}\n     */\n    var initTree = function() {        \n        $(\".dx-department-tree-container\").on('select_node.jstree', function (e, data) {\n            var i, j;\n            for(i = 0, j = data.selected.length; i < j; i++) {\n                var node = data.instance.get_node(data.selected[i], true);\n                \n                $(\".dx-employees-page input[name=department]\").val(node.text());\n                $(\".dx-employees-page input[name=department_id]\").val(node.attr(\"data-id\"));\n                $( '#popup_window' ).modal('hide');\n                break;\n            }\n            \n        }).jstree({\n            \"core\" : {\"multiple\" : false },\n            \n        });\n    };\n\n    return {\n        init: function() {\n            initPage();\n        },\n        initTree: function() {\n            initTree();\n        }\n    };\n}();\n\n$(document).ready(function() {\n    PageEmployees.init();\n});\n\n$(document).ajaxComplete(function(event, xhr, settings) {\n    PageEmployees.initTree();\n});"]}