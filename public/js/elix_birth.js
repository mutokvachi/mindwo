!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.moment=t()}(this,function(){"use strict";function e(){return Ti.apply(null,arguments)}function t(e){Ti=e}function i(e){return"[object Array]"===Object.prototype.toString.call(e)}function n(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function a(e,t){var i,n=[];for(i=0;i<e.length;++i)n.push(t(e[i],i));return n}function s(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function r(e,t){for(var i in t)s(t,i)&&(e[i]=t[i]);return s(t,"toString")&&(e.toString=t.toString),s(t,"valueOf")&&(e.valueOf=t.valueOf),e}function o(e,t,i,n){return De(e,t,i,n,!0).utc()}function d(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function l(e){return null==e._pf&&(e._pf=d()),e._pf}function c(e){if(null==e._isValid){var t=l(e);e._isValid=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidMonth&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated,e._strict&&(e._isValid=e._isValid&&0===t.charsLeftOver&&0===t.unusedTokens.length&&void 0===t.bigHour)}return e._isValid}function h(e){var t=o(NaN);return null!=e?r(l(t),e):l(t).userInvalidated=!0,t}function u(e,t){var i,n,a;if("undefined"!=typeof t._isAMomentObject&&(e._isAMomentObject=t._isAMomentObject),"undefined"!=typeof t._i&&(e._i=t._i),"undefined"!=typeof t._f&&(e._f=t._f),"undefined"!=typeof t._l&&(e._l=t._l),"undefined"!=typeof t._strict&&(e._strict=t._strict),"undefined"!=typeof t._tzm&&(e._tzm=t._tzm),"undefined"!=typeof t._isUTC&&(e._isUTC=t._isUTC),"undefined"!=typeof t._offset&&(e._offset=t._offset),"undefined"!=typeof t._pf&&(e._pf=l(t)),"undefined"!=typeof t._locale&&(e._locale=t._locale),Oi.length>0)for(i in Oi)n=Oi[i],a=t[n],"undefined"!=typeof a&&(e[n]=a);return e}function f(t){u(this,t),this._d=new Date((+t._d)),Pi===!1&&(Pi=!0,e.updateOffset(this),Pi=!1)}function _(e){return e instanceof f||null!=e&&null!=e._isAMomentObject}function g(e){var t=+e,i=0;return 0!==t&&isFinite(t)&&(i=t>=0?Math.floor(t):Math.ceil(t)),i}function p(e,t,i){var n,a=Math.min(e.length,t.length),s=Math.abs(e.length-t.length),r=0;for(n=0;a>n;n++)(i&&e[n]!==t[n]||!i&&g(e[n])!==g(t[n]))&&r++;return r+s}function m(){}function v(e){return e?e.toLowerCase().replace("_","-"):e}function y(e){for(var t,i,n,a,s=0;s<e.length;){for(a=v(e[s]).split("-"),t=a.length,i=v(e[s+1]),i=i?i.split("-"):null;t>0;){if(n=k(a.slice(0,t).join("-")))return n;if(i&&i.length>=t&&p(a,i,!0)>=t-1)break;t--}s++}return null}function k(e){var t=null;if(!Ai[e]&&"undefined"!=typeof module&&module&&module.exports)try{t=Si._abbr,require("./locale/"+e),j(t)}catch(i){}return Ai[e]}function j(e,t){var i;return e&&(i="undefined"==typeof t?x(e):b(e,t),i&&(Si=i)),Si._abbr}function b(e,t){return null!==t?(t.abbr=e,Ai[e]||(Ai[e]=new m),Ai[e].set(t),j(e),Ai[e]):(delete Ai[e],null)}function x(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return Si;if(!i(e)){if(t=k(e))return t;e=[e]}return y(e)}function w(e,t){var i=e.toLowerCase();Li[i]=Li[i+"s"]=Li[t]=e}function D(e){return"string"==typeof e?Li[e]||Li[e.toLowerCase()]:void 0}function C(e){var t,i,n={};for(i in e)s(e,i)&&(t=D(i),t&&(n[t]=e[i]));return n}function Y(t,i){return function(n){return null!=n?(T(this,t,n),e.updateOffset(this,i),this):M(this,t)}}function M(e,t){return e._d["get"+(e._isUTC?"UTC":"")+t]()}function T(e,t,i){return e._d["set"+(e._isUTC?"UTC":"")+t](i)}function S(e,t){var i;if("object"==typeof e)for(i in e)this.set(i,e[i]);else if(e=D(e),"function"==typeof this[e])return this[e](t);return this}function O(e,t,i){for(var n=""+Math.abs(e),a=e>=0;n.length<t;)n="0"+n;return(a?i?"+":"":"-")+n}function P(e,t,i,n){var a=n;"string"==typeof n&&(a=function(){return this[n]()}),e&&(Wi[e]=a),t&&(Wi[t[0]]=function(){return O(a.apply(this,arguments),t[1],t[2])}),i&&(Wi[i]=function(){return this.localeData().ordinal(a.apply(this,arguments),e)})}function A(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function L(e){var t,i,n=e.match(Ni);for(t=0,i=n.length;i>t;t++)Wi[n[t]]?n[t]=Wi[n[t]]:n[t]=A(n[t]);return function(a){var s="";for(t=0;i>t;t++)s+=n[t]instanceof Function?n[t].call(a,e):n[t];return s}}function N(e,t){return e.isValid()?(t=I(t,e.localeData()),Ei[t]||(Ei[t]=L(t)),Ei[t](e)):e.localeData().invalidDate()}function I(e,t){function i(e){return t.longDateFormat(e)||e}var n=5;for(Ii.lastIndex=0;n>=0&&Ii.test(e);)e=e.replace(Ii,i),Ii.lastIndex=0,n-=1;return e}function E(e,t,i){Qi[e]="function"==typeof t?t:function(e){return e&&i?i:t}}function W(e,t){return s(Qi,e)?Qi[e](t._strict,t._locale):new RegExp(H(e))}function H(e){return e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,i,n,a){return t||i||n||a}).replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function U(e,t){var i,n=t;for("string"==typeof e&&(e=[e]),"number"==typeof t&&(n=function(e,i){i[t]=g(e)}),i=0;i<e.length;i++)en[e[i]]=n}function F(e,t){U(e,function(e,i,n,a){n._w=n._w||{},t(e,n._w,n,a)})}function B(e,t,i){null!=t&&s(en,e)&&en[e](t,i._a,i,e)}function q(e,t){return new Date(Date.UTC(e,t+1,0)).getUTCDate()}function $(e){return this._months[e.month()]}function G(e){return this._monthsShort[e.month()]}function K(e,t,i){var n,a,s;for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;12>n;n++){if(a=o([2e3,n]),i&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(a,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(a,"").replace(".","")+"$","i")),i||this._monthsParse[n]||(s="^"+this.months(a,"")+"|^"+this.monthsShort(a,""),this._monthsParse[n]=new RegExp(s.replace(".",""),"i")),i&&"MMMM"===t&&this._longMonthsParse[n].test(e))return n;if(i&&"MMM"===t&&this._shortMonthsParse[n].test(e))return n;if(!i&&this._monthsParse[n].test(e))return n}}function z(e,t){var i;return"string"==typeof t&&(t=e.localeData().monthsParse(t),"number"!=typeof t)?e:(i=Math.min(e.date(),q(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,i),e)}function J(t){return null!=t?(z(this,t),e.updateOffset(this,!0),this):M(this,"Month")}function R(){return q(this.year(),this.month())}function V(e){var t,i=e._a;return i&&-2===l(e).overflow&&(t=i[nn]<0||i[nn]>11?nn:i[an]<1||i[an]>q(i[tn],i[nn])?an:i[sn]<0||i[sn]>24||24===i[sn]&&(0!==i[rn]||0!==i[on]||0!==i[dn])?sn:i[rn]<0||i[rn]>59?rn:i[on]<0||i[on]>59?on:i[dn]<0||i[dn]>999?dn:-1,l(e)._overflowDayOfYear&&(tn>t||t>an)&&(t=an),l(e).overflow=t),e}function X(t){e.suppressDeprecationWarnings===!1&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+t)}function Z(e,t){var i=!0,n=e+"\n"+(new Error).stack;return r(function(){return i&&(X(n),i=!1),t.apply(this,arguments)},t)}function Q(e,t){hn[e]||(X(t),hn[e]=!0)}function ee(e){var t,i,n=e._i,a=un.exec(n);if(a){for(l(e).iso=!0,t=0,i=fn.length;i>t;t++)if(fn[t][1].exec(n)){e._f=fn[t][0]+(a[6]||" ");break}for(t=0,i=_n.length;i>t;t++)if(_n[t][1].exec(n)){e._f+=_n[t][0];break}n.match(Vi)&&(e._f+="Z"),ye(e)}else e._isValid=!1}function te(t){var i=gn.exec(t._i);return null!==i?void(t._d=new Date((+i[1]))):(ee(t),void(t._isValid===!1&&(delete t._isValid,e.createFromInputFallback(t))))}function ie(e,t,i,n,a,s,r){var o=new Date(e,t,i,n,a,s,r);return 1970>e&&o.setFullYear(e),o}function ne(e){var t=new Date(Date.UTC.apply(null,arguments));return 1970>e&&t.setUTCFullYear(e),t}function ae(e){return se(e)?366:365}function se(e){return e%4===0&&e%100!==0||e%400===0}function re(){return se(this.year())}function oe(e,t,i){var n,a=i-t,s=i-e.day();return s>a&&(s-=7),a-7>s&&(s+=7),n=Ce(e).add(s,"d"),{week:Math.ceil(n.dayOfYear()/7),year:n.year()}}function de(e){return oe(e,this._week.dow,this._week.doy).week}function le(){return this._week.dow}function ce(){return this._week.doy}function he(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")}function ue(e){var t=oe(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")}function fe(e,t,i,n,a){var s,r,o=ne(e,0,1).getUTCDay();return o=0===o?7:o,i=null!=i?i:a,s=a-o+(o>n?7:0)-(a>o?7:0),r=7*(t-1)+(i-a)+s+1,{year:r>0?e:e-1,dayOfYear:r>0?r:ae(e-1)+r}}function _e(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")}function ge(e,t,i){return null!=e?e:null!=t?t:i}function pe(e){var t=new Date;return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function me(e){var t,i,n,a,s=[];if(!e._d){for(n=pe(e),e._w&&null==e._a[an]&&null==e._a[nn]&&ve(e),e._dayOfYear&&(a=ge(e._a[tn],n[tn]),e._dayOfYear>ae(a)&&(l(e)._overflowDayOfYear=!0),i=ne(a,0,e._dayOfYear),e._a[nn]=i.getUTCMonth(),e._a[an]=i.getUTCDate()),t=0;3>t&&null==e._a[t];++t)e._a[t]=s[t]=n[t];for(;7>t;t++)e._a[t]=s[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[sn]&&0===e._a[rn]&&0===e._a[on]&&0===e._a[dn]&&(e._nextDay=!0,e._a[sn]=0),e._d=(e._useUTC?ne:ie).apply(null,s),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[sn]=24)}}function ve(e){var t,i,n,a,s,r,o;t=e._w,null!=t.GG||null!=t.W||null!=t.E?(s=1,r=4,i=ge(t.GG,e._a[tn],oe(Ce(),1,4).year),n=ge(t.W,1),a=ge(t.E,1)):(s=e._locale._week.dow,r=e._locale._week.doy,i=ge(t.gg,e._a[tn],oe(Ce(),s,r).year),n=ge(t.w,1),null!=t.d?(a=t.d,s>a&&++n):a=null!=t.e?t.e+s:s),o=fe(i,n,a,r,s),e._a[tn]=o.year,e._dayOfYear=o.dayOfYear}function ye(t){if(t._f===e.ISO_8601)return void ee(t);t._a=[],l(t).empty=!0;var i,n,a,s,r,o=""+t._i,d=o.length,c=0;for(a=I(t._f,t._locale).match(Ni)||[],i=0;i<a.length;i++)s=a[i],n=(o.match(W(s,t))||[])[0],n&&(r=o.substr(0,o.indexOf(n)),r.length>0&&l(t).unusedInput.push(r),o=o.slice(o.indexOf(n)+n.length),c+=n.length),Wi[s]?(n?l(t).empty=!1:l(t).unusedTokens.push(s),B(s,n,t)):t._strict&&!n&&l(t).unusedTokens.push(s);l(t).charsLeftOver=d-c,o.length>0&&l(t).unusedInput.push(o),l(t).bigHour===!0&&t._a[sn]<=12&&t._a[sn]>0&&(l(t).bigHour=void 0),t._a[sn]=ke(t._locale,t._a[sn],t._meridiem),me(t),V(t)}function ke(e,t,i){var n;return null==i?t:null!=e.meridiemHour?e.meridiemHour(t,i):null!=e.isPM?(n=e.isPM(i),n&&12>t&&(t+=12),n||12!==t||(t=0),t):t}function je(e){var t,i,n,a,s;if(0===e._f.length)return l(e).invalidFormat=!0,void(e._d=new Date(NaN));for(a=0;a<e._f.length;a++)s=0,t=u({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[a],ye(t),c(t)&&(s+=l(t).charsLeftOver,s+=10*l(t).unusedTokens.length,l(t).score=s,(null==n||n>s)&&(n=s,i=t));r(e,i||t)}function be(e){if(!e._d){var t=C(e._i);e._a=[t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],me(e)}}function xe(e){var t,a=e._i,s=e._f;return e._locale=e._locale||x(e._l),null===a||void 0===s&&""===a?h({nullInput:!0}):("string"==typeof a&&(e._i=a=e._locale.preparse(a)),_(a)?new f(V(a)):(i(s)?je(e):s?ye(e):n(a)?e._d=a:we(e),t=new f(V(e)),t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t))}function we(t){var s=t._i;void 0===s?t._d=new Date:n(s)?t._d=new Date((+s)):"string"==typeof s?te(t):i(s)?(t._a=a(s.slice(0),function(e){return parseInt(e,10)}),me(t)):"object"==typeof s?be(t):"number"==typeof s?t._d=new Date(s):e.createFromInputFallback(t)}function De(e,t,i,n,a){var s={};return"boolean"==typeof i&&(n=i,i=void 0),s._isAMomentObject=!0,s._useUTC=s._isUTC=a,s._l=i,s._i=e,s._f=t,s._strict=n,xe(s)}function Ce(e,t,i,n){return De(e,t,i,n,!1)}function Ye(e,t){var n,a;if(1===t.length&&i(t[0])&&(t=t[0]),!t.length)return Ce();for(n=t[0],a=1;a<t.length;++a)t[a][e](n)&&(n=t[a]);return n}function Me(){var e=[].slice.call(arguments,0);return Ye("isBefore",e)}function Te(){var e=[].slice.call(arguments,0);return Ye("isAfter",e)}function Se(e){var t=C(e),i=t.year||0,n=t.quarter||0,a=t.month||0,s=t.week||0,r=t.day||0,o=t.hour||0,d=t.minute||0,l=t.second||0,c=t.millisecond||0;this._milliseconds=+c+1e3*l+6e4*d+36e5*o,this._days=+r+7*s,this._months=+a+3*n+12*i,this._data={},this._locale=x(),this._bubble()}function Oe(e){return e instanceof Se}function Pe(e,t){P(e,0,0,function(){var e=this.utcOffset(),i="+";return 0>e&&(e=-e,i="-"),i+O(~~(e/60),2)+t+O(~~e%60,2)})}function Ae(e){var t=(e||"").match(Vi)||[],i=t[t.length-1]||[],n=(i+"").match(kn)||["-",0,0],a=+(60*n[1])+g(n[2]);return"+"===n[0]?a:-a}function Le(t,i){var a,s;return i._isUTC?(a=i.clone(),s=(_(t)||n(t)?+t:+Ce(t))-+a,a._d.setTime(+a._d+s),e.updateOffset(a,!1),a):Ce(t).local()}function Ne(e){return 15*-Math.round(e._d.getTimezoneOffset()/15)}function Ie(t,i){var n,a=this._offset||0;return null!=t?("string"==typeof t&&(t=Ae(t)),Math.abs(t)<16&&(t=60*t),!this._isUTC&&i&&(n=Ne(this)),this._offset=t,this._isUTC=!0,null!=n&&this.add(n,"m"),a!==t&&(!i||this._changeInProgress?Ze(this,ze(t-a,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,e.updateOffset(this,!0),this._changeInProgress=null)),this):this._isUTC?a:Ne(this)}function Ee(e,t){return null!=e?("string"!=typeof e&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function We(e){return this.utcOffset(0,e)}function He(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(Ne(this),"m")),this}function Ue(){return this._tzm?this.utcOffset(this._tzm):"string"==typeof this._i&&this.utcOffset(Ae(this._i)),this}function Fe(e){return e=e?Ce(e).utcOffset():0,(this.utcOffset()-e)%60===0}function Be(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function qe(){if(this._a){var e=this._isUTC?o(this._a):Ce(this._a);return this.isValid()&&p(this._a,e.toArray())>0}return!1}function $e(){return!this._isUTC}function Ge(){return this._isUTC}function Ke(){return this._isUTC&&0===this._offset}function ze(e,t){var i,n,a,r=e,o=null;return Oe(e)?r={ms:e._milliseconds,d:e._days,M:e._months}:"number"==typeof e?(r={},t?r[t]=e:r.milliseconds=e):(o=jn.exec(e))?(i="-"===o[1]?-1:1,r={y:0,d:g(o[an])*i,h:g(o[sn])*i,m:g(o[rn])*i,s:g(o[on])*i,ms:g(o[dn])*i}):(o=bn.exec(e))?(i="-"===o[1]?-1:1,r={y:Je(o[2],i),M:Je(o[3],i),d:Je(o[4],i),h:Je(o[5],i),m:Je(o[6],i),s:Je(o[7],i),w:Je(o[8],i)}):null==r?r={}:"object"==typeof r&&("from"in r||"to"in r)&&(a=Ve(Ce(r.from),Ce(r.to)),r={},r.ms=a.milliseconds,r.M=a.months),n=new Se(r),Oe(e)&&s(e,"_locale")&&(n._locale=e._locale),n}function Je(e,t){var i=e&&parseFloat(e.replace(",","."));return(isNaN(i)?0:i)*t}function Re(e,t){var i={milliseconds:0,months:0};return i.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(i.months,"M").isAfter(t)&&--i.months,i.milliseconds=+t-+e.clone().add(i.months,"M"),i}function Ve(e,t){var i;return t=Le(t,e),e.isBefore(t)?i=Re(e,t):(i=Re(t,e),i.milliseconds=-i.milliseconds,i.months=-i.months),i}function Xe(e,t){return function(i,n){var a,s;return null===n||isNaN(+n)||(Q(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period)."),s=i,i=n,n=s),i="string"==typeof i?+i:i,a=ze(i,n),Ze(this,a,e),this}}function Ze(t,i,n,a){var s=i._milliseconds,r=i._days,o=i._months;a=null==a||a,s&&t._d.setTime(+t._d+s*n),r&&T(t,"Date",M(t,"Date")+r*n),o&&z(t,M(t,"Month")+o*n),a&&e.updateOffset(t,r||o)}function Qe(e){var t=e||Ce(),i=Le(t,this).startOf("day"),n=this.diff(i,"days",!0),a=-6>n?"sameElse":-1>n?"lastWeek":0>n?"lastDay":1>n?"sameDay":2>n?"nextDay":7>n?"nextWeek":"sameElse";return this.format(this.localeData().calendar(a,this,Ce(t)))}function et(){return new f(this)}function tt(e,t){var i;return t=D("undefined"!=typeof t?t:"millisecond"),"millisecond"===t?(e=_(e)?e:Ce(e),+this>+e):(i=_(e)?+e:+Ce(e),i<+this.clone().startOf(t))}function it(e,t){var i;return t=D("undefined"!=typeof t?t:"millisecond"),"millisecond"===t?(e=_(e)?e:Ce(e),+e>+this):(i=_(e)?+e:+Ce(e),+this.clone().endOf(t)<i)}function nt(e,t,i){return this.isAfter(e,i)&&this.isBefore(t,i)}function at(e,t){var i;return t=D(t||"millisecond"),"millisecond"===t?(e=_(e)?e:Ce(e),+this===+e):(i=+Ce(e),+this.clone().startOf(t)<=i&&i<=+this.clone().endOf(t))}function st(e){return 0>e?Math.ceil(e):Math.floor(e)}function rt(e,t,i){var n,a,s=Le(e,this),r=6e4*(s.utcOffset()-this.utcOffset());return t=D(t),"year"===t||"month"===t||"quarter"===t?(a=ot(this,s),"quarter"===t?a/=3:"year"===t&&(a/=12)):(n=this-s,a="second"===t?n/1e3:"minute"===t?n/6e4:"hour"===t?n/36e5:"day"===t?(n-r)/864e5:"week"===t?(n-r)/6048e5:n),i?a:st(a)}function ot(e,t){var i,n,a=12*(t.year()-e.year())+(t.month()-e.month()),s=e.clone().add(a,"months");return 0>t-s?(i=e.clone().add(a-1,"months"),n=(t-s)/(s-i)):(i=e.clone().add(a+1,"months"),n=(t-s)/(i-s)),-(a+n)}function dt(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function lt(){var e=this.clone().utc();return 0<e.year()&&e.year()<=9999?"function"==typeof Date.prototype.toISOString?this.toDate().toISOString():N(e,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):N(e,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}function ct(t){var i=N(this,t||e.defaultFormat);return this.localeData().postformat(i)}function ht(e,t){return this.isValid()?ze({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function ut(e){return this.from(Ce(),e)}function ft(e,t){return this.isValid()?ze({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function _t(e){return this.to(Ce(),e)}function gt(e){var t;return void 0===e?this._locale._abbr:(t=x(e),null!=t&&(this._locale=t),this)}function pt(){return this._locale}function mt(e){switch(e=D(e)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e&&this.weekday(0),"isoWeek"===e&&this.isoWeekday(1),"quarter"===e&&this.month(3*Math.floor(this.month()/3)),this}function vt(e){return e=D(e),void 0===e||"millisecond"===e?this:this.startOf(e).add(1,"isoWeek"===e?"week":e).subtract(1,"ms")}function yt(){return+this._d-6e4*(this._offset||0)}function kt(){return Math.floor(+this/1e3)}function jt(){return this._offset?new Date((+this)):this._d}function bt(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function xt(){return c(this)}function wt(){return r({},l(this))}function Dt(){return l(this).overflow}function Ct(e,t){P(0,[e,e.length],0,t)}function Yt(e,t,i){return oe(Ce([e,11,31+t-i]),t,i).week}function Mt(e){var t=oe(this,this.localeData()._week.dow,this.localeData()._week.doy).year;return null==e?t:this.add(e-t,"y")}function Tt(e){var t=oe(this,1,4).year;return null==e?t:this.add(e-t,"y")}function St(){return Yt(this.year(),1,4)}function Ot(){var e=this.localeData()._week;return Yt(this.year(),e.dow,e.doy)}function Pt(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)}function At(e,t){if("string"==typeof e)if(isNaN(e)){if(e=t.weekdaysParse(e),"number"!=typeof e)return null}else e=parseInt(e,10);return e}function Lt(e){return this._weekdays[e.day()]}function Nt(e){return this._weekdaysShort[e.day()]}function It(e){return this._weekdaysMin[e.day()]}function Et(e){var t,i,n;for(this._weekdaysParse||(this._weekdaysParse=[]),t=0;7>t;t++)if(this._weekdaysParse[t]||(i=Ce([2e3,1]).day(t),n="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[t]=new RegExp(n.replace(".",""),"i")),this._weekdaysParse[t].test(e))return t}function Wt(e){var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=At(e,this.localeData()),this.add(e-t,"d")):t}function Ht(e){var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")}function Ut(e){return null==e?this.day()||7:this.day(this.day()%7?e:e-7)}function Ft(e,t){P(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}function Bt(e,t){return t._meridiemParse}function qt(e){return"p"===(e+"").toLowerCase().charAt(0)}function $t(e,t,i){return e>11?i?"pm":"PM":i?"am":"AM"}function Gt(e){P(0,[e,3],0,"millisecond")}function Kt(){return this._isUTC?"UTC":""}function zt(){return this._isUTC?"Coordinated Universal Time":""}function Jt(e){return Ce(1e3*e)}function Rt(){return Ce.apply(null,arguments).parseZone()}function Vt(e,t,i){var n=this._calendar[e];return"function"==typeof n?n.call(t,i):n}function Xt(e){var t=this._longDateFormat[e];return!t&&this._longDateFormat[e.toUpperCase()]&&(t=this._longDateFormat[e.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e]=t),t}function Zt(){return this._invalidDate}function Qt(e){return this._ordinal.replace("%d",e)}function ei(e){return e}function ti(e,t,i,n){var a=this._relativeTime[i];return"function"==typeof a?a(e,t,i,n):a.replace(/%d/i,e)}function ii(e,t){var i=this._relativeTime[e>0?"future":"past"];return"function"==typeof i?i(t):i.replace(/%s/i,t)}function ni(e){var t,i;for(i in e)t=e[i],"function"==typeof t?this[i]=t:this["_"+i]=t;this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)}function ai(e,t,i,n){var a=x(),s=o().set(n,t);return a[i](s,e)}function si(e,t,i,n,a){if("number"==typeof e&&(t=e,e=void 0),e=e||"",null!=t)return ai(e,t,i,a);var s,r=[];for(s=0;n>s;s++)r[s]=ai(e,s,i,a);return r}function ri(e,t){return si(e,t,"months",12,"month")}function oi(e,t){return si(e,t,"monthsShort",12,"month")}function di(e,t){return si(e,t,"weekdays",7,"day")}function li(e,t){return si(e,t,"weekdaysShort",7,"day")}function ci(e,t){return si(e,t,"weekdaysMin",7,"day")}function hi(){var e=this._data;return this._milliseconds=$n(this._milliseconds),this._days=$n(this._days),this._months=$n(this._months),e.milliseconds=$n(e.milliseconds),e.seconds=$n(e.seconds),e.minutes=$n(e.minutes),e.hours=$n(e.hours),e.months=$n(e.months),e.years=$n(e.years),this}function ui(e,t,i,n){var a=ze(t,i);return e._milliseconds+=n*a._milliseconds,e._days+=n*a._days,e._months+=n*a._months,e._bubble()}function fi(e,t){return ui(this,e,t,1)}function _i(e,t){return ui(this,e,t,-1)}function gi(){var e,t,i,n=this._milliseconds,a=this._days,s=this._months,r=this._data,o=0;return r.milliseconds=n%1e3,e=st(n/1e3),r.seconds=e%60,t=st(e/60),r.minutes=t%60,i=st(t/60),r.hours=i%24,a+=st(i/24),o=st(pi(a)),a-=st(mi(o)),s+=st(a/30),a%=30,o+=st(s/12),s%=12,r.days=a,r.months=s,r.years=o,this}function pi(e){return 400*e/146097}function mi(e){return 146097*e/400}function vi(e){var t,i,n=this._milliseconds;if(e=D(e),"month"===e||"year"===e)return t=this._days+n/864e5,i=this._months+12*pi(t),"month"===e?i:i/12;switch(t=this._days+Math.round(mi(this._months/12)),e){case"week":return t/7+n/6048e5;case"day":return t+n/864e5;case"hour":return 24*t+n/36e5;case"minute":return 1440*t+n/6e4;case"second":return 86400*t+n/1e3;case"millisecond":return Math.floor(864e5*t)+n;default:throw new Error("Unknown unit "+e)}}function yi(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*g(this._months/12)}function ki(e){return function(){return this.as(e)}}function ji(e){return e=D(e),this[e+"s"]()}function bi(e){return function(){return this._data[e]}}function xi(){return st(this.days()/7)}function wi(e,t,i,n,a){return a.relativeTime(t||1,!!i,e,n)}function Di(e,t,i){var n=ze(e).abs(),a=ra(n.as("s")),s=ra(n.as("m")),r=ra(n.as("h")),o=ra(n.as("d")),d=ra(n.as("M")),l=ra(n.as("y")),c=a<oa.s&&["s",a]||1===s&&["m"]||s<oa.m&&["mm",s]||1===r&&["h"]||r<oa.h&&["hh",r]||1===o&&["d"]||o<oa.d&&["dd",o]||1===d&&["M"]||d<oa.M&&["MM",d]||1===l&&["y"]||["yy",l];return c[2]=t,c[3]=+e>0,c[4]=i,wi.apply(null,c)}function Ci(e,t){return void 0!==oa[e]&&(void 0===t?oa[e]:(oa[e]=t,!0))}function Yi(e){var t=this.localeData(),i=Di(this,!e,t);return e&&(i=t.pastFuture(+this,i)),t.postformat(i)}function Mi(){var e=da(this.years()),t=da(this.months()),i=da(this.days()),n=da(this.hours()),a=da(this.minutes()),s=da(this.seconds()+this.milliseconds()/1e3),r=this.asSeconds();return r?(0>r?"-":"")+"P"+(e?e+"Y":"")+(t?t+"M":"")+(i?i+"D":"")+(n||a||s?"T":"")+(n?n+"H":"")+(a?a+"M":"")+(s?s+"S":""):"P0D"}var Ti,Si,Oi=e.momentProperties=[],Pi=!1,Ai={},Li={},Ni=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|x|X|zz?|ZZ?|.)/g,Ii=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Ei={},Wi={},Hi=/\d/,Ui=/\d\d/,Fi=/\d{3}/,Bi=/\d{4}/,qi=/[+-]?\d{6}/,$i=/\d\d?/,Gi=/\d{1,3}/,Ki=/\d{1,4}/,zi=/[+-]?\d{1,6}/,Ji=/\d+/,Ri=/[+-]?\d+/,Vi=/Z|[+-]\d\d:?\d\d/gi,Xi=/[+-]?\d+(\.\d{1,3})?/,Zi=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,Qi={},en={},tn=0,nn=1,an=2,sn=3,rn=4,on=5,dn=6;P("M",["MM",2],"Mo",function(){return this.month()+1}),P("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)}),P("MMMM",0,0,function(e){return this.localeData().months(this,e)}),w("month","M"),E("M",$i),E("MM",$i,Ui),E("MMM",Zi),E("MMMM",Zi),U(["M","MM"],function(e,t){t[nn]=g(e)-1}),U(["MMM","MMMM"],function(e,t,i,n){var a=i._locale.monthsParse(e,n,i._strict);null!=a?t[nn]=a:l(i).invalidMonth=e});var ln="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),cn="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),hn={};e.suppressDeprecationWarnings=!1;var un=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,fn=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],_n=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],gn=/^\/?Date\((\-?\d+)/i;e.createFromInputFallback=Z("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))}),P(0,["YY",2],0,function(){return this.year()%100}),P(0,["YYYY",4],0,"year"),P(0,["YYYYY",5],0,"year"),P(0,["YYYYYY",6,!0],0,"year"),w("year","y"),E("Y",Ri),E("YY",$i,Ui),E("YYYY",Ki,Bi),E("YYYYY",zi,qi),E("YYYYYY",zi,qi),U(["YYYY","YYYYY","YYYYYY"],tn),U("YY",function(t,i){i[tn]=e.parseTwoDigitYear(t)}),e.parseTwoDigitYear=function(e){return g(e)+(g(e)>68?1900:2e3)};var pn=Y("FullYear",!1);P("w",["ww",2],"wo","week"),P("W",["WW",2],"Wo","isoWeek"),w("week","w"),w("isoWeek","W"),E("w",$i),E("ww",$i,Ui),E("W",$i),E("WW",$i,Ui),F(["w","ww","W","WW"],function(e,t,i,n){t[n.substr(0,1)]=g(e)});var mn={dow:0,doy:6};P("DDD",["DDDD",3],"DDDo","dayOfYear"),w("dayOfYear","DDD"),E("DDD",Gi),E("DDDD",Fi),U(["DDD","DDDD"],function(e,t,i){i._dayOfYear=g(e)}),e.ISO_8601=function(){};var vn=Z("moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(){var e=Ce.apply(null,arguments);return this>e?this:e}),yn=Z("moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(){var e=Ce.apply(null,arguments);return e>this?this:e});Pe("Z",":"),Pe("ZZ",""),E("Z",Vi),E("ZZ",Vi),U(["Z","ZZ"],function(e,t,i){i._useUTC=!0,i._tzm=Ae(e)});var kn=/([\+\-]|\d\d)/gi;e.updateOffset=function(){};var jn=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,bn=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/;ze.fn=Se.prototype;var xn=Xe(1,"add"),wn=Xe(-1,"subtract");e.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";var Dn=Z("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return void 0===e?this.localeData():this.locale(e)});P(0,["gg",2],0,function(){return this.weekYear()%100}),P(0,["GG",2],0,function(){return this.isoWeekYear()%100}),Ct("gggg","weekYear"),Ct("ggggg","weekYear"),Ct("GGGG","isoWeekYear"),Ct("GGGGG","isoWeekYear"),w("weekYear","gg"),w("isoWeekYear","GG"),E("G",Ri),E("g",Ri),E("GG",$i,Ui),E("gg",$i,Ui),E("GGGG",Ki,Bi),E("gggg",Ki,Bi),E("GGGGG",zi,qi),E("ggggg",zi,qi),F(["gggg","ggggg","GGGG","GGGGG"],function(e,t,i,n){t[n.substr(0,2)]=g(e)}),F(["gg","GG"],function(t,i,n,a){i[a]=e.parseTwoDigitYear(t)}),P("Q",0,0,"quarter"),w("quarter","Q"),E("Q",Hi),U("Q",function(e,t){t[nn]=3*(g(e)-1)}),P("D",["DD",2],"Do","date"),w("date","D"),E("D",$i),E("DD",$i,Ui),E("Do",function(e,t){return e?t._ordinalParse:t._ordinalParseLenient}),U(["D","DD"],an),U("Do",function(e,t){t[an]=g(e.match($i)[0],10)});var Cn=Y("Date",!0);P("d",0,"do","day"),P("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)}),P("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)}),P("dddd",0,0,function(e){return this.localeData().weekdays(this,e)}),P("e",0,0,"weekday"),P("E",0,0,"isoWeekday"),w("day","d"),w("weekday","e"),w("isoWeekday","E"),E("d",$i),E("e",$i),E("E",$i),E("dd",Zi),E("ddd",Zi),E("dddd",Zi),F(["dd","ddd","dddd"],function(e,t,i){var n=i._locale.weekdaysParse(e);null!=n?t.d=n:l(i).invalidWeekday=e}),F(["d","e","E"],function(e,t,i,n){t[n]=g(e)});var Yn="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Mn="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Tn="Su_Mo_Tu_We_Th_Fr_Sa".split("_");P("H",["HH",2],0,"hour"),P("h",["hh",2],0,function(){return this.hours()%12||12}),Ft("a",!0),Ft("A",!1),w("hour","h"),E("a",Bt),E("A",Bt),E("H",$i),E("h",$i),E("HH",$i,Ui),E("hh",$i,Ui),U(["H","HH"],sn),U(["a","A"],function(e,t,i){i._isPm=i._locale.isPM(e),i._meridiem=e}),U(["h","hh"],function(e,t,i){t[sn]=g(e),l(i).bigHour=!0});var Sn=/[ap]\.?m?\.?/i,On=Y("Hours",!0);P("m",["mm",2],0,"minute"),w("minute","m"),E("m",$i),E("mm",$i,Ui),U(["m","mm"],rn);var Pn=Y("Minutes",!1);P("s",["ss",2],0,"second"),w("second","s"),E("s",$i),E("ss",$i,Ui),U(["s","ss"],on);var An=Y("Seconds",!1);P("S",0,0,function(){return~~(this.millisecond()/100)}),P(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),Gt("SSS"),Gt("SSSS"),w("millisecond","ms"),E("S",Gi,Hi),E("SS",Gi,Ui),E("SSS",Gi,Fi),E("SSSS",Ji),U(["S","SS","SSS","SSSS"],function(e,t){t[dn]=g(1e3*("0."+e))});var Ln=Y("Milliseconds",!1);P("z",0,0,"zoneAbbr"),P("zz",0,0,"zoneName");var Nn=f.prototype;Nn.add=xn,Nn.calendar=Qe,Nn.clone=et,Nn.diff=rt,Nn.endOf=vt,Nn.format=ct,Nn.from=ht,Nn.fromNow=ut,Nn.to=ft,Nn.toNow=_t,Nn.get=S,Nn.invalidAt=Dt,Nn.isAfter=tt,Nn.isBefore=it,Nn.isBetween=nt,Nn.isSame=at,Nn.isValid=xt,Nn.lang=Dn,Nn.locale=gt,Nn.localeData=pt,Nn.max=yn,Nn.min=vn,Nn.parsingFlags=wt,Nn.set=S,Nn.startOf=mt,Nn.subtract=wn,Nn.toArray=bt,Nn.toDate=jt,Nn.toISOString=lt,Nn.toJSON=lt,Nn.toString=dt,Nn.unix=kt,Nn.valueOf=yt,Nn.year=pn,Nn.isLeapYear=re,Nn.weekYear=Mt,Nn.isoWeekYear=Tt,Nn.quarter=Nn.quarters=Pt,Nn.month=J,Nn.daysInMonth=R,Nn.week=Nn.weeks=he,Nn.isoWeek=Nn.isoWeeks=ue,Nn.weeksInYear=Ot,Nn.isoWeeksInYear=St,Nn.date=Cn,Nn.day=Nn.days=Wt,Nn.weekday=Ht,Nn.isoWeekday=Ut,Nn.dayOfYear=_e,Nn.hour=Nn.hours=On,Nn.minute=Nn.minutes=Pn,Nn.second=Nn.seconds=An,Nn.millisecond=Nn.milliseconds=Ln,Nn.utcOffset=Ie,Nn.utc=We,Nn.local=He,Nn.parseZone=Ue,Nn.hasAlignedHourOffset=Fe,Nn.isDST=Be,Nn.isDSTShifted=qe,Nn.isLocal=$e,Nn.isUtcOffset=Ge,Nn.isUtc=Ke,Nn.isUTC=Ke,Nn.zoneAbbr=Kt,Nn.zoneName=zt,Nn.dates=Z("dates accessor is deprecated. Use date instead.",Cn),Nn.months=Z("months accessor is deprecated. Use month instead",J),Nn.years=Z("years accessor is deprecated. Use year instead",pn),Nn.zone=Z("moment().zone is deprecated, use moment().utcOffset instead. https://github.com/moment/moment/issues/1779",Ee);var In=Nn,En={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},Wn={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY LT",LLLL:"dddd, MMMM D, YYYY LT"},Hn="Invalid date",Un="%d",Fn=/\d{1,2}/,Bn={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",
MM:"%d months",y:"a year",yy:"%d years"},qn=m.prototype;qn._calendar=En,qn.calendar=Vt,qn._longDateFormat=Wn,qn.longDateFormat=Xt,qn._invalidDate=Hn,qn.invalidDate=Zt,qn._ordinal=Un,qn.ordinal=Qt,qn._ordinalParse=Fn,qn.preparse=ei,qn.postformat=ei,qn._relativeTime=Bn,qn.relativeTime=ti,qn.pastFuture=ii,qn.set=ni,qn.months=$,qn._months=ln,qn.monthsShort=G,qn._monthsShort=cn,qn.monthsParse=K,qn.week=de,qn._week=mn,qn.firstDayOfYear=ce,qn.firstDayOfWeek=le,qn.weekdays=Lt,qn._weekdays=Yn,qn.weekdaysMin=It,qn._weekdaysMin=Tn,qn.weekdaysShort=Nt,qn._weekdaysShort=Mn,qn.weekdaysParse=Et,qn.isPM=qt,qn._meridiemParse=Sn,qn.meridiem=$t,j("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,i=1===g(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return e+i}}),e.lang=Z("moment.lang is deprecated. Use moment.locale instead.",j),e.langData=Z("moment.langData is deprecated. Use moment.localeData instead.",x);var $n=Math.abs,Gn=ki("ms"),Kn=ki("s"),zn=ki("m"),Jn=ki("h"),Rn=ki("d"),Vn=ki("w"),Xn=ki("M"),Zn=ki("y"),Qn=bi("milliseconds"),ea=bi("seconds"),ta=bi("minutes"),ia=bi("hours"),na=bi("days"),aa=bi("months"),sa=bi("years"),ra=Math.round,oa={s:45,m:45,h:22,d:26,M:11},da=Math.abs,la=Se.prototype;la.abs=hi,la.add=fi,la.subtract=_i,la.as=vi,la.asMilliseconds=Gn,la.asSeconds=Kn,la.asMinutes=zn,la.asHours=Jn,la.asDays=Rn,la.asWeeks=Vn,la.asMonths=Xn,la.asYears=Zn,la.valueOf=yi,la._bubble=gi,la.get=ji,la.milliseconds=Qn,la.seconds=ea,la.minutes=ta,la.hours=ia,la.days=na,la.weeks=xi,la.months=aa,la.years=sa,la.humanize=Yi,la.toISOString=Mi,la.toString=Mi,la.toJSON=Mi,la.locale=gt,la.localeData=pt,la.toIsoString=Z("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Mi),la.lang=Dn,P("X",0,0,"unix"),P("x",0,0,"valueOf"),E("x",Ri),E("X",Xi),U("X",function(e,t,i){i._d=new Date(1e3*parseFloat(e,10))}),U("x",function(e,t,i){i._d=new Date(g(e))}),e.version="2.10.3",t(Ce),e.fn=In,e.min=Me,e.max=Te,e.utc=o,e.unix=Jt,e.months=ri,e.isDate=n,e.locale=j,e.invalid=h,e.duration=ze,e.isMoment=_,e.weekdays=di,e.parseZone=Rt,e.localeData=x,e.isDuration=Oe,e.monthsShort=oi,e.weekdaysMin=ci,e.defineLocale=b,e.weekdaysShort=li,e.normalizeUnits=D,e.relativeTimeThreshold=Ci;var ca=e;return ca}),function(e,t){if("function"==typeof define&&define.amd)define(["moment","jquery","exports"],function(i,n,a){e.daterangepicker=t(e,a,i,n)});else if("undefined"!=typeof exports){var i=require("moment"),n="undefined"!=typeof window?window.jQuery:void 0;if(!n)try{n=require("jquery"),n.fn||(n.fn={})}catch(a){if(!n)throw new Error("jQuery dependency not found")}t(e,exports,i,n)}else e.daterangepicker=t(e,{},e.moment||moment,e.jQuery||e.Zepto||e.ender||e.$)}(this||{},function(e,t,i,n){var a=function(e,t,a){if(this.parentEl="body",this.element=n(e),this.startDate=i().startOf("day"),this.endDate=i().endOf("day"),this.minDate=!1,this.maxDate=!1,this.dateLimit=!1,this.autoApply=!1,this.singleDatePicker=!1,this.showDropdowns=!1,this.showWeekNumbers=!1,this.timePicker=!1,this.timePicker24Hour=!1,this.timePickerIncrement=1,this.timePickerSeconds=!1,this.linkedCalendars=!0,this.autoUpdateInput=!0,this.ranges={},this.opens="right",this.element.hasClass("pull-right")&&(this.opens="left"),this.drops="down",this.element.hasClass("dropup")&&(this.drops="up"),this.buttonClasses="btn btn-sm",this.applyClass="btn-success",this.cancelClass="btn-default",this.locale={format:"MM/DD/YYYY",separator:" - ",applyLabel:"Apply",cancelLabel:"Cancel",weekLabel:"W",customRangeLabel:"Custom Range",daysOfWeek:i.weekdaysMin(),monthNames:i.monthsShort(),firstDay:i.localeData().firstDayOfWeek()},this.callback=function(){},this.isShowing=!1,this.leftCalendar={},this.rightCalendar={},"object"==typeof t&&null!==t||(t={}),t=n.extend(this.element.data(),t),"string"!=typeof t.template&&(t.template='<div class="daterangepicker dropdown-menu"><div class="calendar left"><div class="daterangepicker_input"><input class="input-mini" type="text" name="daterangepicker_start" value="" /><i class="fa fa-calendar"></i><div class="calendar-time"><div></div><i class="fa fa-clock-o"></i></div></div><div class="calendar-table"></div></div><div class="calendar right"><div class="daterangepicker_input"><input class="input-mini" type="text" name="daterangepicker_end" value="" /><i class="fa fa-calendar"></i><div class="calendar-time"><div></div><i class="fa fa-clock-o"></i></div></div><div class="calendar-table"></div></div><div class="ranges"><div class="range_inputs"><button class="applyBtn" disabled="disabled" type="button"></button> <button class="cancelBtn" type="button"></button></div></div></div>'),this.parentEl=n(t.parentEl&&n(t.parentEl).length?t.parentEl:this.parentEl),this.container=n(t.template).appendTo(this.parentEl),"object"==typeof t.locale&&("string"==typeof t.locale.format&&(this.locale.format=t.locale.format),"string"==typeof t.locale.separator&&(this.locale.separator=t.locale.separator),"object"==typeof t.locale.daysOfWeek&&(this.locale.daysOfWeek=t.locale.daysOfWeek.slice()),"object"==typeof t.locale.monthNames&&(this.locale.monthNames=t.locale.monthNames.slice()),"number"==typeof t.locale.firstDay&&(this.locale.firstDay=t.locale.firstDay),"string"==typeof t.locale.applyLabel&&(this.locale.applyLabel=t.locale.applyLabel),"string"==typeof t.locale.cancelLabel&&(this.locale.cancelLabel=t.locale.cancelLabel),"string"==typeof t.locale.weekLabel&&(this.locale.weekLabel=t.locale.weekLabel),"string"==typeof t.locale.customRangeLabel&&(this.locale.customRangeLabel=t.locale.customRangeLabel)),"string"==typeof t.startDate&&(this.startDate=i(t.startDate,this.locale.format)),"string"==typeof t.endDate&&(this.endDate=i(t.endDate,this.locale.format)),"string"==typeof t.minDate&&(this.minDate=i(t.minDate,this.locale.format)),"string"==typeof t.maxDate&&(this.maxDate=i(t.maxDate,this.locale.format)),"object"==typeof t.startDate&&(this.startDate=i(t.startDate)),"object"==typeof t.endDate&&(this.endDate=i(t.endDate)),"object"==typeof t.minDate&&(this.minDate=i(t.minDate)),"object"==typeof t.maxDate&&(this.maxDate=i(t.maxDate)),this.minDate&&this.startDate.isBefore(this.minDate)&&(this.startDate=this.minDate.clone()),this.maxDate&&this.endDate.isAfter(this.maxDate)&&(this.endDate=this.maxDate.clone()),"string"==typeof t.applyClass&&(this.applyClass=t.applyClass),"string"==typeof t.cancelClass&&(this.cancelClass=t.cancelClass),"object"==typeof t.dateLimit&&(this.dateLimit=t.dateLimit),"string"==typeof t.opens&&(this.opens=t.opens),"string"==typeof t.drops&&(this.drops=t.drops),"boolean"==typeof t.showWeekNumbers&&(this.showWeekNumbers=t.showWeekNumbers),"string"==typeof t.buttonClasses&&(this.buttonClasses=t.buttonClasses),"object"==typeof t.buttonClasses&&(this.buttonClasses=t.buttonClasses.join(" ")),"boolean"==typeof t.showDropdowns&&(this.showDropdowns=t.showDropdowns),"boolean"==typeof t.singleDatePicker&&(this.singleDatePicker=t.singleDatePicker,this.singleDatePicker&&(this.endDate=this.startDate.clone())),"boolean"==typeof t.timePicker&&(this.timePicker=t.timePicker),"boolean"==typeof t.timePickerSeconds&&(this.timePickerSeconds=t.timePickerSeconds),"number"==typeof t.timePickerIncrement&&(this.timePickerIncrement=t.timePickerIncrement),"boolean"==typeof t.timePicker24Hour&&(this.timePicker24Hour=t.timePicker24Hour),"boolean"==typeof t.autoApply&&(this.autoApply=t.autoApply),"boolean"==typeof t.autoUpdateInput&&(this.autoUpdateInput=t.autoUpdateInput),"boolean"==typeof t.linkedCalendars&&(this.linkedCalendars=t.linkedCalendars),"function"==typeof t.isInvalidDate&&(this.isInvalidDate=t.isInvalidDate),0!=this.locale.firstDay)for(var s=this.locale.firstDay;s>0;)this.locale.daysOfWeek.push(this.locale.daysOfWeek.shift()),s--;var r,o,d;if("undefined"==typeof t.startDate&&"undefined"==typeof t.endDate&&n(this.element).is("input[type=text]")){var l=n(this.element).val(),c=l.split(this.locale.separator);r=o=null,2==c.length?(r=i(c[0],this.locale.format),o=i(c[1],this.locale.format)):this.singleDatePicker&&""!==l&&(r=i(l,this.locale.format),o=i(l,this.locale.format)),null!==r&&null!==o&&(this.setStartDate(r),this.setEndDate(o))}if("object"==typeof t.ranges){for(d in t.ranges){r="string"==typeof t.ranges[d][0]?i(t.ranges[d][0],this.locale.format):i(t.ranges[d][0]),o="string"==typeof t.ranges[d][1]?i(t.ranges[d][1],this.locale.format):i(t.ranges[d][1]),this.minDate&&r.isBefore(this.minDate)&&(r=this.minDate.clone());var h=this.maxDate;if(this.dateLimit&&r.clone().add(this.dateLimit).isAfter(h)&&(h=r.clone().add(this.dateLimit)),h&&o.isAfter(h)&&(o=h.clone()),!(this.minDate&&o.isBefore(this.minDate)||h&&r.isAfter(h))){var u=document.createElement("textarea");u.innerHTML=d,rangeHtml=u.value,this.ranges[rangeHtml]=[r,o]}}var f="<ul>";for(d in this.ranges)f+="<li>"+d+"</li>";f+="<li>"+this.locale.customRangeLabel+"</li>",f+="</ul>",this.container.find(".ranges").prepend(f)}if("function"==typeof a&&(this.callback=a),this.timePicker||(this.startDate=this.startDate.startOf("day"),this.endDate=this.endDate.endOf("day"),this.container.find(".calendar-time").hide()),this.timePicker&&this.autoApply&&(this.autoApply=!1),this.autoApply&&"object"!=typeof t.ranges?this.container.find(".ranges").hide():this.autoApply&&this.container.find(".applyBtn, .cancelBtn").addClass("hide"),this.singleDatePicker&&(this.container.addClass("single"),this.container.find(".calendar.left").addClass("single"),this.container.find(".calendar.left").show(),this.container.find(".calendar.right").hide(),this.container.find(".daterangepicker_input input, .daterangepicker_input i").hide(),this.timePicker||this.container.find(".ranges").hide()),"undefined"!=typeof t.ranges||this.singleDatePicker||this.container.addClass("show-calendar"),this.container.addClass("opens"+this.opens),"undefined"!=typeof t.ranges&&"right"==this.opens){var _=this.container.find(".ranges"),g=_.clone();_.remove(),this.container.find(".calendar.left").parent().prepend(g)}this.container.find(".applyBtn, .cancelBtn").addClass(this.buttonClasses),this.applyClass.length&&this.container.find(".applyBtn").addClass(this.applyClass),this.cancelClass.length&&this.container.find(".cancelBtn").addClass(this.cancelClass),this.container.find(".applyBtn").html(this.locale.applyLabel),this.container.find(".cancelBtn").html(this.locale.cancelLabel),this.container.find(".calendar").on("click.daterangepicker",".prev",n.proxy(this.clickPrev,this)).on("click.daterangepicker",".next",n.proxy(this.clickNext,this)).on("click.daterangepicker","td.available",n.proxy(this.clickDate,this)).on("mouseenter.daterangepicker","td.available",n.proxy(this.hoverDate,this)).on("mouseleave.daterangepicker","td.available",n.proxy(this.updateFormInputs,this)).on("change.daterangepicker","select.yearselect",n.proxy(this.monthOrYearChanged,this)).on("change.daterangepicker","select.monthselect",n.proxy(this.monthOrYearChanged,this)).on("change.daterangepicker","select.hourselect,select.minuteselect,select.secondselect,select.ampmselect",n.proxy(this.timeChanged,this)).on("click.daterangepicker",".daterangepicker_input input",n.proxy(this.showCalendars,this)).on("change.daterangepicker",".daterangepicker_input input",n.proxy(this.formInputsChanged,this)),this.container.find(".ranges").on("click.daterangepicker","button.applyBtn",n.proxy(this.clickApply,this)).on("click.daterangepicker","button.cancelBtn",n.proxy(this.clickCancel,this)).on("click.daterangepicker","li",n.proxy(this.clickRange,this)).on("mouseenter.daterangepicker","li",n.proxy(this.hoverRange,this)).on("mouseleave.daterangepicker","li",n.proxy(this.updateFormInputs,this)),this.element.is("input")?this.element.on({"click.daterangepicker":n.proxy(this.show,this),"focus.daterangepicker":n.proxy(this.show,this),"keyup.daterangepicker":n.proxy(this.elementChanged,this),"keydown.daterangepicker":n.proxy(this.keydown,this)}):this.element.on("click.daterangepicker",n.proxy(this.toggle,this)),this.element.is("input")&&!this.singleDatePicker&&this.autoUpdateInput?(this.element.val(this.startDate.format(this.locale.format)+this.locale.separator+this.endDate.format(this.locale.format)),this.element.trigger("change")):this.element.is("input")&&this.autoUpdateInput&&(this.element.val(this.startDate.format(this.locale.format)),this.element.trigger("change"))};a.prototype={constructor:a,setStartDate:function(e){"string"==typeof e&&(this.startDate=i(e,this.locale.format)),"object"==typeof e&&(this.startDate=i(e)),this.timePicker||(this.startDate=this.startDate.startOf("day")),this.timePicker&&this.timePickerIncrement&&this.startDate.minute(Math.round(this.startDate.minute()/this.timePickerIncrement)*this.timePickerIncrement),this.minDate&&this.startDate.isBefore(this.minDate)&&(this.startDate=this.minDate),this.maxDate&&this.startDate.isAfter(this.maxDate)&&(this.startDate=this.maxDate),this.isShowing||this.updateElement(),this.updateMonthsInView()},setEndDate:function(e){"string"==typeof e&&(this.endDate=i(e,this.locale.format)),"object"==typeof e&&(this.endDate=i(e)),this.timePicker||(this.endDate=this.endDate.endOf("day")),this.timePicker&&this.timePickerIncrement&&this.endDate.minute(Math.round(this.endDate.minute()/this.timePickerIncrement)*this.timePickerIncrement),this.endDate.isBefore(this.startDate)&&(this.endDate=this.startDate.clone()),this.maxDate&&this.endDate.isAfter(this.maxDate)&&(this.endDate=this.maxDate),this.dateLimit&&this.startDate.clone().add(this.dateLimit).isBefore(this.endDate)&&(this.endDate=this.startDate.clone().add(this.dateLimit)),this.isShowing||this.updateElement(),this.updateMonthsInView()},isInvalidDate:function(){return!1},updateView:function(){this.timePicker&&(this.renderTimePicker("left"),this.renderTimePicker("right"),this.endDate?this.container.find(".right .calendar-time select").removeAttr("disabled").removeClass("disabled"):this.container.find(".right .calendar-time select").attr("disabled","disabled").addClass("disabled")),this.endDate?(this.container.find('input[name="daterangepicker_end"]').removeClass("active"),this.container.find('input[name="daterangepicker_start"]').addClass("active")):(this.container.find('input[name="daterangepicker_end"]').addClass("active"),this.container.find('input[name="daterangepicker_start"]').removeClass("active")),this.updateMonthsInView(),this.updateCalendars(),this.updateFormInputs()},updateMonthsInView:function(){if(this.endDate){if(!this.singleDatePicker&&this.leftCalendar.month&&this.rightCalendar.month&&(this.startDate.format("YYYY-MM")==this.leftCalendar.month.format("YYYY-MM")||this.startDate.format("YYYY-MM")==this.rightCalendar.month.format("YYYY-MM"))&&(this.endDate.format("YYYY-MM")==this.leftCalendar.month.format("YYYY-MM")||this.endDate.format("YYYY-MM")==this.rightCalendar.month.format("YYYY-MM")))return;this.leftCalendar.month=this.startDate.clone().date(2),this.linkedCalendars||this.endDate.month()==this.startDate.month()&&this.endDate.year()==this.startDate.year()?this.rightCalendar.month=this.startDate.clone().date(2).add(1,"month"):this.rightCalendar.month=this.endDate.clone().date(2)}else this.leftCalendar.month.format("YYYY-MM")!=this.startDate.format("YYYY-MM")&&this.rightCalendar.month.format("YYYY-MM")!=this.startDate.format("YYYY-MM")&&(this.leftCalendar.month=this.startDate.clone().date(2),this.rightCalendar.month=this.startDate.clone().date(2).add(1,"month"))},updateCalendars:function(){if(this.timePicker){var e,t,i;if(this.endDate){if(e=parseInt(this.container.find(".left .hourselect").val(),10),t=parseInt(this.container.find(".left .minuteselect").val(),10),i=this.timePickerSeconds?parseInt(this.container.find(".left .secondselect").val(),10):0,!this.timePicker24Hour){var n=this.container.find(".left .ampmselect").val();"PM"===n&&e<12&&(e+=12),"AM"===n&&12===e&&(e=0)}}else if(e=parseInt(this.container.find(".right .hourselect").val(),10),t=parseInt(this.container.find(".right .minuteselect").val(),10),i=this.timePickerSeconds?parseInt(this.container.find(".right .secondselect").val(),10):0,!this.timePicker24Hour){var n=this.container.find(".right .ampmselect").val();"PM"===n&&e<12&&(e+=12),"AM"===n&&12===e&&(e=0)}this.leftCalendar.month.hour(e).minute(t).second(i),this.rightCalendar.month.hour(e).minute(t).second(i)}if(this.renderCalendar("left"),this.renderCalendar("right"),this.container.find(".ranges li").removeClass("active"),null!=this.endDate){var a=!0,s=0;for(var r in this.ranges){if(this.timePicker){if(this.startDate.isSame(this.ranges[r][0])&&this.endDate.isSame(this.ranges[r][1])){a=!1,this.chosenLabel=this.container.find(".ranges li:eq("+s+")").addClass("active").html();break}}else if(this.startDate.format("YYYY-MM-DD")==this.ranges[r][0].format("YYYY-MM-DD")&&this.endDate.format("YYYY-MM-DD")==this.ranges[r][1].format("YYYY-MM-DD")){a=!1,this.chosenLabel=this.container.find(".ranges li:eq("+s+")").addClass("active").html();break}s++}a&&(this.chosenLabel=this.container.find(".ranges li:last").addClass("active").html(),this.showCalendars())}},renderCalendar:function(e){var t="left"==e?this.leftCalendar:this.rightCalendar,a=t.month.month(),s=t.month.year(),r=t.month.hour(),o=t.month.minute(),d=t.month.second(),l=i([s,a]).daysInMonth(),c=i([s,a,1]),h=i([s,a,l]),u=i(c).subtract(1,"month").month(),f=i(c).subtract(1,"month").year(),_=i([f,u]).daysInMonth(),g=c.day(),t=[];t.firstDay=c,t.lastDay=h;for(var p=0;p<6;p++)t[p]=[];var m=_-g+this.locale.firstDay+1;m>_&&(m-=7),g==this.locale.firstDay&&(m=_-6);for(var v,y,k=i([f,u,m,12,o,d]),p=0,v=0,y=0;p<42;p++,v++,k=i(k).add(24,"hour"))p>0&&v%7===0&&(v=0,y++),t[y][v]=k.clone().hour(r).minute(o).second(d),k.hour(12),this.minDate&&t[y][v].format("YYYY-MM-DD")==this.minDate.format("YYYY-MM-DD")&&t[y][v].isBefore(this.minDate)&&"left"==e&&(t[y][v]=this.minDate.clone()),this.maxDate&&t[y][v].format("YYYY-MM-DD")==this.maxDate.format("YYYY-MM-DD")&&t[y][v].isAfter(this.maxDate)&&"right"==e&&(t[y][v]=this.maxDate.clone());"left"==e?this.leftCalendar.calendar=t:this.rightCalendar.calendar=t;var j="left"==e?this.minDate:this.startDate,b=this.maxDate,x=("left"==e?this.startDate:this.endDate,'<table class="table-condensed">');x+="<thead>",x+="<tr>",this.showWeekNumbers&&(x+="<th></th>"),x+=j&&!j.isBefore(t.firstDay)||this.linkedCalendars&&"left"!=e?"<th></th>":'<th class="prev available"><i class="fa fa-angle-left"></i></th>';var w=this.locale.monthNames[t[1][1].month()]+t[1][1].format(" YYYY");if(this.showDropdowns){for(var D=t[1][1].month(),C=t[1][1].year(),Y=b&&b.year()||C+5,M=j&&j.year()||C-50,T=C==M,S=C==Y,O='<select class="monthselect">',P=0;P<12;P++)O+=(!T||P>=j.month())&&(!S||P<=b.month())?"<option value='"+P+"'"+(P===D?" selected='selected'":"")+">"+this.locale.monthNames[P]+"</option>":"<option value='"+P+"'"+(P===D?" selected='selected'":"")+" disabled='disabled'>"+this.locale.monthNames[P]+"</option>";O+="</select>";for(var A='<select class="yearselect">',L=M;L<=Y;L++)A+='<option value="'+L+'"'+(L===C?' selected="selected"':"")+">"+L+"</option>";A+="</select>",w=O+A}if(x+='<th colspan="5" class="month">'+w+"</th>",x+=b&&!b.isAfter(t.lastDay)||this.linkedCalendars&&"right"!=e&&!this.singleDatePicker?"<th></th>":'<th class="next available"><i class="fa fa-angle-right"></i></th>',x+="</tr>",x+="<tr>",this.showWeekNumbers&&(x+='<th class="week">'+this.locale.weekLabel+"</th>"),n.each(this.locale.daysOfWeek,function(e,t){x+="<th>"+t+"</th>"}),x+="</tr>",x+="</thead>",x+="<tbody>",null==this.endDate&&this.dateLimit){var N=this.startDate.clone().add(this.dateLimit).endOf("day");b&&!N.isBefore(b)||(b=N)}for(var y=0;y<6;y++){x+="<tr>",this.showWeekNumbers&&(x+='<td class="week">'+t[y][0].week()+"</td>");for(var v=0;v<7;v++){var I=[];t[y][v].isSame(new Date,"day")&&I.push("today"),t[y][v].isoWeekday()>5&&I.push("weekend"),t[y][v].month()!=t[1][1].month()&&I.push("off"),this.minDate&&t[y][v].isBefore(this.minDate,"day")&&I.push("off","disabled"),b&&t[y][v].isAfter(b,"day")&&I.push("off","disabled"),this.isInvalidDate(t[y][v])&&I.push("off","disabled"),t[y][v].format("YYYY-MM-DD")==this.startDate.format("YYYY-MM-DD")&&I.push("active","start-date"),null!=this.endDate&&t[y][v].format("YYYY-MM-DD")==this.endDate.format("YYYY-MM-DD")&&I.push("active","end-date"),null!=this.endDate&&t[y][v]>this.startDate&&t[y][v]<this.endDate&&I.push("in-range");for(var E="",W=!1,p=0;p<I.length;p++)E+=I[p]+" ","disabled"==I[p]&&(W=!0);W||(E+="available"),x+='<td class="'+E.replace(/^\s+|\s+$/g,"")+'" data-title="r'+y+"c"+v+'">'+t[y][v].date()+"</td>"}x+="</tr>"}x+="</tbody>",x+="</table>",this.container.find(".calendar."+e+" .calendar-table").html(x)},renderTimePicker:function(e){var t,i,n,a=this.maxDate;!this.dateLimit||this.maxDate&&!this.startDate.clone().add(this.dateLimit).isAfter(this.maxDate)||(a=this.startDate.clone().add(this.dateLimit)),"left"==e?(i=this.startDate.clone(),n=this.minDate):"right"==e&&(i=this.endDate?this.endDate.clone():this.startDate.clone(),n=this.startDate),t='<select class="hourselect">';for(var s=this.timePicker24Hour?0:1,r=this.timePicker24Hour?23:12,o=s;o<=r;o++){var d=o;this.timePicker24Hour||(d=i.hour()>=12?12==o?12:o+12:12==o?0:o);var l=i.clone().hour(d),c=!1;n&&l.minute(59).isBefore(n)&&(c=!0),a&&l.minute(0).isAfter(a)&&(c=!0),t+=d!=i.hour()||c?c?'<option value="'+o+'" disabled="disabled" class="disabled">'+o+"</option>":'<option value="'+o+'">'+o+"</option>":'<option value="'+o+'" selected="selected">'+o+"</option>"}t+="</select> ",t+=': <select class="minuteselect">';for(var o=0;o<60;o+=this.timePickerIncrement){var h=o<10?"0"+o:o,l=i.clone().minute(o),c=!1;n&&l.second(59).isBefore(n)&&(c=!0),a&&l.second(0).isAfter(a)&&(c=!0),t+=i.minute()!=o||c?c?'<option value="'+o+'" disabled="disabled" class="disabled">'+h+"</option>":'<option value="'+o+'">'+h+"</option>":'<option value="'+o+'" selected="selected">'+h+"</option>"}if(t+="</select> ",this.timePickerSeconds){t+=': <select class="secondselect">';for(var o=0;o<60;o++){var h=o<10?"0"+o:o,l=i.clone().second(o),c=!1;n&&l.isBefore(n)&&(c=!0),a&&l.isAfter(a)&&(c=!0),t+=i.second()!=o||c?c?'<option value="'+o+'" disabled="disabled" class="disabled">'+h+"</option>":'<option value="'+o+'">'+h+"</option>":'<option value="'+o+'" selected="selected">'+h+"</option>"}t+="</select> "}if(!this.timePicker24Hour){t+='<select class="ampmselect">';var u="",f="";n&&i.clone().hour(12).minute(0).second(0).isBefore(n)&&(u=' disabled="disabled" class="disabled"'),a&&i.clone().hour(0).minute(0).second(0).isAfter(a)&&(f=' disabled="disabled" class="disabled"'),t+=i.hour()>=12?'<option value="AM"'+u+'>AM</option><option value="PM" selected="selected"'+f+">PM</option>":'<option value="AM" selected="selected"'+u+'>AM</option><option value="PM"'+f+">PM</option>",t+="</select>"}this.container.find(".calendar."+e+" .calendar-time div").html(t)},updateFormInputs:function(){this.container.find("input[name=daterangepicker_start]").is(":focus")||this.container.find("input[name=daterangepicker_end]").is(":focus")||(this.container.find("input[name=daterangepicker_start]").val(this.startDate.format(this.locale.format)),this.endDate&&this.container.find("input[name=daterangepicker_end]").val(this.endDate.format(this.locale.format)),this.singleDatePicker||this.endDate&&(this.startDate.isBefore(this.endDate)||this.startDate.isSame(this.endDate))?this.container.find("button.applyBtn").removeAttr("disabled"):this.container.find("button.applyBtn").attr("disabled","disabled"))},move:function(){var e,t={top:0,left:0},i=n(window).width();this.parentEl.is("body")||(t={top:this.parentEl.offset().top-this.parentEl.scrollTop(),left:this.parentEl.offset().left-this.parentEl.scrollLeft()},i=this.parentEl[0].clientWidth+this.parentEl.offset().left),e="up"==this.drops?this.element.offset().top-this.container.outerHeight()-t.top:this.element.offset().top+this.element.outerHeight()-t.top,this.container["up"==this.drops?"addClass":"removeClass"]("dropup"),"left"==this.opens?(this.container.css({top:e,right:i-this.element.offset().left-this.element.outerWidth(),left:"auto"}),this.container.offset().left<0&&this.container.css({right:"auto",left:9})):"center"==this.opens?(this.container.css({top:e,left:this.element.offset().left-t.left+this.element.outerWidth()/2-this.container.outerWidth()/2,right:"auto"}),this.container.offset().left<0&&this.container.css({right:"auto",left:9})):(this.container.css({top:e,left:this.element.offset().left-t.left,right:"auto"}),this.container.offset().left+this.container.outerWidth()>n(window).width()&&this.container.css({left:"auto",right:0}))},show:function(e){this.isShowing||(this._outsideClickProxy=n.proxy(function(e){this.outsideClick(e)},this),n(document).on("mousedown.daterangepicker",this._outsideClickProxy).on("touchend.daterangepicker",this._outsideClickProxy).on("click.daterangepicker","[data-toggle=dropdown]",this._outsideClickProxy).on("focusin.daterangepicker",this._outsideClickProxy),n(window).on("resize.daterangepicker",n.proxy(function(e){this.move(e)},this)),this.oldStartDate=this.startDate.clone(),this.oldEndDate=this.endDate.clone(),this.updateView(),this.container.show(),this.move(),this.element.trigger("show.daterangepicker",this),this.isShowing=!0)},hide:function(e){this.isShowing&&(this.endDate||(this.startDate=this.oldStartDate.clone(),this.endDate=this.oldEndDate.clone()),this.startDate.isSame(this.oldStartDate)&&this.endDate.isSame(this.oldEndDate)||this.callback(this.startDate,this.endDate,this.chosenLabel),this.updateElement(),n(document).off(".daterangepicker"),n(window).off(".daterangepicker"),this.container.hide(),this.element.trigger("hide.daterangepicker",this),this.isShowing=!1)},toggle:function(e){this.isShowing?this.hide():this.show()},outsideClick:function(e){var t=n(e.target);"focusin"==e.type||t.closest(this.element).length||t.closest(this.container).length||t.closest(".calendar-table").length||this.hide()},showCalendars:function(){this.container.addClass("show-calendar"),this.move(),this.element.trigger("showCalendar.daterangepicker",this)},hideCalendars:function(){this.container.removeClass("show-calendar"),this.element.trigger("hideCalendar.daterangepicker",this)},hoverRange:function(e){if(!this.container.find("input[name=daterangepicker_start]").is(":focus")&&!this.container.find("input[name=daterangepicker_end]").is(":focus")){var t=e.target.innerHTML;if(t==this.locale.customRangeLabel)this.updateView();else{var i=this.ranges[t];this.container.find("input[name=daterangepicker_start]").val(i[0].format(this.locale.format)),this.container.find("input[name=daterangepicker_end]").val(i[1].format(this.locale.format))}}},clickRange:function(e){var t=e.target.innerHTML;if(this.chosenLabel=t,t==this.locale.customRangeLabel)this.showCalendars();else{var i=this.ranges[t];this.startDate=i[0],this.endDate=i[1],this.timePicker||(this.startDate.startOf("day"),this.endDate.endOf("day")),this.hideCalendars(),this.clickApply()}},clickPrev:function(e){var t=n(e.target).parents(".calendar");t.hasClass("left")?(this.leftCalendar.month.subtract(1,"month"),this.linkedCalendars&&this.rightCalendar.month.subtract(1,"month")):this.rightCalendar.month.subtract(1,"month"),this.updateCalendars()},clickNext:function(e){var t=n(e.target).parents(".calendar");t.hasClass("left")?this.leftCalendar.month.add(1,"month"):(this.rightCalendar.month.add(1,"month"),this.linkedCalendars&&this.leftCalendar.month.add(1,"month")),this.updateCalendars()},hoverDate:function(e){if(!this.container.find("input[name=daterangepicker_start]").is(":focus")&&!this.container.find("input[name=daterangepicker_end]").is(":focus")&&n(e.target).hasClass("available")){var t=n(e.target).attr("data-title"),i=t.substr(1,1),a=t.substr(3,1),s=n(e.target).parents(".calendar"),r=s.hasClass("left")?this.leftCalendar.calendar[i][a]:this.rightCalendar.calendar[i][a];this.endDate?this.container.find("input[name=daterangepicker_start]").val(r.format(this.locale.format)):this.container.find("input[name=daterangepicker_end]").val(r.format(this.locale.format));var o=this.leftCalendar,d=this.rightCalendar,l=this.startDate;this.endDate||this.container.find(".calendar td").each(function(e,t){if(!n(t).hasClass("week")){var i=n(t).attr("data-title"),a=i.substr(1,1),s=i.substr(3,1),c=n(t).parents(".calendar"),h=c.hasClass("left")?o.calendar[a][s]:d.calendar[a][s];h.isAfter(l)&&h.isBefore(r)?n(t).addClass("in-range"):n(t).removeClass("in-range")}})}},clickDate:function(e){if(n(e.target).hasClass("available")){var t=n(e.target).attr("data-title"),i=t.substr(1,1),a=t.substr(3,1),s=n(e.target).parents(".calendar"),r=s.hasClass("left")?this.leftCalendar.calendar[i][a]:this.rightCalendar.calendar[i][a];if(this.endDate||r.isBefore(this.startDate)){if(this.timePicker){var o=parseInt(this.container.find(".left .hourselect").val(),10);if(!this.timePicker24Hour){var d=s.find(".ampmselect").val();"PM"===d&&o<12&&(o+=12),"AM"===d&&12===o&&(o=0)}var l=parseInt(this.container.find(".left .minuteselect").val(),10),c=this.timePickerSeconds?parseInt(this.container.find(".left .secondselect").val(),10):0;r=r.clone().hour(o).minute(l).second(c)}this.endDate=null,this.setStartDate(r.clone())}else{if(this.timePicker){var o=parseInt(this.container.find(".right .hourselect").val(),10);if(!this.timePicker24Hour){var d=this.container.find(".right .ampmselect").val();"PM"===d&&o<12&&(o+=12),"AM"===d&&12===o&&(o=0)}var l=parseInt(this.container.find(".right .minuteselect").val(),10),c=this.timePickerSeconds?parseInt(this.container.find(".right .secondselect").val(),10):0;r=r.clone().hour(o).minute(l).second(c)}this.setEndDate(r.clone()),this.autoApply&&this.clickApply()}this.singleDatePicker&&(this.setEndDate(this.startDate),this.timePicker||this.clickApply()),this.updateView()}},clickApply:function(e){this.hide(),this.element.trigger("apply.daterangepicker",this)},clickCancel:function(e){this.startDate=this.oldStartDate,this.endDate=this.oldEndDate,this.hide(),this.element.trigger("cancel.daterangepicker",this)},monthOrYearChanged:function(e){var t=n(e.target).closest(".calendar").hasClass("left"),i=t?"left":"right",a=this.container.find(".calendar."+i),s=parseInt(a.find(".monthselect").val(),10),r=a.find(".yearselect").val();t||(r<this.startDate.year()||r==this.startDate.year()&&s<this.startDate.month())&&(s=this.startDate.month(),r=this.startDate.year()),this.minDate&&(r<this.minDate.year()||r==this.minDate.year()&&s<this.minDate.month())&&(s=this.minDate.month(),r=this.minDate.year()),this.maxDate&&(r>this.maxDate.year()||r==this.maxDate.year()&&s>this.maxDate.month())&&(s=this.maxDate.month(),r=this.maxDate.year()),t?(this.leftCalendar.month.month(s).year(r),this.linkedCalendars&&(this.rightCalendar.month=this.leftCalendar.month.clone().add(1,"month"))):(this.rightCalendar.month.month(s).year(r),this.linkedCalendars&&(this.leftCalendar.month=this.rightCalendar.month.clone().subtract(1,"month"))),this.updateCalendars()},timeChanged:function(e){var t=n(e.target).closest(".calendar"),i=t.hasClass("left"),a=parseInt(t.find(".hourselect").val(),10),s=parseInt(t.find(".minuteselect").val(),10),r=this.timePickerSeconds?parseInt(t.find(".secondselect").val(),10):0;if(!this.timePicker24Hour){var o=t.find(".ampmselect").val();"PM"===o&&a<12&&(a+=12),"AM"===o&&12===a&&(a=0)}if(i){var d=this.startDate.clone();d.hour(a),d.minute(s),d.second(r),this.setStartDate(d),this.singleDatePicker?this.endDate=this.startDate.clone():this.endDate&&this.endDate.format("YYYY-MM-DD")==d.format("YYYY-MM-DD")&&this.endDate.isBefore(d)&&this.setEndDate(d.clone())}else if(this.endDate){var l=this.endDate.clone();l.hour(a),l.minute(s),l.second(r),this.setEndDate(l)}this.updateCalendars(),this.updateFormInputs(),this.renderTimePicker("left"),this.renderTimePicker("right")},formInputsChanged:function(e){var t=n(e.target).closest(".calendar").hasClass("right"),a=i(this.container.find('input[name="daterangepicker_start"]').val(),this.locale.format),s=i(this.container.find('input[name="daterangepicker_end"]').val(),this.locale.format);a.isValid()&&s.isValid()&&(t&&s.isBefore(a)&&(a=s.clone()),this.setStartDate(a),this.setEndDate(s),
t?this.container.find('input[name="daterangepicker_start"]').val(this.startDate.format(this.locale.format)):this.container.find('input[name="daterangepicker_end"]').val(this.endDate.format(this.locale.format))),this.updateCalendars(),this.timePicker&&(this.renderTimePicker("left"),this.renderTimePicker("right"))},elementChanged:function(){if(this.element.is("input")&&this.element.val().length&&!(this.element.val().length<this.locale.format.length)){var e=this.element.val().split(this.locale.separator),t=null,n=null;2===e.length&&(t=i(e[0],this.locale.format),n=i(e[1],this.locale.format)),(this.singleDatePicker||null===t||null===n)&&(t=i(this.element.val(),this.locale.format),n=t),t.isValid()&&n.isValid()&&(this.setStartDate(t),this.setEndDate(n),this.updateView())}},keydown:function(e){9!==e.keyCode&&13!==e.keyCode||this.hide()},updateElement:function(){this.element.is("input")&&!this.singleDatePicker&&this.autoUpdateInput?(this.element.val(this.startDate.format(this.locale.format)+this.locale.separator+this.endDate.format(this.locale.format)),this.element.trigger("change")):this.element.is("input")&&this.autoUpdateInput&&(this.element.val(this.startDate.format(this.locale.format)),this.element.trigger("change"))},remove:function(){this.container.remove(),this.element.off(".daterangepicker"),this.element.removeData()}},n.fn.daterangepicker=function(e,t){return this.each(function(){var i=n(this);i.data("daterangepicker")&&i.data("daterangepicker").remove(),i.data("daterangepicker",new a(i,e,t))}),this}}),!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):"undefined"!=typeof module&&module.exports?module.exports=e(require("jquery")):e(jQuery)}(function(e,t){"use strict";if(!e.jstree){var i,n,a=0,s=!1,r=!1,o=!1,d=[],l=e("script:last").attr("src"),c=window.document,h=c.createElement("LI");h.setAttribute("role","treeitem"),i=c.createElement("I"),i.className="jstree-icon jstree-ocl",i.setAttribute("role","presentation"),h.appendChild(i),i=c.createElement("A"),i.className="jstree-anchor",i.setAttribute("href","#"),i.setAttribute("tabindex","-1"),n=c.createElement("I"),n.className="jstree-icon jstree-themeicon",n.setAttribute("role","presentation"),i.appendChild(n),h.appendChild(i),i=n=null,e.jstree={version:"3.2.1",defaults:{plugins:[]},plugins:{},path:l&&-1!==l.indexOf("/")?l.replace(/\/[^\/]+$/,""):"",idregex:/[\\:&!^|()\[\]<>@*'+~#";.,=\- \/${}%?`]/g,root:"#"},e.jstree.create=function(t,i){var n=new e.jstree.core((++a)),s=i;return i=e.extend(!0,{},e.jstree.defaults,i),s&&s.plugins&&(i.plugins=s.plugins),e.each(i.plugins,function(e,t){"core"!==e&&(n=n.plugin(t,i[t]))}),e(t).data("jstree",n),n.init(t,i),n},e.jstree.destroy=function(){e(".jstree:jstree").jstree("destroy"),e(c).off(".jstree")},e.jstree.core=function(e){this._id=e,this._cnt=0,this._wrk=null,this._data={core:{themes:{name:!1,dots:!1,icons:!1},selected:[],last_error:{},working:!1,worker_queue:[],focused:null}}},e.jstree.reference=function(t){var i=null,n=null;if(!t||!t.id||t.tagName&&t.nodeType||(t=t.id),!n||!n.length)try{n=e(t)}catch(a){}if(!n||!n.length)try{n=e("#"+t.replace(e.jstree.idregex,"\\$&"))}catch(a){}return n&&n.length&&(n=n.closest(".jstree")).length&&(n=n.data("jstree"))?i=n:e(".jstree").each(function(){var n=e(this).data("jstree");return n&&n._model.data[t]?(i=n,!1):void 0}),i},e.fn.jstree=function(i){var n="string"==typeof i,a=Array.prototype.slice.call(arguments,1),s=null;return!(i===!0&&!this.length)&&(this.each(function(){var r=e.jstree.reference(this),o=n&&r?r[i]:null;return s=n&&o?o.apply(r,a):null,r||n||i!==t&&!e.isPlainObject(i)||e.jstree.create(this,i),(r&&!n||i===!0)&&(s=r||!1),(null===s||s===t)&&void 0}),null!==s&&s!==t?s:this)},e.expr[":"].jstree=e.expr.createPseudo(function(i){return function(i){return e(i).hasClass("jstree")&&e(i).data("jstree")!==t}}),e.jstree.defaults.core={data:!1,strings:!1,check_callback:!1,error:e.noop,animation:200,multiple:!0,themes:{name:!1,url:!1,dir:!1,dots:!0,icons:!0,stripes:!1,variant:!1,responsive:!1},expand_selected_onload:!0,worker:!0,force_text:!1,dblclick_toggle:!0},e.jstree.core.prototype={plugin:function(t,i){var n=e.jstree.plugins[t];return n?(this._data[t]={},n.prototype=this,new n(i,this)):this},init:function(t,i){this._model={data:{},changed:[],force_full_redraw:!1,redraw_timeout:!1,default_state:{loaded:!0,opened:!1,selected:!1,disabled:!1}},this._model.data[e.jstree.root]={id:e.jstree.root,parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}},this.element=e(t).addClass("jstree jstree-"+this._id),this.settings=i,this._data.core.ready=!1,this._data.core.loaded=!1,this._data.core.rtl="rtl"===this.element.css("direction"),this.element[this._data.core.rtl?"addClass":"removeClass"]("jstree-rtl"),this.element.attr("role","tree"),this.settings.core.multiple&&this.element.attr("aria-multiselectable",!0),this.element.attr("tabindex")||this.element.attr("tabindex","0"),this.bind(),this.trigger("init"),this._data.core.original_container_html=this.element.find(" > ul > li").clone(!0),this._data.core.original_container_html.find("li").addBack().contents().filter(function(){return 3===this.nodeType&&(!this.nodeValue||/^\s+$/.test(this.nodeValue))}).remove(),this.element.html("<ul class='jstree-container-ul jstree-children' role='group'><li id='j"+this._id+"_loading' class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='tree-item'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>"),this.element.attr("aria-activedescendant","j"+this._id+"_loading"),this._data.core.li_height=this.get_container_ul().children("li").first().height()||24,this.trigger("loading"),this.load_node(e.jstree.root)},destroy:function(e){if(this._wrk)try{window.URL.revokeObjectURL(this._wrk),this._wrk=null}catch(t){}e||this.element.empty(),this.teardown()},teardown:function(){this.unbind(),this.element.removeClass("jstree").removeData("jstree").find("[class^='jstree']").addBack().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/gi,"")}),this.element=null},bind:function(){var t="",i=null,n=0;this.element.on("dblclick.jstree",function(e){if(e.target.tagName&&"input"===e.target.tagName.toLowerCase())return!0;if(c.selection&&c.selection.empty)c.selection.empty();else if(window.getSelection){var t=window.getSelection();try{t.removeAllRanges(),t.collapse()}catch(i){}}}).on("mousedown.jstree",e.proxy(function(e){e.target===this.element[0]&&(e.preventDefault(),n=+new Date)},this)).on("mousedown.jstree",".jstree-ocl",function(e){e.preventDefault()}).on("click.jstree",".jstree-ocl",e.proxy(function(e){this.toggle_node(e.target)},this)).on("dblclick.jstree",".jstree-anchor",e.proxy(function(e){return!(!e.target.tagName||"input"!==e.target.tagName.toLowerCase())||void(this.settings.core.dblclick_toggle&&this.toggle_node(e.target))},this)).on("click.jstree",".jstree-anchor",e.proxy(function(t){t.preventDefault(),t.currentTarget!==c.activeElement&&e(t.currentTarget).focus(),this.activate_node(t.currentTarget,t)},this)).on("keydown.jstree",".jstree-anchor",e.proxy(function(t){if(t.target.tagName&&"input"===t.target.tagName.toLowerCase())return!0;if(32!==t.which&&13!==t.which&&(t.shiftKey||t.ctrlKey||t.altKey||t.metaKey))return!0;var i=null;switch(this._data.core.rtl&&(37===t.which?t.which=39:39===t.which&&(t.which=37)),t.which){case 32:t.ctrlKey&&(t.type="click",e(t.currentTarget).trigger(t));break;case 13:t.type="click",e(t.currentTarget).trigger(t);break;case 37:t.preventDefault(),this.is_open(t.currentTarget)?this.close_node(t.currentTarget):(i=this.get_parent(t.currentTarget),i&&i.id!==e.jstree.root&&this.get_node(i,!0).children(".jstree-anchor").focus());break;case 38:t.preventDefault(),i=this.get_prev_dom(t.currentTarget),i&&i.length&&i.children(".jstree-anchor").focus();break;case 39:t.preventDefault(),this.is_closed(t.currentTarget)?this.open_node(t.currentTarget,function(e){this.get_node(e,!0).children(".jstree-anchor").focus()}):this.is_open(t.currentTarget)&&(i=this.get_node(t.currentTarget,!0).children(".jstree-children")[0],i&&e(this._firstChild(i)).children(".jstree-anchor").focus());break;case 40:t.preventDefault(),i=this.get_next_dom(t.currentTarget),i&&i.length&&i.children(".jstree-anchor").focus();break;case 106:this.open_all();break;case 36:t.preventDefault(),i=this._firstChild(this.get_container_ul()[0]),i&&e(i).children(".jstree-anchor").filter(":visible").focus();break;case 35:t.preventDefault(),this.element.find(".jstree-anchor").filter(":visible").last().focus()}},this)).on("load_node.jstree",e.proxy(function(t,i){i.status&&(i.node.id!==e.jstree.root||this._data.core.loaded||(this._data.core.loaded=!0,this._firstChild(this.get_container_ul()[0])&&this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id),this.trigger("loaded")),this._data.core.ready||setTimeout(e.proxy(function(){if(this.element&&!this.get_container_ul().find(".jstree-loading").length){if(this._data.core.ready=!0,this._data.core.selected.length){if(this.settings.core.expand_selected_onload){var t,i,n=[];for(t=0,i=this._data.core.selected.length;i>t;t++)n=n.concat(this._model.data[this._data.core.selected[t]].parents);for(n=e.vakata.array_unique(n),t=0,i=n.length;i>t;t++)this.open_node(n[t],!1,0)}this.trigger("changed",{action:"ready",selected:this._data.core.selected})}this.trigger("ready")}},this),0))},this)).on("keypress.jstree",e.proxy(function(n){if(n.target.tagName&&"input"===n.target.tagName.toLowerCase())return!0;i&&clearTimeout(i),i=setTimeout(function(){t=""},500);var a=String.fromCharCode(n.which).toLowerCase(),s=this.element.find(".jstree-anchor").filter(":visible"),r=s.index(c.activeElement)||0,o=!1;if(t+=a,t.length>1){if(s.slice(r).each(e.proxy(function(i,n){return 0===e(n).text().toLowerCase().indexOf(t)?(e(n).focus(),o=!0,!1):void 0},this)),o)return;if(s.slice(0,r).each(e.proxy(function(i,n){return 0===e(n).text().toLowerCase().indexOf(t)?(e(n).focus(),o=!0,!1):void 0},this)),o)return}if(new RegExp("^"+a.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")+"+$").test(t)){if(s.slice(r+1).each(e.proxy(function(t,i){return e(i).text().toLowerCase().charAt(0)===a?(e(i).focus(),o=!0,!1):void 0},this)),o)return;if(s.slice(0,r+1).each(e.proxy(function(t,i){return e(i).text().toLowerCase().charAt(0)===a?(e(i).focus(),o=!0,!1):void 0},this)),o)return}},this)).on("init.jstree",e.proxy(function(){var e=this.settings.core.themes;this._data.core.themes.dots=e.dots,this._data.core.themes.stripes=e.stripes,this._data.core.themes.icons=e.icons,this.set_theme(e.name||"default",e.url),this.set_theme_variant(e.variant)},this)).on("loading.jstree",e.proxy(function(){this[this._data.core.themes.dots?"show_dots":"hide_dots"](),this[this._data.core.themes.icons?"show_icons":"hide_icons"](),this[this._data.core.themes.stripes?"show_stripes":"hide_stripes"]()},this)).on("blur.jstree",".jstree-anchor",e.proxy(function(t){this._data.core.focused=null,e(t.currentTarget).filter(".jstree-hovered").mouseleave(),this.element.attr("tabindex","0")},this)).on("focus.jstree",".jstree-anchor",e.proxy(function(t){var i=this.get_node(t.currentTarget);i&&i.id&&(this._data.core.focused=i.id),this.element.find(".jstree-hovered").not(t.currentTarget).mouseleave(),e(t.currentTarget).mouseenter(),this.element.attr("tabindex","-1")},this)).on("focus.jstree",e.proxy(function(){if(+new Date-n>500&&!this._data.core.focused){n=0;var e=this.get_node(this.element.attr("aria-activedescendant"),!0);e&&e.find("> .jstree-anchor").focus()}},this)).on("mouseenter.jstree",".jstree-anchor",e.proxy(function(e){this.hover_node(e.currentTarget)},this)).on("mouseleave.jstree",".jstree-anchor",e.proxy(function(e){this.dehover_node(e.currentTarget)},this))},unbind:function(){this.element.off(".jstree"),e(c).off(".jstree-"+this._id)},trigger:function(e,t){t||(t={}),t.instance=this,this.element.triggerHandler(e.replace(".jstree","")+".jstree",t)},get_container:function(){return this.element},get_container_ul:function(){return this.element.children(".jstree-children").first()},get_string:function(t){var i=this.settings.core.strings;return e.isFunction(i)?i.call(this,t):i&&i[t]?i[t]:t},_firstChild:function(e){for(e=e?e.firstChild:null;null!==e&&1!==e.nodeType;)e=e.nextSibling;return e},_nextSibling:function(e){for(e=e?e.nextSibling:null;null!==e&&1!==e.nodeType;)e=e.nextSibling;return e},_previousSibling:function(e){for(e=e?e.previousSibling:null;null!==e&&1!==e.nodeType;)e=e.previousSibling;return e},get_node:function(t,i){t&&t.id&&(t=t.id);var n;try{if(this._model.data[t])t=this._model.data[t];else if("string"==typeof t&&this._model.data[t.replace(/^#/,"")])t=this._model.data[t.replace(/^#/,"")];else if("string"==typeof t&&(n=e("#"+t.replace(e.jstree.idregex,"\\$&"),this.element)).length&&this._model.data[n.closest(".jstree-node").attr("id")])t=this._model.data[n.closest(".jstree-node").attr("id")];else if((n=e(t,this.element)).length&&this._model.data[n.closest(".jstree-node").attr("id")])t=this._model.data[n.closest(".jstree-node").attr("id")];else{if(!(n=e(t,this.element)).length||!n.hasClass("jstree"))return!1;t=this._model.data[e.jstree.root]}return i&&(t=t.id===e.jstree.root?this.element:e("#"+t.id.replace(e.jstree.idregex,"\\$&"),this.element)),t}catch(a){return!1}},get_path:function(t,i,n){if(t=t.parents?t:this.get_node(t),!t||t.id===e.jstree.root||!t.parents)return!1;var a,s,r=[];for(r.push(n?t.id:t.text),a=0,s=t.parents.length;s>a;a++)r.push(n?t.parents[a]:this.get_text(t.parents[a]));return r=r.reverse().slice(1),i?r.join(i):r},get_next_dom:function(t,i){var n;if(t=this.get_node(t,!0),t[0]===this.element[0]){for(n=this._firstChild(this.get_container_ul()[0]);n&&0===n.offsetHeight;)n=this._nextSibling(n);return!!n&&e(n)}if(!t||!t.length)return!1;if(i){n=t[0];do n=this._nextSibling(n);while(n&&0===n.offsetHeight);return!!n&&e(n)}if(t.hasClass("jstree-open")){for(n=this._firstChild(t.children(".jstree-children")[0]);n&&0===n.offsetHeight;)n=this._nextSibling(n);if(null!==n)return e(n)}n=t[0];do n=this._nextSibling(n);while(n&&0===n.offsetHeight);return null!==n?e(n):t.parentsUntil(".jstree",".jstree-node").nextAll(".jstree-node:visible").first()},get_prev_dom:function(t,i){var n;if(t=this.get_node(t,!0),t[0]===this.element[0]){for(n=this.get_container_ul()[0].lastChild;n&&0===n.offsetHeight;)n=this._previousSibling(n);return!!n&&e(n)}if(!t||!t.length)return!1;if(i){n=t[0];do n=this._previousSibling(n);while(n&&0===n.offsetHeight);return!!n&&e(n)}n=t[0];do n=this._previousSibling(n);while(n&&0===n.offsetHeight);if(null!==n){for(t=e(n);t.hasClass("jstree-open");)t=t.children(".jstree-children").first().children(".jstree-node:visible:last");return t}return n=t[0].parentNode.parentNode,!(!n||!n.className||-1===n.className.indexOf("jstree-node"))&&e(n)},get_parent:function(t){return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&t.parent},get_children_dom:function(e){return e=this.get_node(e,!0),e[0]===this.element[0]?this.get_container_ul().children(".jstree-node"):!(!e||!e.length)&&e.children(".jstree-children").children(".jstree-node")},is_parent:function(e){return e=this.get_node(e),e&&(e.state.loaded===!1||e.children.length>0)},is_loaded:function(e){return e=this.get_node(e),e&&e.state.loaded},is_loading:function(e){return e=this.get_node(e),e&&e.state&&e.state.loading},is_open:function(e){return e=this.get_node(e),e&&e.state.opened},is_closed:function(e){return e=this.get_node(e),e&&this.is_parent(e)&&!e.state.opened},is_leaf:function(e){return!this.is_parent(e)},load_node:function(t,i){var n,a,s,r,o;if(e.isArray(t))return this._load_nodes(t.slice(),i),!0;if(t=this.get_node(t),!t)return i&&i.call(this,t,!1),!1;if(t.state.loaded){for(t.state.loaded=!1,n=0,a=t.children_d.length;a>n;n++){for(s=0,r=t.parents.length;r>s;s++)this._model.data[t.parents[s]].children_d=e.vakata.array_remove_item(this._model.data[t.parents[s]].children_d,t.children_d[n]);this._model.data[t.children_d[n]].state.selected&&(o=!0,this._data.core.selected=e.vakata.array_remove_item(this._data.core.selected,t.children_d[n])),delete this._model.data[t.children_d[n]]}t.children=[],t.children_d=[],o&&this.trigger("changed",{action:"load_node",node:t,selected:this._data.core.selected})}return t.state.failed=!1,t.state.loading=!0,this.get_node(t,!0).addClass("jstree-loading").attr("aria-busy",!0),this._load_node(t,e.proxy(function(e){t=this._model.data[t.id],t.state.loading=!1,t.state.loaded=e,t.state.failed=!t.state.loaded;var n=this.get_node(t,!0),a=0,s=0,r=this._model.data,o=!1;for(a=0,s=t.children.length;s>a;a++)if(r[t.children[a]]&&!r[t.children[a]].state.hidden){o=!0;break}t.state.loaded&&!o&&n&&n.length&&!n.hasClass("jstree-leaf")&&n.removeClass("jstree-closed jstree-open").addClass("jstree-leaf"),n.removeClass("jstree-loading").attr("aria-busy",!1),this.trigger("load_node",{node:t,status:e}),i&&i.call(this,t,e)},this)),!0},_load_nodes:function(e,t,i){var n,a,s=!0,r=function(){this._load_nodes(e,t,!0)},o=this._model.data,d=[];for(n=0,a=e.length;a>n;n++)!o[e[n]]||(o[e[n]].state.loaded||o[e[n]].state.failed)&&i||(this.is_loading(e[n])||this.load_node(e[n],r),s=!1);if(s){for(n=0,a=e.length;a>n;n++)o[e[n]]&&o[e[n]].state.loaded&&d.push(e[n]);t&&!t.done&&(t.call(this,d),t.done=!0)}},load_all:function(t,i){if(t||(t=e.jstree.root),t=this.get_node(t),!t)return!1;var n,a,s=[],r=this._model.data,o=r[t.id].children_d;for(t.state&&!t.state.loaded&&s.push(t.id),n=0,a=o.length;a>n;n++)r[o[n]]&&r[o[n]].state&&!r[o[n]].state.loaded&&s.push(o[n]);s.length?this._load_nodes(s,function(){this.load_all(t,i)}):(i&&i.call(this,t),this.trigger("load_all",{node:t}))},_load_node:function(t,i){var n,a=this.settings.core.data;return a?e.isFunction(a)?a.call(this,t,e.proxy(function(n){n===!1&&i.call(this,!1),this["string"==typeof n?"_append_html_data":"_append_json_data"](t,"string"==typeof n?e(e.parseHTML(n)).filter(function(){return 3!==this.nodeType}):n,function(e){i.call(this,e)})},this)):"object"==typeof a?a.url?(a=e.extend(!0,{},a),e.isFunction(a.url)&&(a.url=a.url.call(this,t)),e.isFunction(a.data)&&(a.data=a.data.call(this,t)),e.ajax(a).done(e.proxy(function(n,a,s){var r=s.getResponseHeader("Content-Type");return r&&-1!==r.indexOf("json")||"object"==typeof n?this._append_json_data(t,n,function(e){i.call(this,e)}):r&&-1!==r.indexOf("html")||"string"==typeof n?this._append_html_data(t,e(e.parseHTML(n)).filter(function(){return 3!==this.nodeType}),function(e){i.call(this,e)}):(this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:t.id,xhr:s})},this.settings.core.error.call(this,this._data.core.last_error),i.call(this,!1))},this)).fail(e.proxy(function(e){i.call(this,!1),this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:t.id,xhr:e})},this.settings.core.error.call(this,this._data.core.last_error)},this))):(n=e.isArray(a)||e.isPlainObject(a)?JSON.parse(JSON.stringify(a)):a,t.id===e.jstree.root?this._append_json_data(t,n,function(e){i.call(this,e)}):(this._data.core.last_error={error:"nodata",plugin:"core",id:"core_05",reason:"Could not load node",data:JSON.stringify({id:t.id})},this.settings.core.error.call(this,this._data.core.last_error),i.call(this,!1))):"string"==typeof a?t.id===e.jstree.root?this._append_html_data(t,e(e.parseHTML(a)).filter(function(){return 3!==this.nodeType}),function(e){i.call(this,e)}):(this._data.core.last_error={error:"nodata",plugin:"core",id:"core_06",reason:"Could not load node",data:JSON.stringify({id:t.id})},this.settings.core.error.call(this,this._data.core.last_error),i.call(this,!1)):i.call(this,!1):t.id===e.jstree.root?this._append_html_data(t,this._data.core.original_container_html.clone(!0),function(e){i.call(this,e)}):i.call(this,!1)},_node_changed:function(e){e=this.get_node(e),e&&this._model.changed.push(e.id)},_append_html_data:function(t,i,n){t=this.get_node(t),t.children=[],t.children_d=[];var a,s,r,o=i.is("ul")?i.children():i,d=t.id,l=[],c=[],h=this._model.data,u=h[d],f=this._data.core.selected.length;for(o.each(e.proxy(function(t,i){a=this._parse_model_from_html(e(i),d,u.parents.concat()),a&&(l.push(a),c.push(a),h[a].children_d.length&&(c=c.concat(h[a].children_d)))},this)),u.children=l,u.children_d=c,s=0,r=u.parents.length;r>s;s++)h[u.parents[s]].children_d=h[u.parents[s]].children_d.concat(c);this.trigger("model",{nodes:c,parent:d}),d!==e.jstree.root?(this._node_changed(d),this.redraw()):(this.get_container_ul().children(".jstree-initial-node").remove(),this.redraw(!0)),this._data.core.selected.length!==f&&this.trigger("changed",{action:"model",selected:this._data.core.selected}),n.call(this,!0)},_append_json_data:function(t,i,n,a){if(null!==this.element){t=this.get_node(t),t.children=[],t.children_d=[],i.d&&(i=i.d,"string"==typeof i&&(i=JSON.parse(i))),e.isArray(i)||(i=[i]);var s=null,r={df:this._model.default_state,dat:i,par:t.id,m:this._model.data,t_id:this._id,t_cnt:this._cnt,sel:this._data.core.selected},o=function(e,t){e.data&&(e=e.data);var i,n,a,s,r=e.dat,o=e.par,d=[],l=[],c=[],h=e.df,u=e.t_id,f=e.t_cnt,_=e.m,g=_[o],p=e.sel,m=function(e,i,n){n=n?n.concat():[],i&&n.unshift(i);var a,s,r,o,d=e.id.toString(),l={id:d,text:e.text||"",icon:e.icon===t||e.icon,parent:i,parents:n,children:e.children||[],children_d:e.children_d||[],data:e.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(a in h)h.hasOwnProperty(a)&&(l.state[a]=h[a]);if(e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(l.icon=e.data.jstree.icon),(l.icon===t||null===l.icon||""===l.icon)&&(l.icon=!0),e&&e.data&&(l.data=e.data,e.data.jstree))for(a in e.data.jstree)e.data.jstree.hasOwnProperty(a)&&(l.state[a]=e.data.jstree[a]);if(e&&"object"==typeof e.state)for(a in e.state)e.state.hasOwnProperty(a)&&(l.state[a]=e.state[a]);if(e&&"object"==typeof e.li_attr)for(a in e.li_attr)e.li_attr.hasOwnProperty(a)&&(l.li_attr[a]=e.li_attr[a]);if(l.li_attr.id||(l.li_attr.id=d),e&&"object"==typeof e.a_attr)for(a in e.a_attr)e.a_attr.hasOwnProperty(a)&&(l.a_attr[a]=e.a_attr[a]);for(e&&e.children&&e.children===!0&&(l.state.loaded=!1,l.children=[],l.children_d=[]),_[l.id]=l,a=0,s=l.children.length;s>a;a++)r=m(_[l.children[a]],l.id,n),o=_[r],l.children_d.push(r),o.children_d.length&&(l.children_d=l.children_d.concat(o.children_d));return delete e.data,delete e.children,_[l.id].original=e,l.state.selected&&c.push(l.id),l.id},v=function(e,i,n){n=n?n.concat():[],i&&n.unshift(i);var a,s,r,o,d,l=!1;do l="j"+u+"_"+ ++f;while(_[l]);d={id:!1,text:"string"==typeof e?e:"",icon:"object"!=typeof e||e.icon===t||e.icon,parent:i,parents:n,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(a in h)h.hasOwnProperty(a)&&(d.state[a]=h[a]);if(e&&e.id&&(d.id=e.id.toString()),e&&e.text&&(d.text=e.text),e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(d.icon=e.data.jstree.icon),(d.icon===t||null===d.icon||""===d.icon)&&(d.icon=!0),e&&e.data&&(d.data=e.data,e.data.jstree))for(a in e.data.jstree)e.data.jstree.hasOwnProperty(a)&&(d.state[a]=e.data.jstree[a]);if(e&&"object"==typeof e.state)for(a in e.state)e.state.hasOwnProperty(a)&&(d.state[a]=e.state[a]);if(e&&"object"==typeof e.li_attr)for(a in e.li_attr)e.li_attr.hasOwnProperty(a)&&(d.li_attr[a]=e.li_attr[a]);if(d.li_attr.id&&!d.id&&(d.id=d.li_attr.id.toString()),d.id||(d.id=l),d.li_attr.id||(d.li_attr.id=d.id),e&&"object"==typeof e.a_attr)for(a in e.a_attr)e.a_attr.hasOwnProperty(a)&&(d.a_attr[a]=e.a_attr[a]);if(e&&e.children&&e.children.length){for(a=0,s=e.children.length;s>a;a++)r=v(e.children[a],d.id,n),o=_[r],d.children.push(r),o.children_d.length&&(d.children_d=d.children_d.concat(o.children_d));d.children_d=d.children_d.concat(d.children)}return e&&e.children&&e.children===!0&&(d.state.loaded=!1,d.children=[],d.children_d=[]),delete e.data,delete e.children,d.original=e,_[d.id]=d,d.state.selected&&c.push(d.id),d.id};if(r.length&&r[0].id!==t&&r[0].parent!==t){for(n=0,a=r.length;a>n;n++)r[n].children||(r[n].children=[]),_[r[n].id.toString()]=r[n];for(n=0,a=r.length;a>n;n++)_[r[n].parent.toString()].children.push(r[n].id.toString()),g.children_d.push(r[n].id.toString());for(n=0,a=g.children.length;a>n;n++)i=m(_[g.children[n]],o,g.parents.concat()),l.push(i),_[i].children_d.length&&(l=l.concat(_[i].children_d));for(n=0,a=g.parents.length;a>n;n++)_[g.parents[n]].children_d=_[g.parents[n]].children_d.concat(l);s={cnt:f,mod:_,sel:p,par:o,dpc:l,add:c}}else{for(n=0,a=r.length;a>n;n++)i=v(r[n],o,g.parents.concat()),i&&(d.push(i),l.push(i),_[i].children_d.length&&(l=l.concat(_[i].children_d)));for(g.children=d,g.children_d=l,n=0,a=g.parents.length;a>n;n++)_[g.parents[n]].children_d=_[g.parents[n]].children_d.concat(l);s={cnt:f,mod:_,sel:p,par:o,dpc:l,add:c}}return"undefined"!=typeof window&&"undefined"!=typeof window.document?s:void postMessage(s)},d=function(t,i){if(null!==this.element){if(this._cnt=t.cnt,this._model.data=t.mod,i){var a,s,r=t.add,o=t.sel,d=this._data.core.selected.slice(),l=this._model.data;if(o.length!==d.length||e.vakata.array_unique(o.concat(d)).length!==o.length){for(a=0,s=o.length;s>a;a++)-1===e.inArray(o[a],r)&&-1===e.inArray(o[a],d)&&(l[o[a]].state.selected=!1);for(a=0,s=d.length;s>a;a++)-1===e.inArray(d[a],o)&&(l[d[a]].state.selected=!0)}}t.add.length&&(this._data.core.selected=this._data.core.selected.concat(t.add)),this.trigger("model",{nodes:t.dpc,parent:t.par}),t.par!==e.jstree.root?(this._node_changed(t.par),this.redraw()):this.redraw(!0),t.add.length&&this.trigger("changed",{action:"model",selected:this._data.core.selected}),n.call(this,!0)}};if(this.settings.core.worker&&window.Blob&&window.URL&&window.Worker)try{null===this._wrk&&(this._wrk=window.URL.createObjectURL(new window.Blob(["self.onmessage = "+o.toString()],{type:"text/javascript"}))),!this._data.core.working||a?(this._data.core.working=!0,s=new window.Worker(this._wrk),s.onmessage=e.proxy(function(e){d.call(this,e.data,!0);try{s.terminate(),s=null}catch(t){}this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1},this),r.par?s.postMessage(r):this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1):this._data.core.worker_queue.push([t,i,n,!0])}catch(l){d.call(this,o(r),!1),this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1}else d.call(this,o(r),!1)}},_parse_model_from_html:function(i,n,a){a=a?[].concat(a):[],n&&a.unshift(n);var s,r,o,d,l,c=this._model.data,h={id:!1,text:!1,icon:!0,parent:n,parents:a,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(o in this._model.default_state)this._model.default_state.hasOwnProperty(o)&&(h.state[o]=this._model.default_state[o]);if(d=e.vakata.attributes(i,!0),e.each(d,function(t,i){return i=e.trim(i),!i.length||(h.li_attr[t]=i,void("id"===t&&(h.id=i.toString())))}),d=i.children("a").first(),d.length&&(d=e.vakata.attributes(d,!0),e.each(d,function(t,i){i=e.trim(i),i.length&&(h.a_attr[t]=i)})),d=i.children("a").first().length?i.children("a").first().clone():i.clone(),d.children("ins, i, ul").remove(),d=d.html(),d=e("<div />").html(d),h.text=this.settings.core.force_text?d.text():d.html(),d=i.data(),h.data=d?e.extend(!0,{},d):null,h.state.opened=i.hasClass("jstree-open"),h.state.selected=i.children("a").hasClass("jstree-clicked"),h.state.disabled=i.children("a").hasClass("jstree-disabled"),h.data&&h.data.jstree)for(o in h.data.jstree)h.data.jstree.hasOwnProperty(o)&&(h.state[o]=h.data.jstree[o]);d=i.children("a").children(".jstree-themeicon"),d.length&&(h.icon=!d.hasClass("jstree-themeicon-hidden")&&d.attr("rel")),h.state.icon!==t&&(h.icon=h.state.icon),(h.icon===t||null===h.icon||""===h.icon)&&(h.icon=!0),d=i.children("ul").children("li");do l="j"+this._id+"_"+ ++this._cnt;while(c[l]);return h.id=h.li_attr.id?h.li_attr.id.toString():l,d.length?(d.each(e.proxy(function(t,i){s=this._parse_model_from_html(e(i),h.id,a),r=this._model.data[s],h.children.push(s),r.children_d.length&&(h.children_d=h.children_d.concat(r.children_d))},this)),h.children_d=h.children_d.concat(h.children)):i.hasClass("jstree-closed")&&(h.state.loaded=!1),h.li_attr["class"]&&(h.li_attr["class"]=h.li_attr["class"].replace("jstree-closed","").replace("jstree-open","")),h.a_attr["class"]&&(h.a_attr["class"]=h.a_attr["class"].replace("jstree-clicked","").replace("jstree-disabled","")),c[h.id]=h,h.state.selected&&this._data.core.selected.push(h.id),h.id},_parse_model_from_flat_json:function(e,i,n){n=n?n.concat():[],i&&n.unshift(i);var a,s,r,o,d=e.id.toString(),l=this._model.data,c=this._model.default_state,h={id:d,text:e.text||"",icon:e.icon===t||e.icon,parent:i,parents:n,children:e.children||[],children_d:e.children_d||[],data:e.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(a in c)c.hasOwnProperty(a)&&(h.state[a]=c[a]);if(e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(h.icon=e.data.jstree.icon),(h.icon===t||null===h.icon||""===h.icon)&&(h.icon=!0),e&&e.data&&(h.data=e.data,e.data.jstree))for(a in e.data.jstree)e.data.jstree.hasOwnProperty(a)&&(h.state[a]=e.data.jstree[a]);if(e&&"object"==typeof e.state)for(a in e.state)e.state.hasOwnProperty(a)&&(h.state[a]=e.state[a]);if(e&&"object"==typeof e.li_attr)for(a in e.li_attr)e.li_attr.hasOwnProperty(a)&&(h.li_attr[a]=e.li_attr[a]);if(h.li_attr.id||(h.li_attr.id=d),e&&"object"==typeof e.a_attr)for(a in e.a_attr)e.a_attr.hasOwnProperty(a)&&(h.a_attr[a]=e.a_attr[a]);for(e&&e.children&&e.children===!0&&(h.state.loaded=!1,h.children=[],h.children_d=[]),l[h.id]=h,a=0,s=h.children.length;s>a;a++)r=this._parse_model_from_flat_json(l[h.children[a]],h.id,n),o=l[r],h.children_d.push(r),o.children_d.length&&(h.children_d=h.children_d.concat(o.children_d));return delete e.data,delete e.children,l[h.id].original=e,h.state.selected&&this._data.core.selected.push(h.id),h.id},_parse_model_from_json:function(e,i,n){n=n?n.concat():[],i&&n.unshift(i);var a,s,r,o,d,l=!1,c=this._model.data,h=this._model.default_state;do l="j"+this._id+"_"+ ++this._cnt;while(c[l]);d={id:!1,text:"string"==typeof e?e:"",icon:"object"!=typeof e||e.icon===t||e.icon,parent:i,parents:n,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(a in h)h.hasOwnProperty(a)&&(d.state[a]=h[a]);if(e&&e.id&&(d.id=e.id.toString()),e&&e.text&&(d.text=e.text),e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(d.icon=e.data.jstree.icon),(d.icon===t||null===d.icon||""===d.icon)&&(d.icon=!0),e&&e.data&&(d.data=e.data,e.data.jstree))for(a in e.data.jstree)e.data.jstree.hasOwnProperty(a)&&(d.state[a]=e.data.jstree[a]);if(e&&"object"==typeof e.state)for(a in e.state)e.state.hasOwnProperty(a)&&(d.state[a]=e.state[a]);if(e&&"object"==typeof e.li_attr)for(a in e.li_attr)e.li_attr.hasOwnProperty(a)&&(d.li_attr[a]=e.li_attr[a]);if(d.li_attr.id&&!d.id&&(d.id=d.li_attr.id.toString()),d.id||(d.id=l),d.li_attr.id||(d.li_attr.id=d.id),e&&"object"==typeof e.a_attr)for(a in e.a_attr)e.a_attr.hasOwnProperty(a)&&(d.a_attr[a]=e.a_attr[a]);if(e&&e.children&&e.children.length){for(a=0,s=e.children.length;s>a;a++)r=this._parse_model_from_json(e.children[a],d.id,n),o=c[r],d.children.push(r),o.children_d.length&&(d.children_d=d.children_d.concat(o.children_d));d.children_d=d.children_d.concat(d.children)}return e&&e.children&&e.children===!0&&(d.state.loaded=!1,d.children=[],d.children_d=[]),delete e.data,delete e.children,d.original=e,c[d.id]=d,d.state.selected&&this._data.core.selected.push(d.id),d.id},_redraw:function(){var t,i,n,a=this._model.force_full_redraw?this._model.data[e.jstree.root].children.concat([]):this._model.changed.concat([]),s=c.createElement("UL"),r=this._data.core.focused;for(i=0,n=a.length;n>i;i++)t=this.redraw_node(a[i],!0,this._model.force_full_redraw),t&&this._model.force_full_redraw&&s.appendChild(t);
this._model.force_full_redraw&&(s.className=this.get_container_ul()[0].className,s.setAttribute("role","group"),this.element.empty().append(s)),null!==r&&(t=this.get_node(r,!0),t&&t.length&&t.children(".jstree-anchor")[0]!==c.activeElement?t.children(".jstree-anchor").focus():this._data.core.focused=null),this._model.force_full_redraw=!1,this._model.changed=[],this.trigger("redraw",{nodes:a})},redraw:function(e){e&&(this._model.force_full_redraw=!0),this._redraw()},draw_children:function(t){var i=this.get_node(t),n=!1,a=!1,s=!1,r=c;if(!i)return!1;if(i.id===e.jstree.root)return this.redraw(!0);if(t=this.get_node(t,!0),!t||!t.length)return!1;if(t.children(".jstree-children").remove(),t=t[0],i.children.length&&i.state.loaded){for(s=r.createElement("UL"),s.setAttribute("role","group"),s.className="jstree-children",n=0,a=i.children.length;a>n;n++)s.appendChild(this.redraw_node(i.children[n],!0,!0));t.appendChild(s)}},redraw_node:function(t,i,n,a){var s=this.get_node(t),r=!1,o=!1,d=!1,l=!1,u=!1,f=!1,_="",g=c,p=this._model.data,m=!1,v=null,y=0,k=0,j=!1,b=!1;if(!s)return!1;if(s.id===e.jstree.root)return this.redraw(!0);if(i=i||0===s.children.length,t=c.querySelector?this.element[0].querySelector("#"+(-1!=="0123456789".indexOf(s.id[0])?"\\3"+s.id[0]+" "+s.id.substr(1).replace(e.jstree.idregex,"\\$&"):s.id.replace(e.jstree.idregex,"\\$&"))):c.getElementById(s.id))t=e(t),n||(r=t.parent().parent()[0],r===this.element[0]&&(r=null),o=t.index()),i||!s.children.length||t.children(".jstree-children").length||(i=!0),i||(d=t.children(".jstree-children")[0]),m=t.children(".jstree-anchor")[0]===c.activeElement,t.remove();else if(i=!0,!n){if(r=s.parent!==e.jstree.root?e("#"+s.parent.replace(e.jstree.idregex,"\\$&"),this.element)[0]:null,!(null===r||r&&p[s.parent].state.opened))return!1;o=e.inArray(s.id,null===r?p[e.jstree.root].children:p[s.parent].children)}t=h.cloneNode(!0),_="jstree-node ";for(l in s.li_attr)if(s.li_attr.hasOwnProperty(l)){if("id"===l)continue;"class"!==l?t.setAttribute(l,s.li_attr[l]):_+=s.li_attr[l]}for(s.a_attr.id||(s.a_attr.id=s.id+"_anchor"),t.setAttribute("aria-selected",!!s.state.selected),t.setAttribute("aria-level",s.parents.length),t.setAttribute("aria-labelledby",s.a_attr.id),s.state.disabled&&t.setAttribute("aria-disabled",!0),l=0,u=s.children.length;u>l;l++)if(!p[s.children[l]].state.hidden){j=!0;break}if(null!==s.parent&&p[s.parent]&&!s.state.hidden&&(l=e.inArray(s.id,p[s.parent].children),b=s.id,-1!==l))for(l++,u=p[s.parent].children.length;u>l&&(p[p[s.parent].children[l]].state.hidden||(b=p[s.parent].children[l]),b===s.id);l++);s.state.hidden&&(_+=" jstree-hidden"),s.state.loaded&&!j?_+=" jstree-leaf":(_+=s.state.opened&&s.state.loaded?" jstree-open":" jstree-closed",t.setAttribute("aria-expanded",s.state.opened&&s.state.loaded)),b===s.id&&(_+=" jstree-last"),t.id=s.id,t.className=_,_=(s.state.selected?" jstree-clicked":"")+(s.state.disabled?" jstree-disabled":"");for(u in s.a_attr)if(s.a_attr.hasOwnProperty(u)){if("href"===u&&"#"===s.a_attr[u])continue;"class"!==u?t.childNodes[1].setAttribute(u,s.a_attr[u]):_+=" "+s.a_attr[u]}if(_.length&&(t.childNodes[1].className="jstree-anchor "+_),(s.icon&&s.icon!==!0||s.icon===!1)&&(s.icon===!1?t.childNodes[1].childNodes[0].className+=" jstree-themeicon-hidden":-1===s.icon.indexOf("/")&&-1===s.icon.indexOf(".")?t.childNodes[1].childNodes[0].className+=" "+s.icon+" jstree-themeicon-custom":(t.childNodes[1].childNodes[0].style.backgroundImage="url("+s.icon+")",t.childNodes[1].childNodes[0].style.backgroundPosition="center center",t.childNodes[1].childNodes[0].style.backgroundSize="auto",t.childNodes[1].childNodes[0].className+=" jstree-themeicon-custom")),this.settings.core.force_text?t.childNodes[1].appendChild(g.createTextNode(s.text)):t.childNodes[1].innerHTML+=s.text,i&&s.children.length&&(s.state.opened||a)&&s.state.loaded){for(f=g.createElement("UL"),f.setAttribute("role","group"),f.className="jstree-children",l=0,u=s.children.length;u>l;l++)f.appendChild(this.redraw_node(s.children[l],i,!0));t.appendChild(f)}if(d&&t.appendChild(d),!n){for(r||(r=this.element[0]),l=0,u=r.childNodes.length;u>l;l++)if(r.childNodes[l]&&r.childNodes[l].className&&-1!==r.childNodes[l].className.indexOf("jstree-children")){v=r.childNodes[l];break}v||(v=g.createElement("UL"),v.setAttribute("role","group"),v.className="jstree-children",r.appendChild(v)),r=v,o<r.childNodes.length?r.insertBefore(t,r.childNodes[o]):r.appendChild(t),m&&(y=this.element[0].scrollTop,k=this.element[0].scrollLeft,t.childNodes[1].focus(),this.element[0].scrollTop=y,this.element[0].scrollLeft=k)}return s.state.opened&&!s.state.loaded&&(s.state.opened=!1,setTimeout(e.proxy(function(){this.open_node(s.id,!1,0)},this),0)),t},open_node:function(i,n,a){var s,r,o,d;if(e.isArray(i)){for(i=i.slice(),s=0,r=i.length;r>s;s++)this.open_node(i[s],n,a);return!0}return i=this.get_node(i),!(!i||i.id===e.jstree.root)&&(a=a===t?this.settings.core.animation:a,this.is_closed(i)?this.is_loaded(i)?(o=this.get_node(i,!0),d=this,o.length&&(a&&o.children(".jstree-children").length&&o.children(".jstree-children").stop(!0,!0),i.children.length&&!this._firstChild(o.children(".jstree-children")[0])&&this.draw_children(i),a?(this.trigger("before_open",{node:i}),o.children(".jstree-children").css("display","none").end().removeClass("jstree-closed").addClass("jstree-open").attr("aria-expanded",!0).children(".jstree-children").stop(!0,!0).slideDown(a,function(){this.style.display="",d.trigger("after_open",{node:i})})):(this.trigger("before_open",{node:i}),o[0].className=o[0].className.replace("jstree-closed","jstree-open"),o[0].setAttribute("aria-expanded",!0))),i.state.opened=!0,n&&n.call(this,i,!0),o.length||this.trigger("before_open",{node:i}),this.trigger("open_node",{node:i}),a&&o.length||this.trigger("after_open",{node:i}),!0):this.is_loading(i)?setTimeout(e.proxy(function(){this.open_node(i,n,a)},this),500):void this.load_node(i,function(e,t){return t?this.open_node(e,n,a):!!n&&n.call(this,e,!1)}):(n&&n.call(this,i,!1),!1))},_open_to:function(t){if(t=this.get_node(t),!t||t.id===e.jstree.root)return!1;var i,n,a=t.parents;for(i=0,n=a.length;n>i;i+=1)i!==e.jstree.root&&this.open_node(a[i],!1,0);return e("#"+t.id.replace(e.jstree.idregex,"\\$&"),this.element)},close_node:function(i,n){var a,s,r,o;if(e.isArray(i)){for(i=i.slice(),a=0,s=i.length;s>a;a++)this.close_node(i[a],n);return!0}return i=this.get_node(i),!(!i||i.id===e.jstree.root)&&(!this.is_closed(i)&&(n=n===t?this.settings.core.animation:n,r=this,o=this.get_node(i,!0),o.length&&(n?o.children(".jstree-children").attr("style","display:block !important").end().removeClass("jstree-open").addClass("jstree-closed").attr("aria-expanded",!1).children(".jstree-children").stop(!0,!0).slideUp(n,function(){this.style.display="",o.children(".jstree-children").remove(),r.trigger("after_close",{node:i})}):(o[0].className=o[0].className.replace("jstree-open","jstree-closed"),o.attr("aria-expanded",!1).children(".jstree-children").remove())),i.state.opened=!1,this.trigger("close_node",{node:i}),void(n&&o.length||this.trigger("after_close",{node:i}))))},toggle_node:function(t){var i,n;if(e.isArray(t)){for(t=t.slice(),i=0,n=t.length;n>i;i++)this.toggle_node(t[i]);return!0}return this.is_closed(t)?this.open_node(t):this.is_open(t)?this.close_node(t):void 0},open_all:function(t,i,n){if(t||(t=e.jstree.root),t=this.get_node(t),!t)return!1;var a,s,r,o=t.id===e.jstree.root?this.get_container_ul():this.get_node(t,!0);if(!o.length){for(a=0,s=t.children_d.length;s>a;a++)this.is_closed(this._model.data[t.children_d[a]])&&(this._model.data[t.children_d[a]].state.opened=!0);return this.trigger("open_all",{node:t})}n=n||o,r=this,o=this.is_closed(t)?o.find(".jstree-closed").addBack():o.find(".jstree-closed"),o.each(function(){r.open_node(this,function(e,t){t&&this.is_parent(e)&&this.open_all(e,i,n)},i||0)}),0===n.find(".jstree-closed").length&&this.trigger("open_all",{node:this.get_node(n)})},close_all:function(t,i){if(t||(t=e.jstree.root),t=this.get_node(t),!t)return!1;var n,a,s=t.id===e.jstree.root?this.get_container_ul():this.get_node(t,!0),r=this;for(s.length&&(s=this.is_open(t)?s.find(".jstree-open").addBack():s.find(".jstree-open"),e(s.get().reverse()).each(function(){r.close_node(this,i||0)})),n=0,a=t.children_d.length;a>n;n++)this._model.data[t.children_d[n]].state.opened=!1;this.trigger("close_all",{node:t})},is_disabled:function(e){return e=this.get_node(e),e&&e.state&&e.state.disabled},enable_node:function(t){var i,n;if(e.isArray(t)){for(t=t.slice(),i=0,n=t.length;n>i;i++)this.enable_node(t[i]);return!0}return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&(t.state.disabled=!1,this.get_node(t,!0).children(".jstree-anchor").removeClass("jstree-disabled").attr("aria-disabled",!1),void this.trigger("enable_node",{node:t}))},disable_node:function(t){var i,n;if(e.isArray(t)){for(t=t.slice(),i=0,n=t.length;n>i;i++)this.disable_node(t[i]);return!0}return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&(t.state.disabled=!0,this.get_node(t,!0).children(".jstree-anchor").addClass("jstree-disabled").attr("aria-disabled",!0),void this.trigger("disable_node",{node:t}))},hide_node:function(t,i){var n,a;if(e.isArray(t)){for(t=t.slice(),n=0,a=t.length;a>n;n++)this.hide_node(t[n],!0);return this.redraw(),!0}return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&void(t.state.hidden||(t.state.hidden=!0,this._node_changed(t.parent),i||this.redraw(),this.trigger("hide_node",{node:t})))},show_node:function(t,i){var n,a;if(e.isArray(t)){for(t=t.slice(),n=0,a=t.length;a>n;n++)this.show_node(t[n],!0);return this.redraw(),!0}return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&void(t.state.hidden&&(t.state.hidden=!1,this._node_changed(t.parent),i||this.redraw(),this.trigger("show_node",{node:t})))},hide_all:function(t){var i,n=this._model.data,a=[];for(i in n)n.hasOwnProperty(i)&&i!==e.jstree.root&&!n[i].state.hidden&&(n[i].state.hidden=!0,a.push(i));return this._model.force_full_redraw=!0,t||this.redraw(),this.trigger("hide_all",{nodes:a}),a},show_all:function(t){var i,n=this._model.data,a=[];for(i in n)n.hasOwnProperty(i)&&i!==e.jstree.root&&n[i].state.hidden&&(n[i].state.hidden=!1,a.push(i));return this._model.force_full_redraw=!0,t||this.redraw(),this.trigger("show_all",{nodes:a}),a},activate_node:function(e,i){if(this.is_disabled(e))return!1;if(i&&"object"==typeof i||(i={}),this._data.core.last_clicked=this._data.core.last_clicked&&this._data.core.last_clicked.id!==t?this.get_node(this._data.core.last_clicked.id):null,this._data.core.last_clicked&&!this._data.core.last_clicked.state.selected&&(this._data.core.last_clicked=null),!this._data.core.last_clicked&&this._data.core.selected.length&&(this._data.core.last_clicked=this.get_node(this._data.core.selected[this._data.core.selected.length-1])),this.settings.core.multiple&&(i.metaKey||i.ctrlKey||i.shiftKey)&&(!i.shiftKey||this._data.core.last_clicked&&this.get_parent(e)&&this.get_parent(e)===this._data.core.last_clicked.parent))if(i.shiftKey){var n,a,s=this.get_node(e).id,r=this._data.core.last_clicked.id,o=this.get_node(this._data.core.last_clicked.parent).children,d=!1;for(n=0,a=o.length;a>n;n+=1)o[n]===s&&(d=!d),o[n]===r&&(d=!d),this.is_disabled(o[n])||!d&&o[n]!==s&&o[n]!==r?this.deselect_node(o[n],!0,i):this.select_node(o[n],!0,!1,i);this.trigger("changed",{action:"select_node",node:this.get_node(e),selected:this._data.core.selected,event:i})}else this.is_selected(e)?this.deselect_node(e,!1,i):this.select_node(e,!1,!1,i);else!this.settings.core.multiple&&(i.metaKey||i.ctrlKey||i.shiftKey)&&this.is_selected(e)?this.deselect_node(e,!1,i):(this.deselect_all(!0),this.select_node(e,!1,!1,i),this._data.core.last_clicked=this.get_node(e));this.trigger("activate_node",{node:this.get_node(e),event:i})},hover_node:function(e){if(e=this.get_node(e,!0),!e||!e.length||e.children(".jstree-hovered").length)return!1;var t=this.element.find(".jstree-hovered"),i=this.element;t&&t.length&&this.dehover_node(t),e.children(".jstree-anchor").addClass("jstree-hovered"),this.trigger("hover_node",{node:this.get_node(e)}),setTimeout(function(){i.attr("aria-activedescendant",e[0].id)},0)},dehover_node:function(e){return e=this.get_node(e,!0),!!(e&&e.length&&e.children(".jstree-hovered").length)&&(e.children(".jstree-anchor").removeClass("jstree-hovered"),void this.trigger("dehover_node",{node:this.get_node(e)}))},select_node:function(t,i,n,a){var s,r,o;if(e.isArray(t)){for(t=t.slice(),r=0,o=t.length;o>r;r++)this.select_node(t[r],i,n,a);return!0}return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&(s=this.get_node(t,!0),void(t.state.selected||(t.state.selected=!0,this._data.core.selected.push(t.id),n||(s=this._open_to(t)),s&&s.length&&s.attr("aria-selected",!0).children(".jstree-anchor").addClass("jstree-clicked"),this.trigger("select_node",{node:t,selected:this._data.core.selected,event:a}),i||this.trigger("changed",{action:"select_node",node:t,selected:this._data.core.selected,event:a}))))},deselect_node:function(t,i,n){var a,s,r;if(e.isArray(t)){for(t=t.slice(),a=0,s=t.length;s>a;a++)this.deselect_node(t[a],i,n);return!0}return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&(r=this.get_node(t,!0),void(t.state.selected&&(t.state.selected=!1,this._data.core.selected=e.vakata.array_remove_item(this._data.core.selected,t.id),r.length&&r.attr("aria-selected",!1).children(".jstree-anchor").removeClass("jstree-clicked"),this.trigger("deselect_node",{node:t,selected:this._data.core.selected,event:n}),i||this.trigger("changed",{action:"deselect_node",node:t,selected:this._data.core.selected,event:n}))))},select_all:function(t){var i,n,a=this._data.core.selected.concat([]);for(this._data.core.selected=this._model.data[e.jstree.root].children_d.concat(),i=0,n=this._data.core.selected.length;n>i;i++)this._model.data[this._data.core.selected[i]]&&(this._model.data[this._data.core.selected[i]].state.selected=!0);this.redraw(!0),this.trigger("select_all",{selected:this._data.core.selected}),t||this.trigger("changed",{action:"select_all",selected:this._data.core.selected,old_selection:a})},deselect_all:function(e){var t,i,n=this._data.core.selected.concat([]);for(t=0,i=this._data.core.selected.length;i>t;t++)this._model.data[this._data.core.selected[t]]&&(this._model.data[this._data.core.selected[t]].state.selected=!1);this._data.core.selected=[],this.element.find(".jstree-clicked").removeClass("jstree-clicked").parent().attr("aria-selected",!1),this.trigger("deselect_all",{selected:this._data.core.selected,node:n}),e||this.trigger("changed",{action:"deselect_all",selected:this._data.core.selected,old_selection:n})},is_selected:function(t){return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&t.state.selected},get_selected:function(t){return t?e.map(this._data.core.selected,e.proxy(function(e){return this.get_node(e)},this)):this._data.core.selected.slice()},get_top_selected:function(t){var i,n,a,s,r=this.get_selected(!0),o={};for(i=0,n=r.length;n>i;i++)o[r[i].id]=r[i];for(i=0,n=r.length;n>i;i++)for(a=0,s=r[i].children_d.length;s>a;a++)o[r[i].children_d[a]]&&delete o[r[i].children_d[a]];r=[];for(i in o)o.hasOwnProperty(i)&&r.push(i);return t?e.map(r,e.proxy(function(e){return this.get_node(e)},this)):r},get_bottom_selected:function(t){var i,n,a=this.get_selected(!0),s=[];for(i=0,n=a.length;n>i;i++)a[i].children.length||s.push(a[i].id);return t?e.map(s,e.proxy(function(e){return this.get_node(e)},this)):s},get_state:function(){var t,i={core:{open:[],scroll:{left:this.element.scrollLeft(),top:this.element.scrollTop()},selected:[]}};for(t in this._model.data)this._model.data.hasOwnProperty(t)&&t!==e.jstree.root&&(this._model.data[t].state.opened&&i.core.open.push(t),this._model.data[t].state.selected&&i.core.selected.push(t));return i},set_state:function(i,n){if(i){if(i.core){var a,s;if(i.core.open)return e.isArray(i.core.open)&&i.core.open.length?this._load_nodes(i.core.open,function(e){this.open_node(e,!1,0),delete i.core.open,this.set_state(i,n)},!0):(delete i.core.open,this.set_state(i,n)),!1;if(i.core.scroll)return i.core.scroll&&i.core.scroll.left!==t&&this.element.scrollLeft(i.core.scroll.left),i.core.scroll&&i.core.scroll.top!==t&&this.element.scrollTop(i.core.scroll.top),delete i.core.scroll,this.set_state(i,n),!1;if(i.core.selected)return a=this,this.deselect_all(),e.each(i.core.selected,function(e,t){a.select_node(t,!1,!0)}),delete i.core.selected,this.set_state(i,n),!1;for(s in i)i.hasOwnProperty(s)&&"core"!==s&&-1===e.inArray(s,this.settings.plugins)&&delete i[s];if(e.isEmptyObject(i.core))return delete i.core,this.set_state(i,n),!1}return!e.isEmptyObject(i)||(i=null,n&&n.call(this),this.trigger("set_state"),!1)}return!1},refresh:function(t,i){this._data.core.state=i===!0?{}:this.get_state(),i&&e.isFunction(i)&&(this._data.core.state=i.call(this,this._data.core.state)),this._cnt=0,this._model.data={},this._model.data[e.jstree.root]={id:e.jstree.root,parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}},this._data.core.selected=[],this._data.core.last_clicked=null,this._data.core.focused=null;var n=this.get_container_ul()[0].className;t||(this.element.html("<ul class='"+n+"' role='group'><li class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='treeitem' id='j"+this._id+"_loading'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>"),this.element.attr("aria-activedescendant","j"+this._id+"_loading")),this.load_node(e.jstree.root,function(t,i){i&&(this.get_container_ul()[0].className=n,this._firstChild(this.get_container_ul()[0])&&this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id),this.set_state(e.extend(!0,{},this._data.core.state),function(){this.trigger("refresh")})),this._data.core.state=null})},refresh_node:function(t){if(t=this.get_node(t),!t||t.id===e.jstree.root)return!1;var i=[],n=[];this._data.core.selected.concat([]);n.push(t.id),t.state.opened===!0&&i.push(t.id),this.get_node(t,!0).find(".jstree-open").each(function(){i.push(this.id)}),this._load_nodes(n,e.proxy(function(e){this.open_node(i,!1,0),this.select_node(this._data.core.selected),this.trigger("refresh_node",{node:t,nodes:e})},this))},set_id:function(t,i){if(t=this.get_node(t),!t||t.id===e.jstree.root)return!1;var n,a,s=this._model.data;for(i=i.toString(),s[t.parent].children[e.inArray(t.id,s[t.parent].children)]=i,n=0,a=t.parents.length;a>n;n++)s[t.parents[n]].children_d[e.inArray(t.id,s[t.parents[n]].children_d)]=i;for(n=0,a=t.children.length;a>n;n++)s[t.children[n]].parent=i;for(n=0,a=t.children_d.length;a>n;n++)s[t.children_d[n]].parents[e.inArray(t.id,s[t.children_d[n]].parents)]=i;return n=e.inArray(t.id,this._data.core.selected),-1!==n&&(this._data.core.selected[n]=i),n=this.get_node(t.id,!0),n&&(n.attr("id",i).children(".jstree-anchor").attr("id",i+"_anchor").end().attr("aria-labelledby",i+"_anchor"),this.element.attr("aria-activedescendant")===t.id&&this.element.attr("aria-activedescendant",i)),delete s[t.id],t.id=i,t.li_attr.id=i,s[i]=t,!0},get_text:function(t){return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&t.text},set_text:function(t,i){var n,a;if(e.isArray(t)){for(t=t.slice(),n=0,a=t.length;a>n;n++)this.set_text(t[n],i);return!0}return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&(t.text=i,this.get_node(t,!0).length&&this.redraw_node(t.id),this.trigger("set_text",{obj:t,text:i}),!0)},get_json:function(t,i,n){if(t=this.get_node(t||e.jstree.root),!t)return!1;i&&i.flat&&!n&&(n=[]);var a,s,r={id:t.id,text:t.text,icon:this.get_icon(t),li_attr:e.extend(!0,{},t.li_attr),a_attr:e.extend(!0,{},t.a_attr),state:{},data:(!i||!i.no_data)&&e.extend(!0,{},t.data)};if(i&&i.flat?r.parent=t.parent:r.children=[],!i||!i.no_state)for(a in t.state)t.state.hasOwnProperty(a)&&(r.state[a]=t.state[a]);if(i&&i.no_id&&(delete r.id,r.li_attr&&r.li_attr.id&&delete r.li_attr.id,r.a_attr&&r.a_attr.id&&delete r.a_attr.id),i&&i.flat&&t.id!==e.jstree.root&&n.push(r),!i||!i.no_children)for(a=0,s=t.children.length;s>a;a++)i&&i.flat?this.get_json(t.children[a],i,n):r.children.push(this.get_json(t.children[a],i));return i&&i.flat?n:t.id===e.jstree.root?r.children:r},create_node:function(i,n,a,s,r){if(null===i&&(i=e.jstree.root),i=this.get_node(i),!i)return!1;if(a=a===t?"last":a,!a.toString().match(/^(before|after)$/)&&!r&&!this.is_loaded(i))return this.load_node(i,function(){this.create_node(i,n,a,s,!0)});n||(n={text:this.get_string("New node")}),"string"==typeof n&&(n={text:n}),n.text===t&&(n.text=this.get_string("New node"));var o,d,l,c;switch(i.id===e.jstree.root&&("before"===a&&(a="first"),"after"===a&&(a="last")),a){case"before":o=this.get_node(i.parent),a=e.inArray(i.id,o.children),i=o;break;case"after":o=this.get_node(i.parent),a=e.inArray(i.id,o.children)+1,i=o;break;case"inside":case"first":a=0;break;case"last":a=i.children.length;break;default:a||(a=0)}if(a>i.children.length&&(a=i.children.length),n.id||(n.id=!0),!this.check("create_node",n,i,a))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(n.id===!0&&delete n.id,n=this._parse_model_from_json(n,i.id,i.parents.concat()),!n)return!1;for(o=this.get_node(n),d=[],d.push(n),d=d.concat(o.children_d),this.trigger("model",{nodes:d,parent:i.id}),i.children_d=i.children_d.concat(d),l=0,c=i.parents.length;c>l;l++)this._model.data[i.parents[l]].children_d=this._model.data[i.parents[l]].children_d.concat(d);for(n=o,o=[],l=0,c=i.children.length;c>l;l++)o[l>=a?l+1:l]=i.children[l];return o[a]=n.id,i.children=o,this.redraw_node(i,!0),s&&s.call(this,this.get_node(n)),this.trigger("create_node",{node:this.get_node(n),parent:i.id,position:a}),n.id},rename_node:function(t,i){var n,a,s;if(e.isArray(t)){for(t=t.slice(),n=0,a=t.length;a>n;n++)this.rename_node(t[n],i);return!0}return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&(s=t.text,this.check("rename_node",t,this.get_parent(t),i)?(this.set_text(t,i),this.trigger("rename_node",{node:t,text:i,old:s}),!0):(this.settings.core.error.call(this,this._data.core.last_error),!1))},delete_node:function(t){var i,n,a,s,r,o,d,l,c,h,u,f;if(e.isArray(t)){for(t=t.slice(),i=0,n=t.length;n>i;i++)this.delete_node(t[i]);return!0}if(t=this.get_node(t),!t||t.id===e.jstree.root)return!1;if(a=this.get_node(t.parent),s=e.inArray(t.id,a.children),h=!1,!this.check("delete_node",t,a,s))return this.settings.core.error.call(this,this._data.core.last_error),!1;for(-1!==s&&(a.children=e.vakata.array_remove(a.children,s)),r=t.children_d.concat([]),r.push(t.id),l=0,c=r.length;c>l;l++){for(o=0,d=t.parents.length;d>o;o++)s=e.inArray(r[l],this._model.data[t.parents[o]].children_d),-1!==s&&(this._model.data[t.parents[o]].children_d=e.vakata.array_remove(this._model.data[t.parents[o]].children_d,s));this._model.data[r[l]].state.selected&&(h=!0,s=e.inArray(r[l],this._data.core.selected),-1!==s&&(this._data.core.selected=e.vakata.array_remove(this._data.core.selected,s)))}for(this.trigger("delete_node",{node:t,parent:a.id}),h&&this.trigger("changed",{action:"delete_node",node:t,selected:this._data.core.selected,parent:a.id}),l=0,c=r.length;c>l;l++)delete this._model.data[r[l]];return-1!==e.inArray(this._data.core.focused,r)&&(this._data.core.focused=null,u=this.element[0].scrollTop,f=this.element[0].scrollLeft,a.id===e.jstree.root?this.get_node(this._model.data[e.jstree.root].children[0],!0).children(".jstree-anchor").focus():this.get_node(a,!0).children(".jstree-anchor").focus(),this.element[0].scrollTop=u,this.element[0].scrollLeft=f),this.redraw_node(a,!0),!0},check:function(t,i,n,a,s){i=i&&i.id?i:this.get_node(i),n=n&&n.id?n:this.get_node(n);var r=t.match(/^move_node|copy_node|create_node$/i)?n:i,o=this.settings.core.check_callback;return"move_node"!==t&&"copy_node"!==t||s&&s.is_multi||i.id!==n.id&&e.inArray(i.id,n.children)!==a&&-1===e.inArray(n.id,i.children_d)?(r&&r.data&&(r=r.data),r&&r.functions&&(r.functions[t]===!1||r.functions[t]===!0)?(r.functions[t]===!1&&(this._data.core.last_error={error:"check",plugin:"core",id:"core_02",reason:"Node data prevents function: "+t,data:JSON.stringify({chk:t,pos:a,obj:!(!i||!i.id)&&i.id,par:!(!n||!n.id)&&n.id})}),r.functions[t]):!(o===!1||e.isFunction(o)&&o.call(this,t,i,n,a,s)===!1||o&&o[t]===!1)||(this._data.core.last_error={error:"check",plugin:"core",id:"core_03",reason:"User config for core.check_callback prevents function: "+t,data:JSON.stringify({chk:t,pos:a,obj:!(!i||!i.id)&&i.id,par:!(!n||!n.id)&&n.id})},!1)):(this._data.core.last_error={error:"check",plugin:"core",id:"core_01",reason:"Moving parent inside child",data:JSON.stringify({chk:t,pos:a,obj:!(!i||!i.id)&&i.id,par:!(!n||!n.id)&&n.id})},!1)},last_error:function(){return this._data.core.last_error},move_node:function(i,n,a,s,r,o,d){var l,c,h,u,f,_,g,p,m,v,y,k,j,b;if(n=this.get_node(n),a=a===t?0:a,!n)return!1;if(!a.toString().match(/^(before|after)$/)&&!r&&!this.is_loaded(n))return this.load_node(n,function(){this.move_node(i,n,a,s,!0,!1,d)});if(e.isArray(i)){if(1!==i.length){for(l=0,c=i.length;c>l;l++)(m=this.move_node(i[l],n,a,s,r,!1,d))&&(n=m,a="after");return this.redraw(),!0}i=i[0]}if(i=i&&i.id?i:this.get_node(i),!i||i.id===e.jstree.root)return!1;if(h=(i.parent||e.jstree.root).toString(),f=a.toString().match(/^(before|after)$/)&&n.id!==e.jstree.root?this.get_node(n.parent):n,_=d?d:this._model.data[i.id]?this:e.jstree.reference(i.id),g=!_||!_._id||this._id!==_._id,u=_&&_._id&&h&&_._model.data[h]&&_._model.data[h].children?e.inArray(i.id,_._model.data[h].children):-1,_&&_._id&&(i=_._model.data[i.id]),g)return!!(m=this.copy_node(i,n,a,s,r,!1,d))&&(_&&_.delete_node(i),m);switch(n.id===e.jstree.root&&("before"===a&&(a="first"),"after"===a&&(a="last")),a){case"before":a=e.inArray(n.id,f.children);break;case"after":a=e.inArray(n.id,f.children)+1;break;case"inside":case"first":a=0;break;case"last":a=f.children.length;break;default:a||(a=0)}if(a>f.children.length&&(a=f.children.length),!this.check("move_node",i,f,a,{core:!0,origin:d,is_multi:_&&_._id&&_._id!==this._id,is_foreign:!_||!_._id}))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(i.parent===f.id){for(p=f.children.concat(),m=e.inArray(i.id,p),-1!==m&&(p=e.vakata.array_remove(p,m),a>m&&a--),m=[],v=0,y=p.length;y>v;v++)m[v>=a?v+1:v]=p[v];m[a]=i.id,f.children=m,this._node_changed(f.id),this.redraw(f.id===e.jstree.root)}else{for(m=i.children_d.concat(),m.push(i.id),v=0,y=i.parents.length;y>v;v++){for(p=[],b=_._model.data[i.parents[v]].children_d,k=0,j=b.length;j>k;k++)-1===e.inArray(b[k],m)&&p.push(b[k]);_._model.data[i.parents[v]].children_d=p}for(_._model.data[h].children=e.vakata.array_remove_item(_._model.data[h].children,i.id),v=0,y=f.parents.length;y>v;v++)this._model.data[f.parents[v]].children_d=this._model.data[f.parents[v]].children_d.concat(m);for(p=[],v=0,y=f.children.length;y>v;v++)p[v>=a?v+1:v]=f.children[v];for(p[a]=i.id,f.children=p,f.children_d.push(i.id),f.children_d=f.children_d.concat(i.children_d),i.parent=f.id,m=f.parents.concat(),m.unshift(f.id),b=i.parents.length,i.parents=m,m=m.concat(),v=0,y=i.children_d.length;y>v;v++)this._model.data[i.children_d[v]].parents=this._model.data[i.children_d[v]].parents.slice(0,-1*b),Array.prototype.push.apply(this._model.data[i.children_d[v]].parents,m);(h===e.jstree.root||f.id===e.jstree.root)&&(this._model.force_full_redraw=!0),this._model.force_full_redraw||(this._node_changed(h),this._node_changed(f.id)),o||this.redraw()}return s&&s.call(this,i,f,a),this.trigger("move_node",{node:i,parent:f.id,position:a,old_parent:h,old_position:u,is_multi:_&&_._id&&_._id!==this._id,is_foreign:!_||!_._id,old_instance:_,new_instance:this}),i.id},copy_node:function(i,n,a,s,r,o,d){var l,c,h,u,f,_,g,p,m,v,y;if(n=this.get_node(n),a=a===t?0:a,!n)return!1;if(!a.toString().match(/^(before|after)$/)&&!r&&!this.is_loaded(n))return this.load_node(n,function(){this.copy_node(i,n,a,s,!0,!1,d)});if(e.isArray(i)){if(1!==i.length){for(l=0,c=i.length;c>l;l++)(u=this.copy_node(i[l],n,a,s,r,!0,d))&&(n=u,a="after");return this.redraw(),!0}i=i[0]}if(i=i&&i.id?i:this.get_node(i),!i||i.id===e.jstree.root)return!1;switch(p=(i.parent||e.jstree.root).toString(),m=a.toString().match(/^(before|after)$/)&&n.id!==e.jstree.root?this.get_node(n.parent):n,v=d?d:this._model.data[i.id]?this:e.jstree.reference(i.id),y=!v||!v._id||this._id!==v._id,v&&v._id&&(i=v._model.data[i.id]),n.id===e.jstree.root&&("before"===a&&(a="first"),"after"===a&&(a="last")),a){case"before":a=e.inArray(n.id,m.children);break;case"after":a=e.inArray(n.id,m.children)+1;break;case"inside":case"first":a=0;break;case"last":a=m.children.length;break;default:a||(a=0)}if(a>m.children.length&&(a=m.children.length),!this.check("copy_node",i,m,a,{core:!0,origin:d,is_multi:v&&v._id&&v._id!==this._id,is_foreign:!v||!v._id}))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(g=v?v.get_json(i,{no_id:!0,no_data:!0,no_state:!0}):i,!g)return!1;if(g.id===!0&&delete g.id,g=this._parse_model_from_json(g,m.id,m.parents.concat()),!g)return!1;for(u=this.get_node(g),i&&i.state&&i.state.loaded===!1&&(u.state.loaded=!1),h=[],h.push(g),h=h.concat(u.children_d),this.trigger("model",{nodes:h,parent:m.id}),f=0,_=m.parents.length;_>f;f++)this._model.data[m.parents[f]].children_d=this._model.data[m.parents[f]].children_d.concat(h);for(h=[],f=0,_=m.children.length;_>f;f++)h[f>=a?f+1:f]=m.children[f];return h[a]=u.id,m.children=h,m.children_d.push(u.id),m.children_d=m.children_d.concat(u.children_d),m.id===e.jstree.root&&(this._model.force_full_redraw=!0),this._model.force_full_redraw||this._node_changed(m.id),o||this.redraw(m.id===e.jstree.root),s&&s.call(this,u,m,a),this.trigger("copy_node",{node:u,original:i,parent:m.id,position:a,old_parent:p,old_position:v&&v._id&&p&&v._model.data[p]&&v._model.data[p].children?e.inArray(i.id,v._model.data[p].children):-1,is_multi:v&&v._id&&v._id!==this._id,is_foreign:!v||!v._id,old_instance:v,new_instance:this}),u.id},cut:function(t){if(t||(t=this._data.core.selected.concat()),e.isArray(t)||(t=[t]),!t.length)return!1;var i,n,a,d=[];for(n=0,a=t.length;a>n;n++)i=this.get_node(t[n]),i&&i.id&&i.id!==e.jstree.root&&d.push(i);return!!d.length&&(s=d,o=this,r="move_node",void this.trigger("cut",{node:t}))},copy:function(t){if(t||(t=this._data.core.selected.concat()),e.isArray(t)||(t=[t]),!t.length)return!1;var i,n,a,d=[];for(n=0,a=t.length;a>n;n++)i=this.get_node(t[n]),i&&i.id&&i.id!==e.jstree.root&&d.push(i);return!!d.length&&(s=d,o=this,r="copy_node",void this.trigger("copy",{node:t}))},get_buffer:function(){return{mode:r,node:s,inst:o}},can_paste:function(){return r!==!1&&s!==!1},paste:function(e,t){return e=this.get_node(e),!!(e&&r&&r.match(/^(copy_node|move_node)$/)&&s)&&(this[r](s,e,t,!1,!1,!1,o)&&this.trigger("paste",{parent:e.id,node:s,mode:r}),s=!1,r=!1,void(o=!1))},clear_buffer:function(){s=!1,r=!1,o=!1,this.trigger("clear_buffer")},edit:function(t,i,n){var a,s,r,o,d,l,c,h,u,f=!1;return!!(t=this.get_node(t))&&(this.settings.core.check_callback===!1?(this._data.core.last_error={error:"check",plugin:"core",id:"core_07",reason:"Could not edit node because of check_callback"},this.settings.core.error.call(this,this._data.core.last_error),!1):(u=t,i="string"==typeof i?i:t.text,this.set_text(t,""),t=this._open_to(t),u.text=i,a=this._data.core.rtl,s=this.element.width(),this._data.core.focused=u.id,r=t.children(".jstree-anchor").focus(),o=e("<span>"),d=i,l=e("<div />",{css:{position:"absolute",top:"-200px",left:a?"0px":"-1000px",visibility:"hidden"}}).appendTo("body"),c=e("<input />",{value:d,"class":"jstree-rename-input",css:{padding:"0",border:"1px solid silver","box-sizing":"border-box",display:"inline-block",height:this._data.core.li_height+"px",lineHeight:this._data.core.li_height+"px",width:"150px"},blur:e.proxy(function(i){i.stopImmediatePropagation(),i.preventDefault();var a,s=o.children(".jstree-rename-input"),c=s.val(),h=this.settings.core.force_text;""===c&&(c=d),l.remove(),o.replaceWith(r),o.remove(),d=h?d:e("<div></div>").append(e.parseHTML(d)).html(),
this.set_text(t,d),a=!!this.rename_node(t,h?e("<div></div>").text(c).text():e("<div></div>").append(e.parseHTML(c)).html()),a||this.set_text(t,d),this._data.core.focused=u.id,setTimeout(e.proxy(function(){var e=this.get_node(u.id,!0);e.length&&(this._data.core.focused=u.id,e.children(".jstree-anchor").focus())},this),0),n&&n.call(this,u,a,f)},this),keydown:function(e){var t=e.which;27===t&&(f=!0,this.value=d),(27===t||13===t||37===t||38===t||39===t||40===t||32===t)&&e.stopImmediatePropagation(),(27===t||13===t)&&(e.preventDefault(),this.blur())},click:function(e){e.stopImmediatePropagation()},mousedown:function(e){e.stopImmediatePropagation()},keyup:function(e){c.width(Math.min(l.text("pW"+this.value).width(),s))},keypress:function(e){return 13!==e.which&&void 0}}),h={fontFamily:r.css("fontFamily")||"",fontSize:r.css("fontSize")||"",fontWeight:r.css("fontWeight")||"",fontStyle:r.css("fontStyle")||"",fontStretch:r.css("fontStretch")||"",fontVariant:r.css("fontVariant")||"",letterSpacing:r.css("letterSpacing")||"",wordSpacing:r.css("wordSpacing")||""},o.attr("class",r.attr("class")).append(r.contents().clone()).append(c),r.replaceWith(o),l.css(h),void c.css(h).width(Math.min(l.text("pW"+c[0].value).width(),s))[0].select()))},set_theme:function(t,i){if(!t)return!1;if(i===!0){var n=this.settings.core.themes.dir;n||(n=e.jstree.path+"/themes"),i=n+"/"+t+"/style.css"}i&&-1===e.inArray(i,d)&&(e("head").append('<link rel="stylesheet" href="'+i+'" type="text/css" />'),d.push(i)),this._data.core.themes.name&&this.element.removeClass("jstree-"+this._data.core.themes.name),this._data.core.themes.name=t,this.element.addClass("jstree-"+t),this.element[this.settings.core.themes.responsive?"addClass":"removeClass"]("jstree-"+t+"-responsive"),this.trigger("set_theme",{theme:t})},get_theme:function(){return this._data.core.themes.name},set_theme_variant:function(e){this._data.core.themes.variant&&this.element.removeClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant),this._data.core.themes.variant=e,e&&this.element.addClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant)},get_theme_variant:function(){return this._data.core.themes.variant},show_stripes:function(){this._data.core.themes.stripes=!0,this.get_container_ul().addClass("jstree-striped")},hide_stripes:function(){this._data.core.themes.stripes=!1,this.get_container_ul().removeClass("jstree-striped")},toggle_stripes:function(){this._data.core.themes.stripes?this.hide_stripes():this.show_stripes()},show_dots:function(){this._data.core.themes.dots=!0,this.get_container_ul().removeClass("jstree-no-dots")},hide_dots:function(){this._data.core.themes.dots=!1,this.get_container_ul().addClass("jstree-no-dots")},toggle_dots:function(){this._data.core.themes.dots?this.hide_dots():this.show_dots()},show_icons:function(){this._data.core.themes.icons=!0,this.get_container_ul().removeClass("jstree-no-icons")},hide_icons:function(){this._data.core.themes.icons=!1,this.get_container_ul().addClass("jstree-no-icons")},toggle_icons:function(){this._data.core.themes.icons?this.hide_icons():this.show_icons()},set_icon:function(i,n){var a,s,r,o;if(e.isArray(i)){for(i=i.slice(),a=0,s=i.length;s>a;a++)this.set_icon(i[a],n);return!0}return i=this.get_node(i),!(!i||i.id===e.jstree.root)&&(o=i.icon,i.icon=n===!0||null===n||n===t||""===n||n,r=this.get_node(i,!0).children(".jstree-anchor").children(".jstree-themeicon"),n===!1?this.hide_icon(i):n===!0||null===n||n===t||""===n?(r.removeClass("jstree-themeicon-custom "+o).css("background","").removeAttr("rel"),o===!1&&this.show_icon(i)):-1===n.indexOf("/")&&-1===n.indexOf(".")?(r.removeClass(o).css("background",""),r.addClass(n+" jstree-themeicon-custom").attr("rel",n),o===!1&&this.show_icon(i)):(r.removeClass(o).css("background",""),r.addClass("jstree-themeicon-custom").css("background","url('"+n+"') center center no-repeat").attr("rel",n),o===!1&&this.show_icon(i)),!0)},get_icon:function(t){return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&t.icon},hide_icon:function(t){var i,n;if(e.isArray(t)){for(t=t.slice(),i=0,n=t.length;n>i;i++)this.hide_icon(t[i]);return!0}return t=this.get_node(t),!(!t||t===e.jstree.root)&&(t.icon=!1,this.get_node(t,!0).children(".jstree-anchor").children(".jstree-themeicon").addClass("jstree-themeicon-hidden"),!0)},show_icon:function(t){var i,n,a;if(e.isArray(t)){for(t=t.slice(),i=0,n=t.length;n>i;i++)this.show_icon(t[i]);return!0}return t=this.get_node(t),!(!t||t===e.jstree.root)&&(a=this.get_node(t,!0),t.icon=!a.length||a.children(".jstree-anchor").children(".jstree-themeicon").attr("rel"),t.icon||(t.icon=!0),a.children(".jstree-anchor").children(".jstree-themeicon").removeClass("jstree-themeicon-hidden"),!0)}},e.vakata={},e.vakata.attributes=function(t,i){t=e(t)[0];var n=i?{}:[];return t&&t.attributes&&e.each(t.attributes,function(t,a){-1===e.inArray(a.name.toLowerCase(),["style","contenteditable","hasfocus","tabindex"])&&null!==a.value&&""!==e.trim(a.value)&&(i?n[a.name]=a.value:n.push(a.name))}),n},e.vakata.array_unique=function(e){var i,n,a=[],s={};for(i=0,n=e.length;n>i;i++)s[e[i]]===t&&(a.push(e[i]),s[e[i]]=!0);return a},e.vakata.array_remove=function(e,t,i){var n=e.slice((i||t)+1||e.length);return e.length=0>t?e.length+t:t,e.push.apply(e,n),e},e.vakata.array_remove_item=function(t,i){var n=e.inArray(i,t);return-1!==n?e.vakata.array_remove(t,n):t},e.jstree.plugins.changed=function(e,t){var i=[];this.trigger=function(e,n){var a,s;if(n||(n={}),"changed"===e.replace(".jstree","")){n.changed={selected:[],deselected:[]};var r={};for(a=0,s=i.length;s>a;a++)r[i[a]]=1;for(a=0,s=n.selected.length;s>a;a++)r[n.selected[a]]?r[n.selected[a]]=2:n.changed.selected.push(n.selected[a]);for(a=0,s=i.length;s>a;a++)1===r[i[a]]&&n.changed.deselected.push(i[a]);i=n.selected.slice()}t.trigger.call(this,e,n)},this.refresh=function(e,n){return i=[],t.refresh.apply(this,arguments)}};var u=c.createElement("I");u.className="jstree-icon jstree-checkbox",u.setAttribute("role","presentation"),e.jstree.defaults.checkbox={visible:!0,three_state:!0,whole_node:!0,keep_selected_style:!0,cascade:"",tie_selection:!0},e.jstree.plugins.checkbox=function(i,n){this.bind=function(){n.bind.call(this),this._data.checkbox.uto=!1,this._data.checkbox.selected=[],this.settings.checkbox.three_state&&(this.settings.checkbox.cascade="up+down+undetermined"),this.element.on("init.jstree",e.proxy(function(){this._data.checkbox.visible=this.settings.checkbox.visible,this.settings.checkbox.keep_selected_style||this.element.addClass("jstree-checkbox-no-clicked"),this.settings.checkbox.tie_selection&&this.element.addClass("jstree-checkbox-selection")},this)).on("loading.jstree",e.proxy(function(){this[this._data.checkbox.visible?"show_checkboxes":"hide_checkboxes"]()},this)),-1!==this.settings.checkbox.cascade.indexOf("undetermined")&&this.element.on("changed.jstree uncheck_node.jstree check_node.jstree uncheck_all.jstree check_all.jstree move_node.jstree copy_node.jstree redraw.jstree open_node.jstree",e.proxy(function(){this._data.checkbox.uto&&clearTimeout(this._data.checkbox.uto),this._data.checkbox.uto=setTimeout(e.proxy(this._undetermined,this),50)},this)),this.settings.checkbox.tie_selection||this.element.on("model.jstree",e.proxy(function(e,t){var i,n,a=this._model.data,s=(a[t.parent],t.nodes);for(i=0,n=s.length;n>i;i++)a[s[i]].state.checked=a[s[i]].state.checked||a[s[i]].original&&a[s[i]].original.state&&a[s[i]].original.state.checked,a[s[i]].state.checked&&this._data.checkbox.selected.push(s[i])},this)),(-1!==this.settings.checkbox.cascade.indexOf("up")||-1!==this.settings.checkbox.cascade.indexOf("down"))&&this.element.on("model.jstree",e.proxy(function(t,i){var n,a,s,r,o,d,l=this._model.data,c=l[i.parent],h=i.nodes,u=[],f=this.settings.checkbox.cascade,_=this.settings.checkbox.tie_selection;if(-1!==f.indexOf("down"))if(c.state[_?"selected":"checked"]){for(a=0,s=h.length;s>a;a++)l[h[a]].state[_?"selected":"checked"]=!0;this._data[_?"core":"checkbox"].selected=this._data[_?"core":"checkbox"].selected.concat(h)}else for(a=0,s=h.length;s>a;a++)if(l[h[a]].state[_?"selected":"checked"]){for(r=0,o=l[h[a]].children_d.length;o>r;r++)l[l[h[a]].children_d[r]].state[_?"selected":"checked"]=!0;this._data[_?"core":"checkbox"].selected=this._data[_?"core":"checkbox"].selected.concat(l[h[a]].children_d)}if(-1!==f.indexOf("up")){for(a=0,s=c.children_d.length;s>a;a++)l[c.children_d[a]].children.length||u.push(l[c.children_d[a]].parent);for(u=e.vakata.array_unique(u),r=0,o=u.length;o>r;r++)for(c=l[u[r]];c&&c.id!==e.jstree.root;){for(n=0,a=0,s=c.children.length;s>a;a++)n+=l[c.children[a]].state[_?"selected":"checked"];if(n!==s)break;c.state[_?"selected":"checked"]=!0,this._data[_?"core":"checkbox"].selected.push(c.id),d=this.get_node(c,!0),d&&d.length&&d.attr("aria-selected",!0).children(".jstree-anchor").addClass(_?"jstree-clicked":"jstree-checked"),c=this.get_node(c.parent)}}this._data[_?"core":"checkbox"].selected=e.vakata.array_unique(this._data[_?"core":"checkbox"].selected)},this)).on(this.settings.checkbox.tie_selection?"select_node.jstree":"check_node.jstree",e.proxy(function(t,i){var n,a,s,r,o=i.node,d=this._model.data,l=this.get_node(o.parent),c=this.get_node(o,!0),h=this.settings.checkbox.cascade,u=this.settings.checkbox.tie_selection;if(-1!==h.indexOf("down"))for(this._data[u?"core":"checkbox"].selected=e.vakata.array_unique(this._data[u?"core":"checkbox"].selected.concat(o.children_d)),n=0,a=o.children_d.length;a>n;n++)r=d[o.children_d[n]],r.state[u?"selected":"checked"]=!0,r&&r.original&&r.original.state&&r.original.state.undetermined&&(r.original.state.undetermined=!1);if(-1!==h.indexOf("up"))for(;l&&l.id!==e.jstree.root;){for(s=0,n=0,a=l.children.length;a>n;n++)s+=d[l.children[n]].state[u?"selected":"checked"];if(s!==a)break;l.state[u?"selected":"checked"]=!0,this._data[u?"core":"checkbox"].selected.push(l.id),r=this.get_node(l,!0),r&&r.length&&r.attr("aria-selected",!0).children(".jstree-anchor").addClass(u?"jstree-clicked":"jstree-checked"),l=this.get_node(l.parent)}-1!==h.indexOf("down")&&c.length&&c.find(".jstree-anchor").addClass(u?"jstree-clicked":"jstree-checked").parent().attr("aria-selected",!0)},this)).on(this.settings.checkbox.tie_selection?"deselect_all.jstree":"uncheck_all.jstree",e.proxy(function(t,i){var n,a,s,r=this.get_node(e.jstree.root),o=this._model.data;for(n=0,a=r.children_d.length;a>n;n++)s=o[r.children_d[n]],s&&s.original&&s.original.state&&s.original.state.undetermined&&(s.original.state.undetermined=!1)},this)).on(this.settings.checkbox.tie_selection?"deselect_node.jstree":"uncheck_node.jstree",e.proxy(function(t,i){var n,a,s,r=i.node,o=this.get_node(r,!0),d=this.settings.checkbox.cascade,l=this.settings.checkbox.tie_selection;if(r&&r.original&&r.original.state&&r.original.state.undetermined&&(r.original.state.undetermined=!1),-1!==d.indexOf("down"))for(n=0,a=r.children_d.length;a>n;n++)s=this._model.data[r.children_d[n]],s.state[l?"selected":"checked"]=!1,s&&s.original&&s.original.state&&s.original.state.undetermined&&(s.original.state.undetermined=!1);if(-1!==d.indexOf("up"))for(n=0,a=r.parents.length;a>n;n++)s=this._model.data[r.parents[n]],s.state[l?"selected":"checked"]=!1,s&&s.original&&s.original.state&&s.original.state.undetermined&&(s.original.state.undetermined=!1),s=this.get_node(r.parents[n],!0),s&&s.length&&s.attr("aria-selected",!1).children(".jstree-anchor").removeClass(l?"jstree-clicked":"jstree-checked");for(s=[],n=0,a=this._data[l?"core":"checkbox"].selected.length;a>n;n++)-1!==d.indexOf("down")&&-1!==e.inArray(this._data[l?"core":"checkbox"].selected[n],r.children_d)||-1!==d.indexOf("up")&&-1!==e.inArray(this._data[l?"core":"checkbox"].selected[n],r.parents)||s.push(this._data[l?"core":"checkbox"].selected[n]);this._data[l?"core":"checkbox"].selected=e.vakata.array_unique(s),-1!==d.indexOf("down")&&o.length&&o.find(".jstree-anchor").removeClass(l?"jstree-clicked":"jstree-checked").parent().attr("aria-selected",!1)},this)),-1!==this.settings.checkbox.cascade.indexOf("up")&&this.element.on("delete_node.jstree",e.proxy(function(t,i){for(var n,a,s,r,o=this.get_node(i.parent),d=this._model.data,l=this.settings.checkbox.tie_selection;o&&o.id!==e.jstree.root&&!o.state[l?"selected":"checked"];){for(s=0,n=0,a=o.children.length;a>n;n++)s+=d[o.children[n]].state[l?"selected":"checked"];if(!(a>0&&s===a))break;o.state[l?"selected":"checked"]=!0,this._data[l?"core":"checkbox"].selected.push(o.id),r=this.get_node(o,!0),r&&r.length&&r.attr("aria-selected",!0).children(".jstree-anchor").addClass(l?"jstree-clicked":"jstree-checked"),o=this.get_node(o.parent)}},this)).on("move_node.jstree",e.proxy(function(t,i){var n,a,s,r,o,d=i.is_multi,l=i.old_parent,c=this.get_node(i.parent),h=this._model.data,u=this.settings.checkbox.tie_selection;if(!d)for(n=this.get_node(l);n&&n.id!==e.jstree.root&&!n.state[u?"selected":"checked"];){for(a=0,s=0,r=n.children.length;r>s;s++)a+=h[n.children[s]].state[u?"selected":"checked"];if(!(r>0&&a===r))break;n.state[u?"selected":"checked"]=!0,this._data[u?"core":"checkbox"].selected.push(n.id),o=this.get_node(n,!0),o&&o.length&&o.attr("aria-selected",!0).children(".jstree-anchor").addClass(u?"jstree-clicked":"jstree-checked"),n=this.get_node(n.parent)}for(n=c;n&&n.id!==e.jstree.root;){for(a=0,s=0,r=n.children.length;r>s;s++)a+=h[n.children[s]].state[u?"selected":"checked"];if(a===r)n.state[u?"selected":"checked"]||(n.state[u?"selected":"checked"]=!0,this._data[u?"core":"checkbox"].selected.push(n.id),o=this.get_node(n,!0),o&&o.length&&o.attr("aria-selected",!0).children(".jstree-anchor").addClass(u?"jstree-clicked":"jstree-checked"));else{if(!n.state[u?"selected":"checked"])break;n.state[u?"selected":"checked"]=!1,this._data[u?"core":"checkbox"].selected=e.vakata.array_remove_item(this._data[u?"core":"checkbox"].selected,n.id),o=this.get_node(n,!0),o&&o.length&&o.attr("aria-selected",!1).children(".jstree-anchor").removeClass(u?"jstree-clicked":"jstree-checked")}n=this.get_node(n.parent)}},this))},this._undetermined=function(){if(null!==this.element){var i,n,a,s,r={},o=this._model.data,d=this.settings.checkbox.tie_selection,l=this._data[d?"core":"checkbox"].selected,c=[],h=this;for(i=0,n=l.length;n>i;i++)if(o[l[i]]&&o[l[i]].parents)for(a=0,s=o[l[i]].parents.length;s>a;a++)r[o[l[i]].parents[a]]===t&&o[l[i]].parents[a]!==e.jstree.root&&(r[o[l[i]].parents[a]]=!0,c.push(o[l[i]].parents[a]));for(this.element.find(".jstree-closed").not(":has(.jstree-children)").each(function(){var d,l=h.get_node(this);if(l.state.loaded){for(i=0,n=l.children_d.length;n>i;i++)if(d=o[l.children_d[i]],!d.state.loaded&&d.original&&d.original.state&&d.original.state.undetermined&&d.original.state.undetermined===!0)for(r[d.id]===t&&d.id!==e.jstree.root&&(r[d.id]=!0,c.push(d.id)),a=0,s=d.parents.length;s>a;a++)r[d.parents[a]]===t&&d.parents[a]!==e.jstree.root&&(r[d.parents[a]]=!0,c.push(d.parents[a]))}else if(l.original&&l.original.state&&l.original.state.undetermined&&l.original.state.undetermined===!0)for(r[l.id]===t&&l.id!==e.jstree.root&&(r[l.id]=!0,c.push(l.id)),a=0,s=l.parents.length;s>a;a++)r[l.parents[a]]===t&&l.parents[a]!==e.jstree.root&&(r[l.parents[a]]=!0,c.push(l.parents[a]))}),this.element.find(".jstree-undetermined").removeClass("jstree-undetermined"),i=0,n=c.length;n>i;i++)o[c[i]].state[d?"selected":"checked"]||(l=this.get_node(c[i],!0),l&&l.length&&l.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-undetermined"))}},this.redraw_node=function(t,i,a,s){if(t=n.redraw_node.apply(this,arguments)){var r,o,d=null,l=null;for(r=0,o=t.childNodes.length;o>r;r++)if(t.childNodes[r]&&t.childNodes[r].className&&-1!==t.childNodes[r].className.indexOf("jstree-anchor")){d=t.childNodes[r];break}d&&(!this.settings.checkbox.tie_selection&&this._model.data[t.id].state.checked&&(d.className+=" jstree-checked"),l=u.cloneNode(!1),this._model.data[t.id].state.checkbox_disabled&&(l.className+=" jstree-checkbox-disabled"),d.insertBefore(l,d.childNodes[0]))}return a||-1===this.settings.checkbox.cascade.indexOf("undetermined")||(this._data.checkbox.uto&&clearTimeout(this._data.checkbox.uto),this._data.checkbox.uto=setTimeout(e.proxy(this._undetermined,this),50)),t},this.show_checkboxes=function(){this._data.core.themes.checkboxes=!0,this.get_container_ul().removeClass("jstree-no-checkboxes")},this.hide_checkboxes=function(){this._data.core.themes.checkboxes=!1,this.get_container_ul().addClass("jstree-no-checkboxes")},this.toggle_checkboxes=function(){this._data.core.themes.checkboxes?this.hide_checkboxes():this.show_checkboxes()},this.is_undetermined=function(t){t=this.get_node(t);var i,n,a=this.settings.checkbox.cascade,s=this.settings.checkbox.tie_selection,r=this._data[s?"core":"checkbox"].selected,o=this._model.data;if(!t||t.state[s?"selected":"checked"]===!0||-1===a.indexOf("undetermined")||-1===a.indexOf("down")&&-1===a.indexOf("up"))return!1;if(!t.state.loaded&&t.original.state.undetermined===!0)return!0;for(i=0,n=t.children_d.length;n>i;i++)if(-1!==e.inArray(t.children_d[i],r)||!o[t.children_d[i]].state.loaded&&o[t.children_d[i]].original.state.undetermined)return!0;return!1},this.disable_checkbox=function(t){var i,n,a;if(e.isArray(t)){for(t=t.slice(),i=0,n=t.length;n>i;i++)this.disable_checkbox(t[i]);return!0}return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&(a=this.get_node(t,!0),void(t.state.checkbox_disabled||(t.state.checkbox_disabled=!0,a&&a.length&&a.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-checkbox-disabled"),this.trigger("disable_checkbox",{node:t}))))},this.enable_checkbox=function(t){var i,n,a;if(e.isArray(t)){for(t=t.slice(),i=0,n=t.length;n>i;i++)this.enable_checkbox(t[i]);return!0}return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&(a=this.get_node(t,!0),void(t.state.checkbox_disabled&&(t.state.checkbox_disabled=!1,a&&a.length&&a.children(".jstree-anchor").children(".jstree-checkbox").removeClass("jstree-checkbox-disabled"),this.trigger("enable_checkbox",{node:t}))))},this.activate_node=function(t,i){return!e(i.target).hasClass("jstree-checkbox-disabled")&&(this.settings.checkbox.tie_selection&&(this.settings.checkbox.whole_node||e(i.target).hasClass("jstree-checkbox"))&&(i.ctrlKey=!0),this.settings.checkbox.tie_selection||!this.settings.checkbox.whole_node&&!e(i.target).hasClass("jstree-checkbox")?n.activate_node.call(this,t,i):!this.is_disabled(t)&&(this.is_checked(t)?this.uncheck_node(t,i):this.check_node(t,i),void this.trigger("activate_node",{node:this.get_node(t)})))},this.check_node=function(t,i){if(this.settings.checkbox.tie_selection)return this.select_node(t,!1,!0,i);var n,a,s;if(e.isArray(t)){for(t=t.slice(),a=0,s=t.length;s>a;a++)this.check_node(t[a],i);return!0}return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&(n=this.get_node(t,!0),void(t.state.checked||(t.state.checked=!0,this._data.checkbox.selected.push(t.id),n&&n.length&&n.children(".jstree-anchor").addClass("jstree-checked"),this.trigger("check_node",{node:t,selected:this._data.checkbox.selected,event:i}))))},this.uncheck_node=function(t,i){if(this.settings.checkbox.tie_selection)return this.deselect_node(t,!1,i);var n,a,s;if(e.isArray(t)){for(t=t.slice(),n=0,a=t.length;a>n;n++)this.uncheck_node(t[n],i);return!0}return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&(s=this.get_node(t,!0),void(t.state.checked&&(t.state.checked=!1,this._data.checkbox.selected=e.vakata.array_remove_item(this._data.checkbox.selected,t.id),s.length&&s.children(".jstree-anchor").removeClass("jstree-checked"),this.trigger("uncheck_node",{node:t,selected:this._data.checkbox.selected,event:i}))))},this.check_all=function(){if(this.settings.checkbox.tie_selection)return this.select_all();var t,i;this._data.checkbox.selected.concat([]);for(this._data.checkbox.selected=this._model.data[e.jstree.root].children_d.concat(),t=0,i=this._data.checkbox.selected.length;i>t;t++)this._model.data[this._data.checkbox.selected[t]]&&(this._model.data[this._data.checkbox.selected[t]].state.checked=!0);this.redraw(!0),this.trigger("check_all",{selected:this._data.checkbox.selected})},this.uncheck_all=function(){if(this.settings.checkbox.tie_selection)return this.deselect_all();var e,t,i=this._data.checkbox.selected.concat([]);for(e=0,t=this._data.checkbox.selected.length;t>e;e++)this._model.data[this._data.checkbox.selected[e]]&&(this._model.data[this._data.checkbox.selected[e]].state.checked=!1);this._data.checkbox.selected=[],this.element.find(".jstree-checked").removeClass("jstree-checked"),this.trigger("uncheck_all",{selected:this._data.checkbox.selected,node:i})},this.is_checked=function(t){return this.settings.checkbox.tie_selection?this.is_selected(t):(t=this.get_node(t),!(!t||t.id===e.jstree.root)&&t.state.checked)},this.get_checked=function(t){return this.settings.checkbox.tie_selection?this.get_selected(t):t?e.map(this._data.checkbox.selected,e.proxy(function(e){return this.get_node(e)},this)):this._data.checkbox.selected},this.get_top_checked=function(t){if(this.settings.checkbox.tie_selection)return this.get_top_selected(t);var i,n,a,s,r=this.get_checked(!0),o={};for(i=0,n=r.length;n>i;i++)o[r[i].id]=r[i];for(i=0,n=r.length;n>i;i++)for(a=0,s=r[i].children_d.length;s>a;a++)o[r[i].children_d[a]]&&delete o[r[i].children_d[a]];r=[];for(i in o)o.hasOwnProperty(i)&&r.push(i);return t?e.map(r,e.proxy(function(e){return this.get_node(e)},this)):r},this.get_bottom_checked=function(t){if(this.settings.checkbox.tie_selection)return this.get_bottom_selected(t);var i,n,a=this.get_checked(!0),s=[];for(i=0,n=a.length;n>i;i++)a[i].children.length||s.push(a[i].id);return t?e.map(s,e.proxy(function(e){return this.get_node(e)},this)):s},this.load_node=function(t,i){var a,s,r,o;if(!e.isArray(t)&&!this.settings.checkbox.tie_selection&&(o=this.get_node(t),o&&o.state.loaded))for(a=0,s=o.children_d.length;s>a;a++)this._model.data[o.children_d[a]].state.checked&&(r=!0,this._data.checkbox.selected=e.vakata.array_remove_item(this._data.checkbox.selected,o.children_d[a]));return n.load_node.apply(this,arguments)},this.get_state=function(){var e=n.get_state.apply(this,arguments);return this.settings.checkbox.tie_selection?e:(e.checkbox=this._data.checkbox.selected.slice(),e)},this.set_state=function(t,i){var a=n.set_state.apply(this,arguments);if(a&&t.checkbox){if(!this.settings.checkbox.tie_selection){this.uncheck_all();var s=this;e.each(t.checkbox,function(e,t){s.check_node(t)})}return delete t.checkbox,this.set_state(t,i),!1}return a},this.refresh=function(e,t){return this.settings.checkbox.tie_selection||(this._data.checkbox.selected=[]),n.refresh.apply(this,arguments)}},e.jstree.defaults.conditionalselect=function(){return!0},e.jstree.plugins.conditionalselect=function(e,t){this.activate_node=function(e,i){this.settings.conditionalselect.call(this,this.get_node(e),i)&&t.activate_node.call(this,e,i)}},e.jstree.defaults.contextmenu={select_node:!0,show_at_node:!0,items:function(t,i){return{create:{separator_before:!1,separator_after:!0,_disabled:!1,label:"Create",action:function(t){var i=e.jstree.reference(t.reference),n=i.get_node(t.reference);i.create_node(n,{},"last",function(e){setTimeout(function(){i.edit(e)},0)})}},rename:{separator_before:!1,separator_after:!1,_disabled:!1,label:"Rename",action:function(t){var i=e.jstree.reference(t.reference),n=i.get_node(t.reference);i.edit(n)}},remove:{separator_before:!1,icon:!1,separator_after:!1,_disabled:!1,label:"Delete",action:function(t){var i=e.jstree.reference(t.reference),n=i.get_node(t.reference);i.is_selected(n)?i.delete_node(i.get_selected()):i.delete_node(n)}},ccp:{separator_before:!0,icon:!1,separator_after:!1,label:"Edit",action:!1,submenu:{cut:{separator_before:!1,separator_after:!1,label:"Cut",action:function(t){var i=e.jstree.reference(t.reference),n=i.get_node(t.reference);i.is_selected(n)?i.cut(i.get_top_selected()):i.cut(n)}},copy:{separator_before:!1,icon:!1,separator_after:!1,label:"Copy",action:function(t){var i=e.jstree.reference(t.reference),n=i.get_node(t.reference);i.is_selected(n)?i.copy(i.get_top_selected()):i.copy(n)}},paste:{separator_before:!1,icon:!1,_disabled:function(t){return!e.jstree.reference(t.reference).can_paste()},separator_after:!1,label:"Paste",action:function(t){var i=e.jstree.reference(t.reference),n=i.get_node(t.reference);i.paste(n)}}}}}}},e.jstree.plugins.contextmenu=function(i,n){this.bind=function(){n.bind.call(this);var t,i,a=0,s=null;this.element.on("contextmenu.jstree",".jstree-anchor",e.proxy(function(e,t){e.preventDefault(),a=e.ctrlKey?+new Date:0,(t||s)&&(a=+new Date+1e4),s&&clearTimeout(s),this.is_loading(e.currentTarget)||this.show_contextmenu(e.currentTarget,e.pageX,e.pageY,e)},this)).on("click.jstree",".jstree-anchor",e.proxy(function(t){this._data.contextmenu.visible&&(!a||+new Date-a>250)&&e.vakata.context.hide(),a=0},this)).on("touchstart.jstree",".jstree-anchor",function(n){n.originalEvent&&n.originalEvent.changedTouches&&n.originalEvent.changedTouches[0]&&(t=n.pageX,i=n.pageY,s=setTimeout(function(){e(n.currentTarget).trigger("contextmenu",!0)},750))}).on("touchmove.vakata.jstree",function(e){s&&e.originalEvent&&e.originalEvent.changedTouches&&e.originalEvent.changedTouches[0]&&(Math.abs(t-e.pageX)>50||Math.abs(i-e.pageY)>50)&&clearTimeout(s)}).on("touchend.vakata.jstree",function(e){s&&clearTimeout(s)}),e(c).on("context_hide.vakata.jstree",e.proxy(function(){this._data.contextmenu.visible=!1},this))},this.teardown=function(){this._data.contextmenu.visible&&e.vakata.context.hide(),n.teardown.call(this)},this.show_contextmenu=function(i,n,a,s){if(i=this.get_node(i),!i||i.id===e.jstree.root)return!1;var r=this.settings.contextmenu,o=this.get_node(i,!0),d=o.children(".jstree-anchor"),l=!1,c=!1;(r.show_at_node||n===t||a===t)&&(l=d.offset(),n=l.left,a=l.top+this._data.core.li_height),this.settings.contextmenu.select_node&&!this.is_selected(i)&&this.activate_node(i,s),c=r.items,e.isFunction(c)&&(c=c.call(this,i,e.proxy(function(e){this._show_contextmenu(i,n,a,e)},this))),e.isPlainObject(c)&&this._show_contextmenu(i,n,a,c)},this._show_contextmenu=function(t,i,n,a){var s=this.get_node(t,!0),r=s.children(".jstree-anchor");e(c).one("context_show.vakata.jstree",e.proxy(function(t,i){var n="jstree-contextmenu jstree-"+this.get_theme()+"-contextmenu";e(i.element).addClass(n)},this)),this._data.contextmenu.visible=!0,e.vakata.context.show(r,{x:i,y:n},a),this.trigger("show_contextmenu",{node:t,x:i,y:n})}},function(e){var t=!1,i={element:!1,reference:!1,position_x:0,position_y:0,items:[],html:"",is_visible:!1};e.vakata.context={settings:{hide_onmouseleave:0,icons:!0},_trigger:function(t){e(c).triggerHandler("context_"+t+".vakata",{reference:i.reference,element:i.element,position:{x:i.position_x,y:i.position_y}})},_execute:function(t){return t=i.items[t],!(!t||t._disabled&&(!e.isFunction(t._disabled)||t._disabled({item:t,reference:i.reference,element:i.element}))||!t.action)&&t.action.call(null,{item:t,reference:i.reference,element:i.element,position:{x:i.position_x,y:i.position_y}})},_parse:function(t,n){if(!t)return!1;n||(i.html="",i.items=[]);var a,s="",r=!1;return n&&(s+="<ul>"),e.each(t,function(t,n){return!n||(i.items.push(n),!r&&n.separator_before&&(s+="<li class='vakata-context-separator'><a href='#' "+(e.vakata.context.settings.icons?"":'style="margin-left:0px;"')+">&#160;</a></li>"),r=!1,s+="<li class='"+(n._class||"")+(n._disabled===!0||e.isFunction(n._disabled)&&n._disabled({item:n,reference:i.reference,element:i.element})?" vakata-contextmenu-disabled ":"")+"' "+(n.shortcut?" data-shortcut='"+n.shortcut+"' ":"")+">",s+="<a href='#' rel='"+(i.items.length-1)+"'>",e.vakata.context.settings.icons&&(s+="<i ",n.icon&&(s+=-1!==n.icon.indexOf("/")||-1!==n.icon.indexOf(".")?" style='background:url(\""+n.icon+"\") center center no-repeat' ":" class='"+n.icon+"' "),s+="></i><span class='vakata-contextmenu-sep'>&#160;</span>"),s+=(e.isFunction(n.label)?n.label({item:t,reference:i.reference,element:i.element}):n.label)+(n.shortcut?' <span class="vakata-contextmenu-shortcut vakata-contextmenu-shortcut-'+n.shortcut+'">'+(n.shortcut_label||"")+"</span>":"")+"</a>",n.submenu&&(a=e.vakata.context._parse(n.submenu,!0),a&&(s+=a)),s+="</li>",void(n.separator_after&&(s+="<li class='vakata-context-separator'><a href='#' "+(e.vakata.context.settings.icons?"":'style="margin-left:0px;"')+">&#160;</a></li>",r=!0)))}),s=s.replace(/<li class\='vakata-context-separator'\><\/li\>$/,""),n&&(s+="</ul>"),n||(i.html=s,e.vakata.context._trigger("parse")),s.length>10&&s},_show_submenu:function(i){if(i=e(i),i.length&&i.children("ul").length){var n=i.children("ul"),a=i.offset().left+i.outerWidth(),s=i.offset().top,r=n.width(),o=n.height(),d=e(window).width()+e(window).scrollLeft(),l=e(window).height()+e(window).scrollTop();t?i[a-(r+10+i.outerWidth())<0?"addClass":"removeClass"]("vakata-context-left"):i[a+r+10>d?"addClass":"removeClass"]("vakata-context-right"),s+o+10>l&&n.css("bottom","-1px"),n.show()}},show:function(n,a,s){var r,o,d,l,c,h,u,f,_=!0;switch(i.element&&i.element.length&&i.element.width(""),_){case!a&&!n:return!1;case!!a&&!!n:i.reference=n,i.position_x=a.x,i.position_y=a.y;break;case!a&&!!n:i.reference=n,r=n.offset(),i.position_x=r.left+n.outerHeight(),i.position_y=r.top;break;case!!a&&!n:i.position_x=a.x,i.position_y=a.y}n&&!s&&e(n).data("vakata_contextmenu")&&(s=e(n).data("vakata_contextmenu")),e.vakata.context._parse(s)&&i.element.html(i.html),i.items.length&&(i.element.appendTo("body"),o=i.element,d=i.position_x,l=i.position_y,c=o.width(),h=o.height(),u=e(window).width()+e(window).scrollLeft(),f=e(window).height()+e(window).scrollTop(),t&&(d-=o.outerWidth()-e(n).outerWidth(),d<e(window).scrollLeft()+20&&(d=e(window).scrollLeft()+20)),d+c+20>u&&(d=u-(c+20)),l+h+20>f&&(l=f-(h+20)),i.element.css({left:d,top:l}).show().find("a").first().focus().parent().addClass("vakata-context-hover"),i.is_visible=!0,e.vakata.context._trigger("show"))},hide:function(){i.is_visible&&(i.element.hide().find("ul").hide().end().find(":focus").blur().end().detach(),i.is_visible=!1,e.vakata.context._trigger("hide"))}},e(function(){t="rtl"===e("body").css("direction");var n=!1;i.element=e("<ul class='vakata-context'></ul>"),i.element.on("mouseenter","li",function(t){t.stopImmediatePropagation(),e.contains(this,t.relatedTarget)||(n&&clearTimeout(n),i.element.find(".vakata-context-hover").removeClass("vakata-context-hover").end(),e(this).siblings().find("ul").hide().end().end().parentsUntil(".vakata-context","li").addBack().addClass("vakata-context-hover"),e.vakata.context._show_submenu(this))}).on("mouseleave","li",function(t){e.contains(this,t.relatedTarget)||e(this).find(".vakata-context-hover").addBack().removeClass("vakata-context-hover")}).on("mouseleave",function(t){e(this).find(".vakata-context-hover").removeClass("vakata-context-hover"),e.vakata.context.settings.hide_onmouseleave&&(n=setTimeout(function(t){return function(){e.vakata.context.hide()}}(this),e.vakata.context.settings.hide_onmouseleave))}).on("click","a",function(t){t.preventDefault(),e(this).blur().parent().hasClass("vakata-context-disabled")||e.vakata.context._execute(e(this).attr("rel"))===!1||e.vakata.context.hide()}).on("keydown","a",function(t){var n=null;switch(t.which){case 13:case 32:t.type="mouseup",t.preventDefault(),e(t.currentTarget).trigger(t);break;case 37:i.is_visible&&(i.element.find(".vakata-context-hover").last().closest("li").first().find("ul").hide().find(".vakata-context-hover").removeClass("vakata-context-hover").end().end().children("a").focus(),t.stopImmediatePropagation(),t.preventDefault());break;case 38:i.is_visible&&(n=i.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").prevAll("li:not(.vakata-context-separator)").first(),n.length||(n=i.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").last()),n.addClass("vakata-context-hover").children("a").focus(),t.stopImmediatePropagation(),t.preventDefault());break;case 39:i.is_visible&&(i.element.find(".vakata-context-hover").last().children("ul").show().children("li:not(.vakata-context-separator)").removeClass("vakata-context-hover").first().addClass("vakata-context-hover").children("a").focus(),
t.stopImmediatePropagation(),t.preventDefault());break;case 40:i.is_visible&&(n=i.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").nextAll("li:not(.vakata-context-separator)").first(),n.length||(n=i.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").first()),n.addClass("vakata-context-hover").children("a").focus(),t.stopImmediatePropagation(),t.preventDefault());break;case 27:e.vakata.context.hide(),t.preventDefault()}}).on("keydown",function(e){e.preventDefault();var t=i.element.find(".vakata-contextmenu-shortcut-"+e.which).parent();t.parent().not(".vakata-context-disabled")&&t.click()}),e(c).on("mousedown.vakata.jstree",function(t){i.is_visible&&!e.contains(i.element[0],t.target)&&e.vakata.context.hide()}).on("context_show.vakata.jstree",function(e,n){i.element.find("li:has(ul)").children("a").addClass("vakata-context-parent"),t&&i.element.addClass("vakata-context-rtl").css("direction","rtl"),i.element.find("ul").hide().end()})})}(e),e.jstree.defaults.dnd={copy:!0,open_timeout:500,is_draggable:!0,check_while_dragging:!0,always_copy:!1,inside_pos:0,drag_selection:!0,touch:!0,large_drop_target:!1,large_drag_target:!1},e.jstree.plugins.dnd=function(t,i){this.bind=function(){i.bind.call(this),this.element.on("mousedown.jstree touchstart.jstree",this.settings.dnd.large_drag_target?".jstree-node":".jstree-anchor",e.proxy(function(t){if(this.settings.dnd.large_drag_target&&e(t.target).closest(".jstree-node")[0]!==t.currentTarget)return!0;if("touchstart"===t.type&&(!this.settings.dnd.touch||"selected"===this.settings.dnd.touch&&!e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").hasClass("jstree-clicked")))return!0;var i=this.get_node(t.target),n=this.is_selected(i)&&this.settings.dnd.drag_selection?this.get_top_selected().length:1,a=n>1?n+" "+this.get_string("nodes"):this.get_text(t.currentTarget);return this.settings.core.force_text&&(a=e.vakata.html.escape(a)),i&&i.id&&i.id!==e.jstree.root&&(1===t.which||"touchstart"===t.type)&&(this.settings.dnd.is_draggable===!0||e.isFunction(this.settings.dnd.is_draggable)&&this.settings.dnd.is_draggable.call(this,n>1?this.get_top_selected(!0):[i],t))?(this.element.trigger("mousedown.jstree"),e.vakata.dnd.start(t,{jstree:!0,origin:this,obj:this.get_node(i,!0),nodes:n>1?this.get_top_selected():[i.id]},'<div id="jstree-dnd" class="jstree-'+this.get_theme()+" jstree-"+this.get_theme()+"-"+this.get_theme_variant()+" "+(this.settings.core.themes.responsive?" jstree-dnd-responsive":"")+'"><i class="jstree-icon jstree-er"></i>'+a+'<ins class="jstree-copy" style="display:none;">+</ins></div>')):void 0},this))}},e(function(){var t=!1,i=!1,n=!1,a=!1,s=e('<div id="jstree-marker">&#160;</div>').hide();e(c).on("dnd_start.vakata.jstree",function(e,i){t=!1,n=!1,i&&i.data&&i.data.jstree&&s.appendTo("body")}).on("dnd_move.vakata.jstree",function(r,o){if(a&&clearTimeout(a),o&&o.data&&o.data.jstree&&(!o.event.target.id||"jstree-marker"!==o.event.target.id)){n=o.event;var d,l,c,h,u,f,_,g,p,m,v,y,k,j,b=e.jstree.reference(o.event.target),x=!1,w=!1,D=!1;if(b&&b._data&&b._data.dnd)if(s.attr("class","jstree-"+b.get_theme()+(b.settings.core.themes.responsive?" jstree-dnd-responsive":"")),o.helper.children().attr("class","jstree-"+b.get_theme()+" jstree-"+b.get_theme()+"-"+b.get_theme_variant()+" "+(b.settings.core.themes.responsive?" jstree-dnd-responsive":"")).find(".jstree-copy").first()[o.data.origin&&(o.data.origin.settings.dnd.always_copy||o.data.origin.settings.dnd.copy&&(o.event.metaKey||o.event.ctrlKey))?"show":"hide"](),o.event.target!==b.element[0]&&o.event.target!==b.get_container_ul()[0]||0!==b.get_container_ul().children().length){if(x=b.settings.dnd.large_drop_target?e(o.event.target).closest(".jstree-node").children(".jstree-anchor"):e(o.event.target).closest(".jstree-anchor"),x&&x.length&&x.parent().is(".jstree-closed, .jstree-open, .jstree-leaf")&&(w=x.offset(),D=o.event.pageY-w.top,c=x.outerHeight(),f=c/3>D?["b","i","a"]:D>c-c/3?["a","i","b"]:D>c/2?["i","a","b"]:["i","b","a"],e.each(f,function(n,r){switch(r){case"b":d=w.left-6,l=w.top,h=b.get_parent(x),u=x.parent().index();break;case"i":k=b.settings.dnd.inside_pos,j=b.get_node(x.parent()),d=w.left-2,l=w.top+c/2+1,h=j.id,u="first"===k?0:"last"===k?j.children.length:Math.min(k,j.children.length);break;case"a":d=w.left-6,l=w.top+c,h=b.get_parent(x),u=x.parent().index()+1}for(_=!0,g=0,p=o.data.nodes.length;p>g;g++)if(m=o.data.origin&&(o.data.origin.settings.dnd.always_copy||o.data.origin.settings.dnd.copy&&(o.event.metaKey||o.event.ctrlKey))?"copy_node":"move_node",v=u,"move_node"===m&&"a"===r&&o.data.origin&&o.data.origin===b&&h===b.get_parent(o.data.nodes[g])&&(y=b.get_node(h),v>e.inArray(o.data.nodes[g],y.children)&&(v-=1)),_=_&&(b&&b.settings&&b.settings.dnd&&b.settings.dnd.check_while_dragging===!1||b.check(m,o.data.origin&&o.data.origin!==b?o.data.origin.get_node(o.data.nodes[g]):o.data.nodes[g],h,v,{dnd:!0,ref:b.get_node(x.parent()),pos:r,origin:o.data.origin,is_multi:o.data.origin&&o.data.origin!==b,is_foreign:!o.data.origin})),!_){b&&b.last_error&&(i=b.last_error());break}return"i"===r&&x.parent().is(".jstree-closed")&&b.settings.dnd.open_timeout&&(a=setTimeout(function(e,t){return function(){e.open_node(t)}}(b,x),b.settings.dnd.open_timeout)),_?(t={ins:b,par:h,pos:"i"!==r||"last"!==k||0!==u||b.is_loaded(j)?u:"last"},s.css({left:d+"px",top:l+"px"}).show(),o.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok"),i={},f=!0,!1):void 0}),f===!0))return}else{for(_=!0,g=0,p=o.data.nodes.length;p>g&&(_=_&&b.check(o.data.origin&&(o.data.origin.settings.dnd.always_copy||o.data.origin.settings.dnd.copy&&(o.event.metaKey||o.event.ctrlKey))?"copy_node":"move_node",o.data.origin&&o.data.origin!==b?o.data.origin.get_node(o.data.nodes[g]):o.data.nodes[g],e.jstree.root,"last",{dnd:!0,ref:b.get_node(e.jstree.root),pos:"i",origin:o.data.origin,is_multi:o.data.origin&&o.data.origin!==b,is_foreign:!o.data.origin}),_);g++);if(_)return t={ins:b,par:e.jstree.root,pos:"last"},s.hide(),void o.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok")}t=!1,o.helper.find(".jstree-icon").removeClass("jstree-ok").addClass("jstree-er"),s.hide()}}).on("dnd_scroll.vakata.jstree",function(e,i){i&&i.data&&i.data.jstree&&(s.hide(),t=!1,n=!1,i.helper.find(".jstree-icon").first().removeClass("jstree-ok").addClass("jstree-er"))}).on("dnd_stop.vakata.jstree",function(r,o){if(a&&clearTimeout(a),o&&o.data&&o.data.jstree){s.hide().detach();var d,l,c=[];if(t){for(d=0,l=o.data.nodes.length;l>d;d++)c[d]=o.data.origin?o.data.origin.get_node(o.data.nodes[d]):o.data.nodes[d];t.ins[o.data.origin&&(o.data.origin.settings.dnd.always_copy||o.data.origin.settings.dnd.copy&&(o.event.metaKey||o.event.ctrlKey))?"copy_node":"move_node"](c,t.par,t.pos,!1,!1,!1,o.data.origin)}else d=e(o.event.target).closest(".jstree"),d.length&&i&&i.error&&"check"===i.error&&(d=d.jstree(!0),d&&d.settings.core.error.call(this,i));n=!1,t=!1}}).on("keyup.jstree keydown.jstree",function(t,i){i=e.vakata.dnd._get(),i&&i.data&&i.data.jstree&&(i.helper.find(".jstree-copy").first()[i.data.origin&&(i.data.origin.settings.dnd.always_copy||i.data.origin.settings.dnd.copy&&(t.metaKey||t.ctrlKey))?"show":"hide"](),n&&(n.metaKey=t.metaKey,n.ctrlKey=t.ctrlKey,e.vakata.dnd._trigger("move",n)))})}),function(e){e.vakata.html={div:e("<div />"),escape:function(t){return e.vakata.html.div.text(t).html()},strip:function(t){return e.vakata.html.div.empty().append(e.parseHTML(t)).text()}};var t={element:!1,target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1};e.vakata.dnd={settings:{scroll_speed:10,scroll_proximity:20,helper_left:5,helper_top:10,threshold:5,threshold_touch:50},_trigger:function(t,i){var n=e.vakata.dnd._get();n.event=i,e(c).triggerHandler("dnd_"+t+".vakata",n)},_get:function(){return{data:t.data,element:t.element,helper:t.helper}},_clean:function(){t.helper&&t.helper.remove(),t.scroll_i&&(clearInterval(t.scroll_i),t.scroll_i=!1),t={element:!1,target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1},e(c).off("mousemove.vakata.jstree touchmove.vakata.jstree",e.vakata.dnd.drag),e(c).off("mouseup.vakata.jstree touchend.vakata.jstree",e.vakata.dnd.stop)},_scroll:function(i){if(!t.scroll_e||!t.scroll_l&&!t.scroll_t)return t.scroll_i&&(clearInterval(t.scroll_i),t.scroll_i=!1),!1;if(!t.scroll_i)return t.scroll_i=setInterval(e.vakata.dnd._scroll,100),!1;if(i===!0)return!1;var n=t.scroll_e.scrollTop(),a=t.scroll_e.scrollLeft();t.scroll_e.scrollTop(n+t.scroll_t*e.vakata.dnd.settings.scroll_speed),t.scroll_e.scrollLeft(a+t.scroll_l*e.vakata.dnd.settings.scroll_speed),(n!==t.scroll_e.scrollTop()||a!==t.scroll_e.scrollLeft())&&e.vakata.dnd._trigger("scroll",t.scroll_e)},start:function(i,n,a){"touchstart"===i.type&&i.originalEvent&&i.originalEvent.changedTouches&&i.originalEvent.changedTouches[0]&&(i.pageX=i.originalEvent.changedTouches[0].pageX,i.pageY=i.originalEvent.changedTouches[0].pageY,i.target=c.elementFromPoint(i.originalEvent.changedTouches[0].pageX-window.pageXOffset,i.originalEvent.changedTouches[0].pageY-window.pageYOffset)),t.is_drag&&e.vakata.dnd.stop({});try{i.currentTarget.unselectable="on",i.currentTarget.onselectstart=function(){return!1},i.currentTarget.style&&(i.currentTarget.style.MozUserSelect="none")}catch(s){}return t.init_x=i.pageX,t.init_y=i.pageY,t.data=n,t.is_down=!0,t.element=i.currentTarget,t.target=i.target,t.is_touch="touchstart"===i.type,a!==!1&&(t.helper=e("<div id='vakata-dnd'></div>").html(a).css({display:"block",margin:"0",padding:"0",position:"absolute",top:"-2000px",lineHeight:"16px",zIndex:"10000"})),e(c).on("mousemove.vakata.jstree touchmove.vakata.jstree",e.vakata.dnd.drag),e(c).on("mouseup.vakata.jstree touchend.vakata.jstree",e.vakata.dnd.stop),!1},drag:function(i){if("touchmove"===i.type&&i.originalEvent&&i.originalEvent.changedTouches&&i.originalEvent.changedTouches[0]&&(i.pageX=i.originalEvent.changedTouches[0].pageX,i.pageY=i.originalEvent.changedTouches[0].pageY,i.target=c.elementFromPoint(i.originalEvent.changedTouches[0].pageX-window.pageXOffset,i.originalEvent.changedTouches[0].pageY-window.pageYOffset)),t.is_down){if(!t.is_drag){if(!(Math.abs(i.pageX-t.init_x)>(t.is_touch?e.vakata.dnd.settings.threshold_touch:e.vakata.dnd.settings.threshold)||Math.abs(i.pageY-t.init_y)>(t.is_touch?e.vakata.dnd.settings.threshold_touch:e.vakata.dnd.settings.threshold)))return;t.helper&&(t.helper.appendTo("body"),t.helper_w=t.helper.outerWidth()),t.is_drag=!0,e.vakata.dnd._trigger("start",i)}var n=!1,a=!1,s=!1,r=!1,o=!1,d=!1,l=!1,h=!1,u=!1,f=!1;return t.scroll_t=0,t.scroll_l=0,t.scroll_e=!1,e(e(i.target).parentsUntil("body").addBack().get().reverse()).filter(function(){return/^auto|scroll$/.test(e(this).css("overflow"))&&(this.scrollHeight>this.offsetHeight||this.scrollWidth>this.offsetWidth)}).each(function(){var n=e(this),a=n.offset();return this.scrollHeight>this.offsetHeight&&(a.top+n.height()-i.pageY<e.vakata.dnd.settings.scroll_proximity&&(t.scroll_t=1),i.pageY-a.top<e.vakata.dnd.settings.scroll_proximity&&(t.scroll_t=-1)),this.scrollWidth>this.offsetWidth&&(a.left+n.width()-i.pageX<e.vakata.dnd.settings.scroll_proximity&&(t.scroll_l=1),i.pageX-a.left<e.vakata.dnd.settings.scroll_proximity&&(t.scroll_l=-1)),t.scroll_t||t.scroll_l?(t.scroll_e=e(this),!1):void 0}),t.scroll_e||(n=e(c),a=e(window),s=n.height(),r=a.height(),o=n.width(),d=a.width(),l=n.scrollTop(),h=n.scrollLeft(),s>r&&i.pageY-l<e.vakata.dnd.settings.scroll_proximity&&(t.scroll_t=-1),s>r&&r-(i.pageY-l)<e.vakata.dnd.settings.scroll_proximity&&(t.scroll_t=1),o>d&&i.pageX-h<e.vakata.dnd.settings.scroll_proximity&&(t.scroll_l=-1),o>d&&d-(i.pageX-h)<e.vakata.dnd.settings.scroll_proximity&&(t.scroll_l=1),(t.scroll_t||t.scroll_l)&&(t.scroll_e=n)),t.scroll_e&&e.vakata.dnd._scroll(!0),t.helper&&(u=parseInt(i.pageY+e.vakata.dnd.settings.helper_top,10),f=parseInt(i.pageX+e.vakata.dnd.settings.helper_left,10),s&&u+25>s&&(u=s-50),o&&f+t.helper_w>o&&(f=o-(t.helper_w+2)),t.helper.css({left:f+"px",top:u+"px"})),e.vakata.dnd._trigger("move",i),!1}},stop:function(i){if("touchend"===i.type&&i.originalEvent&&i.originalEvent.changedTouches&&i.originalEvent.changedTouches[0]&&(i.pageX=i.originalEvent.changedTouches[0].pageX,i.pageY=i.originalEvent.changedTouches[0].pageY,i.target=c.elementFromPoint(i.originalEvent.changedTouches[0].pageX-window.pageXOffset,i.originalEvent.changedTouches[0].pageY-window.pageYOffset)),t.is_drag)e.vakata.dnd._trigger("stop",i);else if("touchend"===i.type&&i.target===t.target){var n=setTimeout(function(){e(i.target).click()},100);e(i.target).one("click",function(){n&&clearTimeout(n)})}return e.vakata.dnd._clean(),!1}}}(e),e.jstree.defaults.massload=null,e.jstree.plugins.massload=function(t,i){this.init=function(e,t){i.init.call(this,e,t),this._data.massload={}},this._load_nodes=function(t,n,a){var s=this.settings.massload;return a&&!e.isEmptyObject(this._data.massload)?i._load_nodes.call(this,t,n,a):e.isFunction(s)?s.call(this,t,e.proxy(function(e){if(e)for(var s in e)e.hasOwnProperty(s)&&(this._data.massload[s]=e[s]);i._load_nodes.call(this,t,n,a)},this)):"object"==typeof s&&s&&s.url?(s=e.extend(!0,{},s),e.isFunction(s.url)&&(s.url=s.url.call(this,t)),e.isFunction(s.data)&&(s.data=s.data.call(this,t)),e.ajax(s).done(e.proxy(function(e,s,r){if(e)for(var o in e)e.hasOwnProperty(o)&&(this._data.massload[o]=e[o]);i._load_nodes.call(this,t,n,a)},this)).fail(e.proxy(function(e){i._load_nodes.call(this,t,n,a)},this))):i._load_nodes.call(this,t,n,a)},this._load_node=function(t,n){var a=this._data.massload[t.id];return a?this["string"==typeof a?"_append_html_data":"_append_json_data"](t,"string"==typeof a?e(e.parseHTML(a)).filter(function(){return 3!==this.nodeType}):a,function(e){n.call(this,e),delete this._data.massload[t.id]}):i._load_node.call(this,t,n)}},e.jstree.defaults.search={ajax:!1,fuzzy:!1,case_sensitive:!1,show_only_matches:!1,show_only_matches_children:!1,close_opened_onclear:!0,search_leaves_only:!1,search_callback:!1},e.jstree.plugins.search=function(i,n){this.bind=function(){n.bind.call(this),this._data.search.str="",this._data.search.dom=e(),this._data.search.res=[],this._data.search.opn=[],this._data.search.som=!1,this._data.search.smc=!1,this._data.search.hdn=[],this.element.on("search.jstree",e.proxy(function(t,i){if(this._data.search.som&&i.res.length){var n,a,s=this._model.data,r=[];for(n=0,a=i.res.length;a>n;n++)s[i.res[n]]&&!s[i.res[n]].state.hidden&&(r.push(i.res[n]),r=r.concat(s[i.res[n]].parents),this._data.search.smc&&(r=r.concat(s[i.res[n]].children_d)));r=e.vakata.array_remove_item(e.vakata.array_unique(r),e.jstree.root),this._data.search.hdn=this.hide_all(!0),this.show_node(r)}},this)).on("clear_search.jstree",e.proxy(function(e,t){this._data.search.som&&t.res.length&&this.show_node(this._data.search.hdn)},this))},this.search=function(i,n,a,s,r,o){if(i===!1||""===e.trim(i.toString()))return this.clear_search();s=this.get_node(s),s=s&&s.id?s.id:null,i=i.toString();var d,l,c=this.settings.search,h=!!c.ajax&&c.ajax,u=this._model.data,f=null,_=[],g=[];if(this._data.search.res.length&&!r&&this.clear_search(),a===t&&(a=c.show_only_matches),o===t&&(o=c.show_only_matches_children),!n&&h!==!1)return e.isFunction(h)?h.call(this,i,e.proxy(function(t){t&&t.d&&(t=t.d),this._load_nodes(e.isArray(t)?e.vakata.array_unique(t):[],function(){this.search(i,!0,a,s,r)},!0)},this),s):(h=e.extend({},h),h.data||(h.data={}),h.data.str=i,s&&(h.data.inside=s),e.ajax(h).fail(e.proxy(function(){this._data.core.last_error={error:"ajax",plugin:"search",id:"search_01",reason:"Could not load search parents",data:JSON.stringify(h)},this.settings.core.error.call(this,this._data.core.last_error)},this)).done(e.proxy(function(t){t&&t.d&&(t=t.d),this._load_nodes(e.isArray(t)?e.vakata.array_unique(t):[],function(){this.search(i,!0,a,s,r)},!0)},this)));if(r||(this._data.search.str=i,this._data.search.dom=e(),this._data.search.res=[],this._data.search.opn=[],this._data.search.som=a,this._data.search.smc=o),f=new e.vakata.search(i,(!0),{caseSensitive:c.case_sensitive,fuzzy:c.fuzzy}),e.each(u[s?s:e.jstree.root].children_d,function(e,t){var n=u[t];n.text&&(!c.search_leaves_only||n.state.loaded&&0===n.children.length)&&(c.search_callback&&c.search_callback.call(this,i,n)||!c.search_callback&&f.search(n.text).isMatch)&&(_.push(t),g=g.concat(n.parents))}),_.length){for(g=e.vakata.array_unique(g),d=0,l=g.length;l>d;d++)g[d]!==e.jstree.root&&u[g[d]]&&this.open_node(g[d],null,0)===!0&&this._data.search.opn.push(g[d]);r?(this._data.search.dom=this._data.search.dom.add(e(this.element[0].querySelectorAll("#"+e.map(_,function(t){return-1!=="0123456789".indexOf(t[0])?"\\3"+t[0]+" "+t.substr(1).replace(e.jstree.idregex,"\\$&"):t.replace(e.jstree.idregex,"\\$&")}).join(", #")))),this._data.search.res=e.vakata.array_unique(this._data.search.res.concat(_))):(this._data.search.dom=e(this.element[0].querySelectorAll("#"+e.map(_,function(t){return-1!=="0123456789".indexOf(t[0])?"\\3"+t[0]+" "+t.substr(1).replace(e.jstree.idregex,"\\$&"):t.replace(e.jstree.idregex,"\\$&")}).join(", #"))),this._data.search.res=_),this._data.search.dom.children(".jstree-anchor").addClass("jstree-search")}this.trigger("search",{nodes:this._data.search.dom,str:i,res:this._data.search.res,show_only_matches:a})},this.clear_search=function(){this.settings.search.close_opened_onclear&&this.close_node(this._data.search.opn,0),this.trigger("clear_search",{nodes:this._data.search.dom,str:this._data.search.str,res:this._data.search.res}),this._data.search.res.length&&(this._data.search.dom=e(this.element[0].querySelectorAll("#"+e.map(this._data.search.res,function(t){return-1!=="0123456789".indexOf(t[0])?"\\3"+t[0]+" "+t.substr(1).replace(e.jstree.idregex,"\\$&"):t.replace(e.jstree.idregex,"\\$&")}).join(", #"))),this._data.search.dom.children(".jstree-anchor").removeClass("jstree-search")),this._data.search.str="",this._data.search.res=[],this._data.search.opn=[],this._data.search.dom=e()},this.redraw_node=function(t,i,a,s){if(t=n.redraw_node.apply(this,arguments),t&&-1!==e.inArray(t.id,this._data.search.res)){var r,o,d=null;for(r=0,o=t.childNodes.length;o>r;r++)if(t.childNodes[r]&&t.childNodes[r].className&&-1!==t.childNodes[r].className.indexOf("jstree-anchor")){d=t.childNodes[r];break}d&&(d.className+=" jstree-search")}return t}},function(e){e.vakata.search=function(t,i,n){n=n||{},n=e.extend({},e.vakata.search.defaults,n),n.fuzzy!==!1&&(n.fuzzy=!0),t=n.caseSensitive?t:t.toLowerCase();var a,s,r,o,d=n.location,l=n.distance,c=n.threshold,h=t.length;return h>32&&(n.fuzzy=!1),n.fuzzy&&(a=1<<h-1,s=function(){var e={},i=0;for(i=0;h>i;i++)e[t.charAt(i)]=0;for(i=0;h>i;i++)e[t.charAt(i)]|=1<<h-i-1;return e}(),r=function(e,t){var i=e/h,n=Math.abs(d-t);return l?i+n/l:n?1:i}),o=function(e){if(e=n.caseSensitive?e:e.toLowerCase(),t===e||-1!==e.indexOf(t))return{isMatch:!0,score:0};if(!n.fuzzy)return{isMatch:!1,score:1};var i,o,l,u,f,_,g,p,m,v=e.length,y=c,k=e.indexOf(t,d),j=h+v,b=1,x=[];for(-1!==k&&(y=Math.min(r(0,k),y),k=e.lastIndexOf(t,d+h),-1!==k&&(y=Math.min(r(0,k),y))),k=-1,i=0;h>i;i++){for(l=0,u=j;u>l;)r(i,d+u)<=y?l=u:j=u,u=Math.floor((j-l)/2+l);for(j=u,_=Math.max(1,d-u+1),g=Math.min(d+u,v)+h,p=new Array(g+2),p[g+1]=(1<<i)-1,o=g;o>=_;o--)if(m=s[e.charAt(o-1)],0===i?p[o]=(p[o+1]<<1|1)&m:p[o]=(p[o+1]<<1|1)&m|((f[o+1]|f[o])<<1|1)|f[o+1],p[o]&a&&(b=r(i,o-1),y>=b)){if(y=b,k=o-1,x.push(k),!(k>d))break;_=Math.max(1,2*d-k)}if(r(i+1,d)>y)break;f=p}return{isMatch:k>=0,score:b}},i===!0?{search:o}:o(i)},e.vakata.search.defaults={location:0,distance:100,threshold:.6,fuzzy:!1,caseSensitive:!1}}(e),e.jstree.defaults.sort=function(e,t){return this.get_text(e)>this.get_text(t)?1:-1},e.jstree.plugins.sort=function(t,i){this.bind=function(){i.bind.call(this),this.element.on("model.jstree",e.proxy(function(e,t){this.sort(t.parent,!0)},this)).on("rename_node.jstree create_node.jstree",e.proxy(function(e,t){this.sort(t.parent||t.node.parent,!1),this.redraw_node(t.parent||t.node.parent,!0)},this)).on("move_node.jstree copy_node.jstree",e.proxy(function(e,t){this.sort(t.parent,!1),this.redraw_node(t.parent,!0)},this))},this.sort=function(t,i){var n,a;if(t=this.get_node(t),t&&t.children&&t.children.length&&(t.children.sort(e.proxy(this.settings.sort,this)),i))for(n=0,a=t.children_d.length;a>n;n++)this.sort(t.children_d[n],!1)}};var f=!1;e.jstree.defaults.state={key:"jstree",events:"changed.jstree open_node.jstree close_node.jstree check_node.jstree uncheck_node.jstree",ttl:!1,filter:!1},e.jstree.plugins.state=function(t,i){this.bind=function(){i.bind.call(this);var t=e.proxy(function(){this.element.on(this.settings.state.events,e.proxy(function(){f&&clearTimeout(f),f=setTimeout(e.proxy(function(){this.save_state()},this),100)},this)),this.trigger("state_ready")},this);this.element.on("ready.jstree",e.proxy(function(e,i){this.element.one("restore_state.jstree",t),this.restore_state()||t()},this))},this.save_state=function(){var t={state:this.get_state(),ttl:this.settings.state.ttl,sec:+new Date};e.vakata.storage.set(this.settings.state.key,JSON.stringify(t))},this.restore_state=function(){var t=e.vakata.storage.get(this.settings.state.key);if(t)try{t=JSON.parse(t)}catch(i){return!1}return!(t&&t.ttl&&t.sec&&+new Date-t.sec>t.ttl)&&(t&&t.state&&(t=t.state),t&&e.isFunction(this.settings.state.filter)&&(t=this.settings.state.filter.call(this,t)),!!t&&(this.element.one("set_state.jstree",function(i,n){n.instance.trigger("restore_state",{state:e.extend(!0,{},t)})}),this.set_state(t),!0))},this.clear_state=function(){return e.vakata.storage.del(this.settings.state.key)}},function(e,t){e.vakata.storage={set:function(e,t){return window.localStorage.setItem(e,t)},get:function(e){return window.localStorage.getItem(e)},del:function(e){return window.localStorage.removeItem(e)}}}(e),e.jstree.defaults.types={"default":{}},e.jstree.defaults.types[e.jstree.root]={},e.jstree.plugins.types=function(i,n){this.init=function(i,a){var s,r;if(a&&a.types&&a.types["default"])for(s in a.types)if("default"!==s&&s!==e.jstree.root&&a.types.hasOwnProperty(s))for(r in a.types["default"])a.types["default"].hasOwnProperty(r)&&a.types[s][r]===t&&(a.types[s][r]=a.types["default"][r]);n.init.call(this,i,a),this._model.data[e.jstree.root].type=e.jstree.root},this.refresh=function(t,i){n.refresh.call(this,t,i),this._model.data[e.jstree.root].type=e.jstree.root},this.bind=function(){this.element.on("model.jstree",e.proxy(function(i,n){var a,s,r=this._model.data,o=n.nodes,d=this.settings.types,l="default";for(a=0,s=o.length;s>a;a++)l="default",r[o[a]].original&&r[o[a]].original.type&&d[r[o[a]].original.type]&&(l=r[o[a]].original.type),r[o[a]].data&&r[o[a]].data.jstree&&r[o[a]].data.jstree.type&&d[r[o[a]].data.jstree.type]&&(l=r[o[a]].data.jstree.type),r[o[a]].type=l,r[o[a]].icon===!0&&d[l].icon!==t&&(r[o[a]].icon=d[l].icon);r[e.jstree.root].type=e.jstree.root},this)),n.bind.call(this)},this.get_json=function(t,i,a){var s,r,o=this._model.data,d=i?e.extend(!0,{},i,{no_id:!1}):{},l=n.get_json.call(this,t,d,a);if(l===!1)return!1;if(e.isArray(l))for(s=0,r=l.length;r>s;s++)l[s].type=l[s].id&&o[l[s].id]&&o[l[s].id].type?o[l[s].id].type:"default",i&&i.no_id&&(delete l[s].id,l[s].li_attr&&l[s].li_attr.id&&delete l[s].li_attr.id,l[s].a_attr&&l[s].a_attr.id&&delete l[s].a_attr.id);else l.type=l.id&&o[l.id]&&o[l.id].type?o[l.id].type:"default",i&&i.no_id&&(l=this._delete_ids(l));return l},this._delete_ids=function(t){if(e.isArray(t)){for(var i=0,n=t.length;n>i;i++)t[i]=this._delete_ids(t[i]);return t}return delete t.id,t.li_attr&&t.li_attr.id&&delete t.li_attr.id,t.a_attr&&t.a_attr.id&&delete t.a_attr.id,t.children&&e.isArray(t.children)&&(t.children=this._delete_ids(t.children)),t},this.check=function(i,a,s,r,o){if(n.check.call(this,i,a,s,r,o)===!1)return!1;a=a&&a.id?a:this.get_node(a),s=s&&s.id?s:this.get_node(s);var d,l,c,h,u=a&&a.id?o&&o.origin?o.origin:e.jstree.reference(a.id):null;switch(u=u&&u._model&&u._model.data?u._model.data:null,i){case"create_node":case"move_node":case"copy_node":if("move_node"!==i||-1===e.inArray(a.id,s.children)){if(d=this.get_rules(s),d.max_children!==t&&-1!==d.max_children&&d.max_children===s.children.length)return this._data.core.last_error={error:"check",plugin:"types",id:"types_01",reason:"max_children prevents function: "+i,data:JSON.stringify({chk:i,pos:r,obj:!(!a||!a.id)&&a.id,par:!(!s||!s.id)&&s.id})},!1;if(d.valid_children!==t&&-1!==d.valid_children&&-1===e.inArray(a.type||"default",d.valid_children))return this._data.core.last_error={error:"check",plugin:"types",id:"types_02",reason:"valid_children prevents function: "+i,data:JSON.stringify({chk:i,pos:r,obj:!(!a||!a.id)&&a.id,par:!(!s||!s.id)&&s.id})},!1;if(u&&a.children_d&&a.parents){for(l=0,c=0,h=a.children_d.length;h>c;c++)l=Math.max(l,u[a.children_d[c]].parents.length);l=l-a.parents.length+1}(0>=l||l===t)&&(l=1);do{if(d.max_depth!==t&&-1!==d.max_depth&&d.max_depth<l)return this._data.core.last_error={error:"check",plugin:"types",id:"types_03",reason:"max_depth prevents function: "+i,data:JSON.stringify({chk:i,pos:r,obj:!(!a||!a.id)&&a.id,par:!(!s||!s.id)&&s.id})},!1;s=this.get_node(s.parent),d=this.get_rules(s),l++}while(s)}}return!0},this.get_rules=function(e){if(e=this.get_node(e),!e)return!1;var i=this.get_type(e,!0);return i.max_depth===t&&(i.max_depth=-1),i.max_children===t&&(i.max_children=-1),i.valid_children===t&&(i.valid_children=-1),i},this.get_type=function(t,i){return t=this.get_node(t),!!t&&(i?e.extend({type:t.type},this.settings.types[t.type]):t.type)},this.set_type=function(i,n){var a,s,r,o,d;if(e.isArray(i)){for(i=i.slice(),s=0,r=i.length;r>s;s++)this.set_type(i[s],n);return!0}return a=this.settings.types,i=this.get_node(i),!(!a[n]||!i)&&(o=i.type,d=this.get_icon(i),i.type=n,(d===!0||a[o]&&a[o].icon!==t&&d===a[o].icon)&&this.set_icon(i,a[n].icon===t||a[n].icon),!0)}},e.jstree.defaults.unique={case_sensitive:!1,duplicate:function(e,t){return e+" ("+t+")"}},e.jstree.plugins.unique=function(i,n){this.check=function(t,i,a,s,r){if(n.check.call(this,t,i,a,s,r)===!1)return!1;if(i=i&&i.id?i:this.get_node(i),a=a&&a.id?a:this.get_node(a),!a||!a.children)return!0;var o,d,l="rename_node"===t?s:i.text,c=[],h=this.settings.unique.case_sensitive,u=this._model.data;for(o=0,d=a.children.length;d>o;o++)c.push(h?u[a.children[o]].text:u[a.children[o]].text.toLowerCase());switch(h||(l=l.toLowerCase()),t){case"delete_node":return!0;case"rename_node":return o=-1===e.inArray(l,c)||i.text&&i.text[h?"toString":"toLowerCase"]()===l,o||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_01",reason:"Child with name "+l+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:s,obj:!(!i||!i.id)&&i.id,par:!(!a||!a.id)&&a.id})}),o;case"create_node":return o=-1===e.inArray(l,c),o||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_04",reason:"Child with name "+l+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:s,obj:!(!i||!i.id)&&i.id,par:!(!a||!a.id)&&a.id})}),o;case"copy_node":return o=-1===e.inArray(l,c),o||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_02",reason:"Child with name "+l+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:s,obj:!(!i||!i.id)&&i.id,par:!(!a||!a.id)&&a.id})}),o;case"move_node":return o=i.parent===a.id&&(!r||!r.is_multi)||-1===e.inArray(l,c),o||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_03",reason:"Child with name "+l+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:s,obj:!(!i||!i.id)&&i.id,par:!(!a||!a.id)&&a.id})}),o}return!0},this.create_node=function(i,a,s,r,o){if(!a||a.text===t){if(null===i&&(i=e.jstree.root),i=this.get_node(i),!i)return n.create_node.call(this,i,a,s,r,o);if(s=s===t?"last":s,!s.toString().match(/^(before|after)$/)&&!o&&!this.is_loaded(i))return n.create_node.call(this,i,a,s,r,o);a||(a={});var d,l,c,h,u,f=this._model.data,_=this.settings.unique.case_sensitive,g=this.settings.unique.duplicate;for(l=d=this.get_string("New node"),c=[],h=0,u=i.children.length;u>h;h++)c.push(_?f[i.children[h]].text:f[i.children[h]].text.toLowerCase());for(h=1;-1!==e.inArray(_?l:l.toLowerCase(),c);)l=g.call(this,d,++h).toString();a.text=l}return n.create_node.call(this,i,a,s,r,o)}};var _=c.createElement("DIV");if(_.setAttribute("unselectable","on"),_.setAttribute("role","presentation"),_.className="jstree-wholerow",_.innerHTML="&#160;",e.jstree.plugins.wholerow=function(t,i){this.bind=function(){i.bind.call(this),this.element.on("ready.jstree set_state.jstree",e.proxy(function(){this.hide_dots()},this)).on("init.jstree loading.jstree ready.jstree",e.proxy(function(){this.get_container_ul().addClass("jstree-wholerow-ul")},this)).on("deselect_all.jstree",e.proxy(function(e,t){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked")},this)).on("changed.jstree",e.proxy(function(e,t){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked");var i,n,a=!1;for(i=0,n=t.selected.length;n>i;i++)a=this.get_node(t.selected[i],!0),a&&a.length&&a.children(".jstree-wholerow").addClass("jstree-wholerow-clicked")},this)).on("open_node.jstree",e.proxy(function(e,t){this.get_node(t.node,!0).find(".jstree-clicked").parent().children(".jstree-wholerow").addClass("jstree-wholerow-clicked")},this)).on("hover_node.jstree dehover_node.jstree",e.proxy(function(e,t){"hover_node"===e.type&&this.is_disabled(t.node)||this.get_node(t.node,!0).children(".jstree-wholerow")["hover_node"===e.type?"addClass":"removeClass"]("jstree-wholerow-hovered")},this)).on("contextmenu.jstree",".jstree-wholerow",e.proxy(function(t){t.preventDefault();var i=e.Event("contextmenu",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey,pageX:t.pageX,pageY:t.pageY});e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(i)},this)).on("click.jstree",".jstree-wholerow",function(t){t.stopImmediatePropagation();var i=e.Event("click",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey});e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(i).focus()}).on("click.jstree",".jstree-leaf > .jstree-ocl",e.proxy(function(t){t.stopImmediatePropagation();var i=e.Event("click",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey});e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(i).focus()},this)).on("mouseover.jstree",".jstree-wholerow, .jstree-icon",e.proxy(function(e){return e.stopImmediatePropagation(),this.is_disabled(e.currentTarget)||this.hover_node(e.currentTarget),!1},this)).on("mouseleave.jstree",".jstree-node",e.proxy(function(e){this.dehover_node(e.currentTarget)},this))},this.teardown=function(){this.settings.wholerow&&this.element.find(".jstree-wholerow").remove(),i.teardown.call(this)},this.redraw_node=function(t,n,a,s){if(t=i.redraw_node.apply(this,arguments)){var r=_.cloneNode(!0);-1!==e.inArray(t.id,this._data.core.selected)&&(r.className+=" jstree-wholerow-clicked"),this._data.core.focused&&this._data.core.focused===t.id&&(r.className+=" jstree-wholerow-hovered"),t.insertBefore(r,t.childNodes[0])}return t}},c.registerElement&&Object&&Object.create){var g=Object.create(HTMLElement.prototype);g.createdCallback=function(){var t,i={core:{},plugins:[]};for(t in e.jstree.plugins)e.jstree.plugins.hasOwnProperty(t)&&this.attributes[t]&&(i.plugins.push(t),this.getAttribute(t)&&JSON.parse(this.getAttribute(t))&&(i[t]=JSON.parse(this.getAttribute(t))));for(t in e.jstree.defaults.core)e.jstree.defaults.core.hasOwnProperty(t)&&this.attributes[t]&&(i.core[t]=JSON.parse(this.getAttribute(t))||this.getAttribute(t));e(this).jstree(i)};try{c.registerElement("vakata-jstree",{prototype:g})}catch(p){}}}});var SearchTools=function(){
var e=null,t=null,i=null,n=function(){var n=e.find(".search-tools-btn");if(n.find("i").hasClass("fa-caret-down"))n.find("i").removeClass("fa-caret-down").addClass("fa-caret-up"),n.removeClass("btn-primary").addClass("btn-default"),e.removeClass("search-tools-hiden").addClass("search-tools-shown");else{n.find("i").removeClass("fa-caret-up").addClass("fa-caret-down"),n.removeClass("btn-default").addClass("btn-primary"),e.removeClass("search-tools-shown").addClass("search-tools-hiden");var a=e.find("input[name=criteria]").val();i(),e.find("input[name=criteria]").val(a),t()}},a=function(){e.find(".search-simple-btn").click(function(t){show_page_splash(),e.submit()})},s=function(){e.find(".search-tools-btn").click(function(e){n()})},r=function(n,r){e=$(".search-tools-form"),t=n,i=r,a(),s()};return{init:function(e,t){r(e,t)},showHideTools:function(){n()}}}(),DateRange=function(){var e=null,t=[Lang.get("date_range.m_jan"),Lang.get("date_range.m_feb"),Lang.get("date_range.m_mar"),Lang.get("date_range.m_apr"),Lang.get("date_range.m_may"),Lang.get("date_range.m_jun"),Lang.get("date_range.m_jul"),Lang.get("date_range.m_aug"),Lang.get("date_range.m_sep"),Lang.get("date_range.m_oct"),Lang.get("date_range.m_nov"),Lang.get("date_range.m_dec")],i=[],n=null,a=function(e){if(0==e.length)return"";var t=e.split("-");return t[2]+"."+t[1]+"."+t[0]},s=function(e){if(0==e.length)return"";var i=e.split("-");return parseInt(i[2])+" "+t[parseInt(i[1])-1]+", "+i[0]},r=function(e,t){return 0==e.length||0==t.length?"":s(e)+" - "+s(t)},o=function(){if(jQuery().daterangepicker){$("#"+i.range_id).daterangepicker({opens:App.isRTL()?"left":"right",locale:{format:"DD.MM.YYYY",separator:" - ",applyLabel:Lang.get("date_range.btn_set"),cancelLabel:Lang.get("date_range.btn_cancel"),fromLabel:Lang.get("date_range.lbl_from"),toLabel:Lang.get("date_range.lbl_to"),customRangeLabel:Lang.get("date_range.lbl_interval"),daysOfWeek:[Lang.get("date_range.d_7"),Lang.get("date_range.d_1"),Lang.get("date_range.d_2"),Lang.get("date_range.d_3"),Lang.get("date_range.d_4"),Lang.get("date_range.d_5"),Lang.get("date_range.d_6")],monthNames:t,firstDay:1},startDate:moment().subtract("days",29),endDate:moment(),ranges:i.arr_ranges,autoUpdateInput:!0,alwaysShowCalendars:!0,linkedCalendars:!1},function(e,t){$("#"+i.range_id+" input").val(r(e.format("YYYY-MM-DD"),t.format("YYYY-MM-DD")))}),$("#"+i.range_id).on("apply.daterangepicker",function(t,a){e.find("[name="+i.el_date_from+"]").val(a.startDate.format("YYYY-MM-DD")),e.find("[name="+i.el_date_to+"]").val(a.endDate.format("YYYY-MM-DD")),n()});var s=e.find("[name="+i.el_date_from+"]").val(),o=e.find("[name="+i.el_date_to+"]").val();s&&o&&($("#"+i.range_id).data("daterangepicker").setStartDate(a(s)),$("#"+i.range_id).data("daterangepicker").setEndDate(a(o)),$("#"+i.range_id+" input").val(r(s,o)))}},d=function(t,a){i=t,n=a;var s=$(i.page_selector);e=s.find(i.form_selector),o()};return{init:function(e,t){d(e,t)}}}(),BlockEmplbirth=function(){var e=null,t=null,i=function(e,t,i){var n=e.find(t);return n.length?n.val():i},n=function(){var e=t.find(".dx-tree-value-choose-btn");i(t,"select[name=source_id]",0)>0?e.hasClass("tooltipstered")&&e.tooltipster("disable"):e.hasClass("tooltipstered")?e.tooltipster("enable"):e.tooltipster({theme:"tooltipster-light",animation:"grow",content:Lang.get("employee_fields.unit_hint")})},a=function(){i(t,"select[name=source_id]",0)>0||i(t,"input[name=department]","")||i(t,"input[name=criteria]","")||i(t,"input[name=date_from]","")?t.find(".dx-clear-link").show():t.find(".dx-clear-link").hide()},s=function(){e.find("input[name=criteria]").val(""),e.find("select[name=source_id]").val(0),e.find("input[name=department]").val(""),e.find("#defaultrange input").val(""),e.find("input[name=date_from]").val(""),e.find("input[name=date_to]").val(""),n()},r=function(){t.find(".dx-tree-value-choose-btn").click(function(e){var i=t.find("select[name=source_id]").val();return 0==i?(t.find("select[name=source_id]").focus(),void t.find("select[name=source_id]").simulate("mousedown")):void get_popup_item_by_id_ie9(i,"ajax/departments",t.find("select[name=source_id] option:selected").text()+" - struktrvienbas izvle",_)})},o=function(){t.find(".dx-tree-value-clear-btn").click(function(e){t.find("input[name=department]").val(""),a(t)})},d=function(){t.find(".dx-clear-link").click(function(){s(),a()})},l=function(){e.find("input").keyup(function(){a()}),e.find("select").change(function(){a()})},c=function(){e.find("select[name=source_id]").change(function(){n()})},h=function(){(i(t,"select[name=source_id]",0)>0||i(t,"input[name=department]","")||i(t,"input[name=date_from]",""))&&SearchTools.showHideTools()},u=function(){var e={range_id:"defaultrange",el_date_from:"date_from",el_date_to:"date_to",page_selector:".dx-employees-birth-block",form_selector:".search-tools-form",arr_ranges:{}};e.arr_ranges[Lang.get("date_range.flt_today")]=[moment(),moment()],e.arr_ranges[Lang.get("date_range.flt_tomorrow")]=[moment().add("days",1),moment().add("days",1)],e.arr_ranges[Lang.get("date_range.flt_yesterday")]=[moment().subtract("days",1),moment().subtract("days",1)],e.arr_ranges[Lang.get("date_range.flt_7")]=[moment().subtract("days",6),moment()],e.arr_ranges[Lang.get("date_range.flt_thism")]=[moment().startOf("month"),moment().endOf("month")],e.arr_ranges[Lang.get("date_range.flt_nextm")]=[moment().add("month",1).startOf("month"),moment().add("month",1).endOf("month")],e.arr_ranges[Lang.get("date_range.flt_prevm")]=[moment().subtract("month",1).startOf("month"),moment().subtract("month",1).endOf("month")],DateRange.init(e,a)},f=function(){t=$(".dx-employees-birth-block"),e=t.find(".search-tools-form"),SearchTools.init(a,s),r(),o(),l(),d(),c(),EmployeesLinks.setFormUrl("search"),EmployeesLinks.init($(".dx-employees-birth-page"),s),u(),a(),h(),n()},_=function(){$(".dx-department-tree-container").on("select_node.jstree",function(e,t){var i,n;for(i=0,n=t.selected.length;i<n;i++){$(".dx-employees-birth-block input[name=department]").val(t.instance.get_node(t.selected[i],!0).text()),$("#popup_window").modal("hide");break}}).jstree({core:{multiple:!1}})};return{init:function(){f()},initTree:function(){_()}}}();$(document).ready(function(){BlockEmplbirth.init()}),$(document).ajaxComplete(function(e,t,i){BlockEmplbirth.initTree()});