{"version":3,"sources":["freeform.js","inlineform.js","personal_docs.js","notes.js","timeoff.js","jquery.counterup.min.js","jquery.waypoints.min.js","jquery.flot.min.js","jquery.flot.resize.min.js","jquery.flot.axislabels.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC/MA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC1aA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACjaA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AChOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACniBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"elix_profile.js","sourcesContent":["(function($)\r\n{\r\n\t/**\r\n\t * FreeForm - a jQuery plugin for working with arbitrary forms\r\n\t *\r\n\t * @param root\r\n\t * @returns {*}\r\n\t * @constructor\r\n\t */\r\n\t$.fn.FreeForm = function(opts)\r\n\t{\r\n\t\tvar options = $.extend({}, $.fn.FreeForm.defaults, opts);\r\n\t\t\r\n\t\treturn this.each(function()\r\n\t\t{\r\n\t\t\tnew $.FreeForm(this, options);\r\n\t\t});\r\n\t};\r\n\t\r\n\t$.fn.FreeForm.defaults = {\r\n\t\teditBtnSelector: '.dx-edit-general',\r\n\t\tsaveBtnSelector: '.dx-save-general',\r\n\t\tcancelBtnSelector: '.dx-cancel-general',\r\n\t\tnames: []\r\n\t};\r\n\t\r\n\t/**\r\n\t * FreeForm constructor\r\n\t *\r\n\t * @param root\r\n\t * @constructor\r\n\t */\r\n\t$.FreeForm = function(root, opts)\r\n\t{\r\n\t\t// store object instance along with a root DOM element\r\n\t\t$.data(root, 'FreeForm', this);\r\n\t\t\r\n\t\tvar self = this;\r\n\t\tthis.root = $(root);\r\n\t\tthis.options = opts;\r\n\t\tthis.fields = $('[data-name]', this.root).filter(function()\r\n\t\t{\r\n\t\t\tif(self.options.names.length == 0 || self.options.names.indexOf($(this).data('name')) != -1)\r\n\t\t\t\treturn true;\r\n\t\t});\r\n\t\tthis.originalData = {};\r\n\t\tthis.editButton = $(this.options.editBtnSelector, this.root);\r\n\t\tthis.saveButton = $(this.options.saveBtnSelector, this.root);\r\n\t\tthis.cancelButton = $(this.options.cancelBtnSelector, this.root);\r\n\t\t\r\n\t\t// Bind callbacks to buttons\r\n\t\tthis.editButton.click(function() { self.edit(); });\r\n\t\tthis.saveButton.click(function() { self.save(); });\r\n\t\tthis.cancelButton.click(function() { self.cancel(); });\r\n\t};\r\n\t\r\n\t/**\r\n\t * FreeForm methods\r\n\t */\r\n\t$.extend($.FreeForm.prototype, {\r\n\t\t/**\r\n\t\t * Replace HTML with form input fields\r\n\t\t */\r\n\t\tedit: function()\r\n\t\t{\r\n\t\t\tvar self = this;\r\n\t\t\t\r\n\t\t\t// a structure for JSON request\r\n\t\t\tvar request = {\r\n\t\t\t\tmodel: this.root.data('model'),\r\n\t\t\t\titem_id: this.root.data('item_id'),\r\n\t\t\t\tlist_id: this.root.data('list_id'),\r\n\t\t\t\tfields: []\r\n\t\t\t};\r\n\t\t\t\r\n\t\t\t// collect names of input fields marked with data-name attribute\r\n\t\t\tthis.fields.each(function()\r\n\t\t\t{\r\n\t\t\t\tself.originalData[$(this).data('name')] = $(this).html();\r\n\t\t\t\trequest.fields.push({\r\n\t\t\t\t\tname: $(this).data('name'),\r\n\t\t\t\t\tdisplay: ($(this).data('display') ? $(this).data('display') : 'raw')\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tshow_page_splash(1);\r\n\t\t\t\r\n\t\t\t// perform a request to the server\r\n\t\t\t$.ajax({\r\n\t\t\t\ttype: 'POST',\r\n\t\t\t\turl: DX_CORE.site_url + 'freeform/' + request.item_id + '/edit',\r\n\t\t\t\tdataType: 'json',\r\n\t\t\t\tdata: request,\r\n\t\t\t\tsuccess: function(data)\r\n\t\t\t\t{\r\n\t\t\t\t\tif(typeof data.success != \"undefined\" && data.success == 0)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tnotify_err(data.error);\r\n\t\t\t\t\t\thide_page_splash(1);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tself.editButton.hide();\r\n\t\t\t\t\tself.saveButton.show();\r\n\t\t\t\t\tself.cancelButton.show();\r\n\t\t\t\t\t\r\n\t\t\t\t\t// replace original html content of marked elements with input fields\r\n\t\t\t\t\tfor(var i = 0; i < data.fields.length; i++)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar name = data.fields[i].name;\r\n\t\t\t\t\t\tvar input = data.fields[i].input;\r\n\t\t\t\t\t\tvar elem = $('[data-name=\"' + name + '\"]', self.root);\r\n\t\t\t\t\t\tif(elem.length)\r\n\t\t\t\t\t\t\telem.html(input);\r\n\t\t\t\t\t}\r\n\t\t\t\t\thide_page_splash(1);                                        \r\n\t\t\t\t},\r\n\t\t\t\terror: function(jqXHR, textStatus, errorThrown)\r\n\t\t\t\t{\r\n\t\t\t\t\tconsole.log(textStatus);\r\n\t\t\t\t\tconsole.log(jqXHR);\r\n\t\t\t\t\tconsole.log(errorThrown);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\t\r\n\t\t/**\r\n\t\t * Submit input field values to the server\r\n\t\t */\r\n\t\tsave: function()\r\n\t\t{\r\n\t\t\tvar self = this;\r\n\t\t\tvar fieldMetadata = {};\r\n\t\t\tvar formData = process_data_fields(this.root.attr('id'));\r\n\t\t\tformData.append('model', this.root.data('model'));\r\n\t\t\tformData.append('item_id', this.root.data('item_id'));\r\n\t\t\tformData.append('list_id', this.root.data('list_id'));\r\n\t\t\tformData.append('edit_form_id', this.root.data('form_id'));\r\n\t\t\t\r\n\t\t\t// collect metadata of input fields\r\n\t\t\tthis.fields.each(function()\r\n\t\t\t{\r\n\t\t\t\tfieldMetadata[$(this).data('name')] = {\r\n\t\t\t\t\tdisplay: $(this).data('display') ? $(this).data('display') : 'raw'\r\n\t\t\t\t};\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tformData.append('field_metadata', JSON.stringify(fieldMetadata));\r\n\t\t\t\r\n\t\t\tshow_page_splash(1);\r\n\t\t\t\r\n\t\t\t// submit a request\r\n\t\t\t$.ajax({\r\n\t\t\t\ttype: 'POST',\r\n\t\t\t\turl: DX_CORE.site_url + 'freeform/' + this.root.data('item_id') + '?_method=PUT',\r\n\t\t\t\tdataType: 'json',\r\n\t\t\t\tprocessData: false,\r\n\t\t\t\tcontentType: false,\r\n\t\t\t\tdata: formData,\r\n\t\t\t\tsuccess: function(data)\r\n\t\t\t\t{\r\n\t\t\t\t\tif(typeof data.success != \"undefined\" && data.success == 0)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tnotify_err(data.error);\r\n\t\t\t\t\t\thide_page_splash(1);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tself.editButton.show();\r\n\t\t\t\t\tself.saveButton.hide();\r\n\t\t\t\t\tself.cancelButton.hide();\r\n\t\t\t\t\t\r\n\t\t\t\t\t// replace input fields with html data from server response\r\n\t\t\t\t\tfor(var i = 0; i < data.fields.length; i++)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar name = data.fields[i].name;\r\n\t\t\t\t\t\tvar html = data.fields[i].html;\r\n\t\t\t\t\t\tvar elem = $('[data-name=\"' + name + '\"]', self.root);\r\n\t\t\t\t\t\tif(elem.length)\r\n\t\t\t\t\t\t\telem.html(html);\r\n\t\t\t\t\t}\r\n\t\t\t\t\thide_page_splash(1);\r\n\t\t\t\t},\r\n\t\t\t\terror: function(jqXHR, textStatus, errorThrown)\r\n\t\t\t\t{\r\n\t\t\t\t\tconsole.log(textStatus);\r\n\t\t\t\t\tconsole.log(jqXHR);\r\n\t\t\t\t\tconsole.log(errorThrown);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\t\r\n\t\t/**\r\n\t\t * Remove input fields and display original HTML\r\n\t\t */\r\n\t\tcancel: function()\r\n\t\t{\r\n\t\t\tvar self = this;\r\n\t\t\tthis.editButton.show();\r\n\t\t\tthis.saveButton.hide();\r\n\t\t\tthis.cancelButton.hide();\r\n\t\t\tthis.fields.each(function()\r\n\t\t\t{\r\n\t\t\t\t$(this).html(self.originalData[$(this).data('name')]);\r\n\t\t\t});\r\n\t\t}\r\n\t});\r\n})(jQuery);","/**\r\n * Author:  Eugene Ostapenko <evo@olympsoft.com>\r\n * License: MIT\r\n * Created: 04.11.16, 19:33\r\n */\r\n(function($)\r\n{\r\n\t/**\r\n\t * InlineForm - a jQuery plugin that provides a way to work with AJAX form embedded into a page\r\n\t *\r\n\t * @param root\r\n\t * @returns {*}\r\n\t * @constructor\r\n\t */\r\n\t$.fn.InlineForm = function(opts)\r\n\t{\r\n\t\tvar options = $.extend({}, $.fn.InlineForm.defaults, opts);\r\n\t\t\r\n\t\treturn this.each(function()\r\n\t\t{\r\n\t\t\tnew $.InlineForm(this, options);\r\n\t\t});\r\n\t};\r\n\t\r\n\t$.fn.InlineForm.defaults = {\r\n\t\tbeforeSave: null,\r\n\t\tafterSave: null,\r\n\t\templ_search_page_url: \"/search\"\r\n\t};\r\n\t\r\n\t/**\r\n\t * InlineForm constructor\r\n\t *\r\n\t * @param root\r\n\t * @constructor\r\n\t */\r\n\t$.InlineForm = function(root, opts)\r\n\t{\r\n\t\t$.data(root, 'InlineForm', this);\r\n\t\tvar self = this;\r\n\t\tthis.options = opts;\r\n\t\tthis.root = $(root);\r\n\t\tthis.tabs = $('.tab-pane', this.root).not(\".dx-grid-tab-pane\");\r\n\t\t\r\n\t\t// detached fields, that are custom placed outside of main form (e.g. avatar in employee profile)\r\n\t\tthis.fields = $('[data-name]', this.root);\r\n\t\tthis.fieldNames = [];\r\n\t\t\r\n\t\tthis.fields.each(function()\r\n\t\t{\r\n\t\t\tself.fieldNames.push($(this).data('name'));\r\n\t\t});\r\n\t\t\r\n\t\tthis.originalTabs = {};\r\n\t\tthis.originalFields = {};\r\n\t\tthis.editButton = $('.dx-edit-profile', this.root);\r\n\t\tthis.saveButton = $('.dx-save-profile', this.root);\r\n\t\tthis.cancelButton = $('.dx-cancel-profile', this.root);\r\n\t\tthis.deleteButton = $('.dx-delete-profile', this.root);\r\n\t\tthis.requests = {};\r\n\t\tthis.onRequestSuccess = [];\r\n\t\tthis.onRequestFailed = [];\r\n\t\t\r\n\t\t// Bind callbacks to buttons\r\n\t\tthis.editButton.click(function()\r\n\t\t{\r\n\t\t\tself.edit();\r\n\t\t});\r\n\t\tthis.saveButton.click(function()\r\n\t\t{\r\n\t\t\tself.save();\r\n\t\t});\r\n\t\tthis.cancelButton.click(function()\r\n\t\t{\r\n\t\t\tself.cancel();\r\n\t\t});\r\n\t\tthis.deleteButton.click(function()\r\n\t\t{\r\n\t\t\tself.destroy();\r\n\t\t});\r\n\t};\r\n\t\r\n\t/**\r\n\t * InlineForm methods\r\n\t */\r\n\t$.extend($.InlineForm.prototype, {\r\n\t\t/**\r\n\t\t * Resets and initializes all async request processing parameters\r\n\t\t * @param {integer} total Total count of processes which will be processed asynchronously\r\n\t\t */\r\n\t\tinitRequest: function(total)\r\n\t\t{\r\n\t\t\tthis.requests = {\r\n\t\t\t\ttotal: total,\r\n\t\t\t\tsucceeded: 0,\r\n\t\t\t\tfailed: 0\r\n\t\t\t};\r\n\t\t\t\r\n\t\t\tthis.onRequestSuccess = [];\r\n\t\t\tthis.onRequestFailed = [];\r\n\t\t},\r\n\t\t/**\r\n\t\t * Saves completed request status. If all request are finished, then execute success commands\r\n\t\t * @param {boolean} is_success Parmeter if process was successful\r\n\t\t */\r\n\t\tsetRequestStatus: function(is_success)\r\n\t\t{\r\n\t\t\tif(is_success)\r\n\t\t\t{\r\n\t\t\t\tthis.requests.succeeded++;\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tthis.requests.failed++;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif(this.requests.total === (this.requests.succeeded + this.requests.failed))\r\n\t\t\t{\r\n\t\t\t\tif(this.requests.failed === 0)\r\n\t\t\t\t{\r\n\t\t\t\t\tfor(var i = 0; i < this.onRequestSuccess.length; i++)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.onRequestSuccess[i].func(this.onRequestSuccess[i].args);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\tfor(var i = 0; i < this.onRequestFailed.length; i++)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.onRequestFailed[i].func(this.onRequestFailed[i].args);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\thide_page_splash(1);\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\tstoreOriginalData: function()\r\n\t\t{\r\n\t\t\tvar self = this;\r\n\t\t\t\r\n\t\t\tthis.fields = $('[data-name]', this.root);\r\n\t\t\t\r\n\t\t\tthis.tabs.each(function()\r\n\t\t\t{\r\n\t\t\t\tself.originalTabs[$(this).data('tabTitle')] = $(this).html();\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tthis.fields.each(function()\r\n\t\t\t{\r\n\t\t\t\tself.originalFields[$(this).data('name')] = $(this).html();\r\n\t\t\t});\r\n\t\t\t\r\n\t\t},\r\n\t\t\r\n\t\t/**\r\n\t\t * Replace HTML with form input fields\r\n\t\t */\r\n\t\tedit: function()\r\n\t\t{\r\n\t\t\tvar self = this;\r\n\t\t\t\r\n\t\t\t// a structure for JSON request\r\n\t\t\tvar request = {\r\n\t\t\t\tlist_id: this.root.data('list_id'),\r\n\t\t\t\ttab_list: [],\r\n\t\t\t\tfield_list: this.fieldNames\r\n\t\t\t};\r\n\t\t\t\r\n\t\t\tthis.storeOriginalData();\r\n\t\t\t\r\n\t\t\tshow_page_splash(1);\r\n\t\t\t\r\n\t\t\t// perform a request to the server\r\n\t\t\t$.ajax({\r\n\t\t\t\ttype: 'POST',\r\n\t\t\t\turl: DX_CORE.site_url + 'inlineform/' + this.root.data('item_id') + '/edit',\r\n\t\t\t\tdataType: 'json',\r\n\t\t\t\tdata: request,\r\n\t\t\t\tsuccess: function(data)\r\n\t\t\t\t{\r\n\t\t\t\t\tif(typeof data.success != \"undefined\" && data.success == 0)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tnotify_err(data.error);\r\n\t\t\t\t\t\thide_page_splash(1);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tself.editButton.hide();\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar tabs = $($.parseHTML('<div>' + data.tabs + '</div>')).find('.tab-pane').not(\".dx-grid-tab-pane\");\r\n\t\t\t\t\t\r\n\t\t\t\t\t// replace original html content of marked elements with input fields\r\n\t\t\t\t\tfor(var i = 0; i < tabs.length; i++)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar tab = $(tabs[i]);\r\n\t\t\t\t\t\tvar elem = $('[data-tab-title=\"' + tab.data('tabTitle') + '\"]', self.root);\r\n\t\t\t\t\t\tif(elem.length)\r\n\t\t\t\t\t\t\telem.html(tab.html());\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tfor(var name in data.fields)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$('[data-name=\"' + name + '\"]').html(data.fields[name]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tif(self.root.data('has_users_documents_access') == 1)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\twindow.DxEmpPersDocs.toggleDisable(false);\r\n\t\t\t\t\t}\r\n                                        \r\n\t\t\t\t\thide_page_splash(1);\r\n\t\t\t\t\t\r\n\t\t\t\t\t$('.dx-stick-footer').show();\r\n\t\t\t\t},\r\n\t\t\t\terror: function(jqXHR, textStatus, errorThrown)\r\n\t\t\t\t{\r\n\t\t\t\t\tconsole.log(textStatus);\r\n\t\t\t\t\tconsole.log(jqXHR);\r\n\t\t\t\t\thide_page_splash(1);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\t\r\n\t\t/**\r\n\t\t * Submit input field values to the server\r\n\t\t */\r\n\t\tsave: function()\r\n\t\t{\r\n\t\t\tvar self = this;\r\n\t\t\tvar formData = process_data_fields(this.root.attr('id'));\r\n\t\t\tformData.append('item_id', this.root.data('item_id'));\r\n\t\t\tformData.append('list_id', this.root.data('list_id'));\r\n\t\t\tformData.append('edit_form_id', this.root.data('form_id'));\r\n\t\t\tformData.append('redirect_url', this.root.data('redirect_url'));\r\n\t\t\tformData.append('field_list', JSON.stringify(this.fieldNames));\r\n\t\t\t\r\n\t\t\tvar url = DX_CORE.site_url + 'inlineform';\r\n\t\t\tif(this.root.data('mode') != 'create')\r\n\t\t\t{\r\n\t\t\t\turl += '/' + this.root.data('item_id') + '?_method=PUT';\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tshow_page_splash(1);\r\n\t\t\t\r\n\t\t\t// submit a request\r\n\t\t\t$.ajax({\r\n\t\t\t\ttype: 'POST',\r\n\t\t\t\turl: url,\r\n\t\t\t\tdataType: 'json',\r\n\t\t\t\tprocessData: false,\r\n\t\t\t\tcontentType: false,\r\n\t\t\t\tdata: formData,\r\n\t\t\t\tsuccess: function(data)\r\n\t\t\t\t{\r\n\t\t\t\t\tif(typeof data.success != \"undefined\" && data.success == 0)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tnotify_err(data.error);\r\n\t\t\t\t\t\thide_page_splash(1);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tif(self.root.data('mode') == 'create')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif(self.root.data('has_users_documents_access') == 1)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\twindow.DxEmpPersDocs.userId = data.item_id;\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t// Custom tab\r\n\t\t\t\t\t\t\twindow.DxEmpPersDocs.onClickSaveDocs(function()\r\n\t\t\t\t\t\t\t{\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\thide_page_splash(1);\r\n\t\t\t\t\t\t\t\t$('.dx-stick-footer').hide();\r\n\t\t\t\t\t\t\t\twindow.location = data.redirect;\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{                                                    \r\n\t\t\t\t\t\t\thide_page_splash(1);\r\n\t\t\t\t\t\t\t$('.dx-stick-footer').hide();\r\n\t\t\t\t\t\t\twindow.location = data.redirect;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tif(self.root.data('has_users_documents_access') == 1)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t// Custom tab\r\n\t\t\t\t\t\twindow.DxEmpPersDocs.onClickSaveDocs(function()\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\twindow.DxEmpPersDocs.toggleDisable(true);\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tself.editButton.show();\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tvar tabs = $($.parseHTML('<div>' + data.tabs + '</div>')).find('.tab-pane').not(\".dx-grid-tab-pane\");\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t// replace original html content of marked elements with input fields\r\n\t\t\t\t\t\t\tfor(var i = 0; i < tabs.length; i++)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tvar tab = $(tabs[i]);\r\n\t\t\t\t\t\t\t\tvar elem = $('[data-tab-title=\"' + tab.data('tabTitle') + '\"]', self.root);\r\n\t\t\t\t\t\t\t\tif(elem.length)\r\n\t\t\t\t\t\t\t\t\telem.html(tab.html());\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tif(self.options.afterSave)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tself.options.afterSave();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\thide_page_splash(1);\r\n\t\t\t\t\t\t\t$('.dx-stick-footer').hide();\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tself.editButton.show();\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tvar tabs = $($.parseHTML('<div>' + data.tabs + '</div>')).find('.tab-pane').not(\".dx-grid-tab-pane\");\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// replace original html content of marked elements with input fields\r\n\t\t\t\t\t\tfor(var i = 0; i < tabs.length; i++)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar tab = $(tabs[i]);\r\n\t\t\t\t\t\t\tvar elem = $('[data-tab-title=\"' + tab.data('tabTitle') + '\"]', self.root);\r\n\t\t\t\t\t\t\tif(elem.length)\r\n\t\t\t\t\t\t\t\telem.html(tab.html());\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tfor(var name in data.fields)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t$('[data-name=\"' + name + '\"]').html(data.fields[name]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif(self.options.afterSave)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tself.options.afterSave();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\thide_page_splash(1);\r\n\t\t\t\t\t\t$('.dx-stick-footer').hide();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\terror: function(jqXHR, textStatus, errorThrown)\r\n\t\t\t\t{\r\n\t\t\t\t\tconsole.log(jqXHR);\r\n\t\t\t\t\tconsole.log(errorThrown);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\t\r\n\t\t/**\r\n\t\t * Remove input fields and display original HTML\r\n\t\t */\r\n\t\tcancel: function()\r\n\t\t{\r\n\t\t\tif(this.root.data('mode') == 'create')\r\n\t\t\t{\r\n\t\t\t\tshow_page_splash(1);\r\n\t\t\t\twindow.location = this.options.empl_search_page_url;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis.editButton.show();\r\n\t\t\t\r\n\t\t\tfor(var k in this.originalTabs)\r\n\t\t\t{\r\n\t\t\t\tthis.tabs.filter('[data-tab-title=\"' + k + '\"]').html(this.originalTabs[k]);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tfor(var name in this.originalFields)\r\n\t\t\t{\r\n\t\t\t\tthis.fields.filter('[data-name=\"' + name + '\"]').html(this.originalFields[name]);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t$('.dx-stick-footer').hide();\r\n\t\t\t\r\n\t\t\tif(this.root.data('has_users_documents_access') == 1)\r\n\t\t\t{\r\n\t\t\t\twindow.DxEmpPersDocs.cancelEditMode();\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t/**\r\n\t\t * Delete an item from storage.\r\n\t\t */\r\n\t\tdestroy: function()\r\n\t\t{\r\n\t\t\tif(!confirm(Lang.get('frame.confirm_delete')))\r\n\t\t\t\treturn;\r\n\t\t\t\r\n\t\t\tvar request = {\r\n\t\t\t\tedit_form_id: this.root.data('form_id'),\r\n\t\t\t\titem_id: this.root.data('item_id')\r\n\t\t\t};\r\n\t\t\t\r\n\t\t\tshow_page_splash(1);\r\n\t\t\t\r\n\t\t\t$.ajax({\r\n\t\t\t\ttype: 'POST',\r\n\t\t\t\turl: DX_CORE.site_url + 'inlineform/' + this.root.data('item_id') + '?_method=DELETE',\r\n\t\t\t\tdataType: 'json',\r\n\t\t\t\tdata: request,\r\n\t\t\t\tsuccess: function(data)\r\n\t\t\t\t{\r\n\t\t\t\t\tif(typeof data.success != \"undefined\" && data.success == 0)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tnotify_err(data.error);\r\n\t\t\t\t\t\thide_page_splash(1);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\twindow.history.back();\r\n\t\t\t\t},\r\n\t\t\t\terror: function(jqXHR, textStatus, errorThrown)\r\n\t\t\t\t{\r\n\t\t\t\t\tconsole.log(textStatus);\r\n\t\t\t\t\tconsole.log(jqXHR);\r\n\t\t\t\t\thide_page_splash(1);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t});\r\n})(jQuery);\r\n","/**\r\n * Contains logic for viewing and editing employee's documents\r\n * @type Window.DxEmpPersDocs|window.DxEmpPersDocs \r\n */\r\nwindow.DxEmpPersDocs = window.DxEmpPersDocs || {\r\n    /**\r\n     * Row counter, used to identify rows\r\n     */\r\n    rowCount: 0,\r\n    /**\r\n     * User ID which is loaded\r\n     */\r\n    userId: 0,\r\n    /**\r\n     * Date format used in system. This format is used to initialize date picker\r\n     */\r\n    dateFormat: '',\r\n    /**\r\n     * Locale used in system. This format is used to initializes date picker\r\n     */\r\n    locale: 'en',\r\n    /**\r\n     * Registers ID for table where documents are saved\r\n     */\r\n    empDocListId: 0,\r\n    /**\r\n     * Registers field ID where documents are saved\r\n     */\r\n    empDocFldId: 0,\r\n    /**\r\n     * Parameter if component is initialized\r\n     */\r\n    isInit: false,\r\n    /**\r\n     * Clone of view which contains view state with data saved in database.\r\n     * If edit mode is canceled, then this view is replaced with edit view and all made changes are lost\r\n     */\r\n    viewClone: '',\r\n    /**\r\n     * Callback function which is called after successful components initialization\r\n     * @param {type} data Data which is sent to callback function\r\n     */\r\n    callbackOnInitiSuccess: function (data) {},\r\n    /**\r\n     * Callback function which is called after successful data save\r\n     * @param {type} data Data which is sent to callback function\r\n     */\r\n    callbackOnSaveSuccess: function (data) {},\r\n    /**\r\n     * Callback function which is called after process is exited with error\r\n     * @param {type} data Data which is sent to callback function\r\n     */\r\n    callbackOnError: function (data) {},\r\n    /**\r\n     * Initializes component\r\n     */\r\n    init: function (callbackOnInitiSuccess) {\r\n        if (callbackOnInitiSuccess) {\r\n            window.DxEmpPersDocs.callbackOnInitiSuccess = callbackOnInitiSuccess;\r\n        } else {\r\n            window.DxEmpPersDocs.callbackOnInitiSuccess = function () {};\r\n        }\r\n\r\n        window.DxEmpPersDocs.userId = ($('#dx-emp-pers-docs-panel').attr('data-user-id') == '' ? 0 : $('#dx-emp-pers-docs-panel').attr('data-user-id'));\r\n        window.DxEmpPersDocs.dateFormat = $('#dx-emp-pers-docs-panel').attr('data-date-format');\r\n        window.DxEmpPersDocs.locale = $('#dx-emp-pers-docs-panel').attr('data-locale');\r\n        window.DxEmpPersDocs.empDocListId = $('#dx-emp-pers-docs-panel').attr('data-emp-docs-list-id');\r\n        window.DxEmpPersDocs.empDocFldId = $('#dx-emp-pers-docs-panel').attr('data-emp-docs-fld-id');\r\n        $(\"#dx-emp-pers-docs-country\").change(window.DxEmpPersDocs.onChangeCountry);\r\n        window.DxEmpPersDocs.loadEmployeeData();\r\n    },\r\n    /**\r\n     * Enter edit mode by saving view state in memory. \r\n     * It is needed to revert changes if edit mode is canceled\r\n     */\r\n    enterEditMode: function () {\r\n        window.DxEmpPersDocs.viewClone = $('#dx-emp-pers-docs-panel').clone(true, true);\r\n    },\r\n    /**\r\n     * Cancels edit mode by loading previous view state\r\n     */\r\n    cancelEditMode: function () {\r\n        $('#dx-emp-pers-docs-panel').replaceWith(window.DxEmpPersDocs.viewClone);\r\n        window.DxEmpPersDocs.viewClone = null;\r\n        window.DxEmpPersDocs.toggleDisable(true);\r\n    },\r\n    /**\r\n     * Loads employee document data from server\r\n     */\r\n    loadEmployeeData: function () {\r\n        $.ajax({\r\n            url: '/employee/personal_docs/get/employee_docs/' + window.DxEmpPersDocs.userId,\r\n            type: \"get\",\r\n            success: window.DxEmpPersDocs.onSuccessLoadEmployeeData,\r\n            error: window.DxEmpPersDocs.onAjaxError\r\n        });\r\n    },\r\n    /**\r\n     * Evenet ahndler on successful employee data retrieval\r\n     * @param {array} data Employee document data which ir retrieved\r\n     */\r\n    onSuccessLoadEmployeeData: function (data) {\r\n        if (data != '') {\r\n            var data_rows = JSON.parse(data);\r\n            // Prepares dropdown list options\r\n            for (var i = 0; i < data_rows.length; i++) {\r\n                window.DxEmpPersDocs.createNewDocRow(false, data_rows[i]);\r\n            }\r\n        }\r\n\r\n        $(\"#dx-emp-pers-docs-country\").trigger('change');\r\n    },\r\n    /**\r\n     * Draws document row\r\n     * @param {boolean} is_new Argument if row is new and doesnt contain any data\r\n     * @param {array} data Data which will be used to draw row. Can contains saved data or if new then document type\r\n     */\r\n    createNewDocRow: function (is_new, data) {\r\n        // Gets template for row and converts it as jquery object\r\n        var new_row_html = $($('#dx-emp-pers-docs-new-row').html());\r\n        if (is_new) {\r\n            new_row_html = window.DxEmpPersDocs.setDocTypeValue(new_row_html, data);\r\n        } else {\r\n            new_row_html = window.DxEmpPersDocs.setValues(new_row_html, data);\r\n        }\r\n\r\n        // Append row to table\r\n        if (is_new) {\r\n            $('#dx-emp-pers-docs-table').append(new_row_html);\r\n        } else {\r\n            $('#dx-emp-pers-docs-table-history').append(new_row_html);\r\n        }\r\n\r\n        // Bind all rquired events for row elements\r\n        window.DxEmpPersDocs.bindDocRowEvenets(new_row_html);\r\n        // Increase row counter\r\n        window.DxEmpPersDocs.rowCount++;\r\n    },\r\n    /**\r\n     * Initiates date picker control in row\r\n     * @param {DOMElement} new_row_html Row's DOM elemenet\r\n     * @param {string} value Date which will be set in date picker\r\n     * @returns {DOMElement} Edited row with initialized date picker\r\n     */\r\n    initValidToDatePicker: function (new_row_html, value) {\r\n        var picker = new_row_html.find('.dx-emp-pers-docs-validto-input');\r\n        picker.attr('id', 'dx-emp-pers-docs-validto-input-' + window.DxEmpPersDocs.rowCount);\r\n        picker.val(value);\r\n        picker.datetimepicker({\r\n            lang: window.DxEmpPersDocs.locale,\r\n            format: window.DxEmpPersDocs.dateFormat,\r\n            timepicker: 0,\r\n            dayOfWeekStart: 1,\r\n            closeOnDateSelect: true\r\n        });\r\n        new_row_html.find('.dx-emp-pers-docs-validto-input-calc').click({picker_num: window.DxEmpPersDocs.rowCount}, function (e) {\r\n            jQuery('#dx-emp-pers-docs-validto-input-' + e.data.picker_num).datetimepicker('show');\r\n        });\r\n        return new_row_html;\r\n    },\r\n    /**\r\n     * Sets data for new document row\r\n     * @param {DOMElement} new_row_html Row's DOM elemenet\r\n     * @param {array} data_row Data array for input values\r\n     * @returns {DOMElement} Row containing values\r\n     */\r\n    setDocTypeValue: function (new_row_html, data_row) {\r\n        // Prepare \"valid to\" date picker            \r\n        new_row_html = window.DxEmpPersDocs.initValidToDatePicker(new_row_html, '');\r\n        new_row_html.attr('id', 'dx-emp-pers-docs-row-' + data_row.id);\r\n        new_row_html.find('.dx-emp-pers-docs-type-input').val(data_row.id);\r\n        new_row_html.find('.dx-emp-pers-docs-type-label').html(data_row.name);\r\n        return new_row_html;\r\n    },\r\n    /**\r\n     * Sets data for already saved document row\r\n     * @param {DOMElement} new_row_html Row's DOM elemenet\r\n     * @param {array} data_row Data array for input values\r\n     * @returns {DOMElement} Row containing values\r\n     */\r\n    setValues: function (new_row_html, data_row) {\r\n        new_row_html = window.DxEmpPersDocs.initValidToDatePicker(new_row_html, data_row.valid_to);\r\n        new_row_html.attr('id', 'dx-emp-pers-docs-row-' + data_row.doc_id);\r\n        new_row_html.find('.dx-emp-pers-docs-id-input').val(data_row.id);\r\n        new_row_html.find('.dx-emp-pers-docs-type-input').val(data_row.doc_id);\r\n        new_row_html.find('.dx-emp-pers-docs-type-label').html(data_row.personal_document.name);\r\n        new_row_html.find('.dx-emp-pers-docs-docnr-input').val(data_row.doc_nr);\r\n        new_row_html.find('.dx-emp-pers-docs-publisher-input').val(data_row.publisher);\r\n        window.DxEmpPersDocs.setFileValue(new_row_html, data_row.id, data_row.file_name);\r\n\r\n        return new_row_html;\r\n    },\r\n    /**\r\n     * Sets saved document link in file input box\r\n     * @param {DOMElement} new_row_html Row's DOM elemenet\r\n     * @param {integer} row_id ID for document row in database\r\n     * @param {string} file_name Saved name for the file\r\n     */\r\n    setFileValue: function (new_row_html, row_id, file_name) {\r\n        if (file_name && file_name != null) {\r\n            var file_link = \"<a href='JavaScript: download_file(\" + row_id + \" , \" + window.DxEmpPersDocs.empDocListId + \", \" + window.DxEmpPersDocs.empDocFldId + \");'>\" + file_name + \"</a>\";\r\n            new_row_html.find('.dx-emp-pers-docs-file-input-download').html(file_link);\r\n            new_row_html.find('.dx-emp-pers-docs-file-input-isset').val(1);\r\n        }\r\n    },\r\n    /**\r\n     * Clears documents row data\r\n     * @param {object} e Event arguments which contains event caller\r\n     */\r\n    clearDocRow: function (e) {\r\n        var row = $(e.target).parents('.dx-emp-pers-docs-row');\r\n        row.find('.dx-emp-pers-docs-id-input').val(0);\r\n        row.find('.dx-emp-pers-docs-docnr-input').val('');\r\n        row.find('.dx-emp-pers-docs-validto-input').val('');\r\n        row.find('.dx-emp-pers-docs-publisher-input').val('');\r\n        row.find('.dx-emp-pers-docs-file-input-remove-btn').trigger('click');\r\n    },\r\n    /**\r\n     * Gets data from inputs for data saving\r\n     * @returns {FormData} Data retrieved from input fields\r\n     */\r\n    getDataForSave: function () {\r\n        var rows = $('#dx-emp-pers-docs-table .dx-emp-pers-docs-row');\r\n        var data = {\r\n            user_id: window.DxEmpPersDocs.userId,\r\n            rows: []\r\n        };\r\n        var formData = new FormData();\r\n        for (var i = 0; i < rows.length; i++) {\r\n            var row = $(rows[i]);\r\n            var row_data = {};\r\n            row_data.id = row.find('.dx-emp-pers-docs-id-input').val();\r\n            row_data.document_type = row.find('.dx-emp-pers-docs-type-input').val();\r\n            row_data.publisher = row.find('.dx-emp-pers-docs-publisher-input').val();\r\n            row_data.valid_to = row.find('.dx-emp-pers-docs-validto-input').val();\r\n            row_data.doc_nr = row.find('.dx-emp-pers-docs-docnr-input').val();\r\n            row_data.file_remove = $.trim(row.find('.dx-emp-pers-docs-file-input-download').html()) === '';\r\n            var file = row.find('.dx-emp-pers-docs-file-input-file').prop(\"files\")[0];\r\n            formData.append('file' + i, file);\r\n            data.rows.push(row_data);\r\n        }\r\n\r\n\r\n        formData.append('doc_country_id', $('#dx-emp-pers-docs-country').val());\r\n        formData.append('data', JSON.stringify(data));\r\n        return formData;\r\n    },\r\n    /**\r\n     * Binds click event for clear button\r\n     * @param {DOMElement} new_row_html Row's DOM elemenet\r\n     */\r\n    bindDocRowEvenets: function (new_row_html) {\r\n        new_row_html.find('.dx-emp-pers-docs-clear-btn').click(window.DxEmpPersDocs.clearDocRow);\r\n    },\r\n    /**\r\n     * Event when changing country from dropdown which requests document types associated with selected country\r\n     * @param {object} e Event arguments which contains event caller\r\n     */\r\n    onChangeCountry: function (e) {\r\n        var country_id = $(e.target).val();\r\n        $.ajax({\r\n            url: DX_CORE.site_url + 'employee/personal_docs/get/docs_by_country/' + country_id,\r\n            type: \"get\",\r\n            success: window.DxEmpPersDocs.onSuccessChangeCountry,\r\n            error: window.DxEmpPersDocs.onAjaxError\r\n        });\r\n    },\r\n    /**\r\n     * Event on successful document type retrieval when changing country\r\n     * @param {array} data Document types associated with country\r\n     */\r\n    onSuccessChangeCountry: function (data) {\r\n        var docs = JSON.parse(data);\r\n        window.DxEmpPersDocs.drawRows(docs);\r\n        window.DxEmpPersDocs.finishInit();\r\n    },\r\n    /**\r\n     * Draws rows when country is changed\r\n     * @param {array} docs Document types associated with selected country\r\n     */\r\n    drawRows: function (docs) {\r\n        // Moves all existing rows to hidden history div\r\n        $('#dx-emp-pers-docs-table').contents().appendTo('#dx-emp-pers-docs-table-history');\r\n        // Iterates through all the document types\r\n        for (var d = 0; d < docs.length; d++) {\r\n            var doc = docs[d];\r\n            var existing_row = $('#dx-emp-pers-docs-row-' + doc.id);\r\n            // Check if row exist in history div\r\n            if (existing_row.length > 0) {\r\n                // Move existing document type row into visible view\r\n                existing_row.appendTo('#dx-emp-pers-docs-table');\r\n            } else {\r\n                // Creates new row if it doesn't exist for document type\r\n                window.DxEmpPersDocs.createNewDocRow(true, doc);\r\n            }\r\n        }\r\n        // Initiates tooltips because they are not initiated because rows are created dynamicaly\r\n        $('#dx-emp-pers-docs-table').find('[data-tooltip-title]').each(function (i, obj) {\r\n            $(obj).attr('title', $(obj).data('tooltip-title'));\r\n            $(obj).tooltip();\r\n        });\r\n    },\r\n    /**\r\n     * Finishes initialization\r\n     */\r\n    finishInit: function () {\r\n        if (!window.DxEmpPersDocs.isInit) {\r\n            window.DxEmpPersDocs.isInit = true;\r\n            if (window.DxEmpPersDocs.userId == 0) {\r\n                window.DxEmpPersDocs.toggleDisable(false);\r\n            } else {\r\n                window.DxEmpPersDocs.toggleDisable(true);\r\n            }\r\n            window.DxEmpPersDocs.callbackOnInitiSuccess();\r\n        }\r\n    },\r\n    /**\r\n     * Saves data\r\n     * @param {function} callbackOnSaveSuccess Callback function for successful saving\r\n     * @param {function} callbackOnError Callback function when error happens on data save\r\n     */\r\n    onClickSaveDocs: function (callbackOnSaveSuccess, callbackOnError) {\r\n        if (callbackOnSaveSuccess) {\r\n            window.DxEmpPersDocs.callbackOnSaveSuccess = callbackOnSaveSuccess;\r\n        } else {\r\n            window.DxEmpPersDocs.callbackOnSaveSuccess = function () {};\r\n        }\r\n        if (callbackOnError) {\r\n            window.DxEmpPersDocs.callbackOnError = callbackOnError;\r\n        } else {\r\n            window.DxEmpPersDocs.callbackOnError = function () {};\r\n        }\r\n\r\n        var form_data = window.DxEmpPersDocs.getDataForSave();\r\n        $.ajax({\r\n            url: DX_CORE.site_url + 'employee/personal_docs/save',\r\n            data: form_data,\r\n            type: \"post\",\r\n            processData: false,\r\n            dataType: \"json\",\r\n            contentType: false,\r\n            success: window.DxEmpPersDocs.onSuccessSave,\r\n            error: window.DxEmpPersDocs.onAjaxError\r\n        });\r\n    },\r\n    /**\r\n     * Event on successful data save\r\n     * @param {array} data_rows Data returned about saved document rows\r\n     */\r\n    onSuccessSave: function (data_rows) {\r\n        // Set id for rows and update file input control value\r\n        for (var i = 0; i < data_rows.length; i++) {\r\n            var data_row = data_rows[i];\r\n            var row = $('#dx-emp-pers-docs-row-' + data_row.doc_id);\r\n\r\n            if (row.length > 0) {\r\n                row.find('.dx-emp-pers-docs-id-input').val(data_row.id);\r\n                row.find('.dx-emp-pers-docs-file-input-remove-btn').trigger('click');\r\n                window.DxEmpPersDocs.setFileValue(row, data_row.id, data_row.file_name);\r\n            }\r\n        }\r\n\r\n        $('#dx-emp-pers-docs-table-history').empty();\r\n        window.DxEmpPersDocs.callbackOnSaveSuccess();\r\n    },\r\n    /**\r\n     * Event when ajax request gets error\r\n     * @param {array} data Data containing error information\r\n     */\r\n    onAjaxError: function (data) {\r\n        window.DxEmpPersDocs.finishInit();\r\n        window.DxEmpPersDocs.callbackOnError();\r\n    },\r\n    /**\r\n     * Swicthed edit and view modes\r\n     * @param {boolean} is_disabled If true then view mode is set else edit mode is set\r\n     */\r\n    toggleDisable: function (is_disabled) {\r\n        if (!is_disabled) {\r\n            window.DxEmpPersDocs.enterEditMode();\r\n        }\r\n\r\n        var rows = $('#dx-emp-pers-docs-table .dx-emp-pers-docs-row');\r\n        for (var i = 0; i < rows.length; i++) {\r\n            var row = $(rows[i]);\r\n            row.find('.dx-emp-pers-docs-publisher-input').prop('disabled', is_disabled);\r\n            row.find('.dx-emp-pers-docs-validto-input').prop('disabled', is_disabled);\r\n            row.find('.dx-emp-pers-docs-validto-input-calc').prop('disabled', is_disabled);\r\n            row.find('.dx-emp-pers-docs-docnr-input').prop('disabled', is_disabled);\r\n            if (is_disabled) {\r\n                row.find('.dx-emp-pers-docs-file-input-set-btn').hide();\r\n                if (row.find('.dx-emp-pers-docs-file-input-file').prop(\"files\")[0]) {\r\n                    row.find('.dx-emp-pers-docs-file-input-remove-btn').hide();\r\n                }\r\n\r\n                row.find('.dx-emp-pers-docs-clear-btn').hide();\r\n            } else {\r\n                row.find('.dx-emp-pers-docs-validto-input').datetimepicker('destroy');\r\n                row.find('.dx-emp-pers-docs-validto-input').datetimepicker({\r\n                    lang: window.DxEmpPersDocs.locale,\r\n                    format: window.DxEmpPersDocs.dateFormat,\r\n                    timepicker: 0,\r\n                    dayOfWeekStart: 1,\r\n                    closeOnDateSelect: true\r\n                });\r\n\r\n                row.find('.dx-emp-pers-docs-file-input-set-btn').show();\r\n                if (row.find('.dx-emp-pers-docs-file-input-file').prop(\"files\")[0]) {\r\n                    row.find('.dx-emp-pers-docs-file-input-remove-btn').show();\r\n                }\r\n\r\n                row.find('.dx-emp-pers-docs-clear-btn').show();\r\n            }\r\n        }\r\n\r\n        $('#dx-emp-pers-docs-country').prop('disabled', is_disabled);\r\n    }\r\n};","/**\r\n * Contains logic for viewing and editing employee's notes\r\n * @type Window.DxEmpNotes|window.DxEmpNotes \r\n */\r\nwindow.DxEmpNotes = window.DxEmpNotes || {\r\n    /**\r\n     * User ID which is loaded\r\n     */\r\n    userId: 0,\r\n    /**\r\n     * Parameter if control is loaded\r\n     */\r\n    isLoaded: false,\r\n    /**\r\n     * Parameter if note is sending to server\r\n     */\r\n    isSending: false,\r\n    /**\r\n     * Default color for chat form background\r\n     */\r\n    chatFormColorDefault: 'white',\r\n    /**\r\n     * Initializes component\r\n     */\r\n    init: function (userId) {\r\n        window.DxEmpNotes.userId = userId;\r\n\r\n    },\r\n    /**\r\n     * Loads view\r\n     * @returns {undefined}\r\n     */\r\n    loadView: function () {\r\n        if (window.DxEmpNotes.isLoaded) {\r\n            return;\r\n        }\r\n\r\n        show_page_splash(1);\r\n\r\n        $.ajax({\r\n            url: DX_CORE.site_url + 'employee/notes/get/view/' + window.DxEmpNotes.userId,\r\n            type: \"get\",\r\n            success: window.DxEmpNotes.onLoadViewSuccess,\r\n            error: function (data) {\r\n                hide_page_splash(1);\r\n            }\r\n        });\r\n    },\r\n    /**\r\n     * Evnet handler when view is successfully loaded\r\n     * @returns {string} View's HTML\r\n     */\r\n    onLoadViewSuccess: function (data) {\r\n        $('#dx-tab_notes').html(data);\r\n\r\n        window.DxEmpNotes.chatFormColorDefault = $('.dx-emp-notes-chat-form').css(\"background-color\");\r\n\r\n        $('.dx-emp-notes-btn').click(window.DxEmpNotes.onNoteEnter);\r\n        $('.dx-emp-notes-input-text').keyup(function (e) {\r\n            if (e.keyCode == 13) {\r\n                window.DxEmpNotes.onNoteEnter();\r\n            }\r\n        });\r\n\r\n        $('.dx-emp-notes-chat').on('click', '.dx-emp-notes-btn-link-edit', {}, window.DxEmpNotes.onEditClick);\r\n        $('.dx-emp-notes-chat').on('click', '.dx-emp-notes-btn-link-delete', {}, window.DxEmpNotes.onDeleteClick);\r\n        \r\n        $('.dx-emp-notes-btn-whosee').popover();\r\n\r\n        window.DxEmpNotes.isLoaded = true;\r\n\r\n        hide_page_splash(1);\r\n    },\r\n    /**\r\n     * Retrieve data for saving\r\n     * @returns {object} Prepared data\r\n     */\r\n    getDataForSave: function () {\r\n        var data = {};\r\n\r\n        data.note_id = $('.dx-emp-notes-input-id').val();\r\n        data.user_id = window.DxEmpNotes.userId;\r\n        data.note_text = $('.dx-emp-notes-input-text').val();\r\n\r\n        return data;\r\n    },\r\n    /**\r\n     * Event handler when note saving is initiated\r\n     * @returns {undefined}\r\n     */\r\n    onNoteEnter: function () {\r\n        if (window.DxEmpNotes.isSending) {\r\n            return;\r\n        }\r\n\r\n        window.DxEmpNotes.showLoading();\r\n\r\n        var data = window.DxEmpNotes.getDataForSave();\r\n        $.ajax({\r\n            url: DX_CORE.site_url + 'employee/notes/save',\r\n            data: data,\r\n            type: \"post\",\r\n            success: window.DxEmpNotes.onSuccessSave,\r\n            error: window.DxEmpNotes.onAjaxError\r\n        });\r\n    },\r\n    /**\r\n     * Load selected note's data into note input boxes\r\n     * @param {object} e Evenet caller\r\n     * @returns {undefined}\r\n     */\r\n    onEditClick: function (e) {\r\n        var edit_btn = $(e.target);\r\n\r\n        var note_id = edit_btn.closest('.message').find('.dx-emp-notes-edit-id').val();\r\n        var note_text = edit_btn.closest('.message').find('.dx-emp-notes-edit-body').html();\r\n\r\n        $('.dx-emp-notes-input-id').val(note_id);\r\n        $('.dx-emp-notes-input-text').val(note_text);\r\n        $('.dx-emp-notes-input-text').focus();\r\n\r\n        // Animate \r\n        var chat_form = $('.dx-emp-notes-chat-form');\r\n\r\n        chat_form.animate({backgroundColor: '#7bb6de'}, 'slow', function () {\r\n            chat_form.animate({backgroundColor: window.DxEmpNotes.chatFormColorDefault}, 'slow');\r\n        });\r\n\r\n    },\r\n    /**\r\n     * Event handler for delete click. Opens modal confirmation window\r\n     * @param {object} e Event arguments\r\n     * @returns {undefined}\r\n     */\r\n    onDeleteClick: function (e) {\r\n        var del_btn = $(e.target);\r\n\r\n        var note_id = del_btn.closest('.message').find('.dx-emp-notes-edit-id').val();\r\n\r\n        PageMain.showConfirm(window.DxEmpNotes.onDeleteConfirm,\r\n                note_id,\r\n                Lang.get('empl_profile.notes.delete_note_title'),\r\n                Lang.get('empl_profile.notes.delete_note_text'),\r\n                Lang.get('form.btn_delete'),\r\n                '');\r\n    },\r\n    /**\r\n     * Event handler when delete operation is confirmed\r\n     * @param {integer} id Note's ID which will be deleted\r\n     * @returns {undefined}\r\n     */\r\n    onDeleteConfirm: function (id) {\r\n        if (window.DxEmpNotes.isSending) {\r\n            return;\r\n        }\r\n\r\n        window.DxEmpNotes.showLoading();\r\n        \r\n         var data = {\r\n             note_id: id\r\n         };\r\n        \r\n        $.ajax({\r\n            url: DX_CORE.site_url + 'employee/notes/delete',\r\n            data: data,\r\n            type: \"delete\",\r\n            success: window.DxEmpNotes.onSuccessDelete,\r\n            error: window.DxEmpNotes.onAjaxError\r\n        });\r\n    },\r\n    /**\r\n     * Shows loading box\r\n     * @returns {undefined}\r\n     */\r\n    showLoading: function () {\r\n        window.DxEmpNotes.isSending = true;\r\n        show_page_splash(1);\r\n    },\r\n    /**\r\n     * Hides loading box\r\n     * @returns {undefined}\r\n     */\r\n    hideLoading: function () {\r\n        window.DxEmpNotes.isSending = false;\r\n        hide_page_splash(1);\r\n    },\r\n    /**\r\n     * Event on successful note delete\r\n     * @param {integer} note_id Note id which was deleted\r\n     */\r\n    onSuccessDelete: function (note_id) {\r\n        if (note_id) {\r\n            $('.dx-emp-notes-edit-id[value=' + note_id + ']').closest('li').remove();\r\n        }\r\n\r\n        window.DxEmpNotes.hideLoading();\r\n    },\r\n    /**\r\n     * Event on successful data save\r\n     * @param {array} data Data returned about saved noted. Contains view for new note\r\n     */\r\n    onSuccessSave: function (data) {\r\n        // Removes old noted if existed, because it will be moved to top of the list as latest note\r\n        var note_id = $('.dx-emp-notes-input-id').val();\r\n        if (note_id) {\r\n            $('.dx-emp-notes-edit-id[value=' + note_id + ']').closest('li').remove();\r\n        }\r\n        $('.dx-emp-notes-input-id').val('');\r\n        $('.dx-emp-notes-input-text').val('');\r\n\r\n        window.DxEmpNotes.hideLoading();\r\n\r\n        if (data.view) {\r\n            $('.dx-emp-notes-chat').prepend($(data.view).fadeIn());\r\n            $('.dx-emp-notes-btn-whosee').popover();\r\n        }\r\n    },\r\n    /**\r\n     * Event when ajax request gets error\r\n     * @param {array} data Data containing error information\r\n     */\r\n    onAjaxError: function (data) {\r\n        window.DxEmpNotes.hideLoading();\r\n    }\r\n};","/**\r\n * Contains logic for viewing and editing employee's time off data\r\n * @type Window.DxEmpTimeoff|window.DxEmpTimeoff \r\n */\r\nwindow.DxEmpTimeoff = window.DxEmpTimeoff || {\r\n    /**\r\n     * User ID which is loaded\r\n     */\r\n    userId: 0,\r\n    /**\r\n     * Parameter if control is loaded\r\n     */\r\n    isLoaded: false,\r\n    /**\r\n     * Parameter if data is sending to server\r\n     */\r\n    isSending: false,\r\n    /**\r\n     * Parameter if table has been initialized\r\n     */\r\n    isTableInit: false,\r\n    /**\r\n     * Parameter if chart has been initialized\r\n     */\r\n    isChartInit: false,\r\n    /**\r\n     * Parameter if table needs to be reloaded when gets focus\r\n     */\r\n    doTableRefresh: true,\r\n    /**\r\n     * Parameter if chart needs to be reloaded when gets focus\r\n     */\r\n    doChartRefresh: true,\r\n    /**\r\n     * Current tab index. 0 - focus on chart tab, 1 - focus on table tab\r\n     */\r\n    currentTab: 0,\r\n    /**\r\n     * Current filter's date from value\r\n     */\r\n    dateFrom: '',\r\n    /**\r\n     * Current filter's date to value\r\n     */\r\n    dateTo: '',\r\n    /**\r\n     * Current filter's time off value\r\n     */\r\n    timeoff: 1,\r\n    /**\r\n     * Current filter's time off types title\r\n     */\r\n    timeoffTitle: '',\r\n    /**\r\n     * Parameter if current filter's time off type is in hours or days\r\n     */\r\n    timeoffIsAccrualHours: '',\r\n    /**\r\n     * Date format used in system. This format is used to initialize date picker\r\n     */\r\n    dateFormat: '',\r\n    /**\r\n     * Working days length in hours\r\n     */\r\n    workingDayH: '',\r\n    /**\r\n     * Initializes component\r\n     * @param {integer} userId User's ID which is opened\r\n     * @returns {undefined}\r\n     */\r\n    init: function (userId) {\r\n        window.DxEmpTimeoff.userId = userId;\r\n    },\r\n    /**\r\n     * Get filter parameters for adding to request when getting table or  chart\r\n     * @returns {String} Reteived URL part containign parameters\r\n     */\r\n    getFilterParams: function () {\r\n        return window.DxEmpTimeoff.userId + '/' + window.DxEmpTimeoff.timeoff + '/' + (window.DxEmpTimeoff.dateFrom / 1000) + '/' + (window.DxEmpTimeoff.dateTo / 1000);\r\n    },\r\n    /**\r\n     * Loads view\r\n     * @returns {undefined}\r\n     */\r\n    loadView: function () {\r\n        if (window.DxEmpTimeoff.isLoaded) {\r\n            return;\r\n        }\r\n\r\n        window.DxEmpTimeoff.showLoading();\r\n\r\n        $.ajax({\r\n            url: DX_CORE.site_url + 'employee/timeoff/get/view/' + window.DxEmpTimeoff.userId,\r\n            type: \"get\",\r\n            success: window.DxEmpTimeoff.onLoadViewSuccess,\r\n            error: function (data) {\r\n                window.DxEmpTimeoff.hideLoading();\r\n            }\r\n        });\r\n    },\r\n    /**\r\n     * Evnet handler when view is successfully loaded\r\n     * @returns {string} View's HTML\r\n     */\r\n    onLoadViewSuccess: function (data) {\r\n        $('#dx-tab_timeoff').html(data);\r\n\r\n        window.DxEmpTimeoff.workingDayH = $('#dx-emp-timeoff-panel').data('working_day_h');\r\n        window.DxEmpTimeoff.dateFormat = $('#dx-emp-timeoff-panel').data('date_format').toUpperCase();\r\n        window.DxEmpTimeoff.dateFrom = new Date($('#dx-emp-timeoff-panel').data('date_from'));\r\n        window.DxEmpTimeoff.dateTo = new Date($('#dx-emp-timeoff-panel').data('date_to'));\r\n        window.DxEmpTimeoff.timeoff = $('#dx-emp-timeoff-panel').data('timeoff');\r\n        window.DxEmpTimeoff.timeoffTitle = $('#dx-emp-timeoff-panel').data('timeoff_title');\r\n        window.DxEmpTimeoff.timeoffIsAccrualHours = $('#dx-emp-timeoff-panel').data('is_accrual_hours');\r\n\r\n        $(\"#dx-tab_timeoff [data-counter='counterup']\").counterUp({delay: 10, time: 700});\r\n\r\n        $(\".dx-accrual-calc\").click(function () {\r\n            window.DxEmpTimeoff.showLoading();\r\n            var a_elem = $(this);\r\n            $.ajax({\r\n                url: DX_CORE.site_url + 'employee/timeoff/get/calculate/' + window.DxEmpTimeoff.userId + \"/\" + a_elem.data('timeoff'),\r\n                type: \"get\",\r\n                success: function (data) {\r\n                    window.DxEmpTimeoff.onCalculateSuccess(a_elem, data);\r\n                }\r\n            });\r\n        });\r\n\r\n        $(\".dx-accrual-delete\").click(function () {\r\n            PageMain.showConfirm(window.DxEmpTimeoff.deleteCalculation, $(this), Lang.get('form.modal_confirm_title'), Lang.get('empl_profile.timeoff.delete_confirm'), Lang.get('form.btn_delete'), Lang.get('form.btn_cancel'));\r\n        });\r\n\r\n        $(\".dx-accrual-policy\").click(function () {\r\n            window.DxEmpTimeoff.showLoading();\r\n            view_list_item(\"form\", $(this).data('policy-id'), $(this).data('policy-list-id'), $(this).data('policy-user-field-id'), window.DxEmpTimeoff.userId, \"\", \"\");\r\n        });\r\n\r\n        $('.dx-emp-timeoff-sel-timeoff').click(window.DxEmpTimeoff.timeoffSelect);\r\n\r\n        $('.dx-emp-timeoff-tab-chart-btn').click(function () {\r\n            window.DxEmpTimeoff.switchTab(0);\r\n        });\r\n        $('.dx-emp-timeoff-tab-table-btn').click(function () {\r\n            window.DxEmpTimeoff.switchTab(1);\r\n        });\r\n\r\n        window.DxEmpTimeoff.initFilterDatePicker();\r\n\r\n        // Initializes current tab by loadings its data (by default chart tab)\r\n        window.DxEmpTimeoff.reloadTabData();\r\n\r\n        window.DxEmpTimeoff.isLoaded = true;\r\n    },\r\n    /**\r\n     * Event handler on successful calculation\r\n     * @param {DOMObject} a_elem Button which triggered event\r\n     * @param {array} data Data returned from server\r\n     * @returns {undefined}\r\n     */\r\n    onCalculateSuccess: function (a_elem, data) {\r\n        var thumb = a_elem.closest(\"div.widget-thumb\");\r\n        var cnt_elem = thumb.find(\".widget-thumb-body-stat\").first();\r\n\r\n        cnt_elem.attr(\"data-value\", data.balance);\r\n\r\n        cnt_elem.html(data.balance);\r\n\r\n        thumb.find(\".widget-thumb-subtitle\").first().html(data.unit + ' <span style=\"font-size: 10px\">' + Lang.get('empl_profile.timeoff.available') + '</span>');\r\n        cnt_elem.counterUp({delay: 10, time: 700});\r\n\r\n        if (window.DxEmpTimeoff.timeoff == a_elem.data('timeoff')) {\r\n            window.DxEmpTimeoff.setDataRefreshRequest();\r\n        } else {\r\n            window.DxEmpTimeoff.hideLoading();\r\n        }\r\n    },\r\n    /**\r\n     * Deletes calculation\r\n     * @param {DOMObject} a_elem Button which triggered event\r\n     * @returns {undefined}\r\n     */\r\n    deleteCalculation: function (a_elem) {\r\n        window.DxEmpTimeoff.showLoading();\r\n        $.ajax({\r\n            url: DX_CORE.site_url + 'employee/timeoff/get/delete_calculated/' + window.DxEmpTimeoff.userId + \"/\" + a_elem.data('timeoff'),\r\n            type: \"get\",\r\n            success: function (data) {\r\n                window.DxEmpTimeoff.onCalculateSuccess(a_elem, data);\r\n            }\r\n        });\r\n    },\r\n    /**\r\n     * Sets parameters that data in tabs must be reloaded\r\n     * @returns {undefined}\r\n     */\r\n    setDataRefreshRequest: function () {\r\n        window.DxEmpTimeoff.doChartRefresh = true;\r\n        window.DxEmpTimeoff.doTableRefresh = true;\r\n\r\n        // After setting refresh request, refreshes current tab data\r\n        window.DxEmpTimeoff.reloadTabData();\r\n    },\r\n    /**\r\n     * Switches tab and reload data if needed\r\n     */\r\n    switchTab: function (tab_index) {\r\n        window.DxEmpTimeoff.currentTab = tab_index;\r\n\r\n        // Bug fix for chart tooltip which sometimes doesnt dissapear\r\n        $(\"#dx-emp-timeoff-chart-tooltip\").hide();\r\n\r\n        // After changing tab, chech if data must be resfreshed in current tab\r\n        window.DxEmpTimeoff.reloadTabData();\r\n    },\r\n    /**\r\n     * Reload cureent tab after filter has been changed\r\n     * @returns {undefined}\r\n     */\r\n    reloadTabData: function () {\r\n        if (window.DxEmpTimeoff.currentTab === 0) {\r\n            window.DxEmpTimeoff.loadChart();\r\n        } else {\r\n            window.DxEmpTimeoff.loadTable();\r\n        }\r\n    },\r\n    /**\r\n     * Reload table data. Initializes component if needed\r\n     * @returns {undefined}\r\n     */\r\n    loadTable: function () {\r\n        if (!window.DxEmpTimeoff.isTableInit) {\r\n            window.DxEmpTimeoff.initDataTable();\r\n            window.DxEmpTimeoff.isTableInit = true;\r\n        } else if (window.DxEmpTimeoff.doTableRefresh) {\r\n            window.DxEmpTimeoff.refreshDataTable();\r\n        }\r\n\r\n        // Resets parameter that table has been refreshed\r\n        window.DxEmpTimeoff.doTableRefresh = false;\r\n    },\r\n    /**\r\n     * Reload chart data. Initializes component if needed\r\n     * @returns {undefined}\r\n     */\r\n    loadChart: function () {\r\n        if (!window.DxEmpTimeoff.isChartInit) {\r\n            window.DxEmpTimeoff.initChart();\r\n            window.DxEmpTimeoff.isChartInit = true;\r\n        } else if (window.DxEmpTimeoff.doChartRefresh) {\r\n            window.DxEmpTimeoff.refreshChart();\r\n        }\r\n\r\n        // Resets parameter that chart has been refreshed\r\n        window.DxEmpTimeoff.doChartRefresh = false;\r\n    },\r\n    /**\r\n     * Initializes data table\r\n     * @returns {undefined}\r\n     */\r\n    initDataTable: function () {\r\n        if (!window.DxEmpTimeoff.dataTable) {\r\n            window.DxEmpTimeoff.dataTable = $('#dx-empt-datatable-timeoff').DataTable({\r\n                serverSide: true,\r\n                searching: false,\r\n                order: [[0, \"desc\"]],\r\n                ajax: DX_CORE.site_url + 'employee/timeoff/get/table/' + window.DxEmpTimeoff.getFilterParams(),\r\n                columns: [\r\n                    {data: 'calc_date', name: 'calc_date'},\r\n                    {data: 'from_date', name: 'from_date'},\r\n                    {data: 'to_date', name: 'to_date'},\r\n                    {data: 'timeoff_record_type.title', name: 'timeoffRecordType.title'},\r\n                    {data: 'notes', name: 'notes'},\r\n                    {data: 'amount', name: 'amount'},\r\n                    {data: 'balance', name: 'balance'}\r\n                ],\r\n                fnPreDrawCallback: function () {\r\n                    window.DxEmpTimeoff.showLoading();\r\n                },\r\n                fnDrawCallback: function () {\r\n                    window.DxEmpTimeoff.hideLoading();\r\n                }\r\n            });\r\n        }\r\n    },\r\n    /**\r\n     * Refreshes data table\r\n     * @returns {undefined}\r\n     */\r\n    refreshDataTable: function () {\r\n        var url = DX_CORE.site_url + 'employee/timeoff/get/table/' + window.DxEmpTimeoff.getFilterParams();\r\n\r\n        window.DxEmpTimeoff.dataTable.ajax.url(url).load();\r\n    },\r\n    /**\r\n     * Initializes chart\r\n     * @returns {undefined}\r\n     */\r\n    initChart: function () {\r\n        window.DxEmpTimeoff.showLoading();\r\n\r\n        $(\"<div id='dx-emp-timeoff-chart-tooltip'></div>\").appendTo(\"body\");\r\n\r\n        $(\"#dx-emp-timeoff-chart\").bind(\"plothover\", window.DxEmpTimeoff.onPlotHover);\r\n\r\n        window.DxEmpTimeoff.refreshChart();\r\n    },\r\n    /**\r\n     * Refreshes chart data\r\n     * @returns {undefined}\r\n     */\r\n    refreshChart: function () {\r\n        window.DxEmpTimeoff.showLoading();\r\n\r\n        $.ajax({\r\n            url: DX_CORE.site_url + 'employee/timeoff/get/chart/' + window.DxEmpTimeoff.getFilterParams(),\r\n            type: \"get\",\r\n            success: window.DxEmpTimeoff.onGetChartDataSuccess,\r\n            error: window.DxEmpTimeoff.onAjaxError\r\n        });\r\n    },\r\n    /**\r\n     * Gets unit name for current filtered value\r\n     * @returns {string} Units name\r\n     */\r\n    getUnit: function () {\r\n        if (window.DxEmpTimeoff.timeoffIsAccrualHours == 1) {\r\n            return Lang.get('calendar.hours');\r\n        } else {\r\n            return Lang.get('calendar.days');\r\n        }\r\n    },\r\n    /**\r\n     * Load total values for specified period into panel\r\n     * @param {array} data Data contaning period total data\r\n     * @returns {undefined}\r\n     */\r\n    loadTotalData: function (data) {\r\n        if (!data) {\r\n            return;\r\n        }\r\n\r\n        if (data[0]) {\r\n            window.DxEmpTimeoff.timeoffIsAccrualHours = data[0].is_accrual_hours;\r\n            var unit = window.DxEmpTimeoff.getUnit();\r\n            $('#dx-emp-timeoff-period-balance').html(window.DxEmpTimeoff.calculateChartHours(data[0].balance) + ' ' + unit);\r\n            $('#dx-emp-timeoff-period-accrued').html(window.DxEmpTimeoff.calculateChartHours(data[0].accrued) + ' ' + unit);\r\n            $('#dx-emp-timeoff-period-used').html(window.DxEmpTimeoff.calculateChartHours(data[0].used) + ' ' + unit);\r\n        } else {\r\n            $('#dx-emp-timeoff-period-balance').html(0);\r\n            $('#dx-emp-timeoff-period-accrued').html(0);\r\n            $('#dx-emp-timeoff-period-used').html(0);\r\n        }\r\n    },\r\n    /**\r\n     * If needed convert hours to days\r\n     * @param {Number} value Input hours\r\n     * @returns {Number} Output value, could be in days or hours\r\n     */\r\n    calculateChartHours: function (value) {\r\n        if (window.DxEmpTimeoff.timeoffIsAccrualHours == 1) {\r\n            return value;\r\n        } else {\r\n            // Adding 0.00001 removes problem in javascript floating round problem\r\n            return Math.round(((value / window.DxEmpTimeoff.workingDayH) + 0.00001) * 100) / 100;\r\n        }\r\n    },\r\n    /**\r\n     * Event on usccessful data retrieval for chart \r\n     * @param {object} data Data retrieved form server\r\n     * @returns {undefined}\r\n     */\r\n    onGetChartDataSuccess: function (data) {\r\n        window.DxEmpTimeoff.loadTotalData(data.total);\r\n\r\n        var barsUsed = [];\r\n        var barsAccrued = [];\r\n        var lineBalance = [];\r\n        var categories = [];\r\n\r\n        for (var i = 0; i < data.res.length; i++) {\r\n            var row = data.res[i];\r\n\r\n            categories.push([i, row.calc_date_year + '/' + row.calc_date_month]);\r\n\r\n            if (Number(row.used) > 0) {\r\n                barsUsed.push([i, window.DxEmpTimeoff.calculateChartHours(row.used)]);\r\n            }\r\n\r\n            if (Number(row.accrued) > 0) {\r\n                barsAccrued.push([i, window.DxEmpTimeoff.calculateChartHours(row.accrued)]);\r\n            }\r\n\r\n            lineBalance.push([i, window.DxEmpTimeoff.calculateChartHours(row.balance)]);\r\n        }\r\n\r\n        $.plot(\"#dx-emp-timeoff-chart\", [\r\n            {\r\n                data: barsUsed,\r\n                bars: {\r\n                    show: true,\r\n                    barWidth: 0.4,\r\n                    align: \"left\"\r\n                },\r\n                color: '#E7505A',\r\n                label: Lang.get('empl_profile.timeoff.used')\r\n            },\r\n            {\r\n                data: barsAccrued,\r\n                bars: {\r\n                    show: true,\r\n                    barWidth: 0.4,\r\n                    align: \"right\"\r\n                },\r\n                color: '#26C281',\r\n                label: Lang.get('empl_profile.timeoff.accrued')\r\n            }, {\r\n                data: lineBalance,\r\n                lines: {show: true},\r\n                points: {show: true},\r\n                color: '#3598DC',\r\n                label: Lang.get('empl_profile.timeoff.balance'),\r\n                animator: {start: 100, steps: data.res.length, duration: 1000, direction: \"right\"}\r\n            }],\r\n                {\r\n                    axisLabels: {\r\n                        show: true\r\n                    },\r\n                    yaxes: [{\r\n                            axisLabel: window.DxEmpTimeoff.getUnit()\r\n                        }],\r\n                    xaxis: {\r\n                        ticks: categories\r\n                    },\r\n                    grid: {\r\n                        hoverable: true\r\n                    }\r\n                });\r\n\r\n        window.DxEmpTimeoff.hideLoading();\r\n    },\r\n    /**\r\n     * Shows tooltip on chart hover\r\n     * @param {object} event Event caller\r\n     * @param {object} pos Mouse position\r\n     * @param {object} item Hovered item\r\n     * @returns {undefined}\r\n     */\r\n    onPlotHover: function (event, pos, item) {\r\n        if (item) {\r\n            var y = item.datapoint[1].toFixed(2);\r\n\r\n            $(\"#dx-emp-timeoff-chart-tooltip\").html(item.series.label + \": \" + y + ' ' + window.DxEmpTimeoff.getUnit())\r\n                    .css({top: pos.pageY + 20, left: pos.pageX + 5})\r\n                    .fadeIn(200);\r\n        } else {\r\n            $(\"#dx-emp-timeoff-chart-tooltip\").hide();\r\n        }\r\n    },\r\n    /**\r\n     * Initiates date picker for filter\r\n     * @returns {undefined}\r\n     */\r\n    initFilterDatePicker: function () {\r\n        $('.dx-emp-timeoff-filter-year-btn').click(function (event) {\r\n            $('#dx-emp-timeoff-filter-year-input').data('daterangepicker').toggle();\r\n        });\r\n\r\n        $('#dx-emp-timeoff-filter-year-input').daterangepicker({\r\n            locale: {\r\n                \"format\": window.DxEmpTimeoff.dateFormat,\r\n                \"separator\": \" - \",\r\n                \"applyLabel\": Lang.get('date_range.btn_set'),\r\n                \"cancelLabel\": Lang.get('date_range.btn_cancel'),\r\n                \"fromLabel\": Lang.get('date_range.lbl_from'),\r\n                \"toLabel\": Lang.get('date_range.lbl_to'),\r\n                \"customRangeLabel\": Lang.get('date_range.lbl_interval'),\r\n                \"daysOfWeek\": [\r\n                    Lang.get('date_range.d_7'),\r\n                    Lang.get('date_range.d_1'),\r\n                    Lang.get('date_range.d_2'),\r\n                    Lang.get('date_range.d_3'),\r\n                    Lang.get('date_range.d_4'),\r\n                    Lang.get('date_range.d_5'),\r\n                    Lang.get('date_range.d_6')\r\n                ],\r\n                \"monthNames\": [Lang.get('date_range.m_jan'), Lang.get('date_range.m_feb'), Lang.get('date_range.m_mar'), Lang.get('date_range.m_apr'), Lang.get('date_range.m_may'), Lang.get('date_range.m_jun'), Lang.get('date_range.m_jul'), Lang.get('date_range.m_aug'), Lang.get('date_range.m_sep'), Lang.get('date_range.m_oct'), Lang.get('date_range.m_nov'), Lang.get('date_range.m_dec')],\r\n                \"firstDay\": 1\r\n            },\r\n            \"startDate\": window.DxEmpTimeoff.dateFrom,\r\n            \"endDate\": window.DxEmpTimeoff.dateTo,\r\n            \"showDropdowns\": true\r\n        }, window.DxEmpTimeoff.yearSelect);\r\n    },\r\n    /**\r\n     * Event callback when filter's year value is selected\r\n     * @param {object} e Event caller\r\n     * @returns {undefined}\r\n     */\r\n    yearSelect: function (start, end, label) {\r\n        window.DxEmpTimeoff.dateFrom = start;\r\n        window.DxEmpTimeoff.dateTo = end;\r\n\r\n        $('.dx-emp-timeoff-curr-year').html(start.format(window.DxEmpTimeoff.dateFormat) + ' - ' + end.format(window.DxEmpTimeoff.dateFormat));\r\n\r\n        window.DxEmpTimeoff.setDataRefreshRequest();\r\n    },\r\n    /**\r\n     * Event callback when filter's time off type value is selected\r\n     * @param {object} e Event caller\r\n     * @returns {undefined}\r\n     */\r\n    timeoffSelect: function (e) {\r\n        var btn = $(e.target);\r\n\r\n        window.DxEmpTimeoff.timeoff = btn.data('value');\r\n        window.DxEmpTimeoff.timeoffTitle = btn.data('title');\r\n        window.DxEmpTimeoff.timeoffIsAccrualHours = btn.data('is_accrual_hours');\r\n\r\n        $('.dx-emp-timeoff-curr-timeoff').html(window.DxEmpTimeoff.timeoffTitle);\r\n\r\n        window.DxEmpTimeoff.setDataRefreshRequest();\r\n    },\r\n    /**\r\n     * Shows loading box\r\n     * @returns {undefined}\r\n     */\r\n    showLoading: function () {\r\n        window.DxEmpTimeoff.inProgressCount++;\r\n        show_page_splash(1);\r\n    },\r\n    /**\r\n     * Hides loading box\r\n     * @returns {undefined}\r\n     */\r\n    hideLoading: function () {\r\n        window.DxEmpTimeoff.isSending = false;\r\n        hide_page_splash(1);\r\n    },\r\n    /**\r\n     * Event when ajax request gets error\r\n     * @param {array} data Data containing error information\r\n     * @returns {undefined}\r\n     */\r\n    onAjaxError: function (data) {\r\n        window.DxEmpTimeoff.hideLoading();\r\n    }\r\n};","/*!\r\n* jquery.counterup.js 1.0\r\n*\r\n* Copyright 2013, Benjamin Intal http://gambit.ph @bfintal\r\n* Released under the GPL v2 License\r\n*\r\n* Date: Nov 26, 2013\r\n*/\r\n!function(t){\"use strict\";t.fn.counterUp=function(e){var n=t.extend({time:400,delay:10},e);return this.each(function(){var e=t(this),u=n,a=function(){var t=u.time/u.delay,n=e.attr(\"data-value\"),a=[n],r=/[0-9]+,[0-9]+/.test(n);n=n.replace(/,/g,\"\");for(var o=(/^[0-9]+$/.test(n),/^[0-9]+\\.[0-9]+$/.test(n)),c=o?(n.split(\".\")[1]||[]).length:0,d=t;d>=1;d--){var i=parseInt(n/t*d);if(o&&(i=parseFloat(n/t*d).toFixed(c)),r)for(;/(\\d+)(\\d{3})/.test(i.toString());)i=i.toString().replace(/(\\d+)(\\d{3})/,\"$1,$2\");a.unshift(i)}e.data(\"counterup-nums\",a),e.text(\"0\");var s=function(){e.text(e.data(\"counterup-nums\").shift()),e.data(\"counterup-nums\").length?setTimeout(e.data(\"counterup-func\"),u.delay):(delete e.data(\"counterup-nums\"),e.data(\"counterup-nums\",null),e.data(\"counterup-func\",null))};e.data(\"counterup-func\",s),setTimeout(e.data(\"counterup-func\"),u.delay)};e.waypoint(a,{offset:\"100%\",triggerOnce:!0})})}}(jQuery);","// Generated by CoffeeScript 1.6.2\r\n/*\r\njQuery Waypoints - v2.0.3\r\nCopyright (c) 2011-2013 Caleb Troughton\r\nDual licensed under the MIT license and GPL license.\r\nhttps://github.com/imakewebthings/jquery-waypoints/blob/master/licenses.txt\r\n*/\r\n(function(){var t=[].indexOf||function(t){for(var e=0,n=this.length;e<n;e++){if(e in this&&this[e]===t)return e}return-1},e=[].slice;(function(t,e){if(typeof define===\"function\"&&define.amd){return define(\"waypoints\",[\"jquery\"],function(n){return e(n,t)})}else{return e(t.jQuery,t)}})(this,function(n,r){var i,o,l,s,f,u,a,c,h,d,p,y,v,w,g,m;i=n(r);c=t.call(r,\"ontouchstart\")>=0;s={horizontal:{},vertical:{}};f=1;a={};u=\"waypoints-context-id\";p=\"resize.waypoints\";y=\"scroll.waypoints\";v=1;w=\"waypoints-waypoint-ids\";g=\"waypoint\";m=\"waypoints\";o=function(){function t(t){var e=this;this.$element=t;this.element=t[0];this.didResize=false;this.didScroll=false;this.id=\"context\"+f++;this.oldScroll={x:t.scrollLeft(),y:t.scrollTop()};this.waypoints={horizontal:{},vertical:{}};t.data(u,this.id);a[this.id]=this;t.bind(y,function(){var t;if(!(e.didScroll||c)){e.didScroll=true;t=function(){e.doScroll();return e.didScroll=false};return r.setTimeout(t,n[m].settings.scrollThrottle)}});t.bind(p,function(){var t;if(!e.didResize){e.didResize=true;t=function(){n[m](\"refresh\");return e.didResize=false};return r.setTimeout(t,n[m].settings.resizeThrottle)}})}t.prototype.doScroll=function(){var t,e=this;t={horizontal:{newScroll:this.$element.scrollLeft(),oldScroll:this.oldScroll.x,forward:\"right\",backward:\"left\"},vertical:{newScroll:this.$element.scrollTop(),oldScroll:this.oldScroll.y,forward:\"down\",backward:\"up\"}};if(c&&(!t.vertical.oldScroll||!t.vertical.newScroll)){n[m](\"refresh\")}n.each(t,function(t,r){var i,o,l;l=[];o=r.newScroll>r.oldScroll;i=o?r.forward:r.backward;n.each(e.waypoints[t],function(t,e){var n,i;if(r.oldScroll<(n=e.offset)&&n<=r.newScroll){return l.push(e)}else if(r.newScroll<(i=e.offset)&&i<=r.oldScroll){return l.push(e)}});l.sort(function(t,e){return t.offset-e.offset});if(!o){l.reverse()}return n.each(l,function(t,e){if(e.options.continuous||t===l.length-1){return e.trigger([i])}})});return this.oldScroll={x:t.horizontal.newScroll,y:t.vertical.newScroll}};t.prototype.refresh=function(){var t,e,r,i=this;r=n.isWindow(this.element);e=this.$element.offset();this.doScroll();t={horizontal:{contextOffset:r?0:e.left,contextScroll:r?0:this.oldScroll.x,contextDimension:this.$element.width(),oldScroll:this.oldScroll.x,forward:\"right\",backward:\"left\",offsetProp:\"left\"},vertical:{contextOffset:r?0:e.top,contextScroll:r?0:this.oldScroll.y,contextDimension:r?n[m](\"viewportHeight\"):this.$element.height(),oldScroll:this.oldScroll.y,forward:\"down\",backward:\"up\",offsetProp:\"top\"}};return n.each(t,function(t,e){return n.each(i.waypoints[t],function(t,r){var i,o,l,s,f;i=r.options.offset;l=r.offset;o=n.isWindow(r.element)?0:r.$element.offset()[e.offsetProp];if(n.isFunction(i)){i=i.apply(r.element)}else if(typeof i===\"string\"){i=parseFloat(i);if(r.options.offset.indexOf(\"%\")>-1){i=Math.ceil(e.contextDimension*i/100)}}r.offset=o-e.contextOffset+e.contextScroll-i;if(r.options.onlyOnScroll&&l!=null||!r.enabled){return}if(l!==null&&l<(s=e.oldScroll)&&s<=r.offset){return r.trigger([e.backward])}else if(l!==null&&l>(f=e.oldScroll)&&f>=r.offset){return r.trigger([e.forward])}else if(l===null&&e.oldScroll>=r.offset){return r.trigger([e.forward])}})})};t.prototype.checkEmpty=function(){if(n.isEmptyObject(this.waypoints.horizontal)&&n.isEmptyObject(this.waypoints.vertical)){this.$element.unbind([p,y].join(\" \"));return delete a[this.id]}};return t}();l=function(){function t(t,e,r){var i,o;r=n.extend({},n.fn[g].defaults,r);if(r.offset===\"bottom-in-view\"){r.offset=function(){var t;t=n[m](\"viewportHeight\");if(!n.isWindow(e.element)){t=e.$element.height()}return t-n(this).outerHeight()}}this.$element=t;this.element=t[0];this.axis=r.horizontal?\"horizontal\":\"vertical\";this.callback=r.handler;this.context=e;this.enabled=r.enabled;this.id=\"waypoints\"+v++;this.offset=null;this.options=r;e.waypoints[this.axis][this.id]=this;s[this.axis][this.id]=this;i=(o=t.data(w))!=null?o:[];i.push(this.id);t.data(w,i)}t.prototype.trigger=function(t){if(!this.enabled){return}if(this.callback!=null){this.callback.apply(this.element,t)}if(this.options.triggerOnce){return this.destroy()}};t.prototype.disable=function(){return this.enabled=false};t.prototype.enable=function(){this.context.refresh();return this.enabled=true};t.prototype.destroy=function(){delete s[this.axis][this.id];delete this.context.waypoints[this.axis][this.id];return this.context.checkEmpty()};t.getWaypointsByElement=function(t){var e,r;r=n(t).data(w);if(!r){return[]}e=n.extend({},s.horizontal,s.vertical);return n.map(r,function(t){return e[t]})};return t}();d={init:function(t,e){var r;if(e==null){e={}}if((r=e.handler)==null){e.handler=t}this.each(function(){var t,r,i,s;t=n(this);i=(s=e.context)!=null?s:n.fn[g].defaults.context;if(!n.isWindow(i)){i=t.closest(i)}i=n(i);r=a[i.data(u)];if(!r){r=new o(i)}return new l(t,r,e)});n[m](\"refresh\");return this},disable:function(){return d._invoke(this,\"disable\")},enable:function(){return d._invoke(this,\"enable\")},destroy:function(){return d._invoke(this,\"destroy\")},prev:function(t,e){return d._traverse.call(this,t,e,function(t,e,n){if(e>0){return t.push(n[e-1])}})},next:function(t,e){return d._traverse.call(this,t,e,function(t,e,n){if(e<n.length-1){return t.push(n[e+1])}})},_traverse:function(t,e,i){var o,l;if(t==null){t=\"vertical\"}if(e==null){e=r}l=h.aggregate(e);o=[];this.each(function(){var e;e=n.inArray(this,l[t]);return i(o,e,l[t])});return this.pushStack(o)},_invoke:function(t,e){t.each(function(){var t;t=l.getWaypointsByElement(this);return n.each(t,function(t,n){n[e]();return true})});return this}};n.fn[g]=function(){var t,r;r=arguments[0],t=2<=arguments.length?e.call(arguments,1):[];if(d[r]){return d[r].apply(this,t)}else if(n.isFunction(r)){return d.init.apply(this,arguments)}else if(n.isPlainObject(r)){return d.init.apply(this,[null,r])}else if(!r){return n.error(\"jQuery Waypoints needs a callback function or handler option.\")}else{return n.error(\"The \"+r+\" method does not exist in jQuery Waypoints.\")}};n.fn[g].defaults={context:r,continuous:true,enabled:true,horizontal:false,offset:0,triggerOnce:false};h={refresh:function(){return n.each(a,function(t,e){return e.refresh()})},viewportHeight:function(){var t;return(t=r.innerHeight)!=null?t:i.height()},aggregate:function(t){var e,r,i;e=s;if(t){e=(i=a[n(t).data(u)])!=null?i.waypoints:void 0}if(!e){return[]}r={horizontal:[],vertical:[]};n.each(r,function(t,i){n.each(e[t],function(t,e){return i.push(e)});i.sort(function(t,e){return t.offset-e.offset});r[t]=n.map(i,function(t){return t.element});return r[t]=n.unique(r[t])});return r},above:function(t){if(t==null){t=r}return h._filter(t,\"vertical\",function(t,e){return e.offset<=t.oldScroll.y})},below:function(t){if(t==null){t=r}return h._filter(t,\"vertical\",function(t,e){return e.offset>t.oldScroll.y})},left:function(t){if(t==null){t=r}return h._filter(t,\"horizontal\",function(t,e){return e.offset<=t.oldScroll.x})},right:function(t){if(t==null){t=r}return h._filter(t,\"horizontal\",function(t,e){return e.offset>t.oldScroll.x})},enable:function(){return h._invoke(\"enable\")},disable:function(){return h._invoke(\"disable\")},destroy:function(){return h._invoke(\"destroy\")},extendFn:function(t,e){return d[t]=e},_invoke:function(t){var e;e=n.extend({},s.vertical,s.horizontal);return n.each(e,function(e,n){n[t]();return true})},_filter:function(t,e,r){var i,o;i=a[n(t).data(u)];if(!i){return[]}o=[];n.each(i.waypoints[e],function(t,e){if(r(i,e)){return o.push(e)}});o.sort(function(t,e){return t.offset-e.offset});return n.map(o,function(t){return t.element})}};n[m]=function(){var t,n;n=arguments[0],t=2<=arguments.length?e.call(arguments,1):[];if(h[n]){return h[n].apply(null,t)}else{return h.aggregate.call(null,n)}};n[m].settings={resizeThrottle:100,scrollThrottle:30};return i.load(function(){return n[m](\"refresh\")})})}).call(this);","/* Javascript plotting library for jQuery, version 0.8.3.\r\n\r\nCopyright (c) 2007-2014 IOLA and Ole Laursen.\r\nLicensed under the MIT license.\r\n\r\n*/\r\n(function($){$.color={};$.color.make=function(r,g,b,a){var o={};o.r=r||0;o.g=g||0;o.b=b||0;o.a=a!=null?a:1;o.add=function(c,d){for(var i=0;i<c.length;++i)o[c.charAt(i)]+=d;return o.normalize()};o.scale=function(c,f){for(var i=0;i<c.length;++i)o[c.charAt(i)]*=f;return o.normalize()};o.toString=function(){if(o.a>=1){return\"rgb(\"+[o.r,o.g,o.b].join(\",\")+\")\"}else{return\"rgba(\"+[o.r,o.g,o.b,o.a].join(\",\")+\")\"}};o.normalize=function(){function clamp(min,value,max){return value<min?min:value>max?max:value}o.r=clamp(0,parseInt(o.r),255);o.g=clamp(0,parseInt(o.g),255);o.b=clamp(0,parseInt(o.b),255);o.a=clamp(0,o.a,1);return o};o.clone=function(){return $.color.make(o.r,o.b,o.g,o.a)};return o.normalize()};$.color.extract=function(elem,css){var c;do{c=elem.css(css).toLowerCase();if(c!=\"\"&&c!=\"transparent\")break;elem=elem.parent()}while(elem.length&&!$.nodeName(elem.get(0),\"body\"));if(c==\"rgba(0, 0, 0, 0)\")c=\"transparent\";return $.color.parse(c)};$.color.parse=function(str){var res,m=$.color.make;if(res=/rgb\\(\\s*([0-9]{1,3})\\s*,\\s*([0-9]{1,3})\\s*,\\s*([0-9]{1,3})\\s*\\)/.exec(str))return m(parseInt(res[1],10),parseInt(res[2],10),parseInt(res[3],10));if(res=/rgba\\(\\s*([0-9]{1,3})\\s*,\\s*([0-9]{1,3})\\s*,\\s*([0-9]{1,3})\\s*,\\s*([0-9]+(?:\\.[0-9]+)?)\\s*\\)/.exec(str))return m(parseInt(res[1],10),parseInt(res[2],10),parseInt(res[3],10),parseFloat(res[4]));if(res=/rgb\\(\\s*([0-9]+(?:\\.[0-9]+)?)\\%\\s*,\\s*([0-9]+(?:\\.[0-9]+)?)\\%\\s*,\\s*([0-9]+(?:\\.[0-9]+)?)\\%\\s*\\)/.exec(str))return m(parseFloat(res[1])*2.55,parseFloat(res[2])*2.55,parseFloat(res[3])*2.55);if(res=/rgba\\(\\s*([0-9]+(?:\\.[0-9]+)?)\\%\\s*,\\s*([0-9]+(?:\\.[0-9]+)?)\\%\\s*,\\s*([0-9]+(?:\\.[0-9]+)?)\\%\\s*,\\s*([0-9]+(?:\\.[0-9]+)?)\\s*\\)/.exec(str))return m(parseFloat(res[1])*2.55,parseFloat(res[2])*2.55,parseFloat(res[3])*2.55,parseFloat(res[4]));if(res=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(str))return m(parseInt(res[1],16),parseInt(res[2],16),parseInt(res[3],16));if(res=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(str))return m(parseInt(res[1]+res[1],16),parseInt(res[2]+res[2],16),parseInt(res[3]+res[3],16));var name=$.trim(str).toLowerCase();if(name==\"transparent\")return m(255,255,255,0);else{res=lookupColors[name]||[0,0,0];return m(res[0],res[1],res[2])}};var lookupColors={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]}})(jQuery);(function($){var hasOwnProperty=Object.prototype.hasOwnProperty;if(!$.fn.detach){$.fn.detach=function(){return this.each(function(){if(this.parentNode){this.parentNode.removeChild(this)}})}}function Canvas(cls,container){var element=container.children(\".\"+cls)[0];if(element==null){element=document.createElement(\"canvas\");element.className=cls;$(element).css({direction:\"ltr\",position:\"absolute\",left:0,top:0}).appendTo(container);if(!element.getContext){if(window.G_vmlCanvasManager){element=window.G_vmlCanvasManager.initElement(element)}else{throw new Error(\"Canvas is not available. If you're using IE with a fall-back such as Excanvas, then there's either a mistake in your conditional include, or the page has no DOCTYPE and is rendering in Quirks Mode.\")}}}this.element=element;var context=this.context=element.getContext(\"2d\");var devicePixelRatio=window.devicePixelRatio||1,backingStoreRatio=context.webkitBackingStorePixelRatio||context.mozBackingStorePixelRatio||context.msBackingStorePixelRatio||context.oBackingStorePixelRatio||context.backingStorePixelRatio||1;this.pixelRatio=devicePixelRatio/backingStoreRatio;this.resize(container.width(),container.height());this.textContainer=null;this.text={};this._textCache={}}Canvas.prototype.resize=function(width,height){if(width<=0||height<=0){throw new Error(\"Invalid dimensions for plot, width = \"+width+\", height = \"+height)}var element=this.element,context=this.context,pixelRatio=this.pixelRatio;if(this.width!=width){element.width=width*pixelRatio;element.style.width=width+\"px\";this.width=width}if(this.height!=height){element.height=height*pixelRatio;element.style.height=height+\"px\";this.height=height}context.restore();context.save();context.scale(pixelRatio,pixelRatio)};Canvas.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)};Canvas.prototype.render=function(){var cache=this._textCache;for(var layerKey in cache){if(hasOwnProperty.call(cache,layerKey)){var layer=this.getTextLayer(layerKey),layerCache=cache[layerKey];layer.hide();for(var styleKey in layerCache){if(hasOwnProperty.call(layerCache,styleKey)){var styleCache=layerCache[styleKey];for(var key in styleCache){if(hasOwnProperty.call(styleCache,key)){var positions=styleCache[key].positions;for(var i=0,position;position=positions[i];i++){if(position.active){if(!position.rendered){layer.append(position.element);position.rendered=true}}else{positions.splice(i--,1);if(position.rendered){position.element.detach()}}}if(positions.length==0){delete styleCache[key]}}}}}layer.show()}}};Canvas.prototype.getTextLayer=function(classes){var layer=this.text[classes];if(layer==null){if(this.textContainer==null){this.textContainer=$(\"<div class='flot-text'></div>\").css({position:\"absolute\",top:0,left:0,bottom:0,right:0,\"font-size\":\"smaller\",color:\"#545454\"}).insertAfter(this.element)}layer=this.text[classes]=$(\"<div></div>\").addClass(classes).css({position:\"absolute\",top:0,left:0,bottom:0,right:0}).appendTo(this.textContainer)}return layer};Canvas.prototype.getTextInfo=function(layer,text,font,angle,width){var textStyle,layerCache,styleCache,info;text=\"\"+text;if(typeof font===\"object\"){textStyle=font.style+\" \"+font.variant+\" \"+font.weight+\" \"+font.size+\"px/\"+font.lineHeight+\"px \"+font.family}else{textStyle=font}layerCache=this._textCache[layer];if(layerCache==null){layerCache=this._textCache[layer]={}}styleCache=layerCache[textStyle];if(styleCache==null){styleCache=layerCache[textStyle]={}}info=styleCache[text];if(info==null){var element=$(\"<div></div>\").html(text).css({position:\"absolute\",\"max-width\":width,top:-9999}).appendTo(this.getTextLayer(layer));if(typeof font===\"object\"){element.css({font:textStyle,color:font.color})}else if(typeof font===\"string\"){element.addClass(font)}info=styleCache[text]={width:element.outerWidth(true),height:element.outerHeight(true),element:element,positions:[]};element.detach()}return info};Canvas.prototype.addText=function(layer,x,y,text,font,angle,width,halign,valign){var info=this.getTextInfo(layer,text,font,angle,width),positions=info.positions;if(halign==\"center\"){x-=info.width/2}else if(halign==\"right\"){x-=info.width}if(valign==\"middle\"){y-=info.height/2}else if(valign==\"bottom\"){y-=info.height}for(var i=0,position;position=positions[i];i++){if(position.x==x&&position.y==y){position.active=true;return}}position={active:true,rendered:false,element:positions.length?info.element.clone():info.element,x:x,y:y};positions.push(position);position.element.css({top:Math.round(y),left:Math.round(x),\"text-align\":halign})};Canvas.prototype.removeText=function(layer,x,y,text,font,angle){if(text==null){var layerCache=this._textCache[layer];if(layerCache!=null){for(var styleKey in layerCache){if(hasOwnProperty.call(layerCache,styleKey)){var styleCache=layerCache[styleKey];for(var key in styleCache){if(hasOwnProperty.call(styleCache,key)){var positions=styleCache[key].positions;for(var i=0,position;position=positions[i];i++){position.active=false}}}}}}}else{var positions=this.getTextInfo(layer,text,font,angle).positions;for(var i=0,position;position=positions[i];i++){if(position.x==x&&position.y==y){position.active=false}}}};function Plot(placeholder,data_,options_,plugins){var series=[],options={colors:[\"#edc240\",\"#afd8f8\",\"#cb4b4b\",\"#4da74d\",\"#9440ed\"],legend:{show:true,noColumns:1,labelFormatter:null,labelBoxBorderColor:\"#ccc\",container:null,position:\"ne\",margin:5,backgroundColor:null,backgroundOpacity:.85,sorted:null},xaxis:{show:null,position:\"bottom\",mode:null,font:null,color:null,tickColor:null,transform:null,inverseTransform:null,min:null,max:null,autoscaleMargin:null,ticks:null,tickFormatter:null,labelWidth:null,labelHeight:null,reserveSpace:null,tickLength:null,alignTicksWithAxis:null,tickDecimals:null,tickSize:null,minTickSize:null},yaxis:{autoscaleMargin:.02,position:\"left\"},xaxes:[],yaxes:[],series:{points:{show:false,radius:3,lineWidth:2,fill:true,fillColor:\"#ffffff\",symbol:\"circle\"},lines:{lineWidth:2,fill:false,fillColor:null,steps:false},bars:{show:false,lineWidth:2,barWidth:1,fill:true,fillColor:null,align:\"left\",horizontal:false,zero:true},shadowSize:3,highlightColor:null},grid:{show:true,aboveData:false,color:\"#545454\",backgroundColor:null,borderColor:null,tickColor:null,margin:0,labelMargin:5,axisMargin:8,borderWidth:2,minBorderMargin:null,markings:null,markingsColor:\"#f4f4f4\",markingsLineWidth:2,clickable:false,hoverable:false,autoHighlight:true,mouseActiveRadius:10},interaction:{redrawOverlayInterval:1e3/60},hooks:{}},surface=null,overlay=null,eventHolder=null,ctx=null,octx=null,xaxes=[],yaxes=[],plotOffset={left:0,right:0,top:0,bottom:0},plotWidth=0,plotHeight=0,hooks={processOptions:[],processRawData:[],processDatapoints:[],processOffset:[],drawBackground:[],drawSeries:[],draw:[],bindEvents:[],drawOverlay:[],shutdown:[]},plot=this;plot.setData=setData;plot.setupGrid=setupGrid;plot.draw=draw;plot.getPlaceholder=function(){return placeholder};plot.getCanvas=function(){return surface.element};plot.getPlotOffset=function(){return plotOffset};plot.width=function(){return plotWidth};plot.height=function(){return plotHeight};plot.offset=function(){var o=eventHolder.offset();o.left+=plotOffset.left;o.top+=plotOffset.top;return o};plot.getData=function(){return series};plot.getAxes=function(){var res={},i;$.each(xaxes.concat(yaxes),function(_,axis){if(axis)res[axis.direction+(axis.n!=1?axis.n:\"\")+\"axis\"]=axis});return res};plot.getXAxes=function(){return xaxes};plot.getYAxes=function(){return yaxes};plot.c2p=canvasToAxisCoords;plot.p2c=axisToCanvasCoords;plot.getOptions=function(){return options};plot.highlight=highlight;plot.unhighlight=unhighlight;plot.triggerRedrawOverlay=triggerRedrawOverlay;plot.pointOffset=function(point){return{left:parseInt(xaxes[axisNumber(point,\"x\")-1].p2c(+point.x)+plotOffset.left,10),top:parseInt(yaxes[axisNumber(point,\"y\")-1].p2c(+point.y)+plotOffset.top,10)}};plot.shutdown=shutdown;plot.destroy=function(){shutdown();placeholder.removeData(\"plot\").empty();series=[];options=null;surface=null;overlay=null;eventHolder=null;ctx=null;octx=null;xaxes=[];yaxes=[];hooks=null;highlights=[];plot=null};plot.resize=function(){var width=placeholder.width(),height=placeholder.height();surface.resize(width,height);overlay.resize(width,height)};plot.hooks=hooks;initPlugins(plot);parseOptions(options_);setupCanvases();setData(data_);setupGrid();draw();bindEvents();function executeHooks(hook,args){args=[plot].concat(args);for(var i=0;i<hook.length;++i)hook[i].apply(this,args)}function initPlugins(){var classes={Canvas:Canvas};for(var i=0;i<plugins.length;++i){var p=plugins[i];p.init(plot,classes);if(p.options)$.extend(true,options,p.options)}}function parseOptions(opts){$.extend(true,options,opts);if(opts&&opts.colors){options.colors=opts.colors}if(options.xaxis.color==null)options.xaxis.color=$.color.parse(options.grid.color).scale(\"a\",.22).toString();if(options.yaxis.color==null)options.yaxis.color=$.color.parse(options.grid.color).scale(\"a\",.22).toString();if(options.xaxis.tickColor==null)options.xaxis.tickColor=options.grid.tickColor||options.xaxis.color;if(options.yaxis.tickColor==null)options.yaxis.tickColor=options.grid.tickColor||options.yaxis.color;if(options.grid.borderColor==null)options.grid.borderColor=options.grid.color;if(options.grid.tickColor==null)options.grid.tickColor=$.color.parse(options.grid.color).scale(\"a\",.22).toString();var i,axisOptions,axisCount,fontSize=placeholder.css(\"font-size\"),fontSizeDefault=fontSize?+fontSize.replace(\"px\",\"\"):13,fontDefaults={style:placeholder.css(\"font-style\"),size:Math.round(.8*fontSizeDefault),variant:placeholder.css(\"font-variant\"),weight:placeholder.css(\"font-weight\"),family:placeholder.css(\"font-family\")};axisCount=options.xaxes.length||1;for(i=0;i<axisCount;++i){axisOptions=options.xaxes[i];if(axisOptions&&!axisOptions.tickColor){axisOptions.tickColor=axisOptions.color}axisOptions=$.extend(true,{},options.xaxis,axisOptions);options.xaxes[i]=axisOptions;if(axisOptions.font){axisOptions.font=$.extend({},fontDefaults,axisOptions.font);if(!axisOptions.font.color){axisOptions.font.color=axisOptions.color}if(!axisOptions.font.lineHeight){axisOptions.font.lineHeight=Math.round(axisOptions.font.size*1.15)}}}axisCount=options.yaxes.length||1;for(i=0;i<axisCount;++i){axisOptions=options.yaxes[i];if(axisOptions&&!axisOptions.tickColor){axisOptions.tickColor=axisOptions.color}axisOptions=$.extend(true,{},options.yaxis,axisOptions);options.yaxes[i]=axisOptions;if(axisOptions.font){axisOptions.font=$.extend({},fontDefaults,axisOptions.font);if(!axisOptions.font.color){axisOptions.font.color=axisOptions.color}if(!axisOptions.font.lineHeight){axisOptions.font.lineHeight=Math.round(axisOptions.font.size*1.15)}}}if(options.xaxis.noTicks&&options.xaxis.ticks==null)options.xaxis.ticks=options.xaxis.noTicks;if(options.yaxis.noTicks&&options.yaxis.ticks==null)options.yaxis.ticks=options.yaxis.noTicks;if(options.x2axis){options.xaxes[1]=$.extend(true,{},options.xaxis,options.x2axis);options.xaxes[1].position=\"top\";if(options.x2axis.min==null){options.xaxes[1].min=null}if(options.x2axis.max==null){options.xaxes[1].max=null}}if(options.y2axis){options.yaxes[1]=$.extend(true,{},options.yaxis,options.y2axis);options.yaxes[1].position=\"right\";if(options.y2axis.min==null){options.yaxes[1].min=null}if(options.y2axis.max==null){options.yaxes[1].max=null}}if(options.grid.coloredAreas)options.grid.markings=options.grid.coloredAreas;if(options.grid.coloredAreasColor)options.grid.markingsColor=options.grid.coloredAreasColor;if(options.lines)$.extend(true,options.series.lines,options.lines);if(options.points)$.extend(true,options.series.points,options.points);if(options.bars)$.extend(true,options.series.bars,options.bars);if(options.shadowSize!=null)options.series.shadowSize=options.shadowSize;if(options.highlightColor!=null)options.series.highlightColor=options.highlightColor;for(i=0;i<options.xaxes.length;++i)getOrCreateAxis(xaxes,i+1).options=options.xaxes[i];for(i=0;i<options.yaxes.length;++i)getOrCreateAxis(yaxes,i+1).options=options.yaxes[i];for(var n in hooks)if(options.hooks[n]&&options.hooks[n].length)hooks[n]=hooks[n].concat(options.hooks[n]);executeHooks(hooks.processOptions,[options])}function setData(d){series=parseData(d);fillInSeriesOptions();processData()}function parseData(d){var res=[];for(var i=0;i<d.length;++i){var s=$.extend(true,{},options.series);if(d[i].data!=null){s.data=d[i].data;delete d[i].data;$.extend(true,s,d[i]);d[i].data=s.data}else s.data=d[i];res.push(s)}return res}function axisNumber(obj,coord){var a=obj[coord+\"axis\"];if(typeof a==\"object\")a=a.n;if(typeof a!=\"number\")a=1;return a}function allAxes(){return $.grep(xaxes.concat(yaxes),function(a){return a})}function canvasToAxisCoords(pos){var res={},i,axis;for(i=0;i<xaxes.length;++i){axis=xaxes[i];if(axis&&axis.used)res[\"x\"+axis.n]=axis.c2p(pos.left)}for(i=0;i<yaxes.length;++i){axis=yaxes[i];if(axis&&axis.used)res[\"y\"+axis.n]=axis.c2p(pos.top)}if(res.x1!==undefined)res.x=res.x1;if(res.y1!==undefined)res.y=res.y1;return res}function axisToCanvasCoords(pos){var res={},i,axis,key;for(i=0;i<xaxes.length;++i){axis=xaxes[i];if(axis&&axis.used){key=\"x\"+axis.n;if(pos[key]==null&&axis.n==1)key=\"x\";if(pos[key]!=null){res.left=axis.p2c(pos[key]);break}}}for(i=0;i<yaxes.length;++i){axis=yaxes[i];if(axis&&axis.used){key=\"y\"+axis.n;if(pos[key]==null&&axis.n==1)key=\"y\";if(pos[key]!=null){res.top=axis.p2c(pos[key]);break}}}return res}function getOrCreateAxis(axes,number){if(!axes[number-1])axes[number-1]={n:number,direction:axes==xaxes?\"x\":\"y\",options:$.extend(true,{},axes==xaxes?options.xaxis:options.yaxis)};return axes[number-1]}function fillInSeriesOptions(){var neededColors=series.length,maxIndex=-1,i;for(i=0;i<series.length;++i){var sc=series[i].color;if(sc!=null){neededColors--;if(typeof sc==\"number\"&&sc>maxIndex){maxIndex=sc}}}if(neededColors<=maxIndex){neededColors=maxIndex+1}var c,colors=[],colorPool=options.colors,colorPoolSize=colorPool.length,variation=0;for(i=0;i<neededColors;i++){c=$.color.parse(colorPool[i%colorPoolSize]||\"#666\");if(i%colorPoolSize==0&&i){if(variation>=0){if(variation<.5){variation=-variation-.2}else variation=0}else variation=-variation}colors[i]=c.scale(\"rgb\",1+variation)}var colori=0,s;for(i=0;i<series.length;++i){s=series[i];if(s.color==null){s.color=colors[colori].toString();++colori}else if(typeof s.color==\"number\")s.color=colors[s.color].toString();if(s.lines.show==null){var v,show=true;for(v in s)if(s[v]&&s[v].show){show=false;break}if(show)s.lines.show=true}if(s.lines.zero==null){s.lines.zero=!!s.lines.fill}s.xaxis=getOrCreateAxis(xaxes,axisNumber(s,\"x\"));s.yaxis=getOrCreateAxis(yaxes,axisNumber(s,\"y\"))}}function processData(){var topSentry=Number.POSITIVE_INFINITY,bottomSentry=Number.NEGATIVE_INFINITY,fakeInfinity=Number.MAX_VALUE,i,j,k,m,length,s,points,ps,x,y,axis,val,f,p,data,format;function updateAxis(axis,min,max){if(min<axis.datamin&&min!=-fakeInfinity)axis.datamin=min;if(max>axis.datamax&&max!=fakeInfinity)axis.datamax=max}$.each(allAxes(),function(_,axis){axis.datamin=topSentry;axis.datamax=bottomSentry;axis.used=false});for(i=0;i<series.length;++i){s=series[i];s.datapoints={points:[]};executeHooks(hooks.processRawData,[s,s.data,s.datapoints])}for(i=0;i<series.length;++i){s=series[i];data=s.data;format=s.datapoints.format;if(!format){format=[];format.push({x:true,number:true,required:true});format.push({y:true,number:true,required:true});if(s.bars.show||s.lines.show&&s.lines.fill){var autoscale=!!(s.bars.show&&s.bars.zero||s.lines.show&&s.lines.zero);format.push({y:true,number:true,required:false,defaultValue:0,autoscale:autoscale});if(s.bars.horizontal){delete format[format.length-1].y;format[format.length-1].x=true}}s.datapoints.format=format}if(s.datapoints.pointsize!=null)continue;s.datapoints.pointsize=format.length;ps=s.datapoints.pointsize;points=s.datapoints.points;var insertSteps=s.lines.show&&s.lines.steps;s.xaxis.used=s.yaxis.used=true;for(j=k=0;j<data.length;++j,k+=ps){p=data[j];var nullify=p==null;if(!nullify){for(m=0;m<ps;++m){val=p[m];f=format[m];if(f){if(f.number&&val!=null){val=+val;if(isNaN(val))val=null;else if(val==Infinity)val=fakeInfinity;else if(val==-Infinity)val=-fakeInfinity}if(val==null){if(f.required)nullify=true;if(f.defaultValue!=null)val=f.defaultValue}}points[k+m]=val}}if(nullify){for(m=0;m<ps;++m){val=points[k+m];if(val!=null){f=format[m];if(f.autoscale!==false){if(f.x){updateAxis(s.xaxis,val,val)}if(f.y){updateAxis(s.yaxis,val,val)}}}points[k+m]=null}}else{if(insertSteps&&k>0&&points[k-ps]!=null&&points[k-ps]!=points[k]&&points[k-ps+1]!=points[k+1]){for(m=0;m<ps;++m)points[k+ps+m]=points[k+m];points[k+1]=points[k-ps+1];k+=ps}}}}for(i=0;i<series.length;++i){s=series[i];executeHooks(hooks.processDatapoints,[s,s.datapoints])}for(i=0;i<series.length;++i){s=series[i];points=s.datapoints.points;ps=s.datapoints.pointsize;format=s.datapoints.format;var xmin=topSentry,ymin=topSentry,xmax=bottomSentry,ymax=bottomSentry;for(j=0;j<points.length;j+=ps){if(points[j]==null)continue;for(m=0;m<ps;++m){val=points[j+m];f=format[m];if(!f||f.autoscale===false||val==fakeInfinity||val==-fakeInfinity)continue;if(f.x){if(val<xmin)xmin=val;if(val>xmax)xmax=val}if(f.y){if(val<ymin)ymin=val;if(val>ymax)ymax=val}}}if(s.bars.show){var delta;switch(s.bars.align){case\"left\":delta=0;break;case\"right\":delta=-s.bars.barWidth;break;default:delta=-s.bars.barWidth/2}if(s.bars.horizontal){ymin+=delta;ymax+=delta+s.bars.barWidth}else{xmin+=delta;xmax+=delta+s.bars.barWidth}}updateAxis(s.xaxis,xmin,xmax);updateAxis(s.yaxis,ymin,ymax)}$.each(allAxes(),function(_,axis){if(axis.datamin==topSentry)axis.datamin=null;if(axis.datamax==bottomSentry)axis.datamax=null})}function setupCanvases(){placeholder.css(\"padding\",0).children().filter(function(){return!$(this).hasClass(\"flot-overlay\")&&!$(this).hasClass(\"flot-base\")}).remove();if(placeholder.css(\"position\")==\"static\")placeholder.css(\"position\",\"relative\");surface=new Canvas(\"flot-base\",placeholder);overlay=new Canvas(\"flot-overlay\",placeholder);ctx=surface.context;octx=overlay.context;eventHolder=$(overlay.element).unbind();var existing=placeholder.data(\"plot\");if(existing){existing.shutdown();overlay.clear()}placeholder.data(\"plot\",plot)}function bindEvents(){if(options.grid.hoverable){eventHolder.mousemove(onMouseMove);eventHolder.bind(\"mouseleave\",onMouseLeave)}if(options.grid.clickable)eventHolder.click(onClick);executeHooks(hooks.bindEvents,[eventHolder])}function shutdown(){if(redrawTimeout)clearTimeout(redrawTimeout);eventHolder.unbind(\"mousemove\",onMouseMove);eventHolder.unbind(\"mouseleave\",onMouseLeave);eventHolder.unbind(\"click\",onClick);executeHooks(hooks.shutdown,[eventHolder])}function setTransformationHelpers(axis){function identity(x){return x}var s,m,t=axis.options.transform||identity,it=axis.options.inverseTransform;if(axis.direction==\"x\"){s=axis.scale=plotWidth/Math.abs(t(axis.max)-t(axis.min));m=Math.min(t(axis.max),t(axis.min))}else{s=axis.scale=plotHeight/Math.abs(t(axis.max)-t(axis.min));s=-s;m=Math.max(t(axis.max),t(axis.min))}if(t==identity)axis.p2c=function(p){return(p-m)*s};else axis.p2c=function(p){return(t(p)-m)*s};if(!it)axis.c2p=function(c){return m+c/s};else axis.c2p=function(c){return it(m+c/s)}}function measureTickLabels(axis){var opts=axis.options,ticks=axis.ticks||[],labelWidth=opts.labelWidth||0,labelHeight=opts.labelHeight||0,maxWidth=labelWidth||(axis.direction==\"x\"?Math.floor(surface.width/(ticks.length||1)):null),legacyStyles=axis.direction+\"Axis \"+axis.direction+axis.n+\"Axis\",layer=\"flot-\"+axis.direction+\"-axis flot-\"+axis.direction+axis.n+\"-axis \"+legacyStyles,font=opts.font||\"flot-tick-label tickLabel\";for(var i=0;i<ticks.length;++i){var t=ticks[i];if(!t.label)continue;var info=surface.getTextInfo(layer,t.label,font,null,maxWidth);labelWidth=Math.max(labelWidth,info.width);labelHeight=Math.max(labelHeight,info.height)}axis.labelWidth=opts.labelWidth||labelWidth;axis.labelHeight=opts.labelHeight||labelHeight}function allocateAxisBoxFirstPhase(axis){var lw=axis.labelWidth,lh=axis.labelHeight,pos=axis.options.position,isXAxis=axis.direction===\"x\",tickLength=axis.options.tickLength,axisMargin=options.grid.axisMargin,padding=options.grid.labelMargin,innermost=true,outermost=true,first=true,found=false;$.each(isXAxis?xaxes:yaxes,function(i,a){if(a&&(a.show||a.reserveSpace)){if(a===axis){found=true}else if(a.options.position===pos){if(found){outermost=false}else{innermost=false}}if(!found){first=false}}});if(outermost){axisMargin=0}if(tickLength==null){tickLength=first?\"full\":5}if(!isNaN(+tickLength))padding+=+tickLength;if(isXAxis){lh+=padding;if(pos==\"bottom\"){plotOffset.bottom+=lh+axisMargin;axis.box={top:surface.height-plotOffset.bottom,height:lh}}else{axis.box={top:plotOffset.top+axisMargin,height:lh};plotOffset.top+=lh+axisMargin}}else{lw+=padding;if(pos==\"left\"){axis.box={left:plotOffset.left+axisMargin,width:lw};plotOffset.left+=lw+axisMargin}else{plotOffset.right+=lw+axisMargin;axis.box={left:surface.width-plotOffset.right,width:lw}}}axis.position=pos;axis.tickLength=tickLength;axis.box.padding=padding;axis.innermost=innermost}function allocateAxisBoxSecondPhase(axis){if(axis.direction==\"x\"){axis.box.left=plotOffset.left-axis.labelWidth/2;axis.box.width=surface.width-plotOffset.left-plotOffset.right+axis.labelWidth}else{axis.box.top=plotOffset.top-axis.labelHeight/2;axis.box.height=surface.height-plotOffset.bottom-plotOffset.top+axis.labelHeight}}function adjustLayoutForThingsStickingOut(){var minMargin=options.grid.minBorderMargin,axis,i;if(minMargin==null){minMargin=0;for(i=0;i<series.length;++i)minMargin=Math.max(minMargin,2*(series[i].points.radius+series[i].points.lineWidth/2))}var margins={left:minMargin,right:minMargin,top:minMargin,bottom:minMargin};$.each(allAxes(),function(_,axis){if(axis.reserveSpace&&axis.ticks&&axis.ticks.length){if(axis.direction===\"x\"){margins.left=Math.max(margins.left,axis.labelWidth/2);margins.right=Math.max(margins.right,axis.labelWidth/2)}else{margins.bottom=Math.max(margins.bottom,axis.labelHeight/2);margins.top=Math.max(margins.top,axis.labelHeight/2)}}});plotOffset.left=Math.ceil(Math.max(margins.left,plotOffset.left));plotOffset.right=Math.ceil(Math.max(margins.right,plotOffset.right));plotOffset.top=Math.ceil(Math.max(margins.top,plotOffset.top));plotOffset.bottom=Math.ceil(Math.max(margins.bottom,plotOffset.bottom))}function setupGrid(){var i,axes=allAxes(),showGrid=options.grid.show;for(var a in plotOffset){var margin=options.grid.margin||0;plotOffset[a]=typeof margin==\"number\"?margin:margin[a]||0}executeHooks(hooks.processOffset,[plotOffset]);for(var a in plotOffset){if(typeof options.grid.borderWidth==\"object\"){plotOffset[a]+=showGrid?options.grid.borderWidth[a]:0}else{plotOffset[a]+=showGrid?options.grid.borderWidth:0}}$.each(axes,function(_,axis){var axisOpts=axis.options;axis.show=axisOpts.show==null?axis.used:axisOpts.show;axis.reserveSpace=axisOpts.reserveSpace==null?axis.show:axisOpts.reserveSpace;setRange(axis)});if(showGrid){var allocatedAxes=$.grep(axes,function(axis){return axis.show||axis.reserveSpace});$.each(allocatedAxes,function(_,axis){setupTickGeneration(axis);setTicks(axis);snapRangeToTicks(axis,axis.ticks);measureTickLabels(axis)});for(i=allocatedAxes.length-1;i>=0;--i)allocateAxisBoxFirstPhase(allocatedAxes[i]);adjustLayoutForThingsStickingOut();$.each(allocatedAxes,function(_,axis){allocateAxisBoxSecondPhase(axis)})}plotWidth=surface.width-plotOffset.left-plotOffset.right;plotHeight=surface.height-plotOffset.bottom-plotOffset.top;$.each(axes,function(_,axis){setTransformationHelpers(axis)});if(showGrid){drawAxisLabels()}insertLegend()}function setRange(axis){var opts=axis.options,min=+(opts.min!=null?opts.min:axis.datamin),max=+(opts.max!=null?opts.max:axis.datamax),delta=max-min;if(delta==0){var widen=max==0?1:.01;if(opts.min==null)min-=widen;if(opts.max==null||opts.min!=null)max+=widen}else{var margin=opts.autoscaleMargin;if(margin!=null){if(opts.min==null){min-=delta*margin;if(min<0&&axis.datamin!=null&&axis.datamin>=0)min=0}if(opts.max==null){max+=delta*margin;if(max>0&&axis.datamax!=null&&axis.datamax<=0)max=0}}}axis.min=min;axis.max=max}function setupTickGeneration(axis){var opts=axis.options;var noTicks;if(typeof opts.ticks==\"number\"&&opts.ticks>0)noTicks=opts.ticks;else noTicks=.3*Math.sqrt(axis.direction==\"x\"?surface.width:surface.height);var delta=(axis.max-axis.min)/noTicks,dec=-Math.floor(Math.log(delta)/Math.LN10),maxDec=opts.tickDecimals;if(maxDec!=null&&dec>maxDec){dec=maxDec}var magn=Math.pow(10,-dec),norm=delta/magn,size;if(norm<1.5){size=1}else if(norm<3){size=2;if(norm>2.25&&(maxDec==null||dec+1<=maxDec)){size=2.5;++dec}}else if(norm<7.5){size=5}else{size=10}size*=magn;if(opts.minTickSize!=null&&size<opts.minTickSize){size=opts.minTickSize}axis.delta=delta;axis.tickDecimals=Math.max(0,maxDec!=null?maxDec:dec);axis.tickSize=opts.tickSize||size;if(opts.mode==\"time\"&&!axis.tickGenerator){throw new Error(\"Time mode requires the flot.time plugin.\")}if(!axis.tickGenerator){axis.tickGenerator=function(axis){var ticks=[],start=floorInBase(axis.min,axis.tickSize),i=0,v=Number.NaN,prev;do{prev=v;v=start+i*axis.tickSize;ticks.push(v);++i}while(v<axis.max&&v!=prev);return ticks};axis.tickFormatter=function(value,axis){var factor=axis.tickDecimals?Math.pow(10,axis.tickDecimals):1;var formatted=\"\"+Math.round(value*factor)/factor;if(axis.tickDecimals!=null){var decimal=formatted.indexOf(\".\");var precision=decimal==-1?0:formatted.length-decimal-1;if(precision<axis.tickDecimals){return(precision?formatted:formatted+\".\")+(\"\"+factor).substr(1,axis.tickDecimals-precision)}}return formatted}}if($.isFunction(opts.tickFormatter))axis.tickFormatter=function(v,axis){return\"\"+opts.tickFormatter(v,axis)};if(opts.alignTicksWithAxis!=null){var otherAxis=(axis.direction==\"x\"?xaxes:yaxes)[opts.alignTicksWithAxis-1];if(otherAxis&&otherAxis.used&&otherAxis!=axis){var niceTicks=axis.tickGenerator(axis);if(niceTicks.length>0){if(opts.min==null)axis.min=Math.min(axis.min,niceTicks[0]);if(opts.max==null&&niceTicks.length>1)axis.max=Math.max(axis.max,niceTicks[niceTicks.length-1])}axis.tickGenerator=function(axis){var ticks=[],v,i;for(i=0;i<otherAxis.ticks.length;++i){v=(otherAxis.ticks[i].v-otherAxis.min)/(otherAxis.max-otherAxis.min);v=axis.min+v*(axis.max-axis.min);ticks.push(v)}return ticks};if(!axis.mode&&opts.tickDecimals==null){var extraDec=Math.max(0,-Math.floor(Math.log(axis.delta)/Math.LN10)+1),ts=axis.tickGenerator(axis);if(!(ts.length>1&&/\\..*0$/.test((ts[1]-ts[0]).toFixed(extraDec))))axis.tickDecimals=extraDec}}}}function setTicks(axis){var oticks=axis.options.ticks,ticks=[];if(oticks==null||typeof oticks==\"number\"&&oticks>0)ticks=axis.tickGenerator(axis);else if(oticks){if($.isFunction(oticks))ticks=oticks(axis);else ticks=oticks}var i,v;axis.ticks=[];for(i=0;i<ticks.length;++i){var label=null;var t=ticks[i];if(typeof t==\"object\"){v=+t[0];if(t.length>1)label=t[1]}else v=+t;if(label==null)label=axis.tickFormatter(v,axis);if(!isNaN(v))axis.ticks.push({v:v,label:label})}}function snapRangeToTicks(axis,ticks){if(axis.options.autoscaleMargin&&ticks.length>0){if(axis.options.min==null)axis.min=Math.min(axis.min,ticks[0].v);if(axis.options.max==null&&ticks.length>1)axis.max=Math.max(axis.max,ticks[ticks.length-1].v)}}function draw(){surface.clear();executeHooks(hooks.drawBackground,[ctx]);var grid=options.grid;if(grid.show&&grid.backgroundColor)drawBackground();if(grid.show&&!grid.aboveData){drawGrid()}for(var i=0;i<series.length;++i){executeHooks(hooks.drawSeries,[ctx,series[i]]);drawSeries(series[i])}executeHooks(hooks.draw,[ctx]);if(grid.show&&grid.aboveData){drawGrid()}surface.render();triggerRedrawOverlay()}function extractRange(ranges,coord){var axis,from,to,key,axes=allAxes();for(var i=0;i<axes.length;++i){axis=axes[i];if(axis.direction==coord){key=coord+axis.n+\"axis\";if(!ranges[key]&&axis.n==1)key=coord+\"axis\";if(ranges[key]){from=ranges[key].from;to=ranges[key].to;break}}}if(!ranges[key]){axis=coord==\"x\"?xaxes[0]:yaxes[0];from=ranges[coord+\"1\"];to=ranges[coord+\"2\"]}if(from!=null&&to!=null&&from>to){var tmp=from;from=to;to=tmp}return{from:from,to:to,axis:axis}}function drawBackground(){ctx.save();ctx.translate(plotOffset.left,plotOffset.top);ctx.fillStyle=getColorOrGradient(options.grid.backgroundColor,plotHeight,0,\"rgba(255, 255, 255, 0)\");ctx.fillRect(0,0,plotWidth,plotHeight);ctx.restore()}function drawGrid(){var i,axes,bw,bc;ctx.save();ctx.translate(plotOffset.left,plotOffset.top);var markings=options.grid.markings;if(markings){if($.isFunction(markings)){axes=plot.getAxes();axes.xmin=axes.xaxis.min;axes.xmax=axes.xaxis.max;axes.ymin=axes.yaxis.min;axes.ymax=axes.yaxis.max;markings=markings(axes)}for(i=0;i<markings.length;++i){var m=markings[i],xrange=extractRange(m,\"x\"),yrange=extractRange(m,\"y\");if(xrange.from==null)xrange.from=xrange.axis.min;if(xrange.to==null)xrange.to=xrange.axis.max;\r\nif(yrange.from==null)yrange.from=yrange.axis.min;if(yrange.to==null)yrange.to=yrange.axis.max;if(xrange.to<xrange.axis.min||xrange.from>xrange.axis.max||yrange.to<yrange.axis.min||yrange.from>yrange.axis.max)continue;xrange.from=Math.max(xrange.from,xrange.axis.min);xrange.to=Math.min(xrange.to,xrange.axis.max);yrange.from=Math.max(yrange.from,yrange.axis.min);yrange.to=Math.min(yrange.to,yrange.axis.max);var xequal=xrange.from===xrange.to,yequal=yrange.from===yrange.to;if(xequal&&yequal){continue}xrange.from=Math.floor(xrange.axis.p2c(xrange.from));xrange.to=Math.floor(xrange.axis.p2c(xrange.to));yrange.from=Math.floor(yrange.axis.p2c(yrange.from));yrange.to=Math.floor(yrange.axis.p2c(yrange.to));if(xequal||yequal){var lineWidth=m.lineWidth||options.grid.markingsLineWidth,subPixel=lineWidth%2?.5:0;ctx.beginPath();ctx.strokeStyle=m.color||options.grid.markingsColor;ctx.lineWidth=lineWidth;if(xequal){ctx.moveTo(xrange.to+subPixel,yrange.from);ctx.lineTo(xrange.to+subPixel,yrange.to)}else{ctx.moveTo(xrange.from,yrange.to+subPixel);ctx.lineTo(xrange.to,yrange.to+subPixel)}ctx.stroke()}else{ctx.fillStyle=m.color||options.grid.markingsColor;ctx.fillRect(xrange.from,yrange.to,xrange.to-xrange.from,yrange.from-yrange.to)}}}axes=allAxes();bw=options.grid.borderWidth;for(var j=0;j<axes.length;++j){var axis=axes[j],box=axis.box,t=axis.tickLength,x,y,xoff,yoff;if(!axis.show||axis.ticks.length==0)continue;ctx.lineWidth=1;if(axis.direction==\"x\"){x=0;if(t==\"full\")y=axis.position==\"top\"?0:plotHeight;else y=box.top-plotOffset.top+(axis.position==\"top\"?box.height:0)}else{y=0;if(t==\"full\")x=axis.position==\"left\"?0:plotWidth;else x=box.left-plotOffset.left+(axis.position==\"left\"?box.width:0)}if(!axis.innermost){ctx.strokeStyle=axis.options.color;ctx.beginPath();xoff=yoff=0;if(axis.direction==\"x\")xoff=plotWidth+1;else yoff=plotHeight+1;if(ctx.lineWidth==1){if(axis.direction==\"x\"){y=Math.floor(y)+.5}else{x=Math.floor(x)+.5}}ctx.moveTo(x,y);ctx.lineTo(x+xoff,y+yoff);ctx.stroke()}ctx.strokeStyle=axis.options.tickColor;ctx.beginPath();for(i=0;i<axis.ticks.length;++i){var v=axis.ticks[i].v;xoff=yoff=0;if(isNaN(v)||v<axis.min||v>axis.max||t==\"full\"&&(typeof bw==\"object\"&&bw[axis.position]>0||bw>0)&&(v==axis.min||v==axis.max))continue;if(axis.direction==\"x\"){x=axis.p2c(v);yoff=t==\"full\"?-plotHeight:t;if(axis.position==\"top\")yoff=-yoff}else{y=axis.p2c(v);xoff=t==\"full\"?-plotWidth:t;if(axis.position==\"left\")xoff=-xoff}if(ctx.lineWidth==1){if(axis.direction==\"x\")x=Math.floor(x)+.5;else y=Math.floor(y)+.5}ctx.moveTo(x,y);ctx.lineTo(x+xoff,y+yoff)}ctx.stroke()}if(bw){bc=options.grid.borderColor;if(typeof bw==\"object\"||typeof bc==\"object\"){if(typeof bw!==\"object\"){bw={top:bw,right:bw,bottom:bw,left:bw}}if(typeof bc!==\"object\"){bc={top:bc,right:bc,bottom:bc,left:bc}}if(bw.top>0){ctx.strokeStyle=bc.top;ctx.lineWidth=bw.top;ctx.beginPath();ctx.moveTo(0-bw.left,0-bw.top/2);ctx.lineTo(plotWidth,0-bw.top/2);ctx.stroke()}if(bw.right>0){ctx.strokeStyle=bc.right;ctx.lineWidth=bw.right;ctx.beginPath();ctx.moveTo(plotWidth+bw.right/2,0-bw.top);ctx.lineTo(plotWidth+bw.right/2,plotHeight);ctx.stroke()}if(bw.bottom>0){ctx.strokeStyle=bc.bottom;ctx.lineWidth=bw.bottom;ctx.beginPath();ctx.moveTo(plotWidth+bw.right,plotHeight+bw.bottom/2);ctx.lineTo(0,plotHeight+bw.bottom/2);ctx.stroke()}if(bw.left>0){ctx.strokeStyle=bc.left;ctx.lineWidth=bw.left;ctx.beginPath();ctx.moveTo(0-bw.left/2,plotHeight+bw.bottom);ctx.lineTo(0-bw.left/2,0);ctx.stroke()}}else{ctx.lineWidth=bw;ctx.strokeStyle=options.grid.borderColor;ctx.strokeRect(-bw/2,-bw/2,plotWidth+bw,plotHeight+bw)}}ctx.restore()}function drawAxisLabels(){$.each(allAxes(),function(_,axis){var box=axis.box,legacyStyles=axis.direction+\"Axis \"+axis.direction+axis.n+\"Axis\",layer=\"flot-\"+axis.direction+\"-axis flot-\"+axis.direction+axis.n+\"-axis \"+legacyStyles,font=axis.options.font||\"flot-tick-label tickLabel\",tick,x,y,halign,valign;surface.removeText(layer);if(!axis.show||axis.ticks.length==0)return;for(var i=0;i<axis.ticks.length;++i){tick=axis.ticks[i];if(!tick.label||tick.v<axis.min||tick.v>axis.max)continue;if(axis.direction==\"x\"){halign=\"center\";x=plotOffset.left+axis.p2c(tick.v);if(axis.position==\"bottom\"){y=box.top+box.padding}else{y=box.top+box.height-box.padding;valign=\"bottom\"}}else{valign=\"middle\";y=plotOffset.top+axis.p2c(tick.v);if(axis.position==\"left\"){x=box.left+box.width-box.padding;halign=\"right\"}else{x=box.left+box.padding}}surface.addText(layer,x,y,tick.label,font,null,null,halign,valign)}})}function drawSeries(series){if(series.lines.show)drawSeriesLines(series);if(series.bars.show)drawSeriesBars(series);if(series.points.show)drawSeriesPoints(series)}function drawSeriesLines(series){function plotLine(datapoints,xoffset,yoffset,axisx,axisy){var points=datapoints.points,ps=datapoints.pointsize,prevx=null,prevy=null;ctx.beginPath();for(var i=ps;i<points.length;i+=ps){var x1=points[i-ps],y1=points[i-ps+1],x2=points[i],y2=points[i+1];if(x1==null||x2==null)continue;if(y1<=y2&&y1<axisy.min){if(y2<axisy.min)continue;x1=(axisy.min-y1)/(y2-y1)*(x2-x1)+x1;y1=axisy.min}else if(y2<=y1&&y2<axisy.min){if(y1<axisy.min)continue;x2=(axisy.min-y1)/(y2-y1)*(x2-x1)+x1;y2=axisy.min}if(y1>=y2&&y1>axisy.max){if(y2>axisy.max)continue;x1=(axisy.max-y1)/(y2-y1)*(x2-x1)+x1;y1=axisy.max}else if(y2>=y1&&y2>axisy.max){if(y1>axisy.max)continue;x2=(axisy.max-y1)/(y2-y1)*(x2-x1)+x1;y2=axisy.max}if(x1<=x2&&x1<axisx.min){if(x2<axisx.min)continue;y1=(axisx.min-x1)/(x2-x1)*(y2-y1)+y1;x1=axisx.min}else if(x2<=x1&&x2<axisx.min){if(x1<axisx.min)continue;y2=(axisx.min-x1)/(x2-x1)*(y2-y1)+y1;x2=axisx.min}if(x1>=x2&&x1>axisx.max){if(x2>axisx.max)continue;y1=(axisx.max-x1)/(x2-x1)*(y2-y1)+y1;x1=axisx.max}else if(x2>=x1&&x2>axisx.max){if(x1>axisx.max)continue;y2=(axisx.max-x1)/(x2-x1)*(y2-y1)+y1;x2=axisx.max}if(x1!=prevx||y1!=prevy)ctx.moveTo(axisx.p2c(x1)+xoffset,axisy.p2c(y1)+yoffset);prevx=x2;prevy=y2;ctx.lineTo(axisx.p2c(x2)+xoffset,axisy.p2c(y2)+yoffset)}ctx.stroke()}function plotLineArea(datapoints,axisx,axisy){var points=datapoints.points,ps=datapoints.pointsize,bottom=Math.min(Math.max(0,axisy.min),axisy.max),i=0,top,areaOpen=false,ypos=1,segmentStart=0,segmentEnd=0;while(true){if(ps>0&&i>points.length+ps)break;i+=ps;var x1=points[i-ps],y1=points[i-ps+ypos],x2=points[i],y2=points[i+ypos];if(areaOpen){if(ps>0&&x1!=null&&x2==null){segmentEnd=i;ps=-ps;ypos=2;continue}if(ps<0&&i==segmentStart+ps){ctx.fill();areaOpen=false;ps=-ps;ypos=1;i=segmentStart=segmentEnd+ps;continue}}if(x1==null||x2==null)continue;if(x1<=x2&&x1<axisx.min){if(x2<axisx.min)continue;y1=(axisx.min-x1)/(x2-x1)*(y2-y1)+y1;x1=axisx.min}else if(x2<=x1&&x2<axisx.min){if(x1<axisx.min)continue;y2=(axisx.min-x1)/(x2-x1)*(y2-y1)+y1;x2=axisx.min}if(x1>=x2&&x1>axisx.max){if(x2>axisx.max)continue;y1=(axisx.max-x1)/(x2-x1)*(y2-y1)+y1;x1=axisx.max}else if(x2>=x1&&x2>axisx.max){if(x1>axisx.max)continue;y2=(axisx.max-x1)/(x2-x1)*(y2-y1)+y1;x2=axisx.max}if(!areaOpen){ctx.beginPath();ctx.moveTo(axisx.p2c(x1),axisy.p2c(bottom));areaOpen=true}if(y1>=axisy.max&&y2>=axisy.max){ctx.lineTo(axisx.p2c(x1),axisy.p2c(axisy.max));ctx.lineTo(axisx.p2c(x2),axisy.p2c(axisy.max));continue}else if(y1<=axisy.min&&y2<=axisy.min){ctx.lineTo(axisx.p2c(x1),axisy.p2c(axisy.min));ctx.lineTo(axisx.p2c(x2),axisy.p2c(axisy.min));continue}var x1old=x1,x2old=x2;if(y1<=y2&&y1<axisy.min&&y2>=axisy.min){x1=(axisy.min-y1)/(y2-y1)*(x2-x1)+x1;y1=axisy.min}else if(y2<=y1&&y2<axisy.min&&y1>=axisy.min){x2=(axisy.min-y1)/(y2-y1)*(x2-x1)+x1;y2=axisy.min}if(y1>=y2&&y1>axisy.max&&y2<=axisy.max){x1=(axisy.max-y1)/(y2-y1)*(x2-x1)+x1;y1=axisy.max}else if(y2>=y1&&y2>axisy.max&&y1<=axisy.max){x2=(axisy.max-y1)/(y2-y1)*(x2-x1)+x1;y2=axisy.max}if(x1!=x1old){ctx.lineTo(axisx.p2c(x1old),axisy.p2c(y1))}ctx.lineTo(axisx.p2c(x1),axisy.p2c(y1));ctx.lineTo(axisx.p2c(x2),axisy.p2c(y2));if(x2!=x2old){ctx.lineTo(axisx.p2c(x2),axisy.p2c(y2));ctx.lineTo(axisx.p2c(x2old),axisy.p2c(y2))}}}ctx.save();ctx.translate(plotOffset.left,plotOffset.top);ctx.lineJoin=\"round\";var lw=series.lines.lineWidth,sw=series.shadowSize;if(lw>0&&sw>0){ctx.lineWidth=sw;ctx.strokeStyle=\"rgba(0,0,0,0.1)\";var angle=Math.PI/18;plotLine(series.datapoints,Math.sin(angle)*(lw/2+sw/2),Math.cos(angle)*(lw/2+sw/2),series.xaxis,series.yaxis);ctx.lineWidth=sw/2;plotLine(series.datapoints,Math.sin(angle)*(lw/2+sw/4),Math.cos(angle)*(lw/2+sw/4),series.xaxis,series.yaxis)}ctx.lineWidth=lw;ctx.strokeStyle=series.color;var fillStyle=getFillStyle(series.lines,series.color,0,plotHeight);if(fillStyle){ctx.fillStyle=fillStyle;plotLineArea(series.datapoints,series.xaxis,series.yaxis)}if(lw>0)plotLine(series.datapoints,0,0,series.xaxis,series.yaxis);ctx.restore()}function drawSeriesPoints(series){function plotPoints(datapoints,radius,fillStyle,offset,shadow,axisx,axisy,symbol){var points=datapoints.points,ps=datapoints.pointsize;for(var i=0;i<points.length;i+=ps){var x=points[i],y=points[i+1];if(x==null||x<axisx.min||x>axisx.max||y<axisy.min||y>axisy.max)continue;ctx.beginPath();x=axisx.p2c(x);y=axisy.p2c(y)+offset;if(symbol==\"circle\")ctx.arc(x,y,radius,0,shadow?Math.PI:Math.PI*2,false);else symbol(ctx,x,y,radius,shadow);ctx.closePath();if(fillStyle){ctx.fillStyle=fillStyle;ctx.fill()}ctx.stroke()}}ctx.save();ctx.translate(plotOffset.left,plotOffset.top);var lw=series.points.lineWidth,sw=series.shadowSize,radius=series.points.radius,symbol=series.points.symbol;if(lw==0)lw=1e-4;if(lw>0&&sw>0){var w=sw/2;ctx.lineWidth=w;ctx.strokeStyle=\"rgba(0,0,0,0.1)\";plotPoints(series.datapoints,radius,null,w+w/2,true,series.xaxis,series.yaxis,symbol);ctx.strokeStyle=\"rgba(0,0,0,0.2)\";plotPoints(series.datapoints,radius,null,w/2,true,series.xaxis,series.yaxis,symbol)}ctx.lineWidth=lw;ctx.strokeStyle=series.color;plotPoints(series.datapoints,radius,getFillStyle(series.points,series.color),0,false,series.xaxis,series.yaxis,symbol);ctx.restore()}function drawBar(x,y,b,barLeft,barRight,fillStyleCallback,axisx,axisy,c,horizontal,lineWidth){var left,right,bottom,top,drawLeft,drawRight,drawTop,drawBottom,tmp;if(horizontal){drawBottom=drawRight=drawTop=true;drawLeft=false;left=b;right=x;top=y+barLeft;bottom=y+barRight;if(right<left){tmp=right;right=left;left=tmp;drawLeft=true;drawRight=false}}else{drawLeft=drawRight=drawTop=true;drawBottom=false;left=x+barLeft;right=x+barRight;bottom=b;top=y;if(top<bottom){tmp=top;top=bottom;bottom=tmp;drawBottom=true;drawTop=false}}if(right<axisx.min||left>axisx.max||top<axisy.min||bottom>axisy.max)return;if(left<axisx.min){left=axisx.min;drawLeft=false}if(right>axisx.max){right=axisx.max;drawRight=false}if(bottom<axisy.min){bottom=axisy.min;drawBottom=false}if(top>axisy.max){top=axisy.max;drawTop=false}left=axisx.p2c(left);bottom=axisy.p2c(bottom);right=axisx.p2c(right);top=axisy.p2c(top);if(fillStyleCallback){c.fillStyle=fillStyleCallback(bottom,top);c.fillRect(left,top,right-left,bottom-top)}if(lineWidth>0&&(drawLeft||drawRight||drawTop||drawBottom)){c.beginPath();c.moveTo(left,bottom);if(drawLeft)c.lineTo(left,top);else c.moveTo(left,top);if(drawTop)c.lineTo(right,top);else c.moveTo(right,top);if(drawRight)c.lineTo(right,bottom);else c.moveTo(right,bottom);if(drawBottom)c.lineTo(left,bottom);else c.moveTo(left,bottom);c.stroke()}}function drawSeriesBars(series){function plotBars(datapoints,barLeft,barRight,fillStyleCallback,axisx,axisy){var points=datapoints.points,ps=datapoints.pointsize;for(var i=0;i<points.length;i+=ps){if(points[i]==null)continue;drawBar(points[i],points[i+1],points[i+2],barLeft,barRight,fillStyleCallback,axisx,axisy,ctx,series.bars.horizontal,series.bars.lineWidth)}}ctx.save();ctx.translate(plotOffset.left,plotOffset.top);ctx.lineWidth=series.bars.lineWidth;ctx.strokeStyle=series.color;var barLeft;switch(series.bars.align){case\"left\":barLeft=0;break;case\"right\":barLeft=-series.bars.barWidth;break;default:barLeft=-series.bars.barWidth/2}var fillStyleCallback=series.bars.fill?function(bottom,top){return getFillStyle(series.bars,series.color,bottom,top)}:null;plotBars(series.datapoints,barLeft,barLeft+series.bars.barWidth,fillStyleCallback,series.xaxis,series.yaxis);ctx.restore()}function getFillStyle(filloptions,seriesColor,bottom,top){var fill=filloptions.fill;if(!fill)return null;if(filloptions.fillColor)return getColorOrGradient(filloptions.fillColor,bottom,top,seriesColor);var c=$.color.parse(seriesColor);c.a=typeof fill==\"number\"?fill:.4;c.normalize();return c.toString()}function insertLegend(){if(options.legend.container!=null){$(options.legend.container).html(\"\")}else{placeholder.find(\".legend\").remove()}if(!options.legend.show){return}var fragments=[],entries=[],rowStarted=false,lf=options.legend.labelFormatter,s,label;for(var i=0;i<series.length;++i){s=series[i];if(s.label){label=lf?lf(s.label,s):s.label;if(label){entries.push({label:label,color:s.color})}}}if(options.legend.sorted){if($.isFunction(options.legend.sorted)){entries.sort(options.legend.sorted)}else if(options.legend.sorted==\"reverse\"){entries.reverse()}else{var ascending=options.legend.sorted!=\"descending\";entries.sort(function(a,b){return a.label==b.label?0:a.label<b.label!=ascending?1:-1})}}for(var i=0;i<entries.length;++i){var entry=entries[i];if(i%options.legend.noColumns==0){if(rowStarted)fragments.push(\"</tr>\");fragments.push(\"<tr>\");rowStarted=true}fragments.push('<td class=\"legendColorBox\"><div style=\"border:1px solid '+options.legend.labelBoxBorderColor+';padding:1px\"><div style=\"width:4px;height:0;border:5px solid '+entry.color+';overflow:hidden\"></div></div></td>'+'<td class=\"legendLabel\">'+entry.label+\"</td>\")}if(rowStarted)fragments.push(\"</tr>\");if(fragments.length==0)return;var table='<table style=\"font-size:smaller;color:'+options.grid.color+'\">'+fragments.join(\"\")+\"</table>\";if(options.legend.container!=null)$(options.legend.container).html(table);else{var pos=\"\",p=options.legend.position,m=options.legend.margin;if(m[0]==null)m=[m,m];if(p.charAt(0)==\"n\")pos+=\"top:\"+(m[1]+plotOffset.top)+\"px;\";else if(p.charAt(0)==\"s\")pos+=\"bottom:\"+(m[1]+plotOffset.bottom)+\"px;\";if(p.charAt(1)==\"e\")pos+=\"right:\"+(m[0]+plotOffset.right)+\"px;\";else if(p.charAt(1)==\"w\")pos+=\"left:\"+(m[0]+plotOffset.left)+\"px;\";var legend=$('<div class=\"legend\">'+table.replace('style=\"','style=\"position:absolute;'+pos+\";\")+\"</div>\").appendTo(placeholder);if(options.legend.backgroundOpacity!=0){var c=options.legend.backgroundColor;if(c==null){c=options.grid.backgroundColor;if(c&&typeof c==\"string\")c=$.color.parse(c);else c=$.color.extract(legend,\"background-color\");c.a=1;c=c.toString()}var div=legend.children();$('<div style=\"position:absolute;width:'+div.width()+\"px;height:\"+div.height()+\"px;\"+pos+\"background-color:\"+c+';\"> </div>').prependTo(legend).css(\"opacity\",options.legend.backgroundOpacity)}}}var highlights=[],redrawTimeout=null;function findNearbyItem(mouseX,mouseY,seriesFilter){var maxDistance=options.grid.mouseActiveRadius,smallestDistance=maxDistance*maxDistance+1,item=null,foundPoint=false,i,j,ps;for(i=series.length-1;i>=0;--i){if(!seriesFilter(series[i]))continue;var s=series[i],axisx=s.xaxis,axisy=s.yaxis,points=s.datapoints.points,mx=axisx.c2p(mouseX),my=axisy.c2p(mouseY),maxx=maxDistance/axisx.scale,maxy=maxDistance/axisy.scale;ps=s.datapoints.pointsize;if(axisx.options.inverseTransform)maxx=Number.MAX_VALUE;if(axisy.options.inverseTransform)maxy=Number.MAX_VALUE;if(s.lines.show||s.points.show){for(j=0;j<points.length;j+=ps){var x=points[j],y=points[j+1];if(x==null)continue;if(x-mx>maxx||x-mx<-maxx||y-my>maxy||y-my<-maxy)continue;var dx=Math.abs(axisx.p2c(x)-mouseX),dy=Math.abs(axisy.p2c(y)-mouseY),dist=dx*dx+dy*dy;if(dist<smallestDistance){smallestDistance=dist;item=[i,j/ps]}}}if(s.bars.show&&!item){var barLeft,barRight;switch(s.bars.align){case\"left\":barLeft=0;break;case\"right\":barLeft=-s.bars.barWidth;break;default:barLeft=-s.bars.barWidth/2}barRight=barLeft+s.bars.barWidth;for(j=0;j<points.length;j+=ps){var x=points[j],y=points[j+1],b=points[j+2];if(x==null)continue;if(series[i].bars.horizontal?mx<=Math.max(b,x)&&mx>=Math.min(b,x)&&my>=y+barLeft&&my<=y+barRight:mx>=x+barLeft&&mx<=x+barRight&&my>=Math.min(b,y)&&my<=Math.max(b,y))item=[i,j/ps]}}}if(item){i=item[0];j=item[1];ps=series[i].datapoints.pointsize;return{datapoint:series[i].datapoints.points.slice(j*ps,(j+1)*ps),dataIndex:j,series:series[i],seriesIndex:i}}return null}function onMouseMove(e){if(options.grid.hoverable)triggerClickHoverEvent(\"plothover\",e,function(s){return s[\"hoverable\"]!=false})}function onMouseLeave(e){if(options.grid.hoverable)triggerClickHoverEvent(\"plothover\",e,function(s){return false})}function onClick(e){triggerClickHoverEvent(\"plotclick\",e,function(s){return s[\"clickable\"]!=false})}function triggerClickHoverEvent(eventname,event,seriesFilter){var offset=eventHolder.offset(),canvasX=event.pageX-offset.left-plotOffset.left,canvasY=event.pageY-offset.top-plotOffset.top,pos=canvasToAxisCoords({left:canvasX,top:canvasY});pos.pageX=event.pageX;pos.pageY=event.pageY;var item=findNearbyItem(canvasX,canvasY,seriesFilter);if(item){item.pageX=parseInt(item.series.xaxis.p2c(item.datapoint[0])+offset.left+plotOffset.left,10);item.pageY=parseInt(item.series.yaxis.p2c(item.datapoint[1])+offset.top+plotOffset.top,10)}if(options.grid.autoHighlight){for(var i=0;i<highlights.length;++i){var h=highlights[i];if(h.auto==eventname&&!(item&&h.series==item.series&&h.point[0]==item.datapoint[0]&&h.point[1]==item.datapoint[1]))unhighlight(h.series,h.point)}if(item)highlight(item.series,item.datapoint,eventname)}placeholder.trigger(eventname,[pos,item])}function triggerRedrawOverlay(){var t=options.interaction.redrawOverlayInterval;if(t==-1){drawOverlay();return}if(!redrawTimeout)redrawTimeout=setTimeout(drawOverlay,t)}function drawOverlay(){redrawTimeout=null;octx.save();overlay.clear();octx.translate(plotOffset.left,plotOffset.top);var i,hi;for(i=0;i<highlights.length;++i){hi=highlights[i];if(hi.series.bars.show)drawBarHighlight(hi.series,hi.point);else drawPointHighlight(hi.series,hi.point)}octx.restore();executeHooks(hooks.drawOverlay,[octx])}function highlight(s,point,auto){if(typeof s==\"number\")s=series[s];if(typeof point==\"number\"){var ps=s.datapoints.pointsize;point=s.datapoints.points.slice(ps*point,ps*(point+1))}var i=indexOfHighlight(s,point);if(i==-1){highlights.push({series:s,point:point,auto:auto});triggerRedrawOverlay()}else if(!auto)highlights[i].auto=false}function unhighlight(s,point){if(s==null&&point==null){highlights=[];triggerRedrawOverlay();return}if(typeof s==\"number\")s=series[s];if(typeof point==\"number\"){var ps=s.datapoints.pointsize;point=s.datapoints.points.slice(ps*point,ps*(point+1))}var i=indexOfHighlight(s,point);if(i!=-1){highlights.splice(i,1);triggerRedrawOverlay()}}function indexOfHighlight(s,p){for(var i=0;i<highlights.length;++i){var h=highlights[i];if(h.series==s&&h.point[0]==p[0]&&h.point[1]==p[1])return i}return-1}function drawPointHighlight(series,point){var x=point[0],y=point[1],axisx=series.xaxis,axisy=series.yaxis,highlightColor=typeof series.highlightColor===\"string\"?series.highlightColor:$.color.parse(series.color).scale(\"a\",.5).toString();if(x<axisx.min||x>axisx.max||y<axisy.min||y>axisy.max)return;var pointRadius=series.points.radius+series.points.lineWidth/2;octx.lineWidth=pointRadius;octx.strokeStyle=highlightColor;var radius=1.5*pointRadius;x=axisx.p2c(x);y=axisy.p2c(y);octx.beginPath();if(series.points.symbol==\"circle\")octx.arc(x,y,radius,0,2*Math.PI,false);else series.points.symbol(octx,x,y,radius,false);octx.closePath();octx.stroke()}function drawBarHighlight(series,point){var highlightColor=typeof series.highlightColor===\"string\"?series.highlightColor:$.color.parse(series.color).scale(\"a\",.5).toString(),fillStyle=highlightColor,barLeft;switch(series.bars.align){case\"left\":barLeft=0;break;case\"right\":barLeft=-series.bars.barWidth;break;default:barLeft=-series.bars.barWidth/2}octx.lineWidth=series.bars.lineWidth;octx.strokeStyle=highlightColor;drawBar(point[0],point[1],point[2]||0,barLeft,barLeft+series.bars.barWidth,function(){return fillStyle},series.xaxis,series.yaxis,octx,series.bars.horizontal,series.bars.lineWidth)}function getColorOrGradient(spec,bottom,top,defaultColor){if(typeof spec==\"string\")return spec;else{var gradient=ctx.createLinearGradient(0,top,0,bottom);for(var i=0,l=spec.colors.length;i<l;++i){var c=spec.colors[i];if(typeof c!=\"string\"){var co=$.color.parse(defaultColor);if(c.brightness!=null)co=co.scale(\"rgb\",c.brightness);if(c.opacity!=null)co.a*=c.opacity;c=co.toString()}gradient.addColorStop(i/(l-1),c)}return gradient}}}$.plot=function(placeholder,data,options){var plot=new Plot($(placeholder),data,options,$.plot.plugins);return plot};$.plot.version=\"0.8.3\";$.plot.plugins=[];$.fn.plot=function(data,options){return this.each(function(){$.plot(this,data,options)})};function floorInBase(n,base){return base*Math.floor(n/base)}})(jQuery);","/* Javascript plotting library for jQuery, version 0.8.3.\r\n\r\nCopyright (c) 2007-2014 IOLA and Ole Laursen.\r\nLicensed under the MIT license.\r\n\r\n*/\r\n(function($,e,t){\"$:nomunge\";var i=[],n=$.resize=$.extend($.resize,{}),a,r=false,s=\"setTimeout\",u=\"resize\",m=u+\"-special-event\",o=\"pendingDelay\",l=\"activeDelay\",f=\"throttleWindow\";n[o]=200;n[l]=20;n[f]=true;$.event.special[u]={setup:function(){if(!n[f]&&this[s]){return false}var e=$(this);i.push(this);e.data(m,{w:e.width(),h:e.height()});if(i.length===1){a=t;h()}},teardown:function(){if(!n[f]&&this[s]){return false}var e=$(this);for(var t=i.length-1;t>=0;t--){if(i[t]==this){i.splice(t,1);break}}e.removeData(m);if(!i.length){if(r){cancelAnimationFrame(a)}else{clearTimeout(a)}a=null}},add:function(e){if(!n[f]&&this[s]){return false}var i;function a(e,n,a){var r=$(this),s=r.data(m)||{};s.w=n!==t?n:r.width();s.h=a!==t?a:r.height();i.apply(this,arguments)}if($.isFunction(e)){i=e;return a}else{i=e.handler;e.handler=a}}};function h(t){if(r===true){r=t||1}for(var s=i.length-1;s>=0;s--){var l=$(i[s]);if(l[0]==e||l.is(\":visible\")){var f=l.width(),c=l.height(),d=l.data(m);if(d&&(f!==d.w||c!==d.h)){l.trigger(u,[d.w=f,d.h=c]);r=t||true}}else{d=l.data(m);d.w=0;d.h=0}}if(a!==null){if(r&&(t==null||t-r<1e3)){a=e.requestAnimationFrame(h)}else{a=setTimeout(h,n[o]);r=false}}}if(!e.requestAnimationFrame){e.requestAnimationFrame=function(){return e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(t,i){return e.setTimeout(function(){t((new Date).getTime())},n[l])}}()}if(!e.cancelAnimationFrame){e.cancelAnimationFrame=function(){return e.webkitCancelRequestAnimationFrame||e.mozCancelRequestAnimationFrame||e.oCancelRequestAnimationFrame||e.msCancelRequestAnimationFrame||clearTimeout}()}})(jQuery,this);(function($){var options={};function init(plot){function onResize(){var placeholder=plot.getPlaceholder();if(placeholder.width()==0||placeholder.height()==0)return;plot.resize();plot.setupGrid();plot.draw()}function bindEvents(plot,eventHolder){plot.getPlaceholder().resize(onResize)}function shutdown(plot,eventHolder){plot.getPlaceholder().unbind(\"resize\",onResize)}plot.hooks.bindEvents.push(bindEvents);plot.hooks.shutdown.push(shutdown)}$.plot.plugins.push({init:init,options:options,name:\"resize\",version:\"1.0\"})})(jQuery);","/*\r\nAxis Labels Plugin for flot.\r\nhttp://github.com/markrcote/flot-axislabels\r\nOriginal code is Copyright (c) 2010 Xuan Luo.\r\nOriginal code was released under the GPLv3 license by Xuan Luo, September 2010.\r\nOriginal code was rereleased under the MIT license by Xuan Luo, April 2012.\r\nPermission is hereby granted, free of charge, to any person obtaining\r\na copy of this software and associated documentation files (the\r\n\"Software\"), to deal in the Software without restriction, including\r\nwithout limitation the rights to use, copy, modify, merge, publish,\r\ndistribute, sublicense, and/or sell copies of the Software, and to\r\npermit persons to whom the Software is furnished to do so, subject to\r\nthe following conditions:\r\nThe above copyright notice and this permission notice shall be\r\nincluded in all copies or substantial portions of the Software.\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\r\nEXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\r\nMERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\r\nNONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE\r\nLIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\r\nOF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION\r\nWITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\n\r\n(function ($) {\r\n    var options = {\r\n      axisLabels: {\r\n        show: true\r\n      }\r\n    };\r\n\r\n    function canvasSupported() {\r\n        return !!document.createElement('canvas').getContext;\r\n    }\r\n\r\n    function canvasTextSupported() {\r\n        if (!canvasSupported()) {\r\n            return false;\r\n        }\r\n        var dummy_canvas = document.createElement('canvas');\r\n        var context = dummy_canvas.getContext('2d');\r\n        return typeof context.fillText == 'function';\r\n    }\r\n\r\n    function css3TransitionSupported() {\r\n        var div = document.createElement('div');\r\n        return typeof div.style.MozTransition != 'undefined'    // Gecko\r\n            || typeof div.style.OTransition != 'undefined'      // Opera\r\n            || typeof div.style.webkitTransition != 'undefined' // WebKit\r\n            || typeof div.style.transition != 'undefined';\r\n    }\r\n\r\n\r\n    function AxisLabel(axisName, position, padding, plot, opts) {\r\n        this.axisName = axisName;\r\n        this.position = position;\r\n        this.padding = padding;\r\n        this.plot = plot;\r\n        this.opts = opts;\r\n        this.width = 0;\r\n        this.height = 0;\r\n    }\r\n\r\n    AxisLabel.prototype.cleanup = function() {\r\n    };\r\n\r\n\r\n    CanvasAxisLabel.prototype = new AxisLabel();\r\n    CanvasAxisLabel.prototype.constructor = CanvasAxisLabel;\r\n    function CanvasAxisLabel(axisName, position, padding, plot, opts) {\r\n        AxisLabel.prototype.constructor.call(this, axisName, position, padding,\r\n                                             plot, opts);\r\n    }\r\n\r\n    CanvasAxisLabel.prototype.calculateSize = function() {\r\n        if (!this.opts.axisLabelFontSizePixels)\r\n            this.opts.axisLabelFontSizePixels = 14;\r\n        if (!this.opts.axisLabelFontFamily)\r\n            this.opts.axisLabelFontFamily = 'sans-serif';\r\n\r\n        var textWidth = this.opts.axisLabelFontSizePixels + this.padding;\r\n        var textHeight = this.opts.axisLabelFontSizePixels + this.padding;\r\n        if (this.position == 'left' || this.position == 'right') {\r\n            this.width = this.opts.axisLabelFontSizePixels + this.padding;\r\n            this.height = 0;\r\n        } else {\r\n            this.width = 0;\r\n            this.height = this.opts.axisLabelFontSizePixels + this.padding;\r\n        }\r\n    };\r\n\r\n    CanvasAxisLabel.prototype.draw = function(box) {\r\n        if (!this.opts.axisLabelColour)\r\n            this.opts.axisLabelColour = 'black';\r\n        var ctx = this.plot.getCanvas().getContext('2d');\r\n        ctx.save();\r\n        ctx.font = this.opts.axisLabelFontSizePixels + 'px ' +\r\n            this.opts.axisLabelFontFamily;\r\n        ctx.fillStyle = this.opts.axisLabelColour;\r\n        var width = ctx.measureText(this.opts.axisLabel).width;\r\n        var height = this.opts.axisLabelFontSizePixels;\r\n        var x, y, angle = 0;\r\n        if (this.position == 'top') {\r\n            x = box.left + box.width/2 - width/2;\r\n            y = box.top + height*0.72;\r\n        } else if (this.position == 'bottom') {\r\n            x = box.left + box.width/2 - width/2;\r\n            y = box.top + box.height - height*0.72;\r\n        } else if (this.position == 'left') {\r\n            x = box.left + height*0.72;\r\n            y = box.height/2 + box.top + width/2;\r\n            angle = -Math.PI/2;\r\n        } else if (this.position == 'right') {\r\n            x = box.left + box.width - height*0.72;\r\n            y = box.height/2 + box.top - width/2;\r\n            angle = Math.PI/2;\r\n        }\r\n        ctx.translate(x, y);\r\n        ctx.rotate(angle);\r\n        ctx.fillText(this.opts.axisLabel, 0, 0);\r\n        ctx.restore();\r\n    };\r\n\r\n\r\n    HtmlAxisLabel.prototype = new AxisLabel();\r\n    HtmlAxisLabel.prototype.constructor = HtmlAxisLabel;\r\n    function HtmlAxisLabel(axisName, position, padding, plot, opts) {\r\n        AxisLabel.prototype.constructor.call(this, axisName, position,\r\n                                             padding, plot, opts);\r\n        this.elem = null;\r\n    }\r\n\r\n    HtmlAxisLabel.prototype.calculateSize = function() {\r\n        var elem = $('<div class=\"axisLabels\" style=\"position:absolute;\">' +\r\n                     this.opts.axisLabel + '</div>');\r\n        this.plot.getPlaceholder().append(elem);\r\n        // store height and width of label itself, for use in draw()\r\n        this.labelWidth = elem.outerWidth(true);\r\n        this.labelHeight = elem.outerHeight(true);\r\n        elem.remove();\r\n\r\n        this.width = this.height = 0;\r\n        if (this.position == 'left' || this.position == 'right') {\r\n            this.width = this.labelWidth + this.padding;\r\n        } else {\r\n            this.height = this.labelHeight + this.padding;\r\n        }\r\n    };\r\n\r\n    HtmlAxisLabel.prototype.cleanup = function() {\r\n        if (this.elem) {\r\n            this.elem.remove();\r\n        }\r\n    };\r\n\r\n    HtmlAxisLabel.prototype.draw = function(box) {\r\n        this.plot.getPlaceholder().find('#' + this.axisName + 'Label').remove();\r\n        this.elem = $('<div id=\"' + this.axisName +\r\n                      'Label\" \" class=\"axisLabels\" style=\"position:absolute;\">'\r\n                      + this.opts.axisLabel + '</div>');\r\n        this.plot.getPlaceholder().append(this.elem);\r\n        if (this.position == 'top') {\r\n            this.elem.css('left', box.left + box.width/2 - this.labelWidth/2 +\r\n                          'px');\r\n            this.elem.css('top', box.top + 'px');\r\n        } else if (this.position == 'bottom') {\r\n            this.elem.css('left', box.left + box.width/2 - this.labelWidth/2 +\r\n                          'px');\r\n            this.elem.css('top', box.top + box.height - this.labelHeight +\r\n                          'px');\r\n        } else if (this.position == 'left') {\r\n            this.elem.css('top', box.top + box.height/2 - this.labelHeight/2 +\r\n                          'px');\r\n            this.elem.css('left', box.left + 'px');\r\n        } else if (this.position == 'right') {\r\n            this.elem.css('top', box.top + box.height/2 - this.labelHeight/2 +\r\n                          'px');\r\n            this.elem.css('left', box.left + box.width - this.labelWidth +\r\n                          'px');\r\n        }\r\n    };\r\n\r\n\r\n    CssTransformAxisLabel.prototype = new HtmlAxisLabel();\r\n    CssTransformAxisLabel.prototype.constructor = CssTransformAxisLabel;\r\n    function CssTransformAxisLabel(axisName, position, padding, plot, opts) {\r\n        HtmlAxisLabel.prototype.constructor.call(this, axisName, position,\r\n                                                 padding, plot, opts);\r\n    }\r\n\r\n    CssTransformAxisLabel.prototype.calculateSize = function() {\r\n        HtmlAxisLabel.prototype.calculateSize.call(this);\r\n        this.width = this.height = 0;\r\n        if (this.position == 'left' || this.position == 'right') {\r\n            this.width = this.labelHeight + this.padding;\r\n        } else {\r\n            this.height = this.labelHeight + this.padding;\r\n        }\r\n    };\r\n\r\n    CssTransformAxisLabel.prototype.transforms = function(degrees, x, y) {\r\n        var stransforms = {\r\n            '-moz-transform': '',\r\n            '-webkit-transform': '',\r\n            '-o-transform': '',\r\n            '-ms-transform': ''\r\n        };\r\n        if (x != 0 || y != 0) {\r\n            var stdTranslate = ' translate(' + x + 'px, ' + y + 'px)';\r\n            stransforms['-moz-transform'] += stdTranslate;\r\n            stransforms['-webkit-transform'] += stdTranslate;\r\n            stransforms['-o-transform'] += stdTranslate;\r\n            stransforms['-ms-transform'] += stdTranslate;\r\n        }\r\n        if (degrees != 0) {\r\n            var rotation = degrees / 90;\r\n            var stdRotate = ' rotate(' + degrees + 'deg)';\r\n            stransforms['-moz-transform'] += stdRotate;\r\n            stransforms['-webkit-transform'] += stdRotate;\r\n            stransforms['-o-transform'] += stdRotate;\r\n            stransforms['-ms-transform'] += stdRotate;\r\n        }\r\n        var s = 'top: 0; left: 0; ';\r\n        for (var prop in stransforms) {\r\n            if (stransforms[prop]) {\r\n                s += prop + ':' + stransforms[prop] + ';';\r\n            }\r\n        }\r\n        s += ';';\r\n        return s;\r\n    };\r\n\r\n    CssTransformAxisLabel.prototype.calculateOffsets = function(box) {\r\n        var offsets = { x: 0, y: 0, degrees: 0 };\r\n        if (this.position == 'bottom') {\r\n            offsets.x = box.left + box.width/2 - this.labelWidth/2;\r\n            offsets.y = box.top + box.height - this.labelHeight;\r\n        } else if (this.position == 'top') {\r\n            offsets.x = box.left + box.width/2 - this.labelWidth/2;\r\n            offsets.y = box.top;\r\n        } else if (this.position == 'left') {\r\n            offsets.degrees = -90;\r\n            offsets.x = box.left - this.labelWidth/2 + this.labelHeight/2;\r\n            offsets.y = box.height/2 + box.top;\r\n        } else if (this.position == 'right') {\r\n            offsets.degrees = 90;\r\n            offsets.x = box.left + box.width - this.labelWidth/2\r\n                        - this.labelHeight/2;\r\n            offsets.y = box.height/2 + box.top;\r\n        }\r\n        offsets.x = Math.round(offsets.x);\r\n        offsets.y = Math.round(offsets.y);\r\n\r\n        return offsets;\r\n    };\r\n\r\n    CssTransformAxisLabel.prototype.draw = function(box) {\r\n        this.plot.getPlaceholder().find(\".\" + this.axisName + \"Label\").remove();\r\n        var offsets = this.calculateOffsets(box);\r\n        this.elem = $('<div class=\"axisLabels ' + this.axisName +\r\n                      'Label\" style=\"position:absolute; ' +\r\n                      this.transforms(offsets.degrees, offsets.x, offsets.y) +\r\n                      '\">' + this.opts.axisLabel + '</div>');\r\n        this.plot.getPlaceholder().append(this.elem);\r\n    };\r\n\r\n\r\n    IeTransformAxisLabel.prototype = new CssTransformAxisLabel();\r\n    IeTransformAxisLabel.prototype.constructor = IeTransformAxisLabel;\r\n    function IeTransformAxisLabel(axisName, position, padding, plot, opts) {\r\n        CssTransformAxisLabel.prototype.constructor.call(this, axisName,\r\n                                                         position, padding,\r\n                                                         plot, opts);\r\n        this.requiresResize = false;\r\n    }\r\n\r\n    IeTransformAxisLabel.prototype.transforms = function(degrees, x, y) {\r\n        // I didn't feel like learning the crazy Matrix stuff, so this uses\r\n        // a combination of the rotation transform and CSS positioning.\r\n        var s = '';\r\n        if (degrees != 0) {\r\n            var rotation = degrees/90;\r\n            while (rotation < 0) {\r\n                rotation += 4;\r\n            }\r\n            s += ' filter: progid:DXImageTransform.Microsoft.BasicImage(rotation=' + rotation + '); ';\r\n            // see below\r\n            this.requiresResize = (this.position == 'right');\r\n        }\r\n        if (x != 0) {\r\n            s += 'left: ' + x + 'px; ';\r\n        }\r\n        if (y != 0) {\r\n            s += 'top: ' + y + 'px; ';\r\n        }\r\n        return s;\r\n    };\r\n\r\n    IeTransformAxisLabel.prototype.calculateOffsets = function(box) {\r\n        var offsets = CssTransformAxisLabel.prototype.calculateOffsets.call(\r\n                          this, box);\r\n        // adjust some values to take into account differences between\r\n        // CSS and IE rotations.\r\n        if (this.position == 'top') {\r\n            // FIXME: not sure why, but placing this exactly at the top causes\r\n            // the top axis label to flip to the bottom...\r\n            offsets.y = box.top + 1;\r\n        } else if (this.position == 'left') {\r\n            offsets.x = box.left;\r\n            offsets.y = box.height/2 + box.top - this.labelWidth/2;\r\n        } else if (this.position == 'right') {\r\n            offsets.x = box.left + box.width - this.labelHeight;\r\n            offsets.y = box.height/2 + box.top - this.labelWidth/2;\r\n        }\r\n        return offsets;\r\n    };\r\n\r\n    IeTransformAxisLabel.prototype.draw = function(box) {\r\n        CssTransformAxisLabel.prototype.draw.call(this, box);\r\n        if (this.requiresResize) {\r\n            this.elem = this.plot.getPlaceholder().find(\".\" + this.axisName +\r\n                                                        \"Label\");\r\n            // Since we used CSS positioning instead of transforms for\r\n            // translating the element, and since the positioning is done\r\n            // before any rotations, we have to reset the width and height\r\n            // in case the browser wrapped the text (specifically for the\r\n            // y2axis).\r\n            this.elem.css('width', this.labelWidth);\r\n            this.elem.css('height', this.labelHeight);\r\n        }\r\n    };\r\n\r\n\r\n    function init(plot) {\r\n        plot.hooks.processOptions.push(function (plot, options) {\r\n\r\n            if (!options.axisLabels.show)\r\n                return;\r\n\r\n            // This is kind of a hack. There are no hooks in Flot between\r\n            // the creation and measuring of the ticks (setTicks, measureTickLabels\r\n            // in setupGrid() ) and the drawing of the ticks and plot box\r\n            // (insertAxisLabels in setupGrid() ).\r\n            //\r\n            // Therefore, we use a trick where we run the draw routine twice:\r\n            // the first time to get the tick measurements, so that we can change\r\n            // them, and then have it draw it again.\r\n            var secondPass = false;\r\n\r\n            var axisLabels = {};\r\n            var axisOffsetCounts = { left: 0, right: 0, top: 0, bottom: 0 };\r\n\r\n            var defaultPadding = 2;  // padding between axis and tick labels\r\n            plot.hooks.draw.push(function (plot, ctx) {\r\n                var hasAxisLabels = false;\r\n                if (!secondPass) {\r\n                    // MEASURE AND SET OPTIONS\r\n                    $.each(plot.getAxes(), function(axisName, axis) {\r\n                        var opts = axis.options // Flot 0.7\r\n                            || plot.getOptions()[axisName]; // Flot 0.6\r\n\r\n                        // Handle redraws initiated outside of this plug-in.\r\n                        if (axisName in axisLabels) {\r\n                            axis.labelHeight = axis.labelHeight -\r\n                                axisLabels[axisName].height;\r\n                            axis.labelWidth = axis.labelWidth -\r\n                                axisLabels[axisName].width;\r\n                            opts.labelHeight = axis.labelHeight;\r\n                            opts.labelWidth = axis.labelWidth;\r\n                            axisLabels[axisName].cleanup();\r\n                            delete axisLabels[axisName];\r\n                        }\r\n\r\n                        if (!opts || !opts.axisLabel || !axis.show)\r\n                            return;\r\n\r\n                        hasAxisLabels = true;\r\n                        var renderer = null;\r\n\r\n                        if (!opts.axisLabelUseHtml &&\r\n                            navigator.appName == 'Microsoft Internet Explorer') {\r\n                            var ua = navigator.userAgent;\r\n                            var re  = new RegExp(\"MSIE ([0-9]{1,}[\\.0-9]{0,})\");\r\n                            if (re.exec(ua) != null) {\r\n                                rv = parseFloat(RegExp.$1);\r\n                            }\r\n                            if (rv >= 9 && !opts.axisLabelUseCanvas && !opts.axisLabelUseHtml) {\r\n                                renderer = CssTransformAxisLabel;\r\n                            } else if (!opts.axisLabelUseCanvas && !opts.axisLabelUseHtml) {\r\n                                renderer = IeTransformAxisLabel;\r\n                            } else if (opts.axisLabelUseCanvas) {\r\n                                renderer = CanvasAxisLabel;\r\n                            } else {\r\n                                renderer = HtmlAxisLabel;\r\n                            }\r\n                        } else {\r\n                            if (opts.axisLabelUseHtml || (!css3TransitionSupported() && !canvasTextSupported()) && !opts.axisLabelUseCanvas) {\r\n                                renderer = HtmlAxisLabel;\r\n                            } else if (opts.axisLabelUseCanvas || !css3TransitionSupported()) {\r\n                                renderer = CanvasAxisLabel;\r\n                            } else {\r\n                                renderer = CssTransformAxisLabel;\r\n                            }\r\n                        }\r\n\r\n                        var padding = opts.axisLabelPadding === undefined ?\r\n                                      defaultPadding : opts.axisLabelPadding;\r\n\r\n                        axisLabels[axisName] = new renderer(axisName,\r\n                                                            axis.position, padding,\r\n                                                            plot, opts);\r\n\r\n                        // flot interprets axis.labelHeight and .labelWidth as\r\n                        // the height and width of the tick labels. We increase\r\n                        // these values to make room for the axis label and\r\n                        // padding.\r\n\r\n                        axisLabels[axisName].calculateSize();\r\n\r\n                        // AxisLabel.height and .width are the size of the\r\n                        // axis label and padding.\r\n                        // Just set opts here because axis will be sorted out on\r\n                        // the redraw.\r\n\r\n                        opts.labelHeight = axis.labelHeight +\r\n                            axisLabels[axisName].height;\r\n                        opts.labelWidth = axis.labelWidth +\r\n                            axisLabels[axisName].width;\r\n                    });\r\n\r\n                    // If there are axis labels, re-draw with new label widths and\r\n                    // heights.\r\n\r\n                    if (hasAxisLabels) {\r\n                        secondPass = true;\r\n                        plot.setupGrid();\r\n                        plot.draw();\r\n                    }\r\n                } else {\r\n                    secondPass = false;\r\n                    // DRAW\r\n                    $.each(plot.getAxes(), function(axisName, axis) {\r\n                        var opts = axis.options // Flot 0.7\r\n                            || plot.getOptions()[axisName]; // Flot 0.6\r\n                        if (!opts || !opts.axisLabel || !axis.show)\r\n                            return;\r\n\r\n                        axisLabels[axisName].draw(axis.box);\r\n                    });\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n\r\n    $.plot.plugins.push({\r\n        init: init,\r\n        options: options,\r\n        name: 'axisLabels',\r\n        version: '2.0'\r\n    });\r\n})(jQuery);"]}